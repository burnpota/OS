======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-01-19T06:49:53Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-02-07T11:05:03Z</b><br><b>id : 500A000000Ze5dUIAR</b><br>======================<br><br><b><font size=15>
제목  : dr_edu-ap1 kernel: end_request: I/O error
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요. 현재 서버에서 지속적으로 아래와 같은 로그가 발생하고 있습니다.<br>n 18 10:56:03 dr_edu-ap1 kernel: end_request: I/O error, dev sdd, sector 41943032<br>Jan 18 10:56:03 dr_edu-ap1 kernel: end_request: I/O error, dev sdd, sector 63<br>Jan 18 10:56:03 dr_edu-ap1 kernel: end_request: I/O error, dev sdc, sector 335544304<br>Jan 18 10:56:03 dr_edu-ap1 kernel: end_request: I/O error, dev sdc, sector 0<br>Jan 18 10:56:03 dr_edu-ap1 kernel: end_request: I/O error, dev sdb, sector 0<br><br>sosreport를 첨부하오니 분석 부탁드립니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 5.6</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>dr_edu-ap01</hostname><br><br><br><comment id="a0aA000000LWmUgIAL"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2018-01-23T05:00:17Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2018-01-23T05:00:17Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>Q1) dump와 DUMP는 active가 된 상태 아닌가요? 작업을 vgchage -an vg0 를 한 후에 진행하였는데 dump와 DUMP가 inactive가 되지 않아서<br>vg0가 정상적인 inactive가 되지 않았고 pv 4개중 3개만 missing(sdb sdc sdd)이 되어서 에러 메세지가 발생하는것 아닌가요? <br>unknown에 대한 정보를 보고하는것이라면 로지컬 볼륨은 이미 umount한 상태이긴 합니다.-_-a<br>A1) 죄송합니다. 제가 잘못 말씀을 드린거 같네요. 말씀하신 바가 맞습니다. 현재 vg0 중에 active 가 된것은 오직 dump 와 DUMP 입니다.<br><br>Q2) 추가로 궁금한것은 말씀하신 데로 lvm에 대한 정보를 주기적으로 커널에 보고를 한다면 어떠한 데몬이 보고를 하는지 알수 있을까요?<br>A2) 대부분의 LVM 명령이 /dev 내에 디바이스들의 LVM metadata 를 check 하는 동안에 나타나는  I/O 에러를 커널이 보고하는 메시지<br>       라고 이해하실 수 있습니다. 현재의 sosreport 에서 lsof 를 보면 아래와 같이 vgdisplay 가 실행이 수행하고 있는것을 보실 수 있습니다.<br><br>       vgdisplay 이외에도 다른 LVM 명령을 실행하게 되신다면 계속해서 Buffer I/O 에러는 나타날것이므로, 이전에 안내드린것과 같이 <br>       DUMP 와 dump 이외의 볼륨들은 /etc/lvm/lvm.conf 내에서 filter 에 적용하신다면 현재의 Buffer I/O 에러는 사라지게 될것입니다.<br><br>$ cat lsof<br>~~ skip<br>1478 vgdisplay 16959        0  cwd       DIR                8,2     4096    1540097 /root<br>1479 vgdisplay 16959        0  rtd       DIR                8,2     4096          2 /<br>1480 vgdisplay 16959        0  txt       REG                8,2   772264    4091202 /usr/sbin/lvm                                                                                                                  <br>1481 vgdisplay 16959        0  mem       REG                8,2   144776    6783001 /lib64/ld-2.5.so<br>~~ skip<br><br><br>[ 참고문서 ]<br><br>[1]  kernel: Buffer I/O errors in /var/log/messages. <br>- https://access.redhat.com/solutions/386883<br><br>감사합니다.<br><br><publishedDate>2018-01-23T05:00:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LWm3GIAT"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-01-23T04:09:38Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-01-23T04:09:38Z</b><br><br>안녕하세요. 답변감사합니다.<br>말씀하신 부분에서 lv 들이 모두 inactive가 되었다고 하셨는데요 <br>$ cat lvs_-a_-o_devices <br>  Couldn't find device with uuid lPZWXX-0YjP-R85z-nr7e-TddX-agHh-LLE2Al.<br>  Couldn't find device with uuid gIseQe-kVYh-LPjL-Go9l-7ZQo-OQPl-ImlczS.<br>  Couldn't find device with uuid zNheLX-42KN-4HKp-xGmd-gdZ6-BfNb-rie2Yi.<br>  LV    VG   Attr   LSize   Origin Snap%  Move Log Copy%  Convert Devices              <br>  DUMP  vg0  -wi-a-   5.00G                                       /dev/sda5(0)         <br>  Tools vg0  -wi---  10.00G                                       unknown device(10240)<br>  dump  vg0  -wi-a-   5.00G                                       /dev/sda5(1280)      <br>  http  vg0  -wi---  49.99G                                       unknown device(28160)<br>  jeus  vg0  -wi---  20.00G                                       unknown device(0)    <br>  jeus2 vg0  -wi--- 130.00G                                       unknown device(5120) <br>  jeus2 vg0  -wi--- 130.00G                                       unknown device(0)<br><br>dump와 DUMP는 active가 된 상태 아닌가요?<br>작업을 vgchage -an vg0 를 한 후에 진행하였는데 dump와 DUMP가 inactive가 되지 않아서<br>vg0가 정상적인 inactive가 되지 않았고<br>pv 4개중 3개만 missing(sdb sdc sdd)이 되어서 에러 메세지가 발생하는것 아닌가요? unknown에 대한 정보를 보고하는것이라면 로지컬 볼륨은 이미 umount한 상태이긴 합니다.-_-a<br><br>추가로 궁금한것은<br>말씀하신 데로 lvm에 대한 정보를 주기적으로 커널에 보고를 한다면<br>어떠한 데몬이 보고를 하는지 알수 있을까요?<br><br><publishedDate>2018-01-23T04:09:38Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LWlDHIA1"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2018-01-23T02:17:40Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2018-01-23T02:17:40Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>Q) 추가 내용 보내드리겠습니다. 작업의 목적은 주센터에서 dr로 전환후 다시 dr에서 주센터로 원복하는 것입니다.<br>     주센터에서 dr로 전환시 현재sda5 sdb1 sdc1 sdd1 의 4개의 pv가 vg0영역에 포함되어 lv를 구성하여 사용중입니다. dr로 전환후에는 문제없이 서비스가 됩니다.<br><br>     그런데, dr에서 주센터로 전환시 아래와 같은 방법을 통해서 전환을 합니다.<br>     우선 파일시스템으로 사용중인  lv는 umount 후 vgchage 를이용하여 inactive를 하고 pv를 스토리지에서 제거를 하는 방식입니다..<br><br>     문제는 sdb sdc sdd의 경우 별도의 외장 스토리지지만 sda5의경우 시스템 영역임에도 불구하고<br>     vg0영역에 들어가 있어서 아래와 같은 에러가 발생하는것 같다고 생각하는데요<br><br>     궁금한것은, 하지만 vg0를 inactive를 하였는데도 불구하고   왜 io error가 발생하는 건가요?<br>     sda5는 raw device 로 kdump사용중인 DUMP와  파일시스템으로 사용중인 dump가 존재합니다.<br><br>     kdump가 주기적으로 DUMP를 모니터링 해서 그런건가요?<br><br>A) 먼저, 상세한 설명을 해주셔서 감사합니다.<br><br>$ cat lvs_-a_-o_devices <br>  Couldn't find device with uuid lPZWXX-0YjP-R85z-nr7e-TddX-agHh-LLE2Al.<br>  Couldn't find device with uuid gIseQe-kVYh-LPjL-Go9l-7ZQo-OQPl-ImlczS.<br>  Couldn't find device with uuid zNheLX-42KN-4HKp-xGmd-gdZ6-BfNb-rie2Yi.<br>  LV    VG   Attr   LSize   Origin Snap%  Move Log Copy%  Convert Devices              <br>  DUMP  vg0  -wi-a-   5.00G                                       /dev/sda5(0)         <br>  Tools vg0  -wi---  10.00G                                       unknown device(10240)<br>  dump  vg0  -wi-a-   5.00G                                       /dev/sda5(1280)      <br>  http  vg0  -wi---  49.99G                                       unknown device(28160)<br>  jeus  vg0  -wi---  20.00G                                       unknown device(0)    <br>  jeus2 vg0  -wi--- 130.00G                                       unknown device(5120) <br>  jeus2 vg0  -wi--- 130.00G                                       unknown device(0)<br><br>말씀해주신 내용을 기반으로 LVM 정보를 다시 확인을 해보니 아래와 같이 해당 볼륨정보와 이들이 모두 inactive<br>가 된것을 확인하였습니다. 하지만 일부 LV 정보들이 unknown device 상태인데, LVM 이 주기적으로 디바이스들<br>의 메타데이터를 검사하는 동안에 쓰여진 I/O  들이 이 unknown device 디바이스들로 전달이 되어서 Buffer I/O<br>에러가 발생하는것으로 보이니, 아래 참고문서[1]을 활용하셔서 vg0 볼륨을 lvm filter 에 적용하실것을 권장드립<br>니다.<br><br>[ 참고문서 ]<br><br>[1]  What is LVM's filter setting and how do I configure it easily in RHEL?<br>- https://access.redhat.com/solutions/65960<br><br>감사합니다.<br><br><publishedDate>2018-01-23T02:17:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LWa8nIAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-01-22T13:41:33Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-01-22T13:41:33Z</b><br><br>답변감사합니다.<br>추가 내용 보내드리겠습니다. 작업의 목적은 주센터에서 dr로 전환후 다시 dr에서 주센터로 원복하는 것입니다.<br>주센터에서 dr로 전환시<br>현재sda5 sdb1 sdc1 sdd1 의 4개의 pv가 vg0영역에 포함되어 lv를 구성하여 사용중입니다. dr로 전환후에는 문제없이 서비스가 됩니다.<br>그런데<br>dr에서 주센터로 전환시 아래와 같은 방법을 통해서 전환을 합니다.<br>우선 파일시스템으로 사용중인  lv는 umount 후 vgchage 를이용하여 inactive를 하고 pv를 스토리지에서 제거를 하는 방식입니다..<br><br>문제는 sdb sdc sdd의 경우 별도의 외장 스토리지지만 sda5의경우 시스템 영역임에도 불구하고<br>vg0영역에 들어가 있어서 아래와 같은 에러가 발생하는것 같다고 생각하는데요<br><br><br>궁금한것은<br>하지만 vg0를 inactive를 하였는데도 불구하고   왜 io error가 발생하는 건가요?<br>sda5는 raw device 로 kdump사용중인 DUMP와 <br>파일시스템으로 사용중인 dump가 존재합니다.<br><br>kdump가 주기적으로 DUMP를 모니터링 해서 그런건가요?<br><br>더 자세한 설명이 필요하시면<br>01036209917 송기호책임으로 연락부탁드립니다.<br><br><publishedDate>2018-01-22T13:41:33Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LWUSiIAP"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2018-01-22T06:00:48Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2018-01-22T06:00:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br> 843 Jan  5 21:15:39 dr_edu-ap1 kernel: sd 0:0:3:0: SCSI error: return code = 0x00010000                                                                                                                           <br> 844 Jan  5 21:15:39 dr_edu-ap1 kernel: end_request: I/O error, dev sdd, sector 41929407<br> 845 Jan  5 21:15:39 dr_edu-ap1 kernel: Buffer I/O error on device sdd1, logical block 41929344<br> 846 Jan  5 21:15:39 dr_edu-ap1 kernel: Buffer I/O error on device sdd1, logical block 41929345<br>~~ 생략<br> 853 Jan  5 21:15:39 dr_edu-ap1 kernel: sd 0:0:3:0: SCSI error: return code = 0x00010000<br> 854 Jan  5 21:15:39 dr_edu-ap1 kernel: end_request: I/O error, dev sdd, sector 41929407<br><br>올려주신 위의 로그는 참고문서[1]에서 기술된것과 같이 대부분 하드웨어와의 연결성 문제로 알려져 있습니다.<br>하드웨어 벤더사로 연락하셔서 원인분석과 문제해결 방안에 대하여 기술문의 드릴것을 권장드리며, 이후에도<br>저희 Red Hat 의 지원이 필요하시다면 다시 연락주십시오.<br><br><br>[ 참고문서 ]<br><br>[1] Getting error: 'SCSI error: return code = 0x00010000'<br>- https://access.redhat.com/solutions/163203 <br><br>감사합니다.<br><br><publishedDate>2018-01-22T06:00:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LWT2KIAX"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2018-01-22T02:14:47Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2018-01-22T02:14:47Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>현재 올려주신 문의내용을 자세히 살펴보고 있는중이며 확인이 되는대로 업데이트를 남기도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-22T02:14:47Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>