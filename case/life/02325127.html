======================<br><b>생성계정 : JIMIN KIM</b><br><b>생성날짜 : 2019-02-26T11:29:25Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2019-04-02T04:15:02Z</b><br><b>id : 5002K00000dM5oIQAS</b><br>======================<br><br><b><font size=15>
제목  : /var/log/messages MCE 관련 문
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>아래와 같이 서버에서 MCE 관련해서 memory error가 발생하였는데요.<br>로그 내용으로는 CE로 correctable error로 특이 사항은 없는 것 같은데요.<br><br>문의 사항이 있어서 문의드리려 합니다.<br><br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: HANDLING MCE MEMORY ERROR<br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: CPU 0: Machine Check Event: 0 Bank 10: 8c000048000800c2<br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: TSC 0<br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: ADDR c2fe28000<br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: MISC 122100010001108c<br>Feb 25 21:57:58 SLPATCDL02 kernel: EDAC sbridge MC0: PROCESSOR 0:206d7 TIME 1551099478 SOCKET 0 APIC 0<br>Feb 25 21:57:58 SLPATCDL02 kernel: mce: [Hardware Error]: Machine check events logged<br>Feb 25 21:57:59 SLPATCDL02 kernel: EDAC MC0: 1 CE memory scrubbing error on CPU_SrcID#0_Ha#0_Chan#0_DIMM#0 (channel:0 slot:0 page:0xc2fe28 offset:0x0 grain:32 syndrome:0x0 -  area:DRAM err_code:0008:00c2 socket:0 ha:0 channel_mask:1 rank:1)<br><br> - 문의사항<br>1. memory error correct가 발생한 HW 주소 부분을 알 수 있는지 문의드리려고 합니다.<br>2. 검색을 해보니 메모리 error 확인 관련해서 linux os에서는 edac-utils과 mcelog 패키지가 있는 것 같은데요.<br>   혹시 해당 패키지들의 기능과 활용 관련해서 문의드리려고 합니다.<br><br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPATCDL02</hostname><br><br><br><comment id="a0a2K00000PXqVqQAL"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-03-14T00:49:10Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-03-14T00:49:10Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>관련하여 전문엔지니어로부터 온 답변에 대해 안내해 드립니다.<br><br>&quot;dmidecode -t 20&quot;을 사용하면 20   Memory Device Mapped Address&quot;를 찾을 수 있지만 고객의 하드웨어 DMI(SMBIOS)는 이 정보를 제공하지 않아서 출력되지 않는 것으로 판단됩니다.<br>따라서 &quot;dmidecode -t 19&quot;를 통해 &quot;19  Memory Array Mapped Address&quot; 정보를 확인할 수 있을 것입니다.<br><br>확인 후 업데이트 부탁드립니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-03-14T00:49:10Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PWcFCQA1"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-03-08T07:05:28Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-03-08T07:05:28Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>확인된 내용 업데이트 해 드리겠습니다.<br><br>보내주신 sosreport를 확인 시 mcelog 패키지가 미 설치되어 있습니다.<br># cat ./sosreport-SLPATCDL02-20190308152025/installed-rpms | grep mcelog<br>--&gt; not installed <br><br>/var/log/mcelog 가 로깅되기 위해서는 mcelog 패키지 설치 후 mcelog 데몬을 구동이 되어야 합니다.<br><br>아래와 같이 확인되어야 합니다.<br>[root@pyhost ~]# systemctl status mcelog | grep Active<br>   Active: active (running) since Mon 2019-03-04 00:13:45 EST; 4 days ago<br><br>[root@pyhost ~]# ps aux | grep mcelog | grep -v grep<br>root     31623  0.0  0.0   6608   288 ?        Ss   Mar04   0:00 /usr/sbin/mcelog --ignorenodev --daemon --syslog<br><br>mcelog 데몬이 구동중이라면 mce 발생 시 데몬이 감지된 /dev/mcelog 내용을 /var/log/mcelog 로그에 하기와 같이 로깅을 합니다.<br><br># cat /var/log/mcelog <br>Hardware event. This is not a software error.<br>MCE 0<br>CPU 0 BANK 1 <br>ADDR abcd <br>TIME 1551674521 Sun Mar  3 23:42:01 2019<br>MCG status:<br>MCi status:<br>Corrected error<br>Error enabled<br>MCi_ADDR register valid<br>MCA: No Error<br>STATUS 9400000000000000 MCGSTATUS 0<br>MCGCAP 806 APICID 0 SOCKETID 0 <br>MICROCODE a0b<br>CPUID Vendor Intel Family 6 Model 23<br>Hardware event. This is not a software error.<br>MCE 1<br>CPU 1 BANK 2 <br>MISC abcd ADDR 1234 <br>TIME 1551674521 Sun Mar  3 23:42:01 2019<br>MCG status:<br>MCi status:<br>Corrected error<br>Error enabled<br>MCi_MISC register valid<br>MCi_ADDR register valid<br>MCA: No Error<br>STATUS 9c00000000000000 MCGSTATUS 0<br>MCGCAP 806 APICID 2 SOCKETID 0 <br>MICROCODE a0b<br>CPUID Vendor Intel Family 6 Model 23<br><br><br>만약 해당 서버를 재부팅 하지 않았다면, 아래와 같이 확인 후 출력되는 내용을 피드백 부탁드립니다.<br># cat /dev/mcelog<br>-&gt; 출력 내용<br><br><br>그리고 # dmidecode -t 20  미출력건에 대해서는 확인되는 내용이 있으면 업데이트해 드리도록 하겠습니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-03-08T07:05:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PWc07QAD"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2019-03-08T06:44:16Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2019-03-08T06:44:16Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>요청 내역 보내드립니다.<br><br>1) mcelog 프로세스 확인<br># ps aux | grep mcelog<br>-&gt; 출력 값 <br>▶root@SLPATCDL02 /var/tmp # ps aux | grep mcelog<br>root      98924  0.0  0.0   9040   676 pts/4    S+   15:40   0:00 grep --color=auto mcelog<br><br>2) memory dimm 정보 확인<br># dmidecode -t memory | grep Locator<br>-&gt; 출력 값<br>▶root@SLPATCDL02 /var/tmp # dmidecode -t memory | grep Locator<br>        Locator: DIMM_A1<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A2<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A3<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A4<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A5<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A6<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A7<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A8<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A9<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A10<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A11<br>        Bank Locator: Not Specified<br>        Locator: DIMM_A12<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B1<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B2<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B3<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B4<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B5<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B6<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B7<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B8<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B9<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B10<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B11<br>        Bank Locator: Not Specified<br>        Locator: DIMM_B12<br>        Bank Locator: Not Specified<br><br>3) sosreport 요청<br>mce 로그가 발생된 서버의 sosreport 업로드 요청드립니다.<br>▶ 02325127-sosreport-SLPATCDL02-20190308152025.tar.xz 업로드하였습니다.<br><br>감사합니다.<br><br><publishedDate>2019-03-08T06:44:16Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0a2K00000PWblMQAT"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-03-08T06:18:53Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-03-08T06:18:52Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>관련하여 확인이 필요한 사항 요청 드립니다.<br><br>1) mcelog 프로세스 확인<br># ps aux | grep mcelog<br>-&gt; 출력 값 <br><br>2) memory dimm 정보 확인<br># dmidecode -t memory | grep Locator<br>-&gt; 출력 값<br><br>3) sosreport 요청<br>mce 로그가 발생된 서버의 sosreport 업로드 요청드립니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-03-08T06:18:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PWbaiQAD"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-03-08T05:59:53Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-03-08T05:59:53Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>관련된 내용 확인 후 업데이트해 드리도록 하겠습니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-03-08T05:59:53Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PWbHgQAL"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2019-03-08T05:30:43Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2019-03-08T05:30:43Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>답변 감사드립니다.<br><br>추가 문의사항이 있어서 문의드립니다.<br><br>1. SW감지 부분<br>   알려주신 내역 중 SW감지 부분인데요. 여기서 /var/log/mcelog에 기록이 되는 것으로 보이는데요.<br>   해당 파일이 생기지 않으면 혹시 edac-utils 부분이 설치가 안되어서 그런 것인지 문의드립니다.<br>   문의드렸던 SLPATCDL02 서버는 /var/log/mcelog가 생기는 것 같지는 않습니다.<br><br>2. 알려주신 참조 사이트 관련 문의<br>   http://fibrevillage.com/sysadmin/240-how-to-identify-defective-dimm-from-edac-error-on-linux-2<br>   사이트에서 확인하는 과정 중 dmidecode -t 20 부분이 있는데요. 수행 시 아래와 같은 결과만 출력이 되어서 문의드리려고 합니다.<br><br>   root@SLPATCDL02 /var/log # dmidecode -t 20<br>   # dmidecode 2.12-dmifs<br>   SMBIOS 2.7 present.<br><br>감사합니다.<br><br><publishedDate>2019-03-08T05:30:43Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0a2K00000PRCEVQA5"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-03-04T05:42:41Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-03-04T05:42:40Z</b><br><br>안녕하세요. Red Hat 김마혀 입니다.<br><br>관련하여 안내해 드리겠습니다.<br><br>먼저 MCE(Machine Check Exception)에 대한 설명 드립니다.<br><br>- MCE ?<br>MCE 는 모니터링 중 발생한 Event를 Processor 내 Machine check Registers 영역에 기록됨<br><br>- MCE 주요 발생 원인  <br>    ( BIOS Fault / Power 관련 이슈 및 단락 / RAM(메모리) 문제 / 기타 HW 오류 ) <br><br>- MCE 주요 H/W 요소<br>   └ CPU ,  Cache<br>   └ 메모리 DIMM , 메모리<br>   └ System Board <br><br>* L2 Cache<br>범위 : CPU<br>CPU 처리속도 향상을 위한 CPU 내부 메모리 구간<br><br>* DIMM (Dual In-line Memory Module)<br>범위 : 메모리<br>메모리가 장착되는 슬롯으로 CPU 별 메모리 DIMM 배치<br><br>* QPI (Quick Path Interconnect)<br>범위 : 메인보드<br>인텔의 프로세스와 프로세스간 전송을 위한 버스 프로토콜<br><br><br>- MCE 로그 유형  <br>   └ Memory ECC 에러<br>   └ 메모리 DIMM , 메모리 controller , 메모리와 보드 연결 구간 등의 에러 <br>   └ System BUS 에러 <br>   └ Processor 내부의 cache 에러<br><br>- MCE Corrected / Uncorrected <br>   └ Corrected 에러는 H/W 자체적인 수정 가능한 오류를 포함 <br>   └ Uncorrectd 에러는 H/W 자체 수정인 불가하여 H/W Fault , Fatal exception 등을 유발할 가능성이 있음  <br><br>- SW 감지   <br>  └ 시스템 HW 의 이상 징후를 감시하여 관련된 Event 를 CPU 내 Machine check Registers 에 기록<br>  └ Linux EDAC(Error Detection and Correction) 기능에 의해 registers 에 등록된 Event 를 감지<br>  └ mcelog 데몬이 상시 , 주기적 (crontab) 으로 해당 Register 를 읽어 Event 가 있을 시 /var/log/mcelog 로그에 기록<br>   --&gt; * mcelog 로그 데몬 설명<br>       RHEL 7은 기본적으로 cron job 스케줄은 하지 않음.<br>       mcelog 데몬이 실행 중일 경우 mce 이벤트 발생 시 /dev/mcelog 장치에 기록된 내용을 messages에 로깅 후 /dev/mcelog 파일을 비움<br>       (RHEL 6의 경우 mcelog 패키지 설치 시 1시간 단위 cron job이 자동으로 등록됨)<br>       (RHEL 6의 경우 /var/log/mcelog 라는 별도 파일에 로깅됨)<br><br>- HW 감지 (HP 서버 기준)<br>  └ System ROM 이 모니터링 하여 문제시 H/W 제조사가 제공하는 IML, 장비 LED 에 해당 이벤트를 표시<br>  └ 해당 에러가 Corrected Error 일 경우 Threshold (100+) 에 도달해야 IML에 등록    <br><br><br>- 문의 주신 사항에 대한 답변<br>1. memory error correct가 발생한 HW 주소 부분을 알 수 있는지 문의드리려고 합니다.<br><br>&gt;&gt; EDAC 로그로 봤을 때 MC0(Memory Controller 0)에서 발생한 corrected 된 에러로 보입니다.   <br>   하기 사이트를 참조하여 위치를 찾을 수 있을것으로 판단됩니다.<br>   http://fibrevillage.com/sysadmin/240-how-to-identify-defective-dimm-from-edac-error-on-linux-2<br>   하지만 정확한 DIMM의 위치는 서버 벤더의 서포트를 통해 메인보드 메니지먼트 툴 등을 이용하여 확인하셔야할 것으로 판단됩니다<br>   해당 이벤트의 경우 정상적으로 에러가 보정된 상황이며 운영에는 지장이 없습니다.<br>   하지만 corrected 에러라 할지라도 잦은 에러가 감지될 시 하드웨어 벤더의 서포트를 받아야할 것입니다.<br>   <br><br>2. 검색을 해보니 메모리 error 확인 관련해서 linux os에서는 edac-utils과 mcelog 패키지가 있는 것 같은데요.<br>   혹시 해당 패키지들의 기능과 활용 관련해서 문의드리려고 합니다.<br>&gt;&gt;<br>   mcelog - 위에 언급한 내용처럼 별도로 투을 사용하기 보다는 이벤트 발생 시 생성된 로그를 확인하는 정도만 활용하시면 됩니다.<br>            RHEL 6 : 기본적으로 /var/log/mcelog에 기록됨 (하기 형태로)<br>                     Hardware event. This is not a software error.<br>                     MCE 0<br>                     CPU 0 BANK 1<br>                     ADDR abcd<br>                     <br>            RHEL 7 : 기본적으로 /var/log/mcelog에 기록됨 (하기 형태로)<br>                     Mar  3 23:39:23 pyhost kernel: mce: [Hardware Error]: Machine check events logged<br>                     Mar  3 23:39:23 pyhost kernel: mce: [Hardware Error]: CPU 0: Machine Check: 0 Bank 1: 9400000000000000<br>                     Mar  3 23:39:23 pyhost kernel: mce: [Hardware Error]: TSC 0 ADDR abcd<br><br>   edac - <br>   아래 사이트를 통해 사용방법을 확인해 보시기 바랍니다.<br>   http://fibrevillage.com/sysadmin/240-how-to-identify-defective-dimm-from-edac-error-on-linux-2<br>   http://fibrevillage.com/sysadmin/244-edac-util-edac-error-reporting-utility<br><br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-03-04T05:42:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PQCKcQAP"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-02-27T00:16:05Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-02-27T00:16:05Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>문의주신 내용 확인하여 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-02-27T00:16:05Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>