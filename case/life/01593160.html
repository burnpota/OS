======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2016-03-02T06:52:54Z</b><br><b>마지막 답변자 : Meiyan Zheng</b><br><b>마지막 수정 일자 : 2016-04-12T03:02:07Z</b><br><b>id : 500A000000Te2PdIAJ</b><br>======================<br><br><b><font size=15>
제목  : sftp 업로드시 퍼미션변경 방법
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>A서버에서 B서버로 sftp를 이용하여 file을 업로드시 퍼미션이 644로 되는것을 <br>664로 업로드되게 하고싶습니다.<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>기술지원<br><br>언제 문제가 발생했습니까? 이러한 문제가 자주 발생합니까? 반복적으로 발생합니까? 특정 시간에 발생합니까?<br><br>기술지원<br><br>문제 해결 기간 및  긴급도와 관련된 정보를 제공해 주시겠습니까?<br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김태현 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  010-3734-0720<br>- 메일주소 : 김태현 &lt;th0720.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000Gq6fEIAR"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-04-12T03:02:07Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-04-12T03:02:07Z</b><br><br>안녕하세요,<br><br>본 케이스를 직접 종료 시켜 주셔서 감사합니다. 만약 본 케이스와 관련하여 <br>추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다. <br><br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발송됩니다. 고객님<br>께서 남기 신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br><br>향후 기술  지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대<br>단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-12T03:02:07Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GpQSwIAN"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-04-08T03:21:22Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-04-08T03:21:21Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>ForceCommand 를 설정 하신후 해당 유저/그룹에 대한 scp/ssh 모두 정상적으로 되지 않는 상황입니다. <br>따라서, Match에서 지정 된 유저에 대해 scp 또한 sftp 같이 사용 하시려면, 두개의 sshd 데몬을 기동 <br>하여 설정 하시고, 한 개의 sshd 데몬을 정상적으로 ssh/scp 용도로 설정 하시고, 한 개의 sshd 데몬은<br>sftp 용도로 설정 하시면 될 것 같습니다. <br><br>How to configure multiple instances of sshd in RHEL 5 or 6? <br>- https://access.redhat.com/solutions/63129<br><br><br>설정 완료후 아래와 같이 유저 test1에 대해, scp/ssh는 22 port로 되고, sftp는 2222 포트를 통해 <br>지정된 파일 권한으로 파일 업로드 될수 있습니다. <br> <br>SSH CLIENT:<br><br># scp first test1@192.168.122.1:/home/test1<br>test1@192.168.122.1's password: <br>first               <br><br># sftp -oPort=2222 test1@192.168.122.1 <br>Connecting to 192.168.122.1...<br>test1@192.168.122.1's password: <br>sftp&gt; put second<br>Uploading second to /home/test1/second<br>second                                                                                           100%    0     0.0KB/s   00:00    <br>sftp&gt; exit<br>======================<br>SSH SERVER:<br># ll<br>total 36<br>-rw-r--r-- 1 test1 test1     0 Apr  8 11:20 first<br>-rwxrwxr-x 1 test1 test1     0 Apr  8 11:16 second   <br>...<br>======================<br>감사합니다. <br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-04-08T03:21:21Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GpM0hIAF"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-08T01:13:18Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-08T01:13:18Z</b><br><br>답변감사합니다.<br><br>node2 의 test1 유저로 node1 에 scp 가 아닌 ssh 연결은 정상적으로 되는지요? ssh연결은 잘됩니다.<br>또한, sftp 셋팅이 되어 있지 않을 경우에는 scp 가 정상적으로 처리 되는지요? sftp셋팅이 안되어 있으면 scp가 잘됩니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-08T01:13:18Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GoaLZIAZ"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-04-06T08:40:24Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-04-06T08:40:24Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br>&gt; 문제는 node2에서 sftp가 셋팅되어있는 특정계정(test1)으로 scp를 할시 정상적으로 scp가 되지 않고 화면이 멈춰있습니다.<br>&gt; [node2]<br>&gt; scp /tmp/* test1@node1:/home/test1    //초기 공개키를 받아온후 password입력후 진행이 안됩니다.<br><br>node2 의 test1 유저로 node1 에 scp 가 아닌 ssh 연결은 정상적으로 되는지요?<br>또한, sftp 셋팅이 되어 있지 않을 경우에는 scp 가 정상적으로 처리 되는지요?<br><br>상기 내용에 대해 확인바랍니다. <br><br>감사합니다.<br><br><publishedDate>2016-04-06T08:40:24Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GoHAGIA3"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-05T09:58:43Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-05T09:58:42Z</b><br><br>답변감사합니다.<br>제가 궁금한건 <br><br>현재 sftp관련 node2에서 node1의 특정계정(test1)으로  업로드시 777이 되게 셋팅을 하였습니다.<br>[node1]<br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server<br>Subsystem       sftp    internal-sftp<br><br># Example of overriding settings on a per-user basis<br>#Match User anoncvs<br>#       X11Forwarding no<br>#       AllowTcpForwarding no<br>#       ForceCommand cvs server<br>Match User test1         // test1계정으로 업로드시 <br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m777  //업로드한 파일이 777이 되게 합니다.<br><br><br>문제는 node2에서 sftp가 셋팅되어있는 특정계정(test1)으로 scp를 할시 정상적으로 scp가 되지 않고 화면이 멈춰있습니다.<br>[node2]<br>scp /tmp/* test1@node1:/home/test1    //초기 공개키를 받아온후 password입력후 진행이 안됩니다.<br><br>이러한 현상이 왜 발생하는지 궁금하고<br>해결방안을 알려주시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-05T09:58:42Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GoD3LIAV"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-04-05T02:10:28Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-04-05T02:10:28Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br>scp로 파일을 전송 하실 때 리모트 서버의 umask 값을 참조 하여 파일 권한을 정하게 됩니다. <br>예를 들어서, 원격 서버의 umask가 0002로 되어 있을 경우, 기존 파일 권한이 777로 되어 있다면<br>scp로 파일 전송 후 파일 권한이 최대 775로 될수 있습니다. <br><br>테스트 하신 환경에서 원격 서버 node1에서 유저 scpt의 umask는 0222로 되어 있는 것으로 보이며<br>파일 또는 디렉토리의 권한이 최대로 555로 될수 있습니다. 기존 644로 되어 있었던 파일들 scp를 <br>통하여 node1로 보냈을 경우 444로 되는게 정상으로 보입니다. <br><br>r:4<br>w:2<br>x:1<br><br>file permission: 644 = rw-r--r--<br>          umask:0222 = -w--w--w-  즉 파일의 w 권한을 모두 마스크 처리를 한다는 의미임 <br><br>remote permission:444= r--r--r-- <br><br><br>추가적인 문의 사항이 있으시다면 다시 연락 주시기 바랍니다. <br><br>감사합니다. <br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-04-05T02:10:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GnoGVIAZ"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-04T06:18:00Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-04T06:17:59Z</b><br><br>strace로그 보내드립니다.<br><br>[node2]<br>test1계정으로 node1에 file을 scp 하였을때 strace log &lt;----- 비정상<br><br>[root@node1 security]# strace -p 103925                                      Process 103925 attached<br>select(7, [3 4], NULL, NULL, NULL)      = ? ERESTARTNOHAND (To be restarted if no handler)<br>--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=105425, si_status=255, si_utime=2, si_stime=0} ---<br>wait4(-1, [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 255}], WNOHANG, NULL) = 105425<br>wait4(-1, 0x7fff4be55a94, WNOHANG, NULL) = -1 ECHILD (No child processes)<br>rt_sigaction(SIGCHLD, NULL, {0x7fab4a494470, [], SA_RESTORER, 0x7fab477a26a0}, 8) = 0<br>rt_sigreturn()                          = -1 EINTR (Interrupted system call)<br>select(7, [3 4], NULL, NULL, NULL)      = 1 (in [3])<br>accept(3, {sa_family=AF_INET, sin_port=htons(39751), sin_addr=inet_addr(&quot;192.168.157.20&quot;)}, [16]) = 5<br>fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)<br>pipe([6, 7])                            = 0<br>socketpair(PF_LOCAL, SOCK_STREAM, 0, [8, 9]) = 0<br>clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7fab4a466a90) = 106808<br>close(7)                                = 0<br>write(8, &quot;\0\0\2\237\0&quot;, 5)             = 5<br>write(8, &quot;\0\0\2\226\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProtocol&quot;..., 670) = 670<br>close(8)                                = 0<br>close(9)                                = 0<br>close(5)                                = 0<br>select(7, [3 4 6], NULL, NULL, NULL)    = 1 (in [6])<br>close(6)                                = 0<br>select(7, [3 4], NULL, NULL, NULL<br>======================<br>[node2]<br>root계정으로 node1에 file을 scp 하였을때 strace log &lt;----- 정상<br><br>[root@node1 security]# strace -p 103925<br>Process 103925 attached<br>select(7, [3 4], NULL, NULL, NULL)      = 1 (in [3])<br>accept(3, {sa_family=AF_INET, sin_port=htons(39752), sin_addr=inet_addr(&quot;192.168.157.20&quot;)}, [16]) = 5<br>fcntl(5, F_GETFL)                       = 0x2 (flags O_RDWR)<br>pipe([6, 7])                            = 0<br>socketpair(PF_LOCAL, SOCK_STREAM, 0, [8, 9]) = 0<br>clone(child_stack=0, flags=CLONE_CHILD_CLEARTID|CLONE_CHILD_SETTID|SIGCHLD, child_tidptr=0x7fab4a466a90) = 108517<br>close(7)                                = 0<br>write(8, &quot;\0\0\2\237\0&quot;, 5)             = 5<br>write(8, &quot;\0\0\2\226\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nProtocol&quot;..., 670) = 670<br>close(8)                                = 0<br>close(9)                                = 0<br>close(5)                                = 0<br>select(7, [3 4 6], NULL, NULL, NULL)    = 1 (in [6])<br>close(6)                                = 0<br>select(7, [3 4], NULL, NULL, NULL)      = ? ERESTARTNOHAND (To be restarted if no handler)<br>--- SIGCHLD {si_signo=SIGCHLD, si_code=CLD_EXITED, si_pid=108517, si_status=255, si_utime=2, si_stime=1} ---<br>wait4(-1, [{WIFEXITED(s) &amp;&amp; WEXITSTATUS(s) == 255}], WNOHANG, NULL) = 108517<br>wait4(-1, 0x7fff4be55a94, WNOHANG, NULL) = -1 ECHILD (No child processes)<br>rt_sigaction(SIGCHLD, NULL, {0x7fab4a494470, [], SA_RESTORER, 0x7fab477a26a0}, 8) = 0<br>rt_sigreturn()                          = -1 EINTR (Interrupted system call)<br>select(7, [3 4], NULL, NULL, NULL<br><br><publishedDate>2016-04-04T06:17:59Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Gnnn9IAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-04T04:37:45Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-04T04:37:45Z</b><br><br>답변바랍니다. !<br><br><publishedDate>2016-04-04T04:37:45Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GmpzVIAR"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-01T07:26:13Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-01T07:26:13Z</b><br><br>안녕하세요.<br>아래와같이 테스트시<br>동일한 계정에서<br>sftp는 되는데 scp는 되지 않습니다.<br><br>ex)<br>[node1]<br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server<br>Subsystem       sftp    internal-sftp<br><br># Example of overriding settings on a per-user basis<br>#Match User anoncvs<br>#       X11Forwarding no<br>#       AllowTcpForwarding no<br>#       ForceCommand cvs server<br>Match User test1<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m777<br>[node2]<br>sftp는 정상됨..<br><br>[node2]<br>scp는 정상적으로되지않음<br><br><br>확인바랍니다.<br><br><publishedDate>2016-04-01T07:26:13Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GmpiUIAR"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-01T06:54:56Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-01T06:54:56Z</b><br><br>안녕하세요.<br>아래와 같은 방법으로 진행 하였는데 맞는지 확인 부탁드립니다.<br><br>*sftp 설정<br><br>*node1 sftp 계정 : sftpt <br>*node2 scp 계정 : scpt<br><br>[node1]<br>[root@node1 /]# vi /etc/ssh/sshd_config<br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server  <br>&lt;-- 주석<br>Subsystem       sftp    internal-sftp                 <br><br>&lt;-- 추가<br><br><br># Example of overriding settings on a per-user basis<br>#Match User anoncvs<br>#       X11Forwarding no<br>#       AllowTcpForwarding no<br>#       ForceCommand cvs server<br>Match User sftpt<br>======================<br><br><br>&lt;-- 추가<br>        X11Forwarding no<br>======================<br><br>&lt;-- 추가<br>        AllowTcpForwarding no<br>======================<br><br>&lt;-- 추가<br>        ForceCommand /usr/libexec/openssh/sftp-server -m755<br>&lt;-- 추가<br><br>:wq<br><br>[node2]<br>[root@node2 postfix]# sftp sftpt@node1<br>Connecting to node1...<br>sftpt@node1's password:<br>sftp&gt; !pwd<br>/etc/postfix<br>sftp&gt; mput *<br>Uploading access to /home/sftpt/access<br>access                                              100%   19KB  19.1KB/s   00:00<br>Uploading canonical to /home/sftpt/canonical<br>canonical                                           100%   11KB  11.4KB/s   00:00<br>Uploading generic to /home/sftpt/generic<br>generic                                             100% 9904     9.7KB/s   00:00<br>Uploading header_checks to /home/sftpt/header_checks<br>header_checks                                       100%   18KB  17.9KB/s   00:00<br>Uploading main.cf to /home/sftpt/main.cf<br>main.cf                                             100%   26KB  26.4KB/s   00:00<br>Uploading master.cf to /home/sftpt/master.cf<br>master.cf                                           100% 5113     5.0KB/s   00:00<br>Uploading relocated to /home/sftpt/relocated<br>relocated                                           100% 6816     6.7KB/s   00:00<br>Uploading transport to /home/sftpt/transport<br>transport                                           100%   12KB  12.2KB/s   00:00<br>Uploading virtual to /home/sftpt/virtual<br>virtual                                             100%   12KB  12.2KB/s   00:00<br>sftp&gt; pwd<br>Remote working directory: /home/sftpt<br>sftp&gt;<br><br>[node1]<br>[root@node1 sftpt]# ls -al<br>합계 244<br>drwx------  4 sftpt sftpt  4096 2016-04-02 00:28 .<br>drwxr-xr-x. 7 root  root   4096 2016-04-02 00:16 ..<br>-rw-------  1 sftpt sftpt   103 2016-04-01 23:04 .bash_history<br>-rw-r--r--  1 sftpt sftpt    18 2015-01-16 23:24 .bash_logout<br>-rw-r--r--  1 sftpt sftpt   176 2015-01-16 23:24 .bash_profile<br>-rw-r--r--  1 sftpt sftpt   124 2015-01-16 23:24 .bashrc<br>drwxr-xr-x  2 sftpt sftpt  4096 2010-07-15 00:55 .gnome2<br>drwxr-xr-x  4 sftpt sftpt  4096 2016-03-29 18:46 .mozilla<br>-rw-------  1 sftpt sftpt   730 2016-04-01 22:33 .viminfo<br>-rwxr-xr-x  1 sftpt sftpt 19579 2016-04-02 00:28 access<br><br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt  1642 2016-04-01 23:02 anaconda-ks.cfg<br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 11681 2016-04-02 00:28 canonical<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt  9904 2016-04-02 00:28 generic<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 18287 2016-04-02 00:28 header_checks<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 50791 2016-04-01 23:02 install.log<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 10938 2016-04-01 23:02 install.log.syslog<br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 27014 2016-04-02 00:28 main.cf<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt  5113 2016-04-02 00:28 master.cf<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt  6816 2016-04-02 00:28 relocated<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt     0 2016-04-01 22:34 test1<br><br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 12500 2016-04-02 00:28 transport<br><br>&lt;-- 755<br>-rwxr-xr-x  1 sftpt sftpt 12494 2016-04-02 00:28 virtual<br><br>&lt;-- 755<br><br><br>*scp 설정<br><br>[변경전]<br>[node2]<br>[root@node2 postfix]# scp * scpt@node1:/home/scpt<br>root@node1 scpt]# ls -al<br>합계 176<br>drwx------  4 scpt scpt  4096 2016-04-02 00:32 .<br>drwxr-xr-x. 7 root root  4096 2016-04-02 00:16 ..<br>-rw-------  1 scpt scpt    61 2016-04-02 00:25 .bash_history<br>-rw-r--r--  1 scpt scpt    18 2015-01-16 23:24 .bash_logout<br>-rw-r--r--  1 scpt scpt   176 2015-01-16 23:24 .bash_profile<br>-rw-r--r--  1 scpt scpt   135 2016-04-02 00:25 .bashrc<br>drwxr-xr-x  2 scpt scpt  4096 2010-07-15 00:55 .gnome2<br>drwxr-xr-x  4 scpt scpt  4096 2016-03-29 18:46 .mozilla<br>-rw-------  1 scpt scpt   783 2016-04-02 00:25 .viminfo<br>-rw-r--r--  1 scpt scpt 19579 2016-04-02 00:32 access<br>&lt;--644<br>-rw-r--r--  1 scpt scpt 11681 2016-04-02 00:32 canonical&lt;--644<br>-rw-r--r--  1 scpt scpt  9904 2016-04-02 00:32 generic<br>&lt;--644<br>-rw-r--r--  1 scpt scpt 18287 2016-04-02 00:32 header_checks&lt;--644<br>-rw-r--r--  1 scpt scpt 27014 2016-04-02 00:32 main.cf<br>&lt;--644<br>-rw-r--r--  1 scpt scpt  5113 2016-04-02 00:32 master.cf&lt;--644<br>-rw-r--r--  1 scpt scpt  6816 2016-04-02 00:32 relocated&lt;--644<br>-rw-r--r--  1 scpt scpt 12500 2016-04-02 00:32 transport&lt;--644<br>-rw-r--r--  1 scpt scpt 12494 2016-04-02 00:32 virtual<br>&lt;--644<br><br>[변경후]<br>[node1]<br>[scpt@node1 ~]$ vi .bashrc<br># .bashrc<br><br># Source global definitions<br>if [ -f /etc/bashrc ]; then<br>        . /etc/bashrc<br>fi<br><br># User specific aliases and functions<br>umask 0222<br>&lt;--추가 (defaut file:666 / directory: 777)<br><br>[node1]<br>[scpt@node1 ~]$ source .bashrc<br><br>[node1]<br>[scpt@node1 ~]$ ls -al<br>합계 176<br>drwx------  4 scpt scpt  4096 2016-04-02 00:35 .<br>drwxr-xr-x. 7 root root  4096 2016-04-02 00:16 ..<br>-rw-------  1 scpt scpt    61 2016-04-02 00:25 .bash_history<br>-rw-r--r--  1 scpt scpt    18 2015-01-16 23:24 .bash_logout<br>-rw-r--r--  1 scpt scpt   176 2015-01-16 23:24 .bash_profile<br>-rw-r--r--  1 scpt scpt   135 2016-04-02 00:33 .bashrc<br>drwxr-xr-x  2 scpt scpt  4096 2010-07-15 00:55 .gnome2<br>drwxr-xr-x  4 scpt scpt  4096 2016-03-29 18:46 .mozilla<br>-rw-------  1 scpt scpt   786 2016-04-02 00:34 .viminfo<br>-r--r--r--  1 scpt scpt 19579 2016-04-02 00:35 access<br>&lt;--444<br>-r--r--r--  1 scpt scpt 11681 2016-04-02 00:35 canonical&lt;--444<br>-r--r--r--  1 scpt scpt  9904 2016-04-02 00:35 generic<br>&lt;--444<br>-r--r--r--  1 scpt scpt 18287 2016-04-02 00:35 header_checks&lt;--444<br>-r--r--r--  1 scpt scpt 27014 2016-04-02 00:35 main.cf<br>&lt;--444<br>-r--r--r--  1 scpt scpt  5113 2016-04-02 00:35 master.cf&lt;--444<br>-r--r--r--  1 scpt scpt  6816 2016-04-02 00:35 relocated&lt;--444<br>-r--r--r--  1 scpt scpt 12500 2016-04-02 00:35 transport&lt;--444<br>-r--r--r--  1 scpt scpt 12494 2016-04-02 00:35 virtual<br>&lt;--444<br><br><publishedDate>2016-04-01T06:54:56Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GmpQuIAJ"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-01T06:15:10Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-01T06:15:10Z</b><br><br>변경합니다.<br>scp도 sftp와 마친가기로 특정유 업로드시 퍼미션을 지정할수 있는 방법을 알고 싶습니다.<br><br><publishedDate>2016-04-01T06:15:10Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GmoywIAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-04-01T04:56:09Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-04-01T04:56:09Z</b><br><br>안녕하세요.<br>아래의 연결해서 문의드립니다.<br>현재 node1 node2에서 셋팅을 아래와 같이하였을떄 sftp는되나 scp는 되지 않는 문제가 있습니다.<br><br>[node1]<br>계정 : sftpt<br>vi /etc/ssh/sshd_config<br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server<br>Subsystem       sftp    internal-sftp<br>Subsystem       scp    internal-scp<br><br># Example of overriding settings on a per-user basis<br>#Match User anoncvs<br>#       X11Forwarding no<br>#       AllowTcpForwarding no<br>#       ForceCommand cvs server<br>Match User sftpt<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m755<br><br>[node2]<br>계정 : test<br>sftpt로 sftp로 파일이 업로드 하였을때 정상적으로755생성됨<br><br>[node2]<br> test 계정을 이용하여 scp를 이용하여 파일이 업드할시 scp가 되지 않습니다.<br>[root@node2 openssh]# su - test<br>[test@node2 ~]$ touch test<br>[test@node2 ~]$ scp * node1:/<br>-&gt;멈춰있음<br><br><br>추가적으로 <br>scp도 sftp와 마친가기로 업로드시 퍼미션을 지정할수 있는 방법을 알고 싶습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-01T04:56:09Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Gizq1IAB"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-03-14T04:40:38Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-03-14T04:40:38Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>RHEL6을 사용 하실 경우 RHEL6에서 openssh-5.3p1-111.el6  및 이후 버전으로 업데이트 <br>하셔야 합니다. <br><br>패키지 업데이트 하신후 테스트 결과 부탁드립니다. <br><br>좋은 하루 되세요!<br><br>감사합니다. <br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-03-14T04:40:38Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GizlnIAB"><br>======================<br><b>생성계정 : 김, 태현</b><br><b>생성날짜 : 2016-03-14T04:32:24Z</b><br><b>마지막 답변자 : 김, 태현</b><br><b>마지막 수정 일자 : 2016-03-14T04:32:24Z</b><br><br>test 서버의 openssh 버젼이 5.3p1-84.1.el6 로 조회되는데 버젼에 따른 지원 문제인가요?<br><br><publishedDate>2016-03-14T04:32:24Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GizjSIAR"><br>======================<br><b>생성계정 : 김, 태현</b><br><b>생성날짜 : 2016-03-14T04:27:34Z</b><br><b>마지막 답변자 : 김, 태현</b><br><b>마지막 수정 일자 : 2016-03-14T04:27:33Z</b><br><br>안녕하세요.<br>답변 주신대로 설정 후 sftp로 접속 시도 시 password 인증 이후 바로 Connection closed 됩니다.<br><br>/etc/ssh/sshd_config 설정은 해당 부분만 변경했습니다.<br><br>답변 부탁드립니다.<br><br><publishedDate>2016-03-14T04:27:33Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GizSCIAZ"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-03-14T03:29:05Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-03-14T03:29:05Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>앞서 안내 해 드린바와 같이 아래와 같이 설정 하시면 Match Group test 부분에서 지정된 Group에 포함 된 유저로<br>파일 업로드 할시에만 파일 권한이 664로 됩니다. <br><br>예를 들어서, <br><br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server  <br>Subsystem       sftp    internal-sftp<br><br># Example of overriding settings on a per-user basis<br>Match Group testgroup<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m664<br><br><br>Group를 User로 변경 하실수 있습니다. <br><br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server  <br>Subsystem       sftp    internal-sftp<br><br># Example of overriding settings on a per-user basis<br>Match User testuser           &lt;==========================<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m664<br><br>위와 같이 설정 하실시 testuser로 파일 업로드 할시에만 파일 권한이 664로 변경 됩니다. <br><br>참고로, /etc/ssh/sshd_config 파일을 변경 하시고 내용을 적용 시키기 위해 ssh 서비스를 재기동 시키세요.<br><br># service sshd restart<br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-03-14T03:29:05Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GizA7IAJ"><br>======================<br><b>생성계정 : 김, 태현</b><br><b>생성날짜 : 2016-03-14T02:24:04Z</b><br><b>마지막 답변자 : 김, 태현</b><br><b>마지막 수정 일자 : 2016-03-14T02:24:04Z</b><br><br>안녕하세요.<br><br>전체 계정이 644로 변경 되는 방법만 답변을 주셨는데, <br>특정 계정에 한해서만 권한이 664로 변경 할 수는 없나요?<br>확인 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2016-03-14T02:24:04Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Ge4fPIAR"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-03-10T02:26:17Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-03-10T02:26:16Z</b><br><br>안녕하세요,<br><br>케이스를 직접 클로즈 해 주셔서 감사합니다. 본 케이스를 처리완료하도록 하겠습니다. 만약 <br>본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다. 케이스가 <br>처리 완료되면 가능하게 고객 설문조사 메일이 발송됩니다. 고객님께서 남기 신 의견은 보다 <br>나은 서비스를 위해 지속적으로 반영될 것입니다.<br><br>향후 기술  지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-03-10T02:26:16Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GdomaIAB"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-03-09T06:41:43Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-03-09T06:41:43Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용 해 주셔서 감사합니다.<br><br><br>본 케이스와 관련 하여 오랫 동안 업데이트가 없어 보입니다.<br><br>혹시 어떻게 진행 되고 있으신가요? <br><br>만약 본 이슈와 관련 하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br><br>감사합니다.<br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-03-09T06:41:43Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GbxE6IAJ"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-03-03T02:28:03Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-03-03T02:28:02Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>sftp를 통해 특정 유저 권한으로 파일 업로드시 파일 권한이 모두 664로 되는 방법에 대해 아래와 같이 안내 해 드립니다. <br><br>1. /etc/ssh/sshd_config 파일에서 기존에 있었던 Subsystem 항목을 주석 처리 시키시고 아래와 같은 항목을 추가 하세요. <br><br># override default of no subsystems<br>#Subsystem      sftp    /usr/libexec/openssh/sftp-server  <br>Subsystem       sftp    internal-sftp<br><br># Example of overriding settings on a per-user basis<br>Match Group test<br>        X11Forwarding no<br>        AllowTcpForwarding no<br>        ForceCommand /usr/libexec/openssh/sftp-server -m664<br><br><br>2. 윗 내용을 적용 시키기 위해 sshd 서비스를 재기동 시키세요.<br><br>    # service sshd restart<br><br><br>** 해당 방법을 사용 하기 위해 RHEL7에서 openssh-6.6.1p1-22.el7 및 이후 버전 또는 RHEL6에서 openssh-5.3p1-111.el6 및 <br>   이후 버전을 사용 하셔야 합니다. <br><br>위와 같이 설정 하신후 Group test에 있는 모든 유저의 권한으로 파일 업로드시 파일 권한이 모두 664로 변경 됩니다.  <br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연<br><br><publishedDate>2016-03-03T02:28:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GbkeBIAR"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-03-02T06:57:10Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-03-02T06:57:10Z</b><br><br>&lt;추가&gt;<br><br>전체계정이 아닌 특정계정만 되게 하고 싶습니다.<br><br><publishedDate>2016-03-02T06:57:10Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>664로 업로드되게 하고싶습니다.</issue><environment>기술지원</environment><periodicityOfIssue>기술지원</periodicityOfIssue><timeFramesAndUrgency>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김태현 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  010-3734-0720<br>- 메일주소 : 김태현 &lt;th0720.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================</timeFramesAndUrgency><cep>false</cep></case>