======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2016-05-04T06:33:24Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2016-05-09T03:18:03Z</b><br><b>id : 500A000000U4jQcIAJ</b><br>======================<br><br><b><font size=15>
제목  : [장애문의]IPSIDAP2 서버 리부팅 장애
</font></b><br><br>======================<br><actionPlan>1. THP 비활성화<br>2. 커널 업그레이드<br><br><br>[관련 문서]<br>* Resolution for CVE-2015-1805, pipe: iovec overrun leading to memory corruption <br>  https://access.redhat.com/solutions/1382833</actionPlan><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br>서버 갑작스런 리부팅으로 인한 dump파일 분석 부탁드립니다.<br>경로는 ftp upload 경로는 incoming\IPSIDAP2_vmcore_20150504 파일로 업로드 하였습니다.<br><br>문제 해결 기간 및  긴급도와 관련된 정보를 제공해 주시겠습니까?<br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (사원)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.6</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br>======================<br><comment id="a0aA000000H5NAbIAN"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-05-09T03:18:03Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-05-09T03:18:02Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>먼저, 본 기술 문의가 해결되어 다행입니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 재개하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2016-05-09T03:18:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000H5Kr2IAF"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-05-09T00:21:56Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-05-09T00:21:56Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2016-05-09T00:21:56Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000H4LVSIA3"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-05-04T07:28:06Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-05-04T07:28:06Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>------------------------------------------------------------------------------------<br>        CPUS: 16<br>        DATE: Mon May  2 02:15:22 2016<br>      UPTIME: 12 days, 17:59:11<br>LOAD AVERAGE: 7.75, 7.06, 7.18<br>       TASKS: 591<br>    NODENAME: IPSIDAP2<br>     RELEASE: 2.6.32-358.23.2.el6.x86_64<br>     VERSION: #1 SMP Sat Sep 14 05:32:37 EDT 2013<br>     MACHINE: x86_64  (2593 Mhz)<br>      MEMORY: 32 GB<br>       PANIC: &quot;Kernel panic - not syncing: Out of memory: system-wide panic_on_oom is enabled&quot;<br>         PID: 0<br>     COMMAND: &quot;swapper&quot;<br>        TASK: ffffffff81a8d020  (1 of 8)  [THREAD_INFO: ffffffff81a00000]<br>         CPU: 0<br>       STATE: TASK_RUNNING (ACTIVE)<br>     WARNING: panic task not found<br><br>crash&gt; sys -i<br>        DMI_BIOS_VENDOR: HP<br>       DMI_BIOS_VERSION: P70<br>          DMI_BIOS_DATE: 12/20/2013<br>         DMI_SYS_VENDOR: HP<br>       DMI_PRODUCT_NAME: ProLiant DL380p Gen8<br>    DMI_PRODUCT_VERSION: <br>     DMI_PRODUCT_SERIAL: SGH247FMDH      <br>       DMI_PRODUCT_UUID: 36353332-3030-5347-4832-3437464D4448<br>     DMI_CHASSIS_VENDOR: HP<br>       DMI_CHASSIS_TYPE: 23<br>    DMI_CHASSIS_VERSION: <br>     DMI_CHASSIS_SERIAL: SGH247FMDH      <br>  DMI_CHASSIS_ASSET_TAG:         <br>     DMI_SMBIOS_VERSION: 2.8<br><br><br>swapper: page allocation failure. order:2, mode:0x20<br>Pid: 0, comm: swapper Tainted: P           ---------------    2.6.32-358.23.2.el6.x86_64 #1<br>Call Trace:<br> &lt;IRQ&gt;  [&lt;ffffffff8112c287&gt;] ? __alloc_pages_nodemask+0x757/0x8d0<br> [&lt;ffffffff81166dc2&gt;] ? kmem_getpages+0x62/0x170<br> [&lt;ffffffff811679da&gt;] ? fallback_alloc+0x1ba/0x270<br> [&lt;ffffffff8116742f&gt;] ? cache_grow+0x2cf/0x320<br> [&lt;ffffffff81167759&gt;] ? ____cache_alloc_node+0x99/0x160<br> [&lt;ffffffff81168920&gt;] ? kmem_cache_alloc_node_trace+0x90/0x200<br> [&lt;ffffffff81168b3d&gt;] ? __kmalloc_node+0x4d/0x60<br> [&lt;ffffffff8143de1d&gt;] ? __alloc_skb+0x6d/0x190<br> [&lt;ffffffff8143ef40&gt;] ? skb_copy+0x40/0xb0<br> [&lt;ffffffffa01e827c&gt;] ? tg3_start_xmit+0xa8c/0xd50 [tg3]<br> [&lt;ffffffff81449428&gt;] ? dev_hard_start_xmit+0x308/0x530<br> [&lt;ffffffffa01310d5&gt;] ? ipt_do_table+0x295/0x678 [ip_tables]<br> [&lt;ffffffff814677aa&gt;] ? sch_direct_xmit+0x15a/0x1c0<br> [&lt;ffffffff8144d130&gt;] ? dev_queue_xmit+0x3b0/0x550<br> [&lt;ffffffffa0267687&gt;] ? bond_dev_queue_xmit+0x67/0x200 [bonding]<br> [&lt;ffffffffa0267b11&gt;] ? bond_start_xmit+0x2f1/0x5d0 [bonding]<br> [&lt;ffffffff81449428&gt;] ? dev_hard_start_xmit+0x308/0x530<br> [&lt;ffffffff8144cf85&gt;] ? dev_queue_xmit+0x205/0x550<br> [&lt;ffffffff81485868&gt;] ? ip_finish_output+0x148/0x310<br> [&lt;ffffffff81485ae8&gt;] ? ip_output+0xb8/0xc0<br> [&lt;ffffffff81484daf&gt;] ? __ip_local_out+0x9f/0xb0<br> [&lt;ffffffff81484de5&gt;] ? ip_local_out+0x25/0x30<br> [&lt;ffffffff814852c0&gt;] ? ip_queue_xmit+0x190/0x420<br> [&lt;ffffffff8149a0be&gt;] ? tcp_transmit_skb+0x40e/0x7b0<br> [&lt;ffffffff8149c4cb&gt;] ? tcp_write_xmit+0x1fb/0xa20<br> [&lt;ffffffff8149ce80&gt;] ? __tcp_push_pending_frames+0x30/0xe0<br> [&lt;ffffffff81494913&gt;] ? tcp_data_snd_check+0x33/0x100<br> [&lt;ffffffff8149855d&gt;] ? tcp_rcv_established+0x3ed/0x800<br> [&lt;ffffffff814a0553&gt;] ? tcp_v4_do_rcv+0x2e3/0x430<br> [&lt;ffffffffa0261557&gt;] ? ipv4_confirm+0x87/0x1d0 [nf_conntrack_ipv4]<br> [&lt;ffffffff814a1dde&gt;] ? tcp_v4_rcv+0x4fe/0x8d0<br> [&lt;ffffffff8147f990&gt;] ? ip_local_deliver_finish+0x0/0x2d0<br> [&lt;ffffffff8147fa6d&gt;] ? ip_local_deliver_finish+0xdd/0x2d0<br> [&lt;ffffffff8147fcf8&gt;] ? ip_local_deliver+0x98/0xa0<br> [&lt;ffffffff8147f1bd&gt;] ? ip_rcv_finish+0x12d/0x440<br> [&lt;ffffffff8147f745&gt;] ? ip_rcv+0x275/0x350<br> [&lt;ffffffff8144891b&gt;] ? __netif_receive_skb+0x4ab/0x750<br> [&lt;ffffffff8149f0fa&gt;] ? tcp4_gro_receive+0x5a/0xd0<br> [&lt;ffffffff8144acf8&gt;] ? netif_receive_skb+0x58/0x60<br> [&lt;ffffffff8144ae00&gt;] ? napi_skb_finish+0x50/0x70<br> [&lt;ffffffff8144d3a9&gt;] ? napi_gro_receive+0x39/0x50<br> [&lt;ffffffffa01e4c14&gt;] ? tg3_poll_work+0x784/0xe50 [tg3]<br> [&lt;ffffffffa01e532c&gt;] ? tg3_poll_msix+0x4c/0x150 [tg3]<br> [&lt;ffffffff8144d4c3&gt;] ? net_rx_action+0x103/0x2f0<br> [&lt;ffffffff810770b1&gt;] ? __do_softirq+0xc1/0x1e0<br> [&lt;ffffffff810e1760&gt;] ? handle_IRQ_event+0x60/0x170<br> [&lt;ffffffff8100c1cc&gt;] ? call_softirq+0x1c/0x30<br> [&lt;ffffffff8100de05&gt;] ? do_softirq+0x65/0xa0<br> [&lt;ffffffff81076e95&gt;] ? irq_exit+0x85/0x90<br> [&lt;ffffffff81517775&gt;] ? do_IRQ+0x75/0xf0<br> [&lt;ffffffff8100b9d3&gt;] ? ret_from_intr+0x0/0x11<br> &lt;EOI&gt;  [&lt;ffffffff812d3cfe&gt;] ? intel_idle+0xde/0x170<br> [&lt;ffffffff812d3ce1&gt;] ? intel_idle+0xc1/0x170<br> [&lt;ffffffff81415647&gt;] ? cpuidle_idle_call+0xa7/0x140<br> [&lt;ffffffff81009fc6&gt;] ? cpu_idle+0xb6/0x110<br> [&lt;ffffffff81507600&gt;] ? start_secondary+0x2ac/0x2ef<br><br>Kernel panic - not syncing: Out of memory: system-wide panic_on_oom is enabled<br><br>Pid: 59081, comm: splunkd Tainted: P           ---------------    2.6.32-358.23.2.el6.x86_64 #1<br>Call Trace:<br> [&lt;ffffffff8150daac&gt;] ? panic+0xa7/0x16f<br> [&lt;ffffffff8111cf41&gt;] ? dump_header+0x191/0x1b0<br> [&lt;ffffffff8111cfdc&gt;] ? check_panic_on_oom+0x7c/0x80<br> [&lt;ffffffff8111d69b&gt;] ? out_of_memory+0x1bb/0x3c0<br> [&lt;ffffffff8112c3dc&gt;] ? __alloc_pages_nodemask+0x8ac/0x8d0<br> [&lt;ffffffff81160d6a&gt;] ? alloc_pages_vma+0x9a/0x150<br> [&lt;ffffffff81143f0b&gt;] ? handle_pte_fault+0x76b/0xb50<br> [&lt;ffffffff8104bac7&gt;] ? pte_alloc_one+0x37/0x50<br> [&lt;ffffffff8117b869&gt;] ? do_huge_pmd_anonymous_page+0xb9/0x380<br> [&lt;ffffffff8114452a&gt;] ? handle_mm_fault+0x23a/0x310<br> [&lt;ffffffff810474e9&gt;] ? __do_page_fault+0x139/0x480<br> [&lt;ffffffff8114aaba&gt;] ? do_mmap_pgoff+0x33a/0x380<br> [&lt;ffffffff81513bfe&gt;] ? do_page_fault+0x3e/0xa0<br> [&lt;ffffffff81510fb5&gt;] ? page_fault+0x25/0x30<br><br>crash&gt; kmem -i<br>                 PAGES        TOTAL      PERCENTAGE<br>    TOTAL MEM  8209615      31.3 GB         ----<br>         FREE    39282     153.4 MB    0% of TOTAL MEM<br>         USED  8170333      31.2 GB   99% of TOTAL MEM<br>       SHARED     7198      28.1 MB    0% of TOTAL MEM<br>kmem: read error: kernel virtual address: ffff880834dfc218  type: &quot;list_head next contents&quot;<br>      BUFFERS        0            0    0% of TOTAL MEM<br>       CACHED     2122       8.3 MB    0% of TOTAL MEM<br>         SLAB    31583     123.4 MB    0% of TOTAL MEM<br><br>kmem: read error: kernel virtual address: ffff88083a182c80  type: &quot;vfsmount buffer&quot;<br>crash&gt; ps -G | tail -n +2 | cut -b2- | gawk '{mem += $8} END {print &quot;total &quot; mem/1048576 &quot;GB&quot;}'<br>ps: read error: kernel virtual address: ffff880836ce0340  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff880836ce0340  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff880836ce0340  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083717f300  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083717f300  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083717f300  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370deb80  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370deb80  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370deb80  type: &quot;fill_mm_struct&quot;<br>ps: compressed kdump: uncompress failed: -3<br>ps: read error: kernel virtual address: ffff8806e94a3300  type: &quot;fill_mm_struct&quot;<br>ps: compressed kdump: uncompress failed: -3<br>ps: read error: kernel virtual address: ffff8806e94a3300  type: &quot;fill_mm_struct&quot;<br>ps: compressed kdump: uncompress failed: -3<br>ps: read error: kernel virtual address: ffff8806e94a3300  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083724ae80  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083724ae80  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083724ae80  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083572b900  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083572b900  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff88083572b900  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370de600  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370de600  type: &quot;fill_mm_struct&quot;<br>ps: read error: kernel virtual address: ffff8808370de600  type: &quot;fill_mm_struct&quot;<br>total 0.990944GB<br><br>crash&gt; mount<br>mount: cannot determine mount list location!<br><br>crash&gt; p saved_command_line<br>saved_command_line = $1 = 0xffff88002804b8c0 &quot;ro root=UUID=536d95bc-2ada-4c65-bb6e-9385f3256733 rd_NO_LUKS rd_NO_LVM LANG=en_US.UTF-8 rd_NO_MD SYSFONT=latarcyrheb-sun16 crashkernel=131M@0M KEYBOARDTYPE=pc KEYTABLE=us rd_NO_DM rhgb quiet nmi_watchdog=0&quot;<br><br>crash&gt; p sysctl_panic_on_oom<br>sysctl_panic_on_oom = $2 = 1<br>------------------------------------------------------------------------------------<br><br>표면적인 시스템 리부팅에 대한 원인은 out of memory 입니다.<br>시스템의 메모리가 부족하여 page allocation failure 가 발생하고 뒤이어 oom killer 가 발동되었으며,<br>급기야 panic으로 이어지게 되었습니다.<br><br>vmcore 파일이 완전하지 않아 혹은 메모리가 corrupt 되어 더 이상 분석은 힘들 것으로 보입니다.<br><br>다만, 해당 시스템이 splunk를 동작중이며, THP 가 활성화되어있는 것을 확인하였습니다.<br>따라서, 아래 관련 문서 [1] 에 해당할 가능성이 있는 바, 아래 조치들이 필요할 것으로 보입니다.<br><br>1. THP 비활성화<br>2. 커널 업그레이드<br><br><br>[관련 문서]<br>* Resolution for CVE-2015-1805, pipe: iovec overrun leading to memory corruption <br>  https://access.redhat.com/solutions/1382833<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2016-05-04T07:28:06Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>서버 갑작스런 리부팅으로 인한 dump파일 분석 부탁드립니다.<br>경로는 ftp upload 경로는 incoming\IPSIDAP2_vmcore_20150504 파일로 업로드 하였습니다.</issue><timeFramesAndUrgency>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (사원)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================</timeFramesAndUrgency><cep>false</cep></case>