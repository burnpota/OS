======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2017-11-16T07:46:46Z</b><br><b>마지막 답변자 : 타임게이트 (주)</b><br><b>마지막 수정 일자 : 2017-11-24T01:08:28Z</b><br><b>id : 500A000000Z35G2IAJ</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] 번들 http server (70007), (70008), (70014) 이슈 문의(SAP netweaver 연동)
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br>삼생생명 차세대 ERP 관련 이슈에 대하여 하기와 같이 문의가 요청되어 SR 생성드립니다. <br><br>## 고객정보 ##<br>고객사 : 삼성생명<br>고객명 : 박현우 선임<br>연락처 : 010-9104-2853<br>##<br><br>## 환경 ##<br>-OS : RHEL7<br>-WEB : 번들 HTTP<br>rpm -qf /usr/sbin/httpd<br>httpd-2.4.6-40.el7.x86_64<br>-WAS : SAP netweaver 7.x<br><br>##  협력사정보 ##<br>회사명 : 타임게이트<br>담당자 : 안상훈 책임<br>연락처 : 010-3957-1209<br>##<br><br>## 지난 SR 정보 ##<br>기술 문의 01938049<br>##<br><br>## 문의사항 ##<br><br>지난 SR문의 시 기 공유드린 (70007), (70008), (70014) 세 타입의 에러메세지가 반복발생하고 있는데 <br>하기의 설정으로 timeout 등 관련 에러가 많이 감소하였습니다. <br> [Wed Nov 15 09:19:09.480766 2017] [proxy_http:error] [pid 112029:tid 140562677729024] (70007)The timeout specified has expired: [client 100.xxx.xxx.xxx:51187] AH01095: prefetch request body failed to 100.xxx.xxx.xx:51002 (ep.ap8.r.samsunglife.kr) from 100.xxx.xxx.xxx()<br>[Thu Nov 09 20:26:36.208735 2017] [proxy:error] [pid 10348:tid 139875240064768] (32)Broken pipe: [client 100.x.xx.xxx:58824] AH01084: pass request body failed to 100.xxx.xxx.xx:50001 (ep.ap1.t.samsunglife.kr)<br>---<br>SetEnv proxy-nokeepalive 1  <br>SetEnv proxy-sendchunked 1 <br>SetEnv proxy-sendchunks 1 <br>--<br><br>하지만 access 로그 상 HTTP 상태코드400 Bad Request은 apache 설정값 변경 여부와 관련없이 꾸준히 발생하고 있습니다. <br><br>100.x.xx.xxx - unknown [05/Nov/2017:17:35:39 +0900] 20 &quot;POST /portal/dataService.do HTTP/1.1&quot; 400 774 &quot;https://ep.ap1.t.samsunglife.kr:8443/irj/servlet/prt/portal/prtroot/request.Dispatcher?id=HDR7090820402250001490826542AC&amp;type=HEDR&amp;logType=&amp;menuNm=&amp;IS_POPUP=true&amp;NV=&amp;reqStartTime=1509870903490&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)&quot; &quot;_ga=GA1.2.1577537274.1500629855; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MzAwMDAzMjc5MogAE2Jhc2ljYXV0aGVudGljYXRpb24BAAozMDAwMDMyNzkyAgADMDAwAwADVEVQBAAMMjAxNzExMDUwODM0BQAEAAAAEAoACjMwMDAwMzI3OTL%2FAW8wggFrBgkqhkiG9w0BBwKgggFcMIIBWAIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNzCCATMCAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDVEVQAggKIBYIFgASBDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMTA1MDgzNDU2WjAjBgkqhkiG9w0BCQQxFgQUvUQSR5O50vmMYdqGNuVjQlPvz28wCQYHKoZIzjgEAwQ%2FMD0CHEF1OQet!3cDdPB6rOjT5Ec8Qp4BH8%2F94QZFGlMCHQCPHUvhH%2FrupOBo!prdOaORieINBnZMKeU7UU4B; PortalAlias=portal; saplb_*=(J2EE5696420)5696450; JSESSIONID=uFFoLxKlFvv1jnqwm9LE4qNUh1GLXwHC61YA_SAPBX9880bQKWdliED3JL7IGOSi; JSESSIONMARKID=DCPydgKZSLxa_GR8kUiKYI9-SE2E9JS0lpIcLrVgA; ROUTEID=.ep1&quot;<br> <br><br>문의1.  (70007), (70008), (70014) 관련 에러로그의 발생빈도가 많이 발생하였는데 현재 저희가 적용한 옵션 중 영향을 끼친 것이 있을까요? 만약 있다면, 어떤 이유와 논리로 사라졌는지 확인을 요청드립니다. <br><br>문의2. HTTP 상태코드 400 관련 코드는 꾸준히 발생하는데 완전히 발생하지 않게 하기 위한 가이드를 요청드립니다.(옵션 추가 등)<br><br>문의3. httpd.conf에 옵션 추가/변경 후 하기의 로그가 추가 발생하고 있는데 원인 및 조치가이드를 요청드립니다 .<br>[Wed Nov 08 16:45:32.204806 2017] [ssl:info] [pid 46844:tid 140180140287744] (70007)The timeout specified has expired: [remote 100.xxx.xxx.xx:50001] AH01991: SSL input filter read failed.  <br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000L4VD0IAN"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-24T01:07:54Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-24T01:07:54Z</b><br><br>확인감사합니다<br>해당 SR은 종료 후 문의가 발생할 경우 새 SR로 진행하도록 하겠습니다. <br>감사합니다.<br><br><publishedDate>2017-11-24T01:07:54Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000L4Jz4IAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-11-23T01:05:30Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-11-23T01:05:30Z</b><br><br>안녕하세요,<br><br>Apache doc [1]를 보시면 RequestReadTimeout (Set timeout values for receiving request headers and body from client) 의 default value는 'header=20-40,MinRate=500 body=20,MinRate=500' 입니다.<br><br>&quot;header=20-40,MinRate=500 body=20,MinRate=500&quot; <br>- request header, request body 에 대해 각각 timeout과 minrate가 설정됨<br>- header=20-40,MinRate=500 : 20초 타임아웃을 기본으로 하며, 만약 client가 data를 보내는 경우에 minrate 500 bytes 단위로 타임아웃이 max 40초까지 1초씩 증가<br>- body=20,MinRate=500 : 20초 타임아웃으로, 만약 client가 data를 보내는 경우에 minrate 500 bytes 단위로 타임아웃이 증가(max 설정이 따로 안되어 있기 때문에 LimitRequestBody이 설정된 경우 LimitRequestBody까지 받는 것을 limit으로 함)<br><br>(access_log)<br>100.118.91.30 - unknown [21/Nov/2017:17:46:27 +0900] 0 &quot;GET /common/setLogging.htm?X-UI-DATA-LOG=PGEFPC00269^%EC%A1%B0%ED%9A%8C%EC%A4%91%E2%80%A6 HTTP/1.1&quot; 304 -<br>100.118.91.30 - unknown [21/Nov/2017:17:46:47 +0900] 20 &quot;POST /portal/dataService.do HTTP/1.1&quot; 400 774<br>==&gt;<br>100.118.91.30의 client로부터 2017:17:46:27에 2개의 request가 요청된 것으로 보입니다.<br><br>1) &quot;GET /common/setLogging.htm?X-UI-DATA-LOG=PGEFPC00269^%EC%A1%B0%ED%9A%8C%EC%A4%91%E2%80%A6 HTTP/1.1&quot;<br>-&gt; response time = 0, httpd 304의 결과로 2017:17:46:27에 리턴됨<br><br>2) &quot;POST /portal/dataService.do HTTP/1.1&quot;<br>-&gt; response time = 20, http 400의 결과로 default request read timeout 20초 경과후 http 400의 결과로 2017:17:46:47에 리턴됨<br><br>(error_log)<br>[Tue Nov 21 17:47:07.401930 2017] [proxy_http:error] [pid 115528:tid 140247383500544] (70007)The timeout specified has expired: [client 100.118.91.30:52094] AH01095: prefetch request body failed to 100.253.141.25:51002 (ep.ap5.r.samsunglife.kr) from 100.118.91.30 ()<br>==&gt;<br>100.118.91.30 client로부터 100.253.141.25:51002 까지 request body를 prefetch 하다가 timeout 발생, <br>시간(Nov 21 17:47:07)으로 보면, request 400 return 된 이후에 request body가 backend server 100.253.141.25:51002로 보내지다가 request body timeout 20초를 만난 것으로 보이는데, 왜 이런 식으로 적용이 되는지는 request 전달 방식이 어떻게 되는지 application 구조에 대한 확인이 필요해보임.<br><br>유선상으로 말씀드린 것처럼, RequestReadTimeout 안에 정상적인 request header, body data가 전송되지 못하여 에러가 발생되는 것으로 파악됩니다.<br>그러나, 일반적으로 RequestReadTimeout 설정을 수정하여 사용하는 경우는 거의 없습니다. (default value 로도 왠만한 시스템은 문제없이 잘 돌아감)<br>전송 오류에 대한 정확한 원인 분석 없이 단순히 에러 방지를 위해 timeout을 늘린다면, 에러 발생 시기를 늦추는 형태밖에 되지 않습니다.<br>또한 timeout을 늘리게 되면 apache에서 처리해야 하는 workload가 증가하여 문제가 발생할 소지가 크고, 보안상 DDos 공격 등의 위험에도 노출될 수 있습니다.<br>따라서 timeout 설정 변경을 통한 시도는 권고하지 않습니다. <br><br>감사합니다.<br><br>[1] https://httpd.apache.org/docs/2.4/mod/mod_reqtimeout.html<br><br><publishedDate>2017-11-23T01:05:30Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000L47H5IAJ"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-22T07:53:52Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-22T07:53:52Z</b><br><br>안녕하세요<br><br>70007 에러로그 관련하여 추가문의가 있어 SR업데이트 드립니다 <br><br>문의사항은 다음과 같습니다.<br>EP Web서버의 timeout 관련 에러이슈 해결을 위해 Access Log와 맵핑하여 살펴보던 중 ErrorLog 나온 IP와 시간대로 AccessLog에 grep 하니 아래와 같이 Log가 나타났습니다.<br><br>호출 시간은 46분 27초, 400 code log는 46분 47초, Errorlog는 47분 07초 이렇게 20초 간격으로 Log가 나타나고 있습니다.<br>apache config상으로는 20초를 설정한 부분이 없지만 정확히 20초 간격으로 로그가 찍히고 있는 바 해당사항에 관련한 설정이 존재하는지 여부와 존재한다면 어떤 방법으로 control할 수 있는지 알려주시길 부탁드립니다.<br>(다른 로그도 마찬가지 입니다.)<br><br>## 로그 일부 ##<br><br>&lt;Access Log&gt;<br>100.118.91.30 - unknown [21/Nov/2017:17:46:27 +0900] 0 &quot;GET /common/setLogging.htm?X-UI-DATA-LOG=PGEFPC00269^%EC%A1%B0%ED%9A%8C%EC%A4%91%E2%80%A6 HTTP/1.1&quot; 304 - &quot;https://ep.ap.r.samsunglife.kr:8443/irj/servlet/prt/portal/prtroot/request.Dispatcher?pid=&amp;id=MNU1612010554361549890018E053B&amp;type=MENU&amp;hkey=&amp;reqStartTime=1511253966925&amp;logType=&amp;IS_POPUP=&amp;noticeYn=N&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot; &quot;LPP709150814332553175516101EE0=1; WMONID=RUZ0TZTPgoV; PortalAlias=portal; saplb_*=(J2EE106066520)106066551; JSESSIONID=_85pubbGYZWwqoFpC1SedjnT8ZTdXwF4clIG_SAPqw9VFKKaTL6QdUAfHaba8ul-; JSESSIONMARKID=HdCzRAiKS7Pok1Ybbp2Neqp3L0l7p7XsKO6ndyUgY; ROUTEID=.ep13; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MTAwMDAxODk0MIgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAoxMDAwMDE4OTQwAgADMDAwAwADUkVQBAAMMjAxNzExMjEwNTQxBQAEAAAAEAoACjEwMDAwMTg5NDD%2FAW8wggFrBgkqhkiG9w0BBwKgggFcMIIBWAIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNzCCATMCAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUkVQAggKIBYJBwZANjAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMTIxMDU0MTI5WjAjBgkqhkiG9w0BCQQxFgQUhEzR!WdBZK8mWoRcfhyXQOJrNaAwCQYHKoZIzjgEAwQ%2FMD0CHGRSj5E7EUImXefBujnobxvPM5N!jcyh1Y6tc!wCHQCCxm0hONxPU7NVXCTz3kSxmKnoBgwoS4MnexLf&quot;<br><br>100.118.91.30 - unknown [21/Nov/2017:17:46:47 +0900] 20 &quot;POST /portal/dataService.do HTTP/1.1&quot; 400 774 &quot;https://ep.ap.r.samsunglife.kr:8443/irj/servlet/prt/portal/prtroot/request.Dispatcher?<br>pid=&amp;id=MNU161201055428309303EE053B6C6&amp;type=MENU&amp;hkey=&amp;reqStartTime=1511251042617&amp;logType=&amp;IS_POPUP=&amp;noticeYn=N&quot; &quot;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&quot; <br>&quot;LPP709150814332553175516101EE0=1; WMONID=RUZ0TZTPgoV; PortalAlias=portal; saplb_*=(J2EE106066520)106066551; JSESSIONID=_85pubbGYZWwqoFpC1SedjnT8ZTdXwF4clIG_SAPqw9VFKKaTL6QdUAfHaba8ul-; <br>JSESSIONMARKID=HdCzRAiKS7Pok1Ybbp2Neqp3L0l7p7XsKO6ndyUgY; ROUTEID=.ep13; OAMAuthnHintCookie=1; <br>MYSAPSSO2=AjExMDAgABFwb3J0YWw6MTAwMDAxODk0MIgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAoxMDAwMDE4OTQwAgADMDAwAwADUkVQBAAMMjAxNzExMjEwNTQxBQAEAAAAEAoACjEwMDAwMTg5NDD%2FAW8wggFrBgkqhkiG9w0BBwKgggFcMIIBWAIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNzCCATMCAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUkVQAggKIBYJBwZANjAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMTIxMDU0MTI5WjAjBgkqhkiG9w0BCQQxFgQUhEzR!WdBZK8mWoRcfhyXQOJrNaAwCQYHKoZIzjgEAwQ%2FMD0CHGRSj5E7EUImXefBujnobxvPM5N!jcyh1Y6tc!wCHQCCxm0hONxPU7NVXCTz3kSxmKnoBgwoS4MnexLf&quot;<br> <br>&lt;ErrorLog&gt;<br>[Tue Nov 21 17:47:07.401930 2017] [proxy_http:error] [pid 115528:tid 140247383500544] (70007)The timeout specified has expired: [client 100.118.91.30:52094] AH01095: prefetch request body failed to 100.253.141.25:51002 (ep.ap5.r.samsunglife.kr) from 100.118.91.30 (), referer: https://ep.ap.r.samsunglife.kr:8443/irj/servlet/prt/portal/prtroot/request.Dispatcher?pid=&amp;id=MNU161201055428309303EE053B6C6&amp;type=MENU&amp;hkey=&amp;reqStartTime=1511251042617&amp;logType=&amp;IS_POPUP=&amp;noticeYn=N<br> <br>##<br><br>설정파일 상 timeout 관련 설정은 하기와 같이 600(s)로 설정한 것밖에는 확인되지 않는데 혹시  20초로 설정된 숨겨진 부분이 httpd 설정 상 존재하는지요?<br><br>httpd.conf<br>##<br>Timeout 600<br>ProxyTimeout 600<br>##<br><br>ep.httpd.conf<br>##<br>&lt;Proxy balancer://epCluster&gt;        <br>BalancerMember https://ep.ap1.t.samsunglife.kr:50001 route=ep1 connectiontimeout=600        <br>ProxySet lbmethod=byrequests        <br>ProxySet stickysession=ROUTEID        <br>ProxySet nofailover=On        <br>SetEnv proxy-nokeepalive 1        <br>SetEnv proxy-initial-not-pooled 1        <br>&lt;/Proxy&gt;    <br>##<br><br><publishedDate>2017-11-22T07:53:52Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000L3X61IAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-11-20T08:02:33Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-11-20T08:02:33Z</b><br><br>안녕하세요,<br><br>유선상으로 말씀드린 것처럼, 에러의 원인 분석을 위해서는 backend server의 상태 점검 및 전체 network 점검이 반드시 필요합니다.<br>Apache의 설정값 변경으로 어느정도 tuning을 시도해 볼 수는 있지만, 운영환경의 상태를 모르는 상태에서 에러 로그만을 가지고 진행하기에는 힘든 점이 많습니다.<br><br>1. backend server 상태 점검<br>JBoss EAP를 사용하는 경우에는 원인 분석을 위해, 해당 시점의 아래 data 들을 수집하여 분석합니다.<br> - JBoss EAP<br>   - For standalone mode, standalone(-*).xml <br>   - For domain mode, domain.xml and host.xml<br>   - logs/server.log<br>   - GC logging<br>     If not yet enabled, please enable GC logging on JBoss as explained in https://access.redhat.com/solutions/18656<br>   　I would suggest you to add -verbose:gc -Xloggc:gc.log.`date +%Y%m%d%H%M%S` -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps to JVM options<br>   - Access logging <br>     If not yet enabled, please enable it as explained in https://access.redhat.com/solutions/185383<br>     I would suggest you to add &lt;access-log pattern='%h %l %u %t %r %s %b %{Referer}i %{User-Agent}i %I %S %T'&gt; inside &lt;virtual-server&gt; in web subsystem.<br>    - Thread dump<br><br>위와 유사하게 현재 사용하시는 Net Weaver의 경우는 해당 에러가 발생하는 시점의 상태 점검을 위해 어떤 Data 수집이 필요한지 SAP 쪽의 문의하여 분석이 이루어져야 합니다.<br><br><br>2. 구간별 network 점검<br>Client - LB(?) - Apache httpd - Net Weaver와 같은 구성이신건지, 아니면 단계가 더 추가되는지 모르겠습니다만<br>각 구간별로 packet dump를 떠서 분석하면 어느부분에서 drop이 발생하는지, 왜 drop이 발생하는지를 확인할수가 있습니다.<br>tcp dump 생성 방법은 KCS [1]을 참조하실 수 있습니다.<br><br>[1] https://access.redhat.com/knowledge/solutions/8787 - How to capture network packets with tcpdump?<br><br>문제 해결을 위해 최대한 도움을 드리고 싶지만, 운영 시스템 환경이 SAP Net Weaver를 기반으로 서비스되고 있기 때문에 Apache httpd 로그 분석만으로는 원인 분석이 힘들겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-20T08:02:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000L3WdnIAF"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-20T07:18:32Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-20T07:18:32Z</b><br><br>안녕하세요<br>지난 SR 답변 시 하기와 같이 가이드 주셨는데 network관련 점검, 혹은 좀 더 정확한 분석을 위해 필요한 자료가 없으신지요?<br>##<br>문의1.  (70007), (70008), (70014) 관련 에러로그의 발생빈도가 많이 발생하였는데 현재 저희가 적용한 옵션 중 영향을 끼친 것이 있을까요? 만약 있다면, 어떤 이유와 논리로 사라졌는지 확인을 요청드립니다. <br>--&gt; 이 설정들이 에러를 줄이는데 도움을 줄 수는 있지만, 이 설정만으로 에러들을 모두 clear하게 해결할 수는 없습니다.<br>연계된 client/backend server의 상태 및 network 영향도에 따라 에러가 많이 또는 적게 발생할 수 있습니다.<br><br><br>문의2. HTTP 상태코드 400 관련 코드는 꾸준히 발생하는데 완전히 발생하지 않게 하기 위한 가이드를 요청드립니다.(옵션 추가 등)<br>--&gt;<br>client가 apache로 접속을 하여 request가 처리되는데, 정상적으로 완료되지 못하여 'bad request'로 인식이 되었을 경우에 발생되는 에러입니다.<br>이는 단순히 apache 설정으로 해결할 수 있는 문제는 아니며, 에러의 원인 분석을 위해서는 client - apache 구간의 network 점검을 통해 packet 손실등이 발생하지 않는지 점검이 필요합니다.<br>##<br><br>확인요청드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-20T07:18:32Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000L3U6yIAF"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-20T00:56:33Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-20T00:56:33Z</b><br><br>확인감사합니다. <br>고객에게 해당 내용 전달하여 추가 문의여부를 대기하고 있는 중입니다. <br>감사합니다.<br><br><publishedDate>2017-11-20T00:56:33Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000L3BkfIAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-11-17T05:58:48Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-11-17T05:58:48Z</b><br><br>문의1.  (70007), (70008), (70014) 관련 에러로그의 발생빈도가 많이 발생하였는데 현재 저희가 적용한 옵션 중 영향을 끼친 것이 있을까요? 만약 있다면, 어떤 이유와 논리로 사라졌는지 확인을 요청드립니다. <br><br>(70007)The timeout specified has expired<br>(70008)Partial results are valid but processing is incomplete<br>(70014)End of file found<br><br>위의 오류들은 client 또는 backend server 와의 communication 중에 발생하는 에러입니다.<br><br>에러가 발생하는 원인으로는 <br> - backend server의 응답 저하로 인한 timeout 초과<br> - network 문제(packet 손실로 인해 정상 communication 실패)<br> - keepalive connection 사용으로 인한 문제<br>등이 있습니다.<br><br>Timeout 600<br>ProxyTimeout 600<br>-&gt;<br>이 설정으로 timeout 시간을 늘림으로써, 디폴트 timeout 설정으로 인해 발생했던 에러 메시지는 줄어들 수 있습니다.<br><br>SetEnv proxy-nokeepalive 1<br>SetEnv proxy-initial-not-pooled 1<br>-&gt;<br>이 설정으로 인해 apache - backend server 간의 mod_proxy connection 의 keepalive/pool connection 사용을 안하게 됩니다.<br>그로인해 keepalive(pooled) connection 으로 인한 오류는 줄어들 수 있습니다.<br><br>이 설정들이 에러를 줄이는데 도움을 줄 수는 있지만, 이 설정만으로 에러들을 모두 clear하게 해결할 수는 없습니다.<br>연계된 client/backend server의 상태 및 network 영향도에 따라 에러가 많이 또는 적게 발생할 수 있습니다.<br><br><br>문의2. HTTP 상태코드 400 관련 코드는 꾸준히 발생하는데 완전히 발생하지 않게 하기 위한 가이드를 요청드립니다.(옵션 추가 등)<br><br>http 400 'bad request' 는 다음과 같이 정의됩니다. <br>&quot;The server cannot or will not process the request due to something that is perceived to be a client error. (e.g., malformed request syntax, invalid request message framing, or deceptive request routing)&quot;<br><br>client가 apache로 접속을 하여 request가 처리되는데, 정상적으로 완료되지 못하여 'bad request'로 인식이 되었을 경우에 발생되는 에러입니다.<br>이는 단순히 apache 설정으로 해결할 수 있는 문제는 아니며, 에러의 원인 분석을 위해서는 client - apache 구간의 network 점검을 통해 packet 손실등이 발생하지 않는지 점검이 필요합니다.<br><br><br>문의3. httpd.conf에 옵션 추가/변경 후 하기의 로그가 추가 발생하고 있는데 원인 및 조치가이드를 요청드립니다 .<br>[Wed Nov 08 16:45:32.204806 2017] [ssl:info] [pid 46844:tid 140180140287744] (70007)The timeout specified has expired: [remote 100.xxx.xxx.xx:50001] AH01991: SSL input filter read failed.  <br><br>이 에러는 SSL communication 사이에 timeout이 발생된 것인데요.<br>이 메시지로는 timeout의 정확한 원인은 알수가 없습니만, ssl 설정이 들어간 VirtualHost 구문 안에 아래의 설정을 통해 timeout으로 인해 close_notify 없이 끊긴 ssl connection을 정리하는데 도움을 줄 수 있습니다.<br><br>~~~~~<br>SetEnv nokeepalive ssl-unclean-shutdown<br>~~~~~<br><br>ssl-unclean-shutdown:<br>#     This forces an unclean shutdown when the connection is closed, i.e. no<br>#     SSL close notify alert is sent or allowed to be received.  This violates<br>#     the SSL/TLS standard but is needed for some brain-dead browsers. Use<br>#     this when you receive I/O errors because of the standard approach where<br>#     mod_ssl sends the close notify alert.<br><br>감사합니다.<br><br><publishedDate>2017-11-17T05:58:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000L3AsPIAV"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-11-17T03:45:08Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-11-17T03:45:08Z</b><br><br>안녕하세요,  <br>  <br>Red Hat Global Support Services를 이용해주셔서 감사합니다.  <br><br>현재 이 케이스의 내용을 자세히 살펴보는 중이며, 곧 업데이트 하도록 하겠습니다.<br>  <br>감사합니다. <br>Minwoo Park<br><br><publishedDate>2017-11-17T03:45:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000L2vMqIAJ"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-16T07:47:20Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-16T07:47:20Z</b><br><br>환경설정파일을 첨부드립니다.<br><br><publishedDate>2017-11-16T07:47:20Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>