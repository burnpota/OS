======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2019-02-28T02:47:59Z</b><br><b>마지막 답변자 : Xingbin Li</b><br><b>마지막 수정 일자 : 2019-03-12T07:35:36Z</b><br><b>id : 5002K00000dMOrCQAW</b><br>======================<br><br><b><font size=15>
제목  : ulimit.conf 적용관련 영향도 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요. 송기호입니다.<br>ldapservice계정의 오픈파일(nofile)의 값을 8192 -&gt; 65535로 조정로 변경하고자 하는데요.<br>몇가지 문의를 드립니다.<br><br>1. 설정 변경 영향 검토 요청 : 솔루션 권고인데 OS 上 Side Effect가 있을 사항이 있을지<br><br><br>2. 해당 파라미터가 예전에도 이슈가 된적이 있어서, OPEN File 수는 기본 늘렸었었는데..<br><br>   유사 파라미터로 다른 사항인건지 모르겠어요.<br><br><br>3. 디폴트 설정이 8192일까요?<br><br><br>4. 해당 파라미터 변경 時 리부팅 필요할까요?<br><br>좋은하루되세요~<br>감사합니다<br><br>현재 파라메터값및 설정정보 보내드립니다. 참고부탁드립니다.<br><br>root@SLPLDPAL02 /root # cat /proc/sys/fs/file-nr<br>2720    0       3261599<br><br> <br><br>root@SLPLDPAL02 /root # cat /proc/sys/fs/file-max<br>3261599<br><br> <br><br>root@SLPLDPAL02 /root # cat /etc/security/limits.conf<br># /etc/security/limits.conf<br>#<br>#Each line describes a limit for a user in the form:<br>#<br>#&lt;domain&gt;        &lt;type&gt;  &lt;item&gt;  &lt;value&gt;<br>#<br>#Where:<br>#&lt;domain&gt; can be:<br>#        - a user name<br>#        - a group name, with @group syntax<br>#        - the wildcard *, for default entry<br>#        - the wildcard %, can be also used with %group syntax,<br>#                 for maxlogin limit<br>#<br>#&lt;type&gt; can have the two values:<br>#        - &quot;soft&quot; for enforcing the soft limits<br>#        - &quot;hard&quot; for enforcing hard limits<br>#<br>#&lt;item&gt; can be one of the following:<br>#        - core - limits the core file size (KB)<br>#        - data - max data size (KB)<br>#        - fsize - maximum filesize (KB)<br>#        - memlock - max locked-in-memory address space (KB)<br>#        - nofile - max number of open file descriptors<br>#        - rss - max resident set size (KB)<br>#        - stack - max stack size (KB)<br>#        - cpu - max CPU time (MIN)<br>#        - nproc - max number of processes<br>#        - as - address space limit (KB)<br>#        - maxlogins - max number of logins for this user<br>#        - maxsyslogins - max number of logins on the system<br>#        - priority - the priority to run user process with<br>#        - locks - max number of file locks the user can hold<br>#        - sigpending - max number of pending signals<br>#        - msgqueue - max memory used by POSIX message queues (bytes)<br>#        - nice - max nice priority allowed to raise to values: [-20, 19]<br>#        - rtprio - max realtime priority<br>#<br>#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;<br>#<br><br>#*               soft    core            0<br>#*               hard    rss             10000<br>#@student        hard    nproc           20<br>#@faculty        soft    nproc           20<br>#@faculty        hard    nproc           50<br>#ftp             hard    nproc           0<br>#@student        -       maxlogins       4<br><br># End of file<br>root@SLPLDPAL02 /root #<br><br> <br><br> <br><br>root@SLPLDPAL02 /etc/security/limits.d # ll<br>total 4<br>-rw-r--r--. 1 root root 251 Apr 20  2016 90-nproc.conf<br>root@SLPLDPAL02 /etc/security/limits.d #<br>root@SLPLDPAL02 /etc/security/limits.d #<br>root@SLPLDPAL02 /etc/security/limits.d # cat 90-nproc.conf<br># Default limit for number of user's processes to prevent<br># accidental fork bombs.<br># See rhbz #432903 for reasoning.<br><br>*          soft    nproc     1024<br>root       soft    nproc     unlimited<br><br>ldapservice     soft    nofile  8192<br>ldapservice     hard    nofile  65535<br><br> <br><br> <br><br><br>root@SLPLDPAL02 /root # ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 256398<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 1024<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 256398<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br> <br><br> <br><br>ldapservice@SLPLDPAL02 /home/ldapservice # ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 256398<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 8192<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 1024<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>NA</hostname><br><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2019-03-12T07:35:13Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2019-03-12T07:35:13Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>본 케이스를 종료처리 하고자 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2019-03-12T07:35:13Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PWaLKQA1"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2019-03-08T03:30:32Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2019-03-08T03:30:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 추가적으로 문의하실 사항이 있으신가요?<br><br>본 안내 후 일정기간 답변이 없다면 본 케이스는 자동으로 종료 상태가 됨을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하시다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2019-03-08T03:30:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PRAQbQAP"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2019-03-04T01:39:07Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2019-03-04T01:39:07Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>Q1. nofile의 경우는 limit.conf 넣는 것이 권장인가요?<br>A1. 네, limit.conf 파일 또는 limit.d 디렉토리에 하위 .conf 파일을 생성하여 해당 값을 넣는 것을 권장드립니다.<br><br>Q2. limit.d 하위 20-nproc.conf 가 포크 폭탄과 같은 악의적 인 서비스 거부 공격을 방지위해서 존재하는건가요? <br>A2. 해당 파일의 내용을 보면 nproc 설정을 위해 존재하는 것임을 알 수 있습니다. 즉 계정당 최대 프로세스 개수를 제한하기 위해 존재합니다.<br>    말씀하신 내용처럼 악의적인 포크폭탄으로 인해 시스템 자원을 급격히 소모하는 것을 방지하는 역할을 하게 됩니다.<br>~~~<br># Default limit for number of user's processes to prevent<br># accidental fork bombs.<br>~~~<br>  <br>Q3. limit.d 하위에 임으로 파일을 생성, 예를들면 50-nofile.conf, 하여 값을 설정해도 될까요?<br>A3. 네, 말씀하신 방식으로 해당 값을 설정하셔도 됩니다.<br><br>감사합니다.<br><br><publishedDate>2019-03-04T01:39:07Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PR8xnQAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2019-03-03T14:18:44Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2019-03-03T14:18:44Z</b><br><br>답변감사합니다.<br>궁금한게 있어서 추가 질의드립니다.<br><br>ulimit 를 적용할때<br>몇가지 방법이 있고 어디에 설정을 하느냐에 따라 우선순위도 달라진다고 알고 있습니다.<br>우선순위는 (낮음) limit.conf &gt; ../limit.d/20-nproc.conf &gt; profile or .bash_profile(높음) 로 알고 있습니다.<br>1.  nofile의 경우는 limit.conf 넣는 것이 권장인가요?<br><br>2. limit.d 하위 20-nproc.conf 가 포크 폭탄과 같은 악의적 인 서비스 거부 공격을 방지위해서 존재하는건가요? <br><br>3. limit.d 하위에 임으로 파일을 생성, 예를들면 50-nofile.conf, 하여 값을 설정해도 될까요?<br><br>답변 부탁드립니다.<br><br><publishedDate>2019-03-03T14:18:44Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0a2K00000PQZHvQAP"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2019-02-28T07:15:24Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2019-02-28T07:15:24Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의 주신 내용에 대해 아래와 같이 답변드리겠습니다.<br><br>Q1. 설정 변경 영향 검토 요청 : 솔루션 권고인데 OS 上 Side Effect가 있을 사항이 있을지<br>A1. nofile 값을 8192 -&gt; 65535 로 조정하셔도 시스템 운영에 문제가 없습니다.<br><br>Q2. 해당 파라미터가 예전에도 이슈가 된적이 있어서, OPEN File 수는 기본 늘렸었었는데..<br>    유사 파라미터로 다른 사항인건지 모르겠어요.<br>A2. 한개 계정이 오픈할수 있는 파일수 최대값은 말씀하신 nofile 로 수정하는 것이 맞습니다.<br><br>Q3. 디폴트 설정이 8192일까요?<br>A3. 디폴트 설정은 1024입니다.<br><br>Q4. 해당 파라미터 변경 時 리부팅 필요할까요?<br>A4. 리부팅이 필요하지 않습니다. 다음번 ldapservice 계정으로 로그인시 자동으로 적용됩니다.<br><br>감사합니다.<br><br><publishedDate>2019-02-28T07:15:24Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PQXVdQAP"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2019-02-28T04:47:08Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2019-02-28T04:47:08Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>저는 Platform Support 를 담당하고 있는 Technical Support Engineer 이성빈입니다.<br>올려주신 문의내용은 현재 자세히 살펴보고 있는중이며, 관련된 내용이 확인이 되는대로 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2019-02-28T04:47:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>