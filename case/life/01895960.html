======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-07-24T02:49:40Z</b><br><b>마지막 답변자 : Ying Huang</b><br><b>마지막 수정 일자 : 2017-08-11T10:07:07Z</b><br><b>id : 500A000000XWNhTIAX</b><br>======================<br><br><b><font size=15>
제목  : [문의]partprobe 후 정상적으로 파티션이 보이지 않습니다.
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요.<br>주말에 oracleasm 볼륨 추가 작업을 진행하였습니다.<br>1. 해당 서버에 1호기와 2호기가 공유하는 200GB LUN 10개를  할당 후 멀티패싱을 진행하였습니다.<br>2. 멀티패싱 네임은 ASMERP200G0[01-10]이며 후에 fdisk 를 이용해 파티션을 진행하였습니다.<br>3.  ASMERP200G0[01-10]p1로 만든 후 1호기와 2호기에서 partprobe 를 진행하였습니다.<br>4. 1호기와 2호기에서 보이는 lsblk가 다르고<br>1호기는 ASMERP200G0[01-10]p1 의 파티션 정보만 보이고<br>2호기에서는  ASMERP200G0[01-10]p1 의 파티션 정보 뿐만아니라 하위 디바이스에 대한 파티션 정보가 보입니다.<br><br>서로 같은 공유볼륨에서 다르게 보이는 원인을 알수 있을까요??<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.7</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPHPSDL01 &amp; SLPHPSDL02</hostname><br><br><br><comment id="a0aA000000JxBKmIAN"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-07-26T02:22:28Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-07-26T02:22:28Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>아래의 명령어는 현재 사용하지 않는 멀티패스 디바이스 패스에 사용하셔야 하며<br>서버에 있는 다른 디바이스에는 영향을 주지 않습니다.<br><br>만일 oracle이 명령어를 적용하시려면 디바이스 사용중이 시다면<br>중지후 작업을 진행 하셔야 합니다.<br><br>감사합니다.<br><br><publishedDate>2017-07-26T02:22:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JxAvnIAF"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-07-26T01:21:51Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-07-26T01:21:51Z</b><br><br>답변감사합니다.<br>해당 명령어는 서비스 운용중에 실행해도 가능한가요??<br>현재 oracle이 구동중에 있습니다.<br><br><publishedDate>2017-07-26T01:21:51Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JwvdOIAR"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-07-25T05:36:08Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-07-25T05:36:08Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>상세한 설명 감사드립니다.<br>이와 같은 이슈는 extra cache buffer이 존재하여 발생되는 이슈로 알려져 있는데<br>이슈가 발생되는 패스에 아래와 같은 명령어를 실행 혹은 리부팅 작업으로 이슈를 해소<br>하실수 있습니다.<br><br># blockdev --flushbufs &lt;PATH&gt;<br><br>감사합니다.<br><br><publishedDate>2017-07-25T05:36:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JwttdIAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-07-25T01:34:29Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-07-25T01:34:29Z</b><br><br>답변감사합니다<br>다시 말씀드리겠습니다.<br><br>우선,<br>1호기에 ASMERP200G001 멀티패싱된 장치를 보면<br>ASMERP200G001 (360060e8006d5e6000000d5e600002b30) dm-81 HITACHI,OPEN-V<br>size=200G features='0' hwhandler='0' wp=rw<br>`-+- policy='round-robin 0' prio=0 status=active<br>  |- 3:0:0:40 sdcd 69:16  active undef running<br>  `- 5:0:0:40 sdcn 69:176 active undef running<br>dm명은 dm-81입니다.<br><br>dm-81의 파티션 정보를 보면 <br>Disk /dev/dm-81: 214.7 GB, 214748364800 bytes<br>255 heads, 63 sectors/track, 26108 cylinders<br>Units = cylinders of 16065 * 512 = 8225280 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk identifier: 0xfa6c95b3<br><br>      Device Boot      Start         End      Blocks   Id  System<br>/dev/dm-81p1               1       26108   209712478+  83  Linux<br>보입니다.<br><br>그런데<br>멀티패싱된 네이티브 디바이스 다시말하면 이중화 되기 전의 장치에서 한개를 보면 <br>Disk /dev/sdcd: 214.7 GB, 214748364800 bytes<br>255 heads, 63 sectors/track, 26108 cylinders<br>Units = cylinders of 16065 * 512 = 8225280 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk identifier: 0x00000000<br>파티션이 되어있지 않습니다.<br><br>반면 2호기는<br>ASMERP200G001 (360060e8006d5e6000000d5e600002b30) dm-75 HITACHI,OPEN-V<br>size=200G features='0' hwhandler='0' wp=rw<br>`-+- policy='round-robin 0' prio=0 status=active<br>  |- 3:0:0:40 sdbt 68:112 active undef running<br>  `- 5:0:0:40 sdcd 69:16  active undef running<br><br>Disk /dev/sdbt: 214.7 GB, 214748364800 bytes<br>255 heads, 63 sectors/track, 26108 cylinders<br>Units = cylinders of 16065 * 512 = 8225280 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk identifier: 0xfa6c95b3<br><br>    Device Boot      Start         End      Blocks   Id  System<br>/dev/sdbt1               1       26108   209712478+  83  Linux<br><br>하위장치들도 파티션 정보가 보입니다.<br>1호기와 2호기는 서로 공유하는 볼륨인데 다르게 보이는 이유를 알수 있을까요?<br><br>해당 서버는 리부팅은 진행하지 않았으며<br>파티션 정보가 서로 다르게 보이는 이유로<br>1호기의 label과 2호기의 label이 다르게 보이는 상황입니다.<br><br>설명이 이해가 되셨는지 모르겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-07-25T01:34:29Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JwhYpIAJ"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-07-24T08:56:24Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-07-24T08:56:23Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>현재 올려주신 sosreport 확인시 lsblk 결과는 동일하면 아래와 같이 멀티패스 디바이스 패스들의 파티션 정보도 <br>문제가 없이 확인되는것으로 보입니다.<br><br>구체적으로 어는 디바이스에 문제가 있는지 확인 부탁 드립니다.<br>또한 참고로 멀티패스 디바이스위에 파티션 생성시 portprobe가 아닌 kpartx 명령어로 파티션 정보를 읽어오는 것을 권장 드립니다.<br><br>참고문서:<br>How can I create partitions on multipath devices in RHEL?<br>https://access.redhat.com/solutions/25692<br><br>dhcp-192-28:sosreport-SLPHPSDL01-20170723121548 Catherine$ cat sos_commands/block/parted_-s_.dev.sdbj_unit_s_print <br>Model: HITACHI OPEN-V (scsi)<br>Disk /dev/sdbj: 209715840s<br>Sector size (logical/physical): 512B/512B<br>Partition Table: msdos<br><br>Number  Start  End         Size        Type     File system  Flags<br> 1      63s    209712509s  209712447s  primary<br>dhcp-192-28:sosreport-SLPHPSDL01-20170723121548 Catherine$ cat sos_commands/block/parted_-s_.dev.sdv_unit_s_print <br>Model: HITACHI OPEN-V (scsi)<br>Disk /dev/sdv: 209715840s<br>Sector size (logical/physical): 512B/512B<br>Partition Table: msdos<br><br>Number  Start  End         Size        Type     File system  Flags<br> 1      63s    209712509s  209712447s  primary<br><br>dhcp-192-28:sosreport-SLPHPSDL01-20170723121548 Catherine$ cat sos_commands/block/parted_-s_.dev.dm-14_unit_s_print <br>Model: Linux device-mapper (multipath) (dm)<br>Disk /dev/dm-14: 209715840s<br>Sector size (logical/physical): 512B/512B<br>Partition Table: msdos<br><br>Number  Start  End         Size        Type     File system  Flags<br> 1      63s    209712509s  209712447s  primary<br><br><br>감사합니다.<br><br><publishedDate>2017-07-24T08:56:23Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>