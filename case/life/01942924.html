======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-09-29T20:14:44Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2017-10-06T01:10:06Z</b><br><b>id : 500A000000YRcv7IAD</b><br>======================<br><br><b><font size=15>
제목  : [장애분석]서버 리부팅 관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요.<br>30일 2시 25분경쯤 서버가 갑작스런 리부팅이 되었습니다.<br>로그상에 특별한 내용없는 것으로 보이는데 <br>sosreport첨부드리니 원인 분석 부탁드립니다.<br><br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com&gt;<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.6</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPCSSDL01</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000KfFBjIAN"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-06T01:10:05Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-06T01:10:05Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>먼저, 본 기술 문의를 직접 종료해주셔서 감사합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-10-06T01:10:05Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KfF6KIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-10-06T00:58:40Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-10-06T00:58:40Z</b><br><br>안녕하세요.<br><br>이번 Oracle ASM 리부팅 이슈는 Oracle Bug 로 확인되어 해당 케이스는 Close 하도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-10-06T00:58:40Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KeyRyIAJ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-04T23:32:44Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-04T23:32:44Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>로그를 확인결과 ntpd 수행시에 기본적으로 모든 활성화 인터페이스에 대해 바인드를 수행하게되며,<br>이에 따라 bond0:0 장치도 바인드가 되었으며, ntpd 서비스가 인터페이스를 삭제하는 것은 아닌 것으로 확인되었습니다.<br><br>사용자 혹은 다른 애플리케이션에 의해 해당 장치가 비활성화되었을 가능성이 있으며,<br>이에 따라 ntpd 장치에 바인드되었던 소켓이 해제되면서 로그가 저장된 것입니다.<br><br>-L 옵션은 ntpd 에 가상 인터페이스에 대한 리슨을 하지 않게 설정하게됩니다.<br>해당 옵션이 ntpd 서비스에 영향이 없는지도 확인이 필요합니다.<br><br>       -L      Do not listen to virtual interfaces, defined as those with names containing a colon. This option is  depre-<br>               cated. Please consider using the configuration file interface command, which is more versatile.<br><br>또한, 리부팅에 대한 원인이 해당 장치(bond0:0)의 비활성화 때문인지도 확인이 필요할 것으로 보입니다.<br><br>bond0:1   Link encap:Ethernet  HWaddr EC:F4:BB:E6:BA:02<br>          inet addr:100.254.40.104  Bcast:100.254.40.255  Mask:255.255.255.0<br>          UP BROADCAST RUNNING MASTER MULTICAST  MTU:1500  Metric:1<br><br>100.254.40.104  SLPCSSDL01-VIP  slpcssdl01-vip<br><br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-10-04T23:32:44Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KeubmIAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-10-04T18:16:57Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-10-04T18:16:57Z</b><br><br>안녕하세요.<br>답변 감사합니다.<br>해당 원인 분석 중에  <br>-&gt; 시스템 리부팅 이전에 ntpd 에 의한 인터페이스 삭제가 있었으며, 아래 문서를 확인하여 -L 설정을 추가해보시기 바랍니다.<br><br>NTP가 인터페이스를 삭제하는 것이 가능한 것인가요? <br>NTP 자체의 버그인 부분인가요? 아니면 oracleasm  환경에서 ntp를 사용할때 발생하는 것인가요?<br><br>그럼 수고하세요<br><br><publishedDate>2017-10-04T18:16:57Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KejG0IAJ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-04T04:20:20Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-04T04:20:20Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>확인 감사드립니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-10-04T04:20:20Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KeixQIAR"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-10-04T03:23:32Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-10-04T03:23:32Z</b><br><br>안녕하세요.<br><br>이번 이슈는 Oracle ASM Dump 가 생성되어 별도로 분석 요청을 진행하고 있으며,<br><br>ntp 동기화 관련해서 추가로 다시 케이스를 생성하도록 하겠습니다.<br><br>Oracle ASM Issue 관련 된 내용은 다시 업데이트 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-10-04T03:23:32Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Kei6AIAR"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-04T00:59:02Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-04T00:59:01Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>DMIDECODE<br>  BIOS:<br>    Vend: Dell Inc.    Vers: 2.1.6    Date: 05/19/2016    BIOS Rev: 2.1<br>  System:<br>    Prod: PowerEdge R730<br>  CPU:<br>    2 of 2 CPU sockets populated, 12 cores/12 threads per CPU<br>    24 total cores, 24 total threads<br>    Vers: Intel(R) Xeon(R) CPU E5-2690 v3 @ 2.60GHz<br>  Memory:<br>    Total: 393216 MiB (384 GiB)<br><br>OS<br>  Hostname: SLPCSSDL01<br>  Distro:   [redhat-release] Red Hat Enterprise Linux Server release 6.6 (Santiago)<br>  Kernel:<br>    Booted kernel:  2.6.32-504.23.4.el6.x86_64<br>    Booted kernel cmdline:<br>      ro root=UUID=bda1ab79-f294-4ffe-ac22-8869ba386bea rd_NO_LUKS rd_NO_LVM<br>      LANG=en_US.UTF-8 rd_NO_MD SYSFONT=latarcyrheb-sun16 crashkernel=153M@0M<br>      KEYBOARDTYPE=pc KEYTABLE=us rd_NO_DM rhgb quiet nmi_watchdog=0<br>      transparent_hugepage=never elevator=deadline<br>    Taint-check: 1  (see https://access.redhat.com/solutions/40594)<br>       0  PROPRIETARY_MODULE: Proprietary module has been loaded<br>    - - - - - - - - - - - - - - - - - - -<br>  Sys time:  Sat Sep 30 03:46:22 KST 2017<br>  Boot time: Sat Sep 30 02:27:27 KST 2017  (epoch: 1506706047)<br>  Uptime:    1:18,  1 user<br>  LoadAvg:   [24 CPU] 1.86 (8%), 1.44 (6%), 1.41 (6%)<br>  /proc/stat:<br>    procs_running: 1   procs_blocked: 0    processes [Since boot]: 56488<br>    cpu [Utilization since boot]:<br>      us 1%, ni 0%, sys 0%, idle 98%, iowait 1%, irq 0%, sftirq 0%, steal 0%<br><br>KDUMP CONFIG<br>  kexec-tools rpm version:<br>    kexec-tools-2.0.0-280.el6.x86_64<br>  Service enablement:<br>    kdump  0:off  1:off  2:on  3:on  4:on  5:on  6:off<br>  kdump initrd/initramfs:<br>    6368956 Apr 25  2016 initrd-2.6.32-504.23.4.el6.x86_64kdump.img<br><br>  Memory reservation config:<br>    /proc/cmdline { crashkernel=153M@0M }<br>    GRUB default  { crashkernel=auto }<br>  Actual memory reservation per /proc/iomem:<br>      03000000-0c8fffff : Crash kernel<br>  kdump.conf:<br>    raw /dev/vg1/DUMP<br>    core_collector makedumpfile -c -d 17<br>  Panic sysctls:<br>    kernel.sysrq [bitmask] =  &quot;1&quot;  (all SysRqs allowed)<br>    kernel.panic [secs] =  0  (no autoreboot on panic)<br>    kernel.hung_task_panic =  0<br>    kernel.panic_on_oops =  1<br>    kernel.panic_on_io_nmi =  1<br>    kernel.panic_on_unrecovered_nmi =  1<br>    kernel.panic_on_stackoverflow =<br>    kernel.softlockup_panic =  0<br>    kernel.unknown_nmi_panic =  1<br>    kernel.nmi_watchdog =  0<br>    vm.panic_on_oom [0-2] =  0  (no panic)<br><br>Sep 30 01:30:40 SLPCSSDL01 rear[43761]: DONE: rc=0<br>Sep 30 02:25:44 SLPCSSDL01 ntpd[11555]: Deleting interface #12 bond0:1, 100.254.40.104#123, interface stats: received=0, sent=0, dropped=0, active_time=7131707 secs<br>--- RESTART ---<br>Sep 30 02:28:20 SLPCSSDL01 kernel: imklog 5.8.10, log source = /proc/kmsg started.<br>Sep 30 02:28:20 SLPCSSDL01 rsyslogd: [origin software=&quot;rsyslogd&quot; swVersion=&quot;5.8.10&quot; x-pid=&quot;9404&quot; x-info=&quot;http://www.rsyslog.com&quot;] start<br><br>시스템 리부팅 이전에 ntpd 에 의한 인터페이스 삭제가 있었으며,<br>아래 문서를 확인하여 -L 설정을 추가해보시기 바랍니다.<br><br>https://access.redhat.com/solutions/261123<br><br>또한, 해당 시스템이 오라클 클러스터 구성일 것으로 추정하고 있으며, 인터페이스 삭제로 인한<br>오라클 펜싱 기능이 동작하였을 가능성도 있습니다.<br>vmcore 덤프 수집이 되었는지도 확인해주시고, 만일 수집이 되지 않았다면, 하드웨어 ASR 기능이<br>활성화되어있는지도 확인해주시기 바랍니다.<br>또한, 하드웨어 로그 확인에 이상 로그는 없었는지도 확인해보시기 바랍니다.<br><br>마지막으로, 본 기술 문의는 혼란을 방지하고자, 서버 리부팅 관련 내용만을 다루도록 하겠으니,<br>이점 양해해주시기 바랍니다.<br><br>NTP 시간이 느려지는 문제는 번거로우시더라도 새로운 기술문의로 생성해주시면<br>돌아오는 영업일에 서비스 담당 엔지니어가 확인 후 처리하도록 하겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-10-04T00:59:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Ke7OpIAJ"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-09-30T09:26:12Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-09-30T09:26:11Z</b><br><br>Greeting,<br><br>Thank you for contacting Red Hat Global Support Services!<br><br>As Sep 30 ~ Oct 9 are Korean Holiday, this issue will be handled by local engineer in the next business day.<br><br>Enjoy your holiday!<br><br>Best Regards,<br>Catherine<br>Red Hat Support Delivery<br><br><publishedDate>2017-09-30T09:26:11Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Ke6L9IAJ"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-09-30T00:12:55Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-09-30T00:12:55Z</b><br><br>안녕하세요. <br><br>추가로 코멘트 드립니다.<br><br>현 시스템은 Oracle ASM DB 시스템이며, <br><br>추가로 시스템을 확인 해 보니, /var/log/messages 에 NTP 관련 에러가 상당히 많이 나오고 있습니다.<br><br>&quot; ntpd[3285]: frequency error -15113 PPM exceeds tolerance 500 PPM &quot;<br><br>그래서 ntpq 를 통해 peers 를 확인 해 보니, 2개의 NTP Server 중 한개 노드는 게속해서 x 로 나오면서 동기화가 안되고 있으며,<br><br>이를 제외시키고, 정상적인 한개로 만 동기화를 해도 offset 과 jitter 가 벌어지고 있습니다.<br><br>ntpdate 로 수동으로 sync 후에 hwclock 고 맞춰준 후 ntpd 를 실행해도 offset  이 기본 300 이상 벌어지면서 실행이 되고 있어, <br><br>다른 ASM 노드와 시간 격차가 많이 벌어지고 있습니다.<br><br>이와 관련하여 이번 Oracle ASM 노드 Reboot 이슈가 NTP 시간 동기화와 관련성이 있을지 문의 드립니다.<br><br>문제 해결을 위해 필요한 분석 데이터가 어떤것이 필요한지 알려주시면 수집해서 업로드 하도록 하겠습니다.<br><br>빠른 답변 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-30T00:12:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Ke4atIAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-09-29T20:16:01Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-09-29T20:16:01Z</b><br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br><br><publishedDate>2017-09-29T20:16:01Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>