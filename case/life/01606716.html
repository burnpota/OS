======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2016-03-25T01:53:42Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2016-04-09T10:07:14Z</b><br><b>id : 500A000000TtlFaIAJ</b><br>======================<br><br><b><font size=15>
제목  : 계정별 open file 갯수 제한 문제
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>계정별 open file 개수 제한을 하기 위해 아래와 같이 작업을 진행하였습니다.<br><br>리눅스 계정 별 최대 File Open 개수 확인 및 제한하기<br>(fs.file-max 파라미터는 시스템 전체에서 최대로 열 수 있는 파일 개수)<br><br>[변경전]<br>[root@rhel6 ~]# su - test<br>[test@rhel6 ~]$ ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 14738<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 1024  &lt;--------------- 1024<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 1024<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br><br>[root@rhel6 ~]# vi /etc/security/limits.conf<br>#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;<br>#<br><br>#*               soft    core            0<br>#*               hard    rss             10000<br>#@student        hard    nproc           20<br>#@faculty        soft    nproc           20<br>#@faculty        hard    nproc           50<br>#ftp             hard    nproc           0<br>#@student        -       maxlogins       4<br>test             soft    nofile          40  &lt;----------------- 변경<br>test             hard    nofile          40 &lt;----------------- 변경<br>:wq<br><br>[root@rhel6 ~]# su - test<br>[test@rhel6 ~]$ ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 14738<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 40   &lt;-------------------- 변경<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 1024<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br>[test@rhel6 ~]$ lsof -u test | wc -l<br>52     &lt;----------------------------- open file 개수가 52개<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>40개로 변경하였습니다.<br>lsof 하였을때 52 개로 나오는 것이 정상인지 확인부탁드립낟.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.4</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br>======================<br><comment id="a0aA000000GlaHaIAJ"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-03-25T06:56:03Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-03-25T06:56:02Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>&gt; nofile의 의미가 사용자별 open file개수 제한 인가요?<br>&gt; 아니면 프로세스당 open file개수 제한 인가요??<br><br>프로세스당 open file 갯수의 제한입니다.<br><br>감사합니다.<br><br><publishedDate>2016-03-25T06:56:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Gla4WIAR"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-03-25T06:16:02Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-03-25T06:16:02Z</b><br><br>답변감사합니다.<br>혹시<br><br>[root@rhel6 ~]# vi /etc/security/limits.conf<br>#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;<br>#<br><br>#*               soft    core            0<br>#*               hard    rss             10000<br>#@student        hard    nproc           20<br>#@faculty        soft    nproc           20<br>#@faculty        hard    nproc           50<br>#ftp             hard    nproc           0<br>#@student        -       maxlogins       4<br>test             soft    nofile          40  &lt;----------------- 변경<br>test             hard    nofile          40 &lt;----------------- 변경<br>:wq<br><br>nofile의 의미가 사용자별 open file개수 제한 인가요?<br>아니면 프로세스당 open file개수 제한 인가요??<br><br><publishedDate>2016-03-25T06:16:02Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GlZqrIAF"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-03-25T05:29:28Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-03-25T05:29:28Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>$ lsof -u test | wc -l<br><br>상기 명령어를 실행시 linked 라이브러리, executable의 등 normal FD 넘버도 포함하고 있기 때문입니다.<br>하기 명령어로 정확한 정보를 확인 가능한지를 확인해 보시기 바랍니다.<br><br># lsof -a -u test -d ^mem -d ^cwd -d ^rtd -d ^txt -d ^DEL | wc -l<br><br><br>감사합니다.<br><br><publishedDate>2016-03-25T05:29:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GlYvPIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-03-25T01:57:40Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-03-25T01:57:40Z</b><br><br>정의찬<br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 정의찬 (사원)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  82-10-2952-3184<br>- 메일주소 : 정의찬 &lt;echan.jeong@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br><br><publishedDate>2016-03-25T01:57:40Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br>리눅스 계정 별 최대 File Open 개수 확인 및 제한하기<br>(fs.file-max 파라미터는 시스템 전체에서 최대로 열 수 있는 파일 개수)<br><br>[변경전]<br>[root@rhel6 ~]# su - test<br>[test@rhel6 ~]$ ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 14738<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 1024  &lt;--------------- 1024<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 1024<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br><br>[root@rhel6 ~]# vi /etc/security/limits.conf<br>#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;<br>#<br><br>#*               soft    core            0<br>#*               hard    rss             10000<br>#@student        hard    nproc           20<br>#@faculty        soft    nproc           20<br>#@faculty        hard    nproc           50<br>#ftp             hard    nproc           0<br>#@student        -       maxlogins       4<br>test             soft    nofile          40  &lt;----------------- 변경<br>test             hard    nofile          40 &lt;----------------- 변경<br>:wq<br><br>[root@rhel6 ~]# su - test<br>[test@rhel6 ~]$ ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 14738<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 40   &lt;-------------------- 변경<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 10240<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 1024<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br>[test@rhel6 ~]$ lsof -u test | wc -l<br>52     &lt;----------------------------- open file 개수가 52개</issue><environment>40개로 변경하였습니다.<br>lsof 하였을때 52 개로 나오는 것이 정상인지 확인부탁드립낟.</environment><cep>false</cep></case>