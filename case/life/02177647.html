======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-09-07T07:40:51Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2018-09-17T04:42:35Z</b><br><b>id : 500A000000bxOwTIAU</b><br>======================<br><br><b><font size=15>
제목  : sap관련 프로세스 CPU가 1분단위로 점유하는 증상
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까 타임게이트 오선우입니다<br><br>고객사 장비중 sap관련 프로세스가 약1분에 한번씩 CPU가 올라가는 증상이 있습니다<br><br>OS상에 특이점을 찾지 못했습니다 전체 CPU사용률은 그리높지 않지만 특정 프로세스가 cpu사용률이 높은 증상이 있습니다  <br><br>관련 프로세스(sap)쪽에서도 해당 증상을 확인중이 있지만<br><br>OS단에 특이사항이 있는지 분석 부탁드립니다<br><br>sosreport와 로그, 해당프로세스 2분간의 strace한 결과( out.txt) 드롭박스에 <br><br>pecccl01sl.tar.gz 이름으로 업로드하였습니다<br><br>감사합니다<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>PECCCL01SL</hostname><br><br><br><comment id="a0aA000000Nm4V3IAJ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-09-17T04:42:33Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-09-17T04:42:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-09-17T04:42:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Nl5KJIAZ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-09-12T05:11:31Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-09-12T05:11:31Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-09-12T05:11:31Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NXsddIAD"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-09-10T03:50:47Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-09-10T03:50:47Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>DMIDECODE<br>  BIOS:<br>    Vend: HP    Vers: P89    Date: 10/25/2017    BIOS Rev: 2.52    FW Rev:   2.55<br>  System:<br>    Prod: ProLiant DL380 Gen9<br>  CPU:<br>    2 of 2 CPU sockets populated, 4 cores/8 threads per CPU<br>    8 total cores, 16 total threads<br>    Vers: Intel(R) Xeon(R) CPU E5-2637 v3 @ 3.50GHz<br>  Memory:<br>    Total: 131072 MiB (128 GiB)<br><br>OS<br>  Hostname: PECCCL01SL<br>  Kernel:<br>    Booted kernel:  3.10.0-327.53.1.el7.x86_64<br>    GRUB default:   3.10.0-327.53.1.el7.x86_64<br>    Booted kernel cmdline:<br>      root=UUID=008ff2a9-b851-4427-af07-7716cacc34a3 ro crashkernel=512M rhgb quiet<br>      LANG=en_US.UTF-8 nmi_watchdog=0 transparent_hugepage=never elevator=deadline<br>      rdloaddriver=hpsa rdloaddriver=qla2xxx nosoftlockup intel_idle.max_cstate=0<br>      processor.max_cstate=1 intel_pstate=disable mce=ignore_ce<br>    Taint-check: 12289  (see https://access.redhat.com/solutions/40594)<br>       0  PROPRIETARY_MODULE: Proprietary module has been loaded<br>      12  OOT_MODULE: Out-of-tree module has been loaded<br>      13  UNSIGNED_MODULE: Unsigned module has been loaded<br>    - - - - - - - - - - - - - - - - - - -<br>  Sys time:  Fri Sep  7 15:45:32 KST 2018<br>  Boot time: Sun May  6 05:12:25 UTC 2018  (epoch: 1525583545)<br>  Uptime:    124 days,  1:33,  7 users<br>  LoadAvg:   [16 CPU] 0.57 (4%), 0.49 (3%), 0.42 (3%)<br>  /proc/stat:<br>    procs_running: 2   procs_blocked: 0    processes [Since boot]: 176752237<br>    cpu [Utilization since boot]:<br>      us 1%, ni 0%, sys 1%, idle 99%, iowait 0%, irq 0%, sftirq 0%, steal 0%<br><br>  vm.<br>    dirty_ratio =  &quot;40&quot;  (% of total system memory)<br>    dirty_bytes =  &quot;0&quot;  (disabled -- check dirty_ratio)<br>    dirty_background_ratio =  &quot;10&quot;  (% of total system memory)<br>    dirty_background_bytes =  &quot;0&quot;  (disabled -- check dirty_background_ratio)<br>    dirty_expire_centisecs =  &quot;3000&quot;<br>    dirty_writeback_centisecs =  &quot;500&quot;<br>    nr_hugepages [2-MiB pages] =  &quot;0&quot;<br>    nr_overcommit_hugepages [2-MiB pages] =  &quot;0&quot;<br>    overcommit_memory [0-2] =  &quot;0&quot;  (heuristic overcommit)<br>    overcommit_ratio =  &quot;50&quot;<br>    oom_kill_allocating_task [bool] =  &quot;0&quot;  (scan tasklist)<br>    panic_on_oom [0-2] =  &quot;0&quot;  (no panic)<br>    swappiness [0-100] =  &quot;10&quot;<br><br>PS CHECK<br>  Total number of threads/processes:<br>    1167 / 478<br>  Top users of CPU &amp; MEM:<br>    USER     %CPU   %MEM  RSS<br>    root     19.7%  0.0%  0.66 GiB<br>    pecadm   18.1%  1.4%  1.99 GiB<br>    egurkha  0.0%   0.2%  0.27 GiB<br>  Uninteruptible sleep threads/processes (0/0):<br>    [None]<br>  Defunct zombie threads/processes (0/0):<br>    [None]<br>  Top CPU-using processes:<br>    USER      PID     %CPU  %MEM  VSZ-MiB  RSS-MiB  TTY    STAT  START  TIME      COMMAND<br>    root      111892  18.8  0.0   293      68       pts/9  S+    15:45  0:09      /usr/bin/python /sbin/sosreport -k<br>    pecadm    21828   8.8   1.4   53315    1855     ?      Ssl   May06  15848:30  en.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br>    pecadm    89113   7.8   0.0   140      60       ?      Ss    Jul07  6966:40   gw.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS -no_abap<br>    pecadm    21827   1.3   0.0   101      37       ?      Ss    May06  2462:26   ms.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br>    root      8641    0.5   0.0   596      12       ?      Sl    Jul19  365:28    ./ontuned -c -x<br>    root      16916   0.4   0.0   187      44       ?      Ssl   May06  757:19    corosync<br>    pecadm    16268   0.2   0.0   42       2        pts/3  S+    Sep06  4:02      top<br>    zabbix    5323    0.0   0.0   21       1        ?      S     May06  2:34      /Tools/zabbix/sbin/zabbix_agentd: active checks<br>    zabbix    5322    0.0   0.0   21       1        ?      S     May06  8:32      /Tools/zabbix/sbin/zabbix_agentd: listener #3<br>    zabbix    5321    0.0   0.0   21       1        ?      S     May06  8:36      /Tools/zabbix/sbin/zabbix_agentd: listener #2<br>  Top MEM-using processes:<br>    USER      PID     %CPU  %MEM  VSZ-MiB  RSS-MiB  TTY    STAT  START  TIME      COMMAND<br>    pecadm    21828   8.8   1.4   53315    1855     ?      Ssl   May06  15848:30  en.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br>    egurkha   95937   0.0   0.2   34600    278      ?      Sl    May06  85:41     /opt/egurkha/jre/bin/java -Xrs -Dsun.net.inetaddr.ttl=900<br>    root      2634    0.0   0.0   252      84       ?      Ss    May06  53:24     /sbin/hpHelper -f<br>    pecadm    21463   0.0   0.0   1141     75       ?      Ssl   May06  26:56     /usr/sap/PEC/ASCS50/exe/sapstartsrv pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS -D<br>    root      111892  18.8  0.0   293      68       pts/9  S+    15:45  0:09      /usr/bin/python /sbin/sosreport -k<br>    root      4115    0.0   0.0   1114     61       ?      Sl    May06  55:56     /opt/opsware/agent/bin/python /opt/opsware/agent/pylibs/shadowbot/daemonbot.pyc --conf<br>    pecadm    89113   7.8   0.0   140      60       ?      Ss    Jul07  6966:40   gw.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS -no_abap<br>    sapadm    5390    0.0   0.0   515      57       ?      Ssl   May06  9:39      /usr/sap/hostctrl/exe/sapstartsrv pf=/usr/sap/hostctrl/exe/host_profile -D<br>    root      5081    0.0   0.0   259      46       ?      S     May06  7:02      vmd<br>    root      16916   0.4   0.0   187      44       ?      Ssl   May06  757:19    corosync<br>  Top thread-spawning processes:<br>    #   USER      PID     %CPU  %MEM  VSZ-MiB  RSS-MiB  TTY    STAT  START  TIME      COMMAND<br>    43  egurkha   95937   0.0   0.2   34600    278      ?      -     May06  85:41     /opt/egurkha/jre/bin/java -Xrs -Dsun.net.inetaddr.ttl=900<br>    24  root      5109    0.0   0.0   1873     23       ?      -     May06  11:20     /usr/openv/netbackup/bin/nbrmms<br>    22  root      5134    0.0   0.0   1770     34       ?      -     May06  37:00     /usr/openv/netbackup/bin/nbsl<br>    15  root      1275    0.0   0.0   931      15       ?      -     May06  68:25     /usr/local/sgaSolAgent/sbin/sgaSol<br>    14  pecadm    21463   0.0   0.0   1141     75       ?      -     May06  26:56     /usr/sap/PEC/ASCS50/exe/sapstartsrv pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS -D<br>    13  root      4115    0.0   0.0   1114     61       ?      -     May06  55:56     /opt/opsware/agent/bin/python /opt/opsware/agent/pylibs/shadowbot/daemonbot.pyc --conf<br>    10  root      701     0.0   0.0   636      8        ?      -     May06  7:32      /sbin/multipathd<br>    10  root      3467    0.0   0.0   349      2        ?      -     May06  5:46      hpasmlited -f /dev/hpilo<br>    10  pecadm    21828   8.8   1.4   53315    1855     ?      -     May06  15848:30  en.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br>    9   root      8641    0.5   0.0   596      12       ?      -     Jul19  365:28    ./ontuned -c -x<br><br>올려주신 데이터를 분석한 결과 안내해드립니다.<br>SAP 애플리케이션의 사용량에 문제가 될만한 부분은 찾지 못했습니다.<br><br>    pecadm    21828   8.8   1.4   53315    1855     ?      Ssl   May06  15848:30  en.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br>    pecadm    89113   7.8   0.0   140      60       ?      Ss    Jul07  6966:40   gw.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS -no_abap<br>    pecadm    21827   1.3   0.0   101      37       ?      Ss    May06  2462:26   ms.sapPEC_ASCS50 pf=/usr/sap/PEC/SYS/profile/PEC_ASCS50_PECCSCS<br><br>또한, SAP 애플리케이션의 동작을 strace 하여도 저희가 분석할 만한 정보는 확인할 수 없었습니다.<br>SAP 측의 분석 결과를 기다려볼 필요가 있습니다.<br><br>커널 옵션을 아래와 같이 설정하여, 하드웨어 오류가 발생되어도 무시되는 설정을 사용하고 계십니다.<br>nosoftlockup  mce=ignore_ce<br>위 옵션을 제거하고 메시지로그에 soft lockup 과 하드웨어 오류 메시지가 출력되는지도 확인이 필요합니다.<br><br>저희 레드햇에서 제공된 모듈이 아니며, 레드햇이 검증하지 않은 모듈을 사용하고 계십니다.<br><br>filename:       /lib/modules/3.10.0-327.53.1.el7.x86_64/weak-updates/tg3/tg3.ko<br>version:        3.137q<br><br>lename:       /lib/modules/3.10.0-327.53.1.el7.x86_64/weak-updates/hpsa/hpsa.ko<br>version:        3.4.20-100<br><br>filename:       /lib/modules/3.10.0-327.53.1.el7.x86_64/weak-updates/qlgc-qla2xxx/qla2xxx.ko<br>version:        8.07.00.50.07.0-k3<br><br>filename:       /lib/modules/3.10.0-327.53.1.el7.x86_64/weak-updates/hp-ixgbe/ixgbe.ko<br>version:        5.0.7<br><br>SAP용 tuned 설정을 사용하고 있지 않으며, 성능향상을 위해 tuned 설정을 사용해보시기 바랍니다.<br><br>Overview of Additional Performance Tuning Utilities in Red Hat Enterprise Linux 7 <br>https://access.redhat.com/articles/785283<br><br>vmcore 를 수집해주시면 추가적으로 분석이 가능한 부분이 있을 수 있습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-09-10T03:50:47Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>