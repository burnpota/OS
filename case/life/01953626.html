======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2017-10-17T01:50:46Z</b><br><b>마지막 답변자 : Min Woo Park</b><br><b>마지막 수정 일자 : 2017-11-02T10:05:17Z</b><br><b>id : 500A000000YTWoqIAH</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] 번들 http server 관련 문의(Access Log)
</font></b><br><br>======================<br><b>사전문의<br></b><br>## 고객정보 ## <br>고객사 : 삼성생명<br>고객명 : 박현우 선임<br>연락처 : 010-9104-2853<br>##<br><br>## 환경정보 ##<br>OS : RHEL 7.2<br>web : bundle http server 2.4.x<br>##<br><br>현재 httpd.conf 로그포멧이 하기와 같이 설정되어 있습니다. <br>##<br>LogFormat &quot;%h %l %u %t %T \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; \&quot;%{Cookie}i\&quot;&quot; combined<br>##<br>각 옵션 중 일부를 확인결과 apache access log는 최초 요청 시가 아닌 뒷단의 연동된 WAS에서 처리된 순간 처리완료된 시점(%t), HTTP 상태코드(%s), 처리시간(%T) 등을 적재하는 것으로 확인됩니다. <br>%t : The time that the request was received.<br>%&gt;s : This is the status code that the server sends back to the client.<br>참고URL : http://httpd.apache.org/docs/current/en/logs.html<br><br>문의1. 처리여부와 상관없이 최초 유입시간을 적재할 수 있는 설정이 있는지요?<br>문의2. 하기와 같이 정상적으로 처리된 (200 HTTP code) 로그의 경우 처리시간(%T)이  1547876 로 수행된 경우 TimeOut=600(sec)을 초과한 것으로 판단되는데 맞는지요?<br>25.110.7.90 - uid=5000017222,ou=people,dc=samsunglife,dc=com [10/Oct/2017:10:06:57 +0900] 1547876 &quot;POST /portal/dataService.do?info=l HTTP/1.1&quot; 200 224 <br>문의3. 처리시간(%T)가 의미하는 시간이 현재 web-was만이 아닌 연계 서버가 있는경우 end-to-end의 최종결과를 중간연계 webserver 의 access 로그에 처리시간으로 적재되는지요?<br><br>확인요청드립니다. <br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br>======================<br><comment id="a0aA000000KhZsxIAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-10-17T05:50:10Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-10-17T05:50:10Z</b><br><br>안녕하세요,<br><br>해당 웹서버의 모든 *.conf 파일과 Timeout 보다 큰 response time이 찍히는 시간대가 포함된 access_log, error_log 첨부 부탁드립니다.<br><br>conf/*.conf<br>conf.d/*.conf<br>conf.module.d/*.conf<br><br>logs/access_log<br>logs/error_log<br><br><br>감사합니다.<br><br><publishedDate>2017-10-17T05:50:10Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KhZnNIAV"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-10-17T05:39:32Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-10-17T05:39:32Z</b><br><br>안녕하세요!<br>빠른 확인에 감사드립니다. <br>확인요청하신 내역에 대하여 하기와 같이 공유드립니다 <br><br>문의2. 하기와 같이 정상적으로 처리된 (200 HTTP code) 로그의 경우 처리시간(%T)이  1547876 로 수행된 경우 TimeOut=600(sec)을 초과한 것으로 판단되는데 맞는지요?<br>==&gt;<br>다른 conf 파일의 LogFomat 설정이 overriding 되어 적용되는 것이 아닐까 의심되는데요. 다른 케이스에 올려주신 일부 access log를 확인해보면 %D를 설정한 것처럼 microsecond 단위로 출력이 되는 것으로 생각됩니다.<br>참고로, Timeout 600초가 초과하면 60x초(간혹 603, 601과 같이 Timeout을 약간 초과하여 로깅되는 경우가 있음)의 응답시간과 함께 http 503이 리턴되어집니다.<br>--&gt; 혼선을 드려 죄송합니다. 기존 첨부드린 설정파일은 개발/검증계쪽 설정파일 내용을 첨부드린 것이며 현재 운영계 로그포멧은 하기와 같이 %D(msec)으로 설정되어 있어 access log 상 1547876 msec으로 적재되는 것입니다. <br>LogFormat &quot;%h %l %u %t %D \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; \&quot;%{Cookie}i\&quot;&quot; combined<br>다만, 저희가 궁금한 것은 httpd.conf 상 TimeOut이 600초로 설정되어 있는데 해당 값보다 큰 처리시간으로 적재되어 있는데 503과 같은 에러 HTTP code가 아닌 200 HTTP code에 대하여 문의드린 것입니다<br><br>문의3. 처리시간(%T)가 의미하는 시간이 현재 web-was만이 아닌 연계 서버가 있는경우 end-to-end의 최종결과를 중간연계 webserver 의 access 로그에 처리시간으로 적재되는지요?<br>==&gt;<br>apache와 연계 서버가 어떻게 연결되어 있는 건가요?<br>was에서 구동되는 application에서 다른 서버로의 호출이 발생하는 형태가 아닌가요?<br><br>--&gt;<br>모든 케이스가 하기와 같지는 않지만 말씀하신 것과 같이 연계하는 형태의 로직이 존재합니다. 하기의 케이스일 경우 다른 conf 파일의 LogFomat 설정이 overriding 되어 적용되는 건지요? 기 적재드린 로그는 web1에서 부분발췌한 것입니다. <br>web browser(client) -&gt; web1(대표 포탈) -&gt; was1 -&gt; 특정 메뉴호출(예, 장애관리 - 소스상 http://xx.samsung.com:8444 의 별도의 web 호출) -&gt; web2 -&gt; was2<br><br>감사합니다.<br><br><publishedDate>2017-10-17T05:39:32Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KhZdcIAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-10-17T05:19:46Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-10-17T05:19:46Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.  <br><br>문의1. 처리여부와 상관없이 최초 유입시간을 적재할 수 있는 설정이 있는지요?<br>==&gt;<br>access log 에는 request가 처리 완료되는 시점에 로깅이 됩니다.<br>최소 request 유입 시간을 확인하기 위해서는 access log에 찍힌 시간에서 response time 을 빼서 manual하게 계산할 수 밖에 없습니다.<br>apache log level을 debug로 상세히 올리면 error_log에 apache에서 request를 받아서 처리하는 내용들이 상세히 로깅되기 때문에 request가 처음 적재되는 시간을 확인할 수 있지만, 로깅양으로 인한 성능저하때문에 사용을 권고하지는 않습니다.<br>다시 말씀드리면, 최초 유입시간을 적재할 수 있는 설정은 따로 없습니다.<br><br><br>문의2. 하기와 같이 정상적으로 처리된 (200 HTTP code) 로그의 경우 처리시간(%T)이  1547876 로 수행된 경우 TimeOut=600(sec)을 초과한 것으로 판단되는데 맞는지요?<br>25.110.7.90 - uid=5000017222,ou=people,dc=samsunglife,dc=com [10/Oct/2017:10:06:57 +0900] 1547876 &quot;POST /portal/dataService.do?info=l HTTP/1.1&quot; 200 224 <br>==&gt;<br>다른 conf 파일의 LogFomat 설정이 overriding 되어 적용되는 것이 아닐까 의심되는데요. 다른 케이스에 올려주신 일부 access log를 확인해보면 %D를 설정한 것처럼 microsecond 단위로 출력이 되는 것으로 생각됩니다.<br>기존 LogFormat을 아래와 같이 변경하고 어떻게 나오는지 확인부탁드립니다.<br>참고로, Timeout 600초가 초과하면 60x초(간혹 603, 601과 같이 Timeout을 약간 초과하여 로깅되는 경우가 있음)의 응답시간과 함께 http 503이 리턴되어집니다.<br><br>(수정 전)<br>LogFormat &quot;%h %l %u %t %T \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; \&quot;%{Cookie}i\&quot;&quot; combined<br>(수정 후)<br>LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b %T %D \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; \&quot;%{Cookie}i\&quot;&quot; combined<br><br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>## 200 정상 ##<br>203.241.147.14 - uid=0007851739,ou=people,dc=samsunglife,dc=com [12/Oct/2017:09:05:19 +0900] 70571 <br>&quot;POST /portal/dataService.do?info=l HTTP/1.1&quot; 200 222 &quot;https://erp-ep.samsunglife.com/irj/servlet/prt/portal/prtroot/request.Dispatcher&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)&quot; &quot;WMONID=jJRDrW-F5jk; saplb_*=(J2EE102919720)102919751; JSESSIONID=cm5yU9av4UbJdoGRoQGowp4zy-QNXwFHbiIG_SAPFUo9gnnHRFv6nUI836FeF8LH; JSESSIONMARKID=m7vKvw-ogkFSZkURa4c1DgzNVOQETHgrPHqkduIgY; ROUTEID=.ep29; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MDAwNzg1MTczOYgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAowMDA3ODUxNzM5AgADMDAwAwADUEVQBAAMMjAxNzEwMTIwMDAzBQAEAAAAEAoACjAwMDc4NTE3Mzn%2FAW4wggFqBgkqhkiG9w0BBwKgggFbMIIBVwIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNjCCATICAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUEVQAggKIBYIFgIIFDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMDEyMDAwMzM4WjAjBgkqhkiG9w0BCQQxFgQULb237F14PderfhJQbDOElpVWqiwwCQYHKoZIzjgEAwQ!MDwCHH2kMZk7fazG8yuStzVBywjf!noH!bcOBayfeK0CHBmC9WggEf6aTX9ijaa0X4ZqKIm30qTXYpPB0Ro%3D&quot;<br>-----&gt; 70571<br><br>## 400 HTTP 에러 ##<br>203.241.147.14 - unknown [12/Oct/2017:09:05:20 +0900] 71109 <br>&quot;POST /portal/dataService.do HTTP/1.1&quot; 400 774 &quot;https://erp-ep.samsunglife.com/irj/servlet/prt/portal/prtroot/request.Dispatcher&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)&quot; &quot;WMONID=jJRDrW-F5jk; saplb_*=(J2EE102919720)102919751; JSESSIONID=cm5yU9av4UbJdoGRoQGowp4zy-QNXwFHbiIG_SAPFUo9gnnHRFv6nUI836FeF8LH; JSESSIONMARKID=m7vKvw-ogkFSZkURa4c1DgzNVOQETHgrPHqkduIgY; ROUTEID=.ep29; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MDAwNzg1MTczOYgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAowMDA3ODUxNzM5AgADMDAwAwADUEVQBAAMMjAxNzEwMTIwMDAzBQAEAAAAEAoACjAwMDc4NTE3Mzn%2FAW4wggFqBgkqhkiG9w0BBwKgggFbMIIBVwIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNjCCATICAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUEVQAggKIBYIFgIIFDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMDEyMDAwMzM4WjAjBgkqhkiG9w0BCQQxFgQULb237F14PderfhJQbDOElpVWqiwwCQYHKoZIzjgEAwQ!MDwCHH2kMZk7fazG8yuStzVBywjf!noH!bcOBayfeK0CHBmC9WggEf6aTX9ijaa0X4ZqKIm30qTXYpPB0Ro%3D&quot;<br>-----&gt; 71109<br><br>## 200 정상처리  ##<br>203.241.147.14 - uid=0007851739,ou=people,dc=samsunglife,dc=com [12/Oct/2017:09:05:22 +0900] 58522 <br>&quot;POST /portal/dataService.do HTTP/1.1&quot; 200 4190 &quot;https://erp-ep.samsunglife.com/irj/servlet/prt/portal/prtroot/request.Dispatcher&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)&quot; &quot;WMONID=jJRDrW-F5jk; saplb_*=(J2EE102919720)102919751; JSESSIONID=cm5yU9av4UbJdoGRoQGowp4zy-QNXwFHbiIG_SAPFUo9gnnHRFv6nUI836FeF8LH; JSESSIONMARKID=m7vKvw-ogkFSZkURa4c1DgzNVOQETHgrPHqkduIgY; ROUTEID=.ep29; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MDAwNzg1MTczOYgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAowMDA3ODUxNzM5AgADMDAwAwADUEVQBAAMMjAxNzEwMTIwMDAzBQAEAAAAEAoACjAwMDc4NTE3Mzn%2FAW4wggFqBgkqhkiG9w0BBwKgggFbMIIBVwIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNjCCATICAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUEVQAggKIBYIFgIIFDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMDEyMDAwMzM4WjAjBgkqhkiG9w0BCQQxFgQULb237F14PderfhJQbDOElpVWqiwwCQYHKoZIzjgEAwQ!MDwCHH2kMZk7fazG8yuStzVBywjf!noH!bcOBayfeK0CHBmC9WggEf6aTX9ijaa0X4ZqKIm30qTXYpPB0Ro%3D&quot;<br>-----&gt; 58522<br><br>## 400 HTTP 에러##<br>203.241.147.14 - unknown [12/Oct/2017:09:05:24 +0900] 116375 <br>&quot;POST /portal/dataService.do HTTP/1.1&quot; 400 774 &quot;https://erp-ep.samsunglife.com/irj/servlet/prt/portal/prtroot/request.Dispatcher&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)&quot; &quot;WMONID=jJRDrW-F5jk; saplb_*=(J2EE102919720)102919751; JSESSIONID=cm5yU9av4UbJdoGRoQGowp4zy-QNXwFHbiIG_SAPFUo9gnnHRFv6nUI836FeF8LH; JSESSIONMARKID=m7vKvw-ogkFSZkURa4c1DgzNVOQETHgrPHqkduIgY; ROUTEID=.ep29; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MDAwNzg1MTczOYgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAowMDA3ODUxNzM5AgADMDAwAwADUEVQBAAMMjAxNzEwMTIwMDAzBQAEAAAAEAoACjAwMDc4NTE3Mzn%2FAW4wggFqBgkqhkiG9w0BBwKgggFbMIIBVwIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNjCCATICAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUEVQAggKIBYIFgIIFDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMDEyMDAwMzM4WjAjBgkqhkiG9w0BCQQxFgQULb237F14PderfhJQbDOElpVWqiwwCQYHKoZIzjgEAwQ!MDwCHH2kMZk7fazG8yuStzVBywjf!noH!bcOBayfeK0CHBmC9WggEf6aTX9ijaa0X4ZqKIm30qTXYpPB0Ro%3D&quot;<br>-----&gt; 116375<br><br>## 200 정상 ##<br>203.241.147.14 - uid=0007851739,ou=people,dc=samsunglife,dc=com [12/Oct/2017:09:05:27 +0900] 54609 <br>&quot;POST /portal/dataService.do HTTP/1.1&quot; 200 4191 &quot;https://erp-ep.samsunglife.com/irj/servlet/prt/portal/prtroot/request.Dispatcher&quot; &quot;Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3)&quot; &quot;WMONID=jJRDrW-F5jk; saplb_*=(J2EE102919720)102919751; JSESSIONID=cm5yU9av4UbJdoGRoQGowp4zy-QNXwFHbiIG_SAPFUo9gnnHRFv6nUI836FeF8LH; JSESSIONMARKID=m7vKvw-ogkFSZkURa4c1DgzNVOQETHgrPHqkduIgY; ROUTEID=.ep29; OAMAuthnHintCookie=1; MYSAPSSO2=AjExMDAgABFwb3J0YWw6MDAwNzg1MTczOYgAE2Jhc2ljYXV0aGVudGljYXRpb24BAAowMDA3ODUxNzM5AgADMDAwAwADUEVQBAAMMjAxNzEwMTIwMDAzBQAEAAAAEAoACjAwMDc4NTE3Mzn%2FAW4wggFqBgkqhkiG9w0BBwKgggFbMIIBVwIBATELMAkGBSsOAwIaBQAwCwYJKoZIhvcNAQcBMYIBNjCCATICAQEweDBsMQswCQYDVQQGEwJLUjEOMAwGA1UECRMFU2VvdWwxDDAKBgNVBAoTA0VSUDEQMA4GA1UEBxMHSnVuZy1ndTEfMB0GA1UECxMWU2Ftc3VuZyBMaWZlIEluc3VyYW5jZTEMMAoGA1UEAxMDUEVQAggKIBYIFgIIFDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTcxMDEyMDAwMzM4WjAjBgkqhkiG9w0BCQQxFgQULb237F14PderfhJQbDOElpVWqiwwCQYHKoZIzjgEAwQ!MDwCHH2kMZk7fazG8yuStzVBywjf!noH!bcOBayfeK0CHBmC9WggEf6aTX9ijaa0X4ZqKIm30qTXYpPB0Ro%3D&quot;<br>-----&gt; 54609<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br><br>문의3. 처리시간(%T)가 의미하는 시간이 현재 web-was만이 아닌 연계 서버가 있는경우 end-to-end의 최종결과를 중간연계 webserver 의 access 로그에 처리시간으로 적재되는지요?<br>==&gt;<br>%T 아파치에 request가 들어와서 처리가 완료되는 시점까지의 시간이 로깅됩니다. <br>즉 apache로 request가 들어와서 was로 request가 전달되어 처리 완료 후 응답을 받으면 client에 전달하면서 그때까지의 시간이 로깅이 되는 것입니다.<br>apache와 연계 서버가 어떻게 연결되어 있는 건가요?<br>was에서 구동되는 application에서 다른 서버로의 호출이 발생하는 형태가 아닌가요?<br>사용하시는 정확한 구조를 알려주시기 바랍니다.<br><br>감사합니다.<br>Minwoo Park<br><br><publishedDate>2017-10-17T05:19:46Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>