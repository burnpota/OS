======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-05-28T04:43:04Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2018-06-20T01:45:20Z</b><br><b>id : 500A000000atGkeIAE</b><br>======================<br><br><b><font size=15>
제목  : server reboot unexpectly (시스템 비정상 리부팅 KDUMP발생)
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요.<br>시스템이 갑작스럽게 리부팅을 하게되었습니다.<br>리부팅 후 vmcore파일이 발생된 것을 확인 하였는데요. <br>분석 부탁드립니다.<br><br>추가적으로 해당 파일을 저희가 다운 받을수 있게 링크도 부탁드립니다.<br>감사합니다.<br><br>해당 파일은 dropbox incoming에 sosreport_SLPFDSAL02-201805271138 &amp;vmcore-20180527_SLPFDSAL02 로 업로드 하였습니다.<br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김태현 (책임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  82-10-3734-0720<br>- 메일주소 : 김태현 &lt;th0720.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.6</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPFDSAL02</hostname><br><br><br><comment id="a0aA000000MtRv9IAF"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-06-20T01:45:19Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-06-20T01:45:19Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>먼저, 본 기술 문의를 직접 종료해주셔서 감사합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-06-20T01:45:19Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MsX0vIAF"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-06-15T05:39:52Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-06-15T05:39:52Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>---------------------------------------------<br>저희 분석 서버의 현재 시각입니다.<br><br>$ date<br>2018. 06. 15. (금) 01:34:01 EDT<br><br>https://www.timeanddate.com/time/zones/edt<br>---------------------------------------------<br><br>---------------------------------------------<br>대한 민국의 현재 시각은 14:34:01 KST 입니다. <br>https://www.timeanddate.com/time/zones/kst<br>---------------------------------------------<br><br>14:34:01 - 01:34:01 = 13 시간 차이<br><br><br>의문을 제기한 시각<br>        DATE: Sat May 26 20:37:28 2018<br><br>20:37 May 26 + 13 = 4 + 익일 9 = 09:37 May 27<br><br>이해가 되셨으리라 믿습니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-06-15T05:39:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MsWy6IAF"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-06-15T05:33:35Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-06-15T05:33:35Z</b><br><br>답변감사합니다.<br>그럼 분석서버의 경우 어떤 타임존을 사용하는지 알수 있을까요??<br><br><publishedDate>2018-06-15T05:33:35Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000MsVdJIAV"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-06-15T02:45:11Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-06-15T02:45:11Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>vmcore 를 로드한 저희 분석시스템의 타임존이 Asia/Seoul 이 아니어 vmcore 수집시간이 다르게 표기된 것입니다.<br>아래는 타임존을 설정한 이후에 vmcore 를 로드한 결과입니다.<br><br>      KERNEL: /cores/retrace/repos/kernel/x86_64/usr/lib/debug/lib/modules/2.6.32-358.23.2.el6.x86_64/vmlinux<br>    DUMPFILE: /cores/retrace/tasks/620221846/crash/vmcore  [PARTIAL DUMP]<br>        CPUS: 4<br>        DATE: Sun May 27 09:37:28 2018<br>              ______________/<br>             /<br>            /<br>May 27 09:37:21 SLPFDSAL02 kernel: Out of memory: Kill process 7099 (java) score 29 or sacrifice child<br><br>      UPTIME: 378 days, 00:11:18<br>LOAD AVERAGE: 1.23, 4.66, 9.42<br>       TASKS: 173<br>    NODENAME: SLPFDSAL02<br>     RELEASE: 2.6.32-358.23.2.el6.x86_64<br>     VERSION: #1 SMP Sat Sep 14 05:32:37 EDT 2013<br>     MACHINE: x86_64  (2299 Mhz)<br>      MEMORY: 64 GB<br>       PANIC: &quot;Kernel panic - not syncing: Out of memory and no killable processes...&quot;<br>         PID: 1<br>     COMMAND: &quot;init&quot;<br>        TASK: ffff881029a4f500  [THREAD_INFO: ffff881029a50000]<br>         CPU: 1<br>       STATE: TASK_RUNNING (PANIC)<br><br>답변이 되셨으면 좋겠습니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-06-15T02:45:11Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MsVaFIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-06-15T02:38:03Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-06-15T02:38:03Z</b><br><br>안녕하세요. <br>해당 덤프 분석에서 몇가지 의문점이 있어서 케이스를 다시 오픈 합니다.<br>아래 덤프 분석에 있는 날짜에서는 <br>      KERNEL: /cores/retrace/repos/kernel/x86_64/usr/lib/debug/lib/modules/2.6.32-358.23.2.el6.x86_64/vmlinux<br>    DUMPFILE: /cores/retrace/tasks/620221846/crash/vmcore  [PARTIAL DUMP]<br>        CPUS: 4<br>        DATE: Sat May 26 20:37:28 2018  &lt;----------이부분<br>      UPTIME: 378 days, 00:11:18<br>LOAD AVERAGE: 1.23, 4.66, 9.42<br><br>하지만 실질적은 messages에서는 <br><br>May 27 09:37:21 SLPFDSAL02 kernel: Out of memory: Kill process 7099 (java) score 29 or sacrifice child<br>May 27 09:37:22 SLPFDSAL02 kernel: Out of memory: Kill process 7109 (java) score 16 or sacrifice child<br>May 27 09:37:23 SLPFDSAL02 kernel: Out of memory: Kill process 23269 (java) score 7 or sacrifice child<br>May 27 09:37:24 SLPFDSAL02 kernel: Out of memory: Kill process 2009 (vmtoolsd) score 1 or sacrifice child<br>May 27 09:37:24 SLPFDSAL02 kernel: Out of memory: Kill process 2081 (VGAuthService) score 1 or sacrifice child<br><br>으로 확인 되는데요<br><br>서로 시간이 다른 이유를 알수있을까요??<br><br><publishedDate>2018-06-15T02:38:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000MgusYIAR"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-06-01T01:08:15Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-06-01T01:08:15Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>피드백 감사합니다. 요청하신 대로 본 케이스는 종료처리하도록 하겠습니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-06-01T01:08:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Mgm27IAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-05-31T14:34:47Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-05-31T14:34:47Z</b><br><br>답변감사합니다.<br>해당 문제에 대해서 미팅을 진행하였습니다.<br>말씀하신데로 vmware쪽에 문의를 해보았고 vmware측에서 이슈사항으로 보고 있는중입니다<br>리눅스 상에서는 메모리부족으로 정상적인 절차가 발생한것으로 보고 더이상 케이스 진행이 하지 않아도될것 같습니다.<br>혹시 추가 질의가 있으면 추가 진행을 하겠습니다.<br>감사합니다.<br><br><publishedDate>2018-05-31T14:34:47Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000MgNImIAN"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-05-30T07:47:46Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-05-30T07:47:45Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>swap 영역 증가외에 아래의 파라메터를 두배로 조정하실수도 있습니다.<br><br>vm.min_free_kbytes = 32539 <br><br>해당 조치로 페이지 회수를 더 빨리 진행하실수 있습니다.<br>허나 커널파라미터 튜닝으로 메모리 회수를 더 일찍 진행하게 하여 메모리 소진을 늦출수 있거나 완화할수 <br>있을 것으로 보입니다만 이번 이슈와 같이 대량의 메모리 점유가 발생한다면 메모리 소진을 막을수는 없을 것으로 보입니다.  <br><br>감사합니다.<br><br><publishedDate>2018-05-30T07:47:45Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MgLCwIAN"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-05-30T04:40:56Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-05-30T04:40:55Z</b><br><br>답변감사합니다.<br>아래와 같은 다운발생은 말씀하신데로<br>발루닝기능으로 인해서 발생한 것으로 확인 되었습니다. <br><br> 1) 안정화 작업을 위해 vmotion 수행<br> 2) vmotion을 위한 메모리 확보를 위해 Balooning 수행됨<br> 3) 받아주는 호스트 쪽의 리눅스 가상머신에서 Balooning 시 메모리 부족으로 서버 다운(리소스부족)<br><br>생명쪽의 해당 부분에  대해서 시스템이 다운되지 않게 하는 방법을 문의하였습니다.<br><br>현재 물리64기가 메모리에 16기가 swap을 사용중인데요<br>권고메모리를 확인하니 32기가 이상의 swap메모리로 늘려볼까 하는데요<br><br>다른 권고사항 있으시면 회신 부탁드립니다.<br><br><publishedDate>2018-05-30T04:40:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Mg0ihIAB"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-05-29T02:32:01Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-05-29T02:32:01Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>OOM 발생시 아래와 같이 프로세스들을 kill 하였지만 여전히 메모리 확보가 안되었고,<br>더이상 kill 할 프로세스가 없어서 커널 패닉이 발생하였습니다.<br><br>~~~~<br>$ grep &quot;Out of memory&quot; var/log/messages<br>May 27 09:37:21 SLPFDSAL02 kernel: Out of memory: Kill process 7099 (java) score 29 or sacrifice child<br>May 27 09:37:22 SLPFDSAL02 kernel: Out of memory: Kill process 7109 (java) score 16 or sacrifice child<br>May 27 09:37:23 SLPFDSAL02 kernel: Out of memory: Kill process 23269 (java) score 7 or sacrifice child<br>May 27 09:37:24 SLPFDSAL02 kernel: Out of memory: Kill process 2009 (vmtoolsd) score 1 or sacrifice child<br>May 27 09:37:24 SLPFDSAL02 kernel: Out of memory: Kill process 2081 (VGAuthService) score 1 or sacrifice child<br><br>May 27 09:41:07   재부팅.<br>~~~~<br><br>vmcore 에서는 아래와 같이 더 이상 kill이 가능한 프로세스가 없어서 패닉이 되었다고 나와있습니다.<br><br>~~~~<br> PANIC: &quot;Kernel panic - not syncing: Out of memory and no killable processes...&quot;<br>~~~~<br><br><br>감사합니다.<br><br><publishedDate>2018-05-29T02:32:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Mg0ZuIAJ"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-05-29T02:05:27Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-05-29T02:05:27Z</b><br><br>답변감사합니다.<br>현재 셋팅이 아래와 같이 oom이 발생하면 해당 메모리가 많이 사용중인 프로세스만 KILL하는 방식으로 알고있는데요.<br>왜 시스템이 다운되었는지 알수 있을까요?<br><br><publishedDate>2018-05-29T02:05:27Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000MfsZCIAZ"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-05-28T09:39:17Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-05-29T01:00:39Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>vmcore 분석결과를 안내해드립니다.<br><br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>      KERNEL: /cores/retrace/repos/kernel/x86_64/usr/lib/debug/lib/modules/2.6.32-358.23.2.el6.x86_64/vmlinux<br>    DUMPFILE: /cores/retrace/tasks/620221846/crash/vmcore  [PARTIAL DUMP]<br>        CPUS: 4<br>        DATE: Sat May 26 20:37:28 2018<br>      UPTIME: 378 days, 00:11:18<br>LOAD AVERAGE: 1.23, 4.66, 9.42<br>       TASKS: 173<br>    NODENAME: SLPFDSAL02<br>     RELEASE: 2.6.32-358.23.2.el6.x86_64<br>     VERSION: #1 SMP Sat Sep 14 05:32:37 EDT 2013<br>     MACHINE: x86_64  (2299 Mhz)<br>      MEMORY: 64 GB<br>       PANIC: &quot;Kernel panic - not syncing: Out of memory and no killable processes...&quot;<br>         PID: 1<br>     COMMAND: &quot;init&quot;<br>        TASK: ffff881029a4f500  [THREAD_INFO: ffff881029a50000]<br>         CPU: 1<br>       STATE: TASK_RUNNING (PANIC)<br><br><br>crash&gt; kmem -i<br>                 PAGES        TOTAL      PERCENTAGE<br>    TOTAL MEM  16493695      62.9 GB         ----<br>         FREE   407463       1.6 GB    2% of TOTAL MEM<br>         USED  16086232      61.4 GB   97% of TOTAL MEM<br>       SHARED       90       360 KB    0% of TOTAL MEM<br>      BUFFERS       84       336 KB    0% of TOTAL MEM<br>       CACHED        9        36 KB    0% of TOTAL MEM<br>         SLAB    22337      87.3 MB    0% of TOTAL MEM<br><br>   TOTAL HUGE        0            0         ----<br>    HUGE FREE        0            0    0% of TOTAL HUGE<br><br>   TOTAL SWAP  4196979        16 GB         ----<br>    SWAP USED      589       2.3 MB    0% of TOTAL SWAP<br>    SWAP FREE  4196390        16 GB   99% of TOTAL SWAP<br><br> COMMIT LIMIT  12443826      47.5 GB         ----<br>    COMMITTED     1107       4.3 MB    0% of TOTAL LIMIT<br><br><br>crash&gt; struct vmballoon.size,target ffffffffa002b600<br>  size = 10720901<br>  target = 10720901<br><br>10720901 * 4k = 40 G<br><br>crash&gt; mod -t<br>NAME       TAINTS<br>pvscsi     (U)<br>vmxnet3    (U)<br>vmmemctl   (U)<br>vmci       (U)<br>vsock      (U)<br>RedCastle  P(U)<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>상기와 같이 이번 이슈는 메모리 부족으로 OOM이 발생하여 재부팅 된 것으로 확인이 됩니다.<br>당시에 vmware의 발루닝(balloon) 기술에 연관된 모듈이 40G 가량 잡게 되면서 메모리 부족현상이 생긴 것으로 보입니다.<br>해당 모듈이 대량의 메모리를 잡게 된 원인은 vmware쪽으로 문의 하시기 바라며 해당 기능을 disable 할수 있는지 벤더사로 <br>확인이 필요할 것 같습니다.<br><br>[참고문서]<br>Unaccounted memory usage when running Red Hat Enterprise Linux as a VMware guest<br>https://access.redhat.com/solutions/43729<br><br>감사합니다.<br><br><publishedDate>2018-05-28T09:39:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MfrUWIAZ"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-05-28T08:28:49Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-05-28T08:28:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>현재 문의 주신 내용에 대해 확인중에 있습니다.<br>vmcore 상세한 분석결과는 명일 전달드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-05-28T08:28:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>