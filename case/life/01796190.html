======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-02-21T07:49:55Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2017-03-01T01:28:12Z</b><br><b>id : 500A000000WUGB0IAP</b><br>======================<br><br><b><font size=15>
제목  : [장애문의]swap 사용률 증가
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요.<br>해당서버에서 19일~20일 sawp사용률이 갑자기 증가하여 오라클서비스가 hangup 이 되어 재가동후 정상 처리를 하였습니다. <br>swap사용률이 증가한 원인에 대해서 분석을 요청드립니다.<br>sosreport 수집이 원활하지 않아서 우선 messages파일을 먼저 보내드립니다.<br><br><br>해당 서버에는 많은 볼륨이 연결되어있고 중요도가 높은 서버입니다.<br>sosreport를 수집히 상당히  오래 걸리는데 <br>권장해주실 sosreport 방식이 있으면 알려주시기 바랍니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 5.8</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br>======================<br><comment id="a0aA000000Iw2ufIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-03-01T01:28:11Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-03-01T01:28:11Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-03-01T01:28:11Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IvFESIA3"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-02-24T06:59:39Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-02-24T06:59:39Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-02-24T06:59:39Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Iud1dIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-02-22T06:18:04Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-02-22T06:18:03Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>시스템 로그상에서는 DB 가 비정상종료된 원인은 확인이 되지 않습니다.<br>DB 애플리케이션 로그 혹은 클러스터 로그에서 확인이 가능하실 것으로 보입니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-02-22T06:18:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IucxpIAB"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-02-22T06:08:08Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-02-22T06:08:08Z</b><br><br>안녕하세요.<br>답변감사합니다.<br><br>아래의 로그상에서 <br>DB가 죽은 원인에 대해서는 확인이 되지 않나요??<br><br><publishedDate>2017-02-22T06:08:08Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IuaOyIAJ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-02-21T23:52:18Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-02-21T23:52:17Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>Linux 2.6.18-308.el5 (pms-db1)  2017-02-20<br><br>00:00:02          CPU     %user     %nice   %system   %iowait    %steal     %idle<br>00:03:03          all      0.67      0.00      0.75     17.69      0.00     80.89<br>00:06:01          all      0.73      0.00      1.04     14.75      0.00     83.47<br>00:09:01          all      1.00      0.00      0.60     18.15      0.00     80.25<br>00:12:01          all      1.08      0.00      0.69     25.61      0.00     72.63<br>...<br>08:48:02          all      0.50      0.00      1.18     29.93      0.00     68.39<br>08:51:06          all      0.70      0.00      1.14     31.53      0.00     66.63<br>08:54:01          all      0.56      0.00      0.95     15.65      0.00     82.83<br>08:57:01          all      1.39      0.00      1.08     15.86      0.00     81.68<br>09:00:01          all      0.66      0.00      0.46      0.85      0.00     98.03<br>09:03:01          all      2.83      0.00      0.81      2.95      0.00     93.41<br><br>00:00:02    kbmemfree kbmemused  %memused kbbuffers  kbcached kbswpfree kbswpused  %swpused  kbswpcad<br>00:03:03     10074908  14469148     58.95     18888  11883664  16471112   6975716     29.75    889052<br>00:06:01     11414516  13129540     53.49     18936  10715288  15244232   8202596     34.98    684904<br>...<br>08:48:02     11605372  12938684     52.72     26228  10493704  14767144   8679684     37.02   1018952<br>08:51:06     11585364  12958692     52.80     26264  10503384  14737200   8709628     37.15   1022108<br>08:54:01     15468584   9075472     36.98     27040   7775276  22515972    930856      3.97    289016<br>08:57:01      9614000  14930056     60.83     28292  13447760  22517468    929360      3.96    293312<br>09:00:01      9110524  15433532     62.88     29264  13844500  22518808    928020      3.96    297192<br>09:03:01      7538616  17005440     69.29     30384  15457044  22523632    923196      3.94    297496<br><br>00:00:02      runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15<br>00:03:03            0      1010      3.54      4.39      3.27<br>00:06:01            0       998      1.56      3.11      2.97<br>00:09:01            1       999      2.04      2.51      2.75<br>...<br>08:48:02            1      1256     13.21     12.74     14.27<br>08:51:06            0      1284     11.79     12.47     13.91<br>08:54:01            0      1002      3.00      9.04     12.41<br>08:57:01            1      1050      1.71      5.79     10.53<br>09:00:01            2      1094      0.34      3.25      8.70<br>09:03:01            0      1080      0.48      2.01      7.26<br><br>00:00:02     pgpgin/s pgpgout/s   fault/s  majflt/s<br>00:03:03     17748.94    688.71   7262.18   1238.05<br>00:06:01      7273.98   7659.26   2631.54    212.97<br>00:09:01      5308.67   1515.93   3053.47    375.39<br>...<br>20:09:01       978.63     86.38   4891.48    198.09<br>20:12:01       212.44    544.09   2761.46     29.38<br>Average:      7023.24   4151.81   5424.22    713.21<br><br><br>Feb 20 08:47:55 pms-db1 pbrun7.0.1-02: [24485] 3201.07 Exec of bassh failed: Command not found.<br>Feb 20 08:48:26 pms-db1 pbrun7.0.1-02: [24611] 8807 PAM authentication failed - Authentication failure<br>Feb 20 08:48:26 pms-db1 rc_pam_acl[24616]: session opened for user 'c6033162'(from 100.254.180.21) with service 'sshd' [#1]<br>Feb 20 08:50:02 pms-db1 pbrun7.0.1-02: [21744] 5003.02 read - Input/output error<br>Feb 20 08:50:04 pms-db1 pbrun7.0.1-02: [21744] Command caught signal 1 (Hangup)<br>Feb 20 08:50:33 pms-db1 rc_pam_acl[25733]: session opened for user 'c6033162'(from 100.254.180.24) with service 'sshd' [#1]<br>Feb 20 08:51:27 pms-db1 AgentFramework[11990]: VCS ERROR V-16-2-13067 Thread(4153404304) Agent is calling clean for resource(Oracle_CASDB) because the resource became OFFLINE unexpectedly, on its own.<br>Feb 20 08:51:27 pms-db1 Had[11771]: VCS ERROR V-16-2-13067 (pms-db1) Agent is calling clean for resource(Oracle_CASDB) because the resource became OFFLINE unexpectedly, on its own.<br>Feb 20 08:52:21 pms-db1 AgentFramework[11990]: VCS ERROR V-16-2-13068 Thread(4153404304) Resource(Oracle_CASDB) - clean completed successfully.<br><br>스왑 영역의 사용은 majflt 수치가 높아서 발생하고 있는것으로 보여집니다.<br>메모리 활동에 관한 major fault 는 시스템이 이전에 디스크에서 사용되었던 메모리 페이지를 복구해야만하는 상황입니다.<br>이것이 지속적으로 발생할 때 스와핑이 발생하며, 시스템이 지속적으로 하드디스크를 사용하게 하며, 일반적인 성능저하 및 느려짐이 발생할 수 있습니다.<br><br>이를 완화하기 위해서는 swappiness 파라메터를 수정하는 것입니다. 하지만, 더 나은 튜닝 방법은 사용자기반/프로세스 기반에서 찾아볼 필요가 있습니다.<br><br>https://en.wikipedia.org/wiki/Page_fault<br><br>결국 vm.swappiness 값을 조절해서 스왑사용을 자제하게 할 수 있을 것으로 보입니다만, 시스템이 오라클 구동 이후에 극심한 iowait 과 높은 load average 를 보여지는 것이<br>스토리지 영역의 성능 문제 혹은 오라클 애플리케이션 혹은 베리타스 모듈등의 문제일 가능성도 배제할 수 없을 것으로 보입니다.<br><br>따라서, 1차적으로는 vm.swappiness = 1~10 으로 설정한 이후에도 swap 사용 및 iowait 증가/load average 증가가 관측되는지 확인이 필요하며,<br>어떤 프로세스가 swap을 사용하는지도 확인이 필요합니다.<br><br>Swap usage is at 100% and need to find out what processes are using swap and reduce swap usage<br>https://access.redhat.com/knowledge/solutions/33375<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-02-21T23:52:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IuQV1IAN"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-02-21T14:05:34Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-02-21T14:05:34Z</b><br><br>sosreport첨부해드립니다.  감사합니다.<br><br><publishedDate>2017-02-21T14:05:34Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>