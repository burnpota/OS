======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-04-16T08:41:30Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-05-04T10:05:49Z</b><br><b>id : 500A000000aOjTFIA0</b><br>======================<br><br><b><font size=15>
제목  : /tmp/* 권한 관련 이슈 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하십니까,<br>/tmp 디렉토리 이하 파일의 권한에 관련된 문의사항이 있습니다.<br><br>보안 취약점 설정 과정에서 /tmp 이하에 존재하는 디렉토리와 파일에 대해 권한 설정을 변경하였습니다 . ( 1777 -&gt; 640 )<br>그런데, 재기동 후 아래의 디렉토리에서 권한설정이 적용되지 않은것을 확인하였습니다.<br>&lt;아래&gt;<br>drwxrwxrwt.  2 root     root         6 Dec 27 14:58 .ICE-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .Test-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 15:44 .X11-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .XIM-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .font-unix<br><br>추측컨대 /tmp 이하의 디렉토리들은 기본적으로 1777 권한을 따라가고 있는 것 같습니다.<br>어떤 이유로 /tmp 이하 디렉토리의 기본설정이 1777로 되어있는지, <br>또한 권한 설정을 1777이 아닌 다른 권한으로 부여할 수 있는 방법이 있는지 확인 부탁드립니다.<br>만약, 다른 권한을 부여했을때 우려할만한 부작용이 있을지도 덧붙여서 알려주시면 감사하겠습니다.<br><br>또, /tmp  밑에 아래와 같은 디렉토리가 생성되어 있는데 정확히 어떠한 원인으로 생성되는 디렉토리인지 알고 싶습니다.<br>&lt;아래&gt;<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vgauthd.service-qDIoDG/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vmtoolsd.service-XwGJBO/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-ntpd.service-8jVNv0/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vgauthd.service-FdjwoE/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vmtoolsd.service-PQu2Oy/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-ntpd.service-yGrLOi/tmp<br><br>위의 사항들 확인부탁드립니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLVDIGAL01</hostname><br><br><br><comment id="a0aA000000LW1bBIAT"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-04-18T02:59:09Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-04-18T02:59:09Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>문의 주신 내용에 대해 아래와 같이 답변드리겠습니다.<br><br>Q1) .ICE-unix ,  .Test-unix 등 의 파일들의 역할이 무엇인가요? X-windows를 공용으로 사용하기 위해서 생성되는 임시공간으로 보이는데요. <br>해당 디렉토리들의 역할이 어떻게 되는지 확인 부탁드립니다.<br><br>A1. 해당 디렉토리의 역할은 X-windows의 임시파일을 저장하기 위해 생성된 것으로 보실수 있습니다.<br><br>Q2) systemd-private.xxxx 디렉토리들도 서비스에 대한 임시공유디렉토리로 판단되는데요. 마찬가지로 역할은 어떻게 되나요??<br><br>A2. 네 말씀하신대로 해당 서비스의 private 임시파일들을 저장하기 위해 생성된 디렉토리라 보실수 있습니다.<br><br>감사합니다.<br><br><publishedDate>2018-04-18T02:59:09Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LVnavIAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-04-17T11:39:51Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-04-17T11:39:51Z</b><br><br>답변감사합니다.<br>tmp의 퍼미션을 임의로 변경하는 부분에 대해서는 권장하지 않으며 시스템 내부적인 구조로 1777로 생성된다고 전달하였고<br>보안취약점에서 예외로 등록할 예정입니다.<br><br>궁금한 부분이 있어서 질문 추가 합니다.<br><br>1) .ICE-unix ,  .Test-unix 등 의 파일들의 역할이 무엇인가요? X-windows를 공용으로 사용하기 위해서 생성되는 임시공간으로 보이는데요. <br>해당 디렉토리들의 역할이 어떻게 되는지 확인 부탁드립니다.<br><br>2) systemd-private.xxxx 디렉토리들도 서비스에 대한 임시공유디렉토리로 판단되는데요. 마찬가지로 역할은 어떻게 되나요??<br><br>감사합니다.<br><br><publishedDate>2018-04-17T11:39:51Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LVk3YIAT"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-04-17T07:35:32Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-04-17T07:35:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>재부팅후 권한이 1777로 되는 원인은 아래의 파일의 설정과 관련됩니다.<br><br>~~~<br># grep -v ^# /usr/lib/tmpfiles.d/tmp.conf <br><br>v /tmp 1777 root root 10d   &lt;--- <br>v /var/tmp 1777 root root 30d<br><br>x /tmp/systemd-private-%b-*<br>X /tmp/systemd-private-%b-*/tmp<br>x /var/tmp/systemd-private-%b-*<br>X /var/tmp/systemd-private-%b-*/tmp<br>~~~<br><br>즉 재부팅할때마다 1777의 권한을 가지는 파일을 생성하게 됩니다. Red Hat Enterprise Linux의 파일 권한 설정의 경우 시스템이 운영되는데 기본적으로 필요한 수준으로 기본 설정되어 제공되며 이에 맞춰 품질 테스트를 거치게 됩니다. 해당 권한은 /tmp의 임시파일들을 삭제하기 위한 목적으로 설정되었으므로 변경하시는 것을 권장드리지 않으며 변경으로 인한 영향은 예측하기 힘듭니다. 자세한 내용은 &quot;man tmpfiles.d&quot; 를 참고 하시면 됩니다.<br><br>~~<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vgauthd.service-qDIoDG/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vmtoolsd.service-XwGJBO/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-ntpd.service-8jVNv0/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vgauthd.service-FdjwoE/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vmtoolsd.service-PQu2Oy/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-ntpd.service-yGrLOi/tmp<br>~~<br><br>상기의 디렉토리가 생성되는 원인에는 해당 서비스 파일에 PrivateTmp=yes 혹은 PrivateTmp=true 로 설정 되었기 때문입니다.<br>PrivateTmp 옵션을 쓰게 되면 해당 서비스가 임시파일을 저장하기 위해 /tmp 아래에 systemd-private* 디렉토리를 생성하고 그 아래에 /tmp 마운트포인트를 생성하게 됩니다.<br><br>man systemd.exec<br>~~~<br>PrivateTmp=<br>Takes a boolean argument. If true, sets up a new file system namespace for the executed processes and mounts private /tmp and /var/tmp directories inside it that is not shared by processes outside of the namespace. This is useful to secure access to temporary files of the process, but makes sharing between processes via /tmp or /var/tmp impossible. If this is enabled, all temporary files created by a service in these directories will be removed after the service is stopped. Defaults to false.<br>~~~<br><br>감사합니다.<br><br><publishedDate>2018-04-17T07:35:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LVh63IAD"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-04-17T02:16:34Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-04-17T02:16:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의 주신 내용에 관해 확인 중에 있으며 답변이 정리되는 대로 코멘트를 <br>업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-04-17T02:16:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LVgWgIAL"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-04-17T01:00:01Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-04-17T01:00:01Z</b><br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 이인식(사원)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : +82 01040433211<br>- 메일주소 : is.lee@time-gate.com<br>==============================================================================<br><br><publishedDate>2018-04-17T01:00:01Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>/tmp 디렉토리 이하 파일의 권한에 관련된 문의사항이 있습니다.<br><br>보안 취약점 설정 과정에서 /tmp 이하에 존재하는 디렉토리와 파일에 대해 권한 설정을 변경하였습니다 . ( 1777 -&gt; 640 )<br>그런데, 재기동 후 아래의 디렉토리에서 권한설정이 적용되지 않은것을 확인하였습니다.<br>&lt;아래&gt;<br>drwxrwxrwt.  2 root     root         6 Dec 27 14:58 .ICE-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .Test-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 15:44 .X11-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .XIM-unix<br>drwxrwxrwt.  2 root     root         6 Dec 27 11:23 .font-unix<br><br>추측컨대 /tmp 이하의 디렉토리들은 기본적으로 1777 권한을 따라가고 있는 것 같습니다.<br>어떤 이유로 /tmp 이하 디렉토리의 기본설정이 1777로 되어있는지, <br>또한 권한 설정을 1777이 아닌 다른 권한으로 부여할 수 있는 방법이 있는지 확인 부탁드립니다.<br>만약, 다른 권한을 부여했을때 우려할만한 부작용이 있을지도 덧붙여서 알려주시면 감사하겠습니다.<br><br>또, /tmp  밑에 아래와 같은 디렉토리가 생성되어 있는데 정확히 어떠한 원인으로 생성되는 디렉토리인지 알고 싶습니다.<br>&lt;아래&gt;<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vgauthd.service-qDIoDG/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-vmtoolsd.service-XwGJBO/tmp<br>drwxrwxrwt 2 root root 6 Feb  1 11:22 /var/tmp/systemd-private-60fd2089dcba4e6d98ec4d0f697a3a18-ntpd.service-8jVNv0/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vgauthd.service-FdjwoE/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-vmtoolsd.service-PQu2Oy/tmp<br>drwxrwxrwt 2 root root 6 Feb  7 11:09 /var/tmp/systemd-private-ca6e1713ef504ae3a7e85211fdcaf68b-ntpd.service-yGrLOi/tmp<br><br>위의 사항들 확인부탁드립니다.<br><br>감사합니다.</issue><cep>false</cep></case>