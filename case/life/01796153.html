======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-02-21T06:28:19Z</b><br><b>마지막 답변자 : Jake Jaewook Shin</b><br><b>마지막 수정 일자 : 2017-03-08T00:42:41Z</b><br><b>id : 500A000000WUFwPIAX</b><br>======================<br><br><b><font size=15>
제목  : [기술]maildrop 파일 생성
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br>/var/spool/postfix/maildrop 에 메일이 계속 쌓여서 <br> /var 공간이 부족한데 현재 서버에서는 postfix 데몬은 stop상태 입니다. maildrop에  쌓인 파일은 삭제해도 무관한지 또한 더이상 파일이 생성 안되게 하는 방법을 알려주세요.<br>감사합니다.sosreport 첨부 합니다.<br><br>What information can you provide around timeframes and the business impact?<br><br>=========================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (사원)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com''&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com''<br>=========================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.4</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000J1nxSIAR"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-03-08T00:42:40Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-03-08T00:42:40Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>어제 통화상으로 말씀 나눈 내용을 정리하여 남겨드리면,<br>제가 안내드린 방안을 적용하신 후,<br>rsyslogd 서비스를 재시작하여 이슈가 해결되었다는 피드백을 받았습니다.<br><br>해당 케이스는 이상으로 close 처리하도록 하겠습니다.<br><br>케이스가 처리 완료되면 고객 설문조사 메일이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-08T00:42:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000J1X3EIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-03-07T07:44:26Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-03-07T07:44:26Z</b><br><br>안녕하세요.<br>저는<br>담당엔지니어는 송기호책임 01036209917이고<br>담당어드민은 김경희선임 01030491440 <br>입니다.<br><br>필요하신 정보 있으면 언제든 요청 바랍니다.<br>감사합니다.<br><br><publishedDate>2017-03-07T07:44:26Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000J1WovIAF"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-03-07T07:22:08Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-03-07T07:22:08Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>Sosreport 업로드 감사합니다. 확인후 업데이트 드리도록 하겠습니다.<br>참고로 케이스 관리 및 기록을 위해 해당 케이스의 바뀌신 담당 엔지니어분(책임님)의 연락처를 <br>커멘트로 남겨주시기 바랍니다. <br><br>감사합니다.<br><br><publishedDate>2017-03-07T07:22:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000J1WnJIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-03-07T07:19:54Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-03-07T07:19:54Z</b><br><br>안녕하세요.<br>빠른대응 감사드립니다.<br>sosreport업로드 하였습니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T07:19:54Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000J1WWhIAN"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-03-07T06:51:21Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-03-07T06:51:21Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>sosreport 를 올려주시면 살펴보도록 하겠습니다.<br>그런데 정확히 어떤 마운트 포인트나 디렉토리의 용량인지 기술해주시면<br>분석에 도움이 될 것 같습니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T06:51:21Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000J1WSQIA3"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-03-07T06:43:06Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-03-07T06:43:06Z</b><br><br>답변감사합니다.<br>현재 계속 모니터링 중인데요.<br><br>용량이 지속적으로 증가하고 있습니다.<br>오전중  74%였던 것이 현재 84% 로 4시간만에 증가하였습니다.<br><br>다른 프로세스의 증가 추세가 있는 것일지도 모르니 확인 부탁드립니다.<br>현재 최신sosreport수집중이니 수집후에 바로 업로드 해드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T06:43:06Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000J1VrpIAF"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-03-07T05:38:44Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-03-07T05:38:44Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>예, 현재까지 보고된 바에 따르면 바르게 조치하신 것으로 판단됩니다.<br>모니터링 후, 경과를 기다리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T05:38:44Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000J1VmVIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-03-07T05:27:12Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-03-07T05:27:12Z</b><br><br>안녕하세요.<br>말씀하신데로<br>su - simsplk1 <br><br>crontab -e  후에<br><br>MAILTO=&quot;&quot;을 추가 하였습니다.<br><br>추가로<br><br>vi /etc/anacron<br>에서도 <br>MAILTO=root를<br>MAILTO=&quot;&quot;로 변경하였습니다.<br><br>현재 모니터링 중입니다.<br><br><publishedDate>2017-03-07T05:27:12Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000J1VTYIA3"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-03-07T04:43:01Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-03-07T04:43:01Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>전화상으로 말씀드린바와 같이 <br>simsplk1 유저의 crontab 관련 정보를 수정하셔야 합니다.<br>수정 후, 모니터링하신 후 피드백 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T04:43:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000J1VKGIA3"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-03-07T04:11:04Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-03-07T04:11:04Z</b><br><br>안녕하세요.<br>말씀하신데로<br>MAILTO=&quot;root&quot; 이 부분을 MAILTO=&quot;&quot;로 변경을 하였는데<br>갑자기<br>사용자의 메일이 올라가 /var 의 영역을 사용률이 높아지고 있습니다.<br><br>해당 사용자로 들어가서 mailq를 쳐보니<br>su - simsplk1 <br>postqueue : fatal : Queue report unavailable - mail system is down 이라고 나옵니다.<br><br>ps -ef | grep simsplk1 을하였을때는<br>sendmail simsplk1 /usr/sbin/sendmail -FCronDaemon -i -odi -oem -t -f root<br>이러한 프로세스가 만개정도 유지가 되면<br>지속적으로 증가하고 있습니다.<br><br><br>해당 문제의 해소할수 있는 방안 부탁드리며<br>추가 필요한 정보 있으면 요청해 주시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2017-03-07T04:11:04Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IvXhLIAV"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-02-27T05:29:24Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-02-27T05:29:23Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>기 안내 드린 내용과 겹치는데요,<br><br>시스템에서 cron 데몬 등에서 스케쥴링 된 잡 실행시 메일을 보낼 수 있으므로<br>postfix 서비스를 종료 시킬 경우 해당 메일들을 전송할 수 없어 <br>maildrop 에 쌓이게 됩니다. 또한, 관련 로그가 maillog 에도 로깅될 수 있을 것입니다.<br><br>큐안의 데이터를 지우는 방법에 대해서는 이미 안내드렸는데요.<br><br>그밖에,<br><br>아래와 같이 cron job 실행시 메일을 보내지 않도록<br>메일 보내는 옵션을 주석 처리 하시면 해당 이슈가 개선될 수 있습니다. <br><br># grep -irl &quot;MAILTO&quot; /etc/cron*          &lt;== cron 에서 이메일 보내는 옵션을 검출  <br><br>예를 들면,<br>#cat /etc/crontab <br>MAILTO=root    &lt; ==== 주석 처리<br><br>또한 일반 유저들에 cron 잡을 설정했다면<br>(예를 들어 /var/spool/cron 밑에 생성됨)<br><br>예를 들어 해당 유저로 로그인하셔서 MAILTO 를 &quot;&quot; 란으로 설정해보시기 바랍니다.<br>$ crontab -e<br>~~~<br>MAILTO=&quot;&quot;<br>스케쥴링된 잡들..<br>~~~<br><br>crond 데몬을 재기동하지 않으셔도 crontab 수정은 적용됩니다.<br><br>감사합니다.<br><br><publishedDate>2017-02-27T05:29:23Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IvXUgIAN"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-02-27T04:59:59Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-02-27T04:59:59Z</b><br><br>안녕하세요.<br>현재 서버에서 postfix를 stop했음으로 불구하고<br>지속적으로 /var/spool/postfix/maildrop 에 queue가 쌓이고 있는 원인을 알 수 있을까요?<br><br>그리고<br>maillog에 mail내용이 지속적으로 쌓이는 원인 또한 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-02-27T04:59:59Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IuaiIIAR"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-02-22T00:33:59Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-02-22T02:48:31Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>일반 사용방법이 아닌 제공 패키지의 디폴트 권한을 변경하는데 대한 영향도에 대해서는<br>저희가 공식적으로 기술 지원 드리기 어렵습니다.<br><br>권한 삭제 이므로 개인적으로는 서비스 제공에는 특별히 문제 없어 보입니다만,<br>직접 테스트를 통해서 확인하실 필요가 있으며,<br>문제 발생시 권한을 복구하실 필요가 있을 것입니다.<br><br>감사합니다.<br><br><publishedDate>2017-02-22T00:33:58Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IuHrWIAV"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-02-21T07:43:55Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-02-21T07:43:55Z</b><br><br>안녕하세요.답변 감사합니다.<br>postfix 서비스를 가동하지 않고 해당 폴더에 큐가 안 쌓이게 하는 방법으로 <br># chmod 000 /var/spool/postfix/maildrop 으로<br>postfix 유저가 write 하는것을 막아도 상관 없을까요?<br><br><publishedDate>2017-02-21T07:43:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IuHdyIAF"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-02-21T07:17:02Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-02-21T07:19:35Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대하여 안내를 드리면 다음과 같습니다.<br><br>기존 유사 사례 등을 토대로 말씀드리면<br>postfix 서비스가 정지되어 있을 때,<br>cron 등의 서비스에 의해 셍성된 메일이 송신되지 못하여 큐잉되는건<br>정상적인 동작입니다.<br><br>만약 postfix 서비스를 기동시키면 큐잉되지 않고 일거에 대량으로 송신되어<br>큐가 비어질 것입니다.<br><br>postfix 의 서비스 정지가 계획된 일이며 큐잉되어 있는<br>드롭메일들을 지웠다고 해서 시스템적 문제가 있을 것으로 보이지는 않습니다.<br>큐를 지우는 방법으로는 다음과 같은 방법들이 보고되어 있습니다.<br><br>1. post 관련 커멘드로 삭제하는 법<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br># postqueue -p<br><br>-Queue ID- --Size-- ----Arrival Time---- -Sender/Recipient-------<br>091A22Exxx* 300 Thu Apr 13 11:51:57 xxx@example.com<br>yyy@example.com<br><br># postsuper -d 091A22Exxx &lt;- '091A22Exxx' is the queue ID<br><br>or<br><br># postsuper -d ALL<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>2. maildrop 디렉토리의 밑의 모든 파일 삭제(rm 커멘드가 있으므로 실행에 주의)<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br># cd /var/spool/postfix/maildrop<br># find . -type f -exec rm {} \;<br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>감사합니다.<br><br><publishedDate>2017-02-21T07:17:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IuHcqIAF"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-02-21T07:15:35Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-02-21T07:15:35Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>저는 신재욱이라고 하며<br>앞으로 해당 케이스를 담당하게 되었습니다.<br><br>현재 이 케이스의 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-02-21T07:15:35Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>/var/spool/postfix/maildrop 에 메일이 계속 쌓여서 <br> /var 공간이 부족한데 현재 서버에서는 postfix 데몬은 stop상태 입니다. maildrop에  쌓인 파일은 삭제해도 무관한지 또한 더이상 파일이 생성 안되게 하는 방법을 알려주세요.<br>감사합니다.sosreport 첨부 합니다.</issue><timeFramesAndUrgency>=========================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김경희 (사원)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-3049-1440 <br>- 메일주소 : 김경희 &lt;khsds.kim@samsung.com''&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com''<br>=========================================================</timeFramesAndUrgency><cep>false</cep></case>