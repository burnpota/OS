======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-10-11T15:26:05Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2017-10-18T05:35:03Z</b><br><b>id : 500A000000YSveDIAT</b><br>======================<br><br><b><font size=15>
제목  : 덤프분석 요청드립니다.
</font></b><br><br>======================<br><b>사전문의<br></b><br>FLPMTA01~04 4대의 WAS서버가 로드밸런싱으로 서비스 중이였는데,<br>갑자기 03서버로 사용자가 몰리는 현상이 발생하였습니다.<br>해당 원인에 대해서<br>WAS에도 문의를 요청한 상황이며,<br>시스템 적으로도 해당 문제에 대해서 원인이 있는지 확인 부탁드립니다.<br>강제적으로 KDUMP를 수행하여 vmcore파일을 드롭박스<br>incoming에 FLPMTA03_vmcore_171010 으로 업로드 하였으니 해당 덤프 파일을 분석 요청드립니다.<br><br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김태현 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  82-10-3734-0720<br>- 메일주소 : 김태현 &lt;th0720.kim@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>FLPMTA03</hostname><br><br><br><comment id="a0aA000000KhqyIIAR"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-18T05:35:01Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-18T05:35:01Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-10-18T05:35:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KhGOFIA3"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-16T06:45:35Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-16T06:45:35Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-10-16T06:45:35Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KgNRIIA3"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-10-12T00:45:26Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-10-12T00:45:26Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>Red Hat Enterprise Linux 5 는 Extended Life Phase 로 접어들었으며, ELS 서브스크립션 없이는<br>제한적인 지원이 이루어지고 있습니다.<br><br>따라서, 원인 분석이 된다고 하여 커널의 버그(드라이버, 보안취약점등)라고 밝혀진다고 하더라도,<br>패치 제공이 제한적으로 이루어질 것입니다.<br><br>아래 에라타를 통해 커널 버전을 최신 버전으로 업그레이드하여 문제가 해소될 수 있는지 확인해주시고,<br>장기적으로 Red Hat Enterprise Linux 6 혹은 7로 마이그레이션이 가능할지도 고려해주시기 바랍니다.<br><br>https://rhn.redhat.com/errata/RHSA-2017-0323.html<br><br>[관련 문서]<br>[1] FAQ: Red Hat Enterprise Linux 5 Reaches End of Production Phase and Transitions to Extended Life Phase <br>    https://access.redhat.com/articles/2986371<br><br>[2] How to troubleshoot kernel crashes, hangs, or reboots with kdump on Red Hat Enterprise Linux <br>    https://access.redhat.com/knowledge/solutions/6038<br><br>아래는 vmcore 분석 결과입니다.<br><br>      KERNEL: /cores/retrace/repos/kernel/x86_64/usr/lib/debug/lib/modules/2.6.18-274.el5/vmlinux<br>    DUMPFILE: /cores/retrace/tasks/967641845/crash/vmcore  [PARTIAL DUMP]<br>        CPUS: 8<br>        DATE: Mon Oct  9 22:49:12 2017<br>      UPTIME: 148 days, 21:30:12<br>LOAD AVERAGE: 0.03, 1.18, 7.91<br>       TASKS: 411<br>    NODENAME: FLPMTA03<br>     RELEASE: 2.6.18-274.el5<br>     VERSION: #1 SMP Fri Jul 8 17:36:59 EDT 2011<br>     MACHINE: x86_64  (3599 Mhz)<br>      MEMORY: 71 GB<br>       PANIC: &quot;SysRq : Trigger a crashdump&quot;<br>         PID: 6809<br>     COMMAND: &quot;bash&quot;<br>        TASK: ffff81121dd2e860  [THREAD_INFO: ffff8110a8b1c000]<br>         CPU: 2<br>       STATE: TASK_RUNNING (SYSRQ)<br><br>아래 커널 링버퍼에 ptymonitor 프로세스의 segfault 가 다수 발생하고 있습니다.<br><br>ptymonitor[31402]: segfault at 0000000000000000 rip 000000336f278ca0 rsp 00007fff6f149408 error 4<br>ptymonitor[31405]: segfault at 0000000000000000 rip 000000336f278ca0 rsp 00007fff469c55d8 error 4<br>SysRq : Trigger a crashdump<br>crash&gt; log|grep ptymonitor |wc -l<br>1937<br><br>                 PAGES        TOTAL      PERCENTAGE<br>    TOTAL MEM  18511583      70.6 GB         ----<br>         FREE  8734689      33.3 GB   47% of TOTAL MEM<br>         USED  9776894      37.3 GB   52% of TOTAL MEM<br>       SHARED  5407484      20.6 GB   29% of TOTAL MEM<br>      BUFFERS   254649     994.7 MB    1% of TOTAL MEM<br>       CACHED  8618556      32.9 GB   46% of TOTAL MEM<br>         SLAB   354882       1.4 GB    1% of TOTAL MEM<br><br>   TOTAL HIGH        0            0    0% of TOTAL MEM<br>    FREE HIGH        0            0    0% of TOTAL HIGH<br>    TOTAL LOW  18511583      70.6 GB  100% of TOTAL MEM<br>     FREE LOW  8734689      33.3 GB   47% of TOTAL LOW<br><br>   TOTAL HUGE        0            0         ----<br>    HUGE FREE        0            0    0% of TOTAL HUGE<br><br>   TOTAL SWAP  4002183      15.3 GB         ----<br>    SWAP USED       46       184 KB    0% of TOTAL SWAP<br>    SWAP FREE  4002137      15.3 GB   99% of TOTAL SWAP<br><br> COMMIT LIMIT  13257974      50.6 GB         ----<br>    COMMITTED  1219783       4.7 GB    9% of TOTAL LIMIT<br><br>  PID  CMD                Age    ARGS<br>-----  --------------   ------  ----------------------------<br>    0 swapper             0 ms  (no user stack)<br> 4829 klogd               0 ms  klogd -x <br> 6808 python              0 ms  /opt/opsware/agent/bin/python /opt/opsware/agent/pylibs/shadowbot/daemonbot.pyc --conf /etc/opt/opsware/agent/agent.args <br><br> 6806 ptymonitor          0 ms  ptymonitor --oob-fd 31 --stderr-mode MUX --pty --term xterm --rows 45 --cols 102 --termios 38400:38400:3.1C.7F.15.4.0.0.11.13.1A.100.12.17.16.100.100.100.F:140:E3B:544505:8 --ttlg --gid 0 --username root --wait-time 60 --shell <br><br> ----- Total Numbers of Threads per State ------<br>  TASK_INTERRUPTIBLE                         401<br>  TASK_RUNNING                                 3<br><br>                                +------------+<br>&gt;-------------------------------| Mounted FS |-------------------------------&lt;<br>                                +------------+<br><br>    VFSMOUNT         SUPERBLK     TYPE   DEVNAME   DIRNAME<br>ffff81011ff96e80 ffff81011ff88800 rootfs rootfs    /         <br>ffff81011ff96480 ffff81091ec8e000 ext3   /dev/root /         <br>ffff81011ff96580 ffff81121ffad400 tmpfs  /dev      /dev      <br>ffff81011ff96680 ffff81121ffedc00 proc   /proc     /proc     <br>ffff81011ff96780 ffff81121ffed400 sysfs  /sys      /sys      <br>ffff81121f09c1c0 ffff81121fe45400 usbfs  /proc/bus/usb /proc/bus/usb<br>ffff81011ff96380 ffff81121faff400 devpts devpts    /dev/pts  <br>ffff81011ff96880 ffff81091b8b5000 ext3   /dev/cciss/c0d0p3 /var      <br>ffff81011ff96080 ffff81091bec3400 ext3   /dev/cciss/c0d0p1 /boot     <br>ffff81011ff96980 ffff81091b8b1400 tmpfs  tmpfs     /dev/shm  <br>ffff81011ff96a80 ffff81091b8b1c00 ext3   /dev/vg0/lv_home /home     <br>ffff81011ff96180 ffff81091b8b2400 ext3   /dev/vg0/lv_CRASH /CRASH    <br>ffff81011ff96280 ffff81091b8b4400 ext3   /dev/vg1/lv_APP /APP      <br>ffff81091f5d3ec0 ffff81091afdbc00 ext3   /dev/vg1/lv_LOG /LOG      <br>ffff81091f5d3dc0 ffff81091afdb800 ext3   /dev/vg1/lv_LIB /LIB      <br>ffff81091f5d3cc0 ffff81091b8b4c00 ext3   /dev/vg1/lv_Tools /Tools    <br>ffff81121f09c5c0 ffff81121f35a400 binfmt_misc none /proc/sys/fs/binfmt_misc<br>ffff81091f5d36c0 ffff8108aa6e9800 rpc_pipefs sunrpc /var/lib/nfs/rpc_pipefs<br>ffff81121f09c4c0 ffff810b2c093000 nfs    100.254.170.203:/FLP_PDF /PDF      <br>ffff81121f09cbc0 ffff810b3fd26c00 nfs    100.254.170.203:/attachfile /NAS/attachfile<br>ffff81121f09cdc0 ffff810fc8315400 nfs    100.254.170.203:/ft /LIB/FSLP/ncruntime/fileupload/ft<br><br>crash&gt; nfsshow<br>********************  Host As A NFS-client  ********************<br> 3 mounted shares, by flags/caps:<br>    3 shares with flags=&lt;TCP|VER3&gt;<br>    3 shares with caps=&lt;READDIRPLUS&gt;<br>  ............. struct nfs_client .....................<br>     --- &lt;struct nfs_client 0xffff81121ff98000&gt; 100.254.170.203 100.254.170.203<br>      ... &lt;struct rpc_xprt 0xffff810f40265000&gt; ...<br>        state=XPRT_CONNECTED<br>        last_used     12.2 s ago<br>  .... Stats for program  nfs<br>                program  &lt;struct rpc_program 0xffffffff88fde060&gt;<br>                 netcnt  0<br>              netudpcnt  0<br>              nettcpcnt  0<br>             nettcpconn  0<br>              netreconn  58<br>                 rpccnt  15870110<br>             rpcretrans  0<br>         rpcauthrefresh  0<br>             rpcgarbage  0<br>================================ RPC =================================<br>  ------- 0 RPC Tasks ---------<br> --- XPRT Info ---<br><br> ** Execution took   0.62s (real)   0.58s (CPU)<br><br>분석 결과, 시스템 자원 사용율은 높지 않으며, ptymonitor 프로세스의 segfault 이외에는 <br>별다른 문제를 발견하지 못하였습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-10-12T00:45:26Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>