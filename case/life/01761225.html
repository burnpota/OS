======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2016-12-20T13:15:44Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-01-22T11:08:49Z</b><br><b>id : 500A000000Vq8p4IAB</b><br>======================<br><br><b><font size=15>
제목  : [기술문의]Synchronizing SCSI cache
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br>현재 RAC구성되 있는 서버 1호기와 2호기중 <br>2호기에서 <br>arning (SLPAFIDL02) (Syslog)  Dec 20 21:20:57 SLPAFIDL02 kernel: sd 15:0:0:4: [sdw] Synchronizing SCSI cache (TIME 12/20 21:20)<br>메시지가 지속적으로 발생하고 있습니다.<br>전 후로그상에서는 error의 메시지는 보이지 않습니다.<br>예상으로는<br>스토리지 샌스위치 서버간 라인 혹은  포트 및 HBA장치에러로 예상됩니다.<br>어떤한 문제로 위의 로그가 지속적으로 발생하는지 알려주시기 바랍니다<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>RAC구성중인 서버<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><br><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-12-22T07:57:19Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-12-22T07:57:18Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>QLOGIC 에서 LOOP UP/DOWN 현상에 대해 만약 OS측 도움이 더 필요 하실 경우 <br>언제든지 코멘트 남겨 주시기 바랍니다. <br><br>말씀 하신 대로 Found duplicate PV를 해결 할수 있는 것으로 보입니다. <br>단, 필터 부분중 &quot;a|/dev/mapper/ext*|&quot; 를 &quot;a|/dev/mapper/ext.*|&quot;로 <br>변경 하시는게 더 좋을 것 같습니다. '.*'로 적어도 하나의 문자가 있음을 의미 <br>하고 있습니다. <br><br>참고 자료:<br> Why do I see 'Found duplicate PV' warnings when using LVM with multipath storage in RHEL? <br> - https://access.redhat.com/solutions/2989<br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연 드림<br><br><publishedDate>2016-12-22T07:57:18Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IWS7qIAH"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-12-22T07:02:19Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-12-22T07:02:19Z</b><br><br>답변감사합니다.<br>말씀하신 부분에 대해서는 확인 조치 후에도 동일한 문제가 발생하면 케이스를 다시 오픈하도록 하겠습니다.<br><br>그리고 <br>이 상황과는 별개로 <br>현재<br>pvscan 하면 <br>Found duplicate PV 5PpngNs2OhEkuFPIxxRMXgdsJVM6jHMp: using existing dev /dev/mapper/ext0p1<br>..<br>Found duplicate PV V47ec6X1vNrAuBTTavdV13tzPdkyZCqi: using existing dev /dev/mapper/ext4p1<br>..<br>Found duplicate PV V47ec6X1vNrAuBTTavdV13tzPdkyZCqi: using /dev/mapper/ext4p1 not /dev/sdz1<br>  Using duplicate PV /dev/mapper/ext4p1 from subsystem DM, ignoring /dev/sdz1<br>과같은 메시지가 발생하고 있습니다.<br><br>일단<br>multipath.conf 를 보면<br>ext6 (360060e8006d5e6000000d5e600002a1a) dm-20 HITACHI ,OPEN-V<br>size=100G features='0' hwhandler='0' wp=rw<br>`-+- policy='service-time 0' prio=0 status=active<br>  |- 14:0:0:6  sdi               8:128  active undef running<br>  `- 15:0:0:6  sdab              65:176 active undef running<br>ext10 (360060e8006d5e6000000d5e600002a1e) dm-10 HITACHI ,OPEN-V<br>...<br>ext11 (360060e8006d5e6000000d5e600002a1f) dm-2 HITACHI ,OPEN-V<br>size=100G features='0' hwhandler='0' wp=rw<br>`-+- policy='service-time 0' prio=0 status=active<br>  |- 14:0:0:11 sdn               8:208  active undef running<br>  `- 15:0:0:11 sdag              66:0   active undef running<br>식으로 extn으로 alias해서 사용중인데,<br>Found duplicate PV ...를 pvscan 하였을때, 발생하지 않게 하기 위해서<br><br>1.  systemctl disable lvm2-monitor.service <br>2. echo “” &gt; /etc/multipath/bindings <br>3. echo “” &gt; /etc/multipath/wwids <br>4. systemctl reload multipath.service <br>5. vi /etc/lvm/lvm.conf 에 filter에서 alias ext와 localdisk 중 lvm으로 사용중인 sda, sdb 를 append하여<br>filter =  [ &quot;a|/dev/mapper/ext*|&quot;, &quot;a|/dev/sda[1-9]|&quot;, &quot;a|/dev/sdb[1-9]|&quot;, &quot;r|.*/|&quot; ] <br>6.  pvscan --cache <br>7.  pvs<br><br>의 절차가 맞는 지 확인 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2016-12-22T07:02:19Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IWQ17IAH"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-12-22T06:18:27Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-12-22T06:18:27Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>&quot;Synchronizing SCSI cache&quot; 메시지는 SLPAFIDL02에서만 발생 하였던 것으로 <br>보입니다. <br><br>따라서 SLPAFIDL02 로그를 확인 해 보니 해당 메시지 발생 할때 HBA 에서 LOOP DOWN <br>현상이 있었습니다. <br><br>Dec 20 20:02:01 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500b:15: LOOP DOWN detected (2 3 0 0).<br><br>qla2xxx [0000:84:00.0] 는 14:0:0:x 경로를 관리 하고 있으며 해당 경로에서 LOOP DOWN<br>이슈 인식 한 후 경로 failing path 이슈가 발생 하였습니다. <br><br>Dec 20 20:02:06 SLPAFIDL02 kernel: device-mapper: multipath: Failing path 66:0.<br>Dec 20 20:02:06 SLPAFIDL02 kernel: device-mapper: multipath: Failing path 65:176.<br><br><br>그후에 15:0-0: 에서 &quot;Synchronizing SCSI cache&quot; 시도를 하였지만 failed 되었습니다. <br>Result 부분에 &quot;hostbyte=DID_NO_CONNECT driverbyte=DRIVER_OK&quot; 로 표시 되어 있으며 <br>드라이버측에는 문제가 없었으며 경로가 단절 된 것으로 추정 됩니다. <br><br>Dec 20 20:02:46 SLPAFIDL02 kernel: rport-15:0-0: blocked FC remote port time out: removing target and saving binding<br>Dec 20 20:02:46 SLPAFIDL02 kernel: sd 15:0:0:0: [sds] Synchronizing SCSI cache<br>Dec 20 20:02:46 SLPAFIDL02 kernel: sd 15:0:0:0: [sds] Synchronize Cache(10) failed: Result: hostbyte=DID_NO_CONNECT driverbyte=DRIVER_OK<br><br>Dec 20 20:02:46 SLPAFIDL02 kernel: sd 15:0:0:18: [sdah] Synchronizing SCSI cache<br>Dec 20 20:02:46 SLPAFIDL02 kernel: sd 15:0:0:18: [sdah] Synchronize Cache(10) failed: Result: hostbyte=DID_NO_CONNECT driverbyte=DRIVER_OK<br><br><br>로그 내용을 보면 LOOP UP/DOWN 현상이 지속적으로 발생 하였으며 혹시 펌웨어나 케이블/샌 스위치쪽에 <br>문제가 없었는지 확인 해 보시기 바랍니다. <br><br>Dec 20 20:07:15 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500a:15: LOOP UP detected (4 Gbps).<br>Dec 20 20:09:13 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500b:15: LOOP DOWN detected (2 3 0 0).<br>Dec 20 20:14:27 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500a:15: LOOP UP detected (4 Gbps).<br>Dec 20 20:41:16 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500b:15: LOOP DOWN detected (2 3 0 0).<br>Dec 20 20:46:30 SLPAFIDL02 kernel: qla2xxx [0000:84:00.0]-500a:15: LOOP UP detected (4 Gbps).<br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연 드림<br><br><publishedDate>2016-12-22T06:18:27Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IWBOdIAP"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-12-21T08:59:30Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-12-21T08:59:30Z</b><br><br>답변감사합니다.<br><br>답변감사합니다.<br>현재는 동일한 메시지가 발생하고 있지 않아서 모니터링 중입니다.<br>1. 공유스토리지여부는 확인해보도록 하겠습니다.<br>2. 물리장비 입니다.<br>3. 야간에 발생하였기 때문에 예상하건데 작업을 하였기 보단 IO가 발생하였을때 생긴로그 같습니다.<br>4. sosreport는  ftp://dropbox.redat.com incoming에 sosreport-SLPAFIDL01-20161221104238.tar.xz, sosreport-SLPAFIDL02-20161221104241.tar.zx로 업로드 하였습니다.<br><br>감사합니다.<br><br><publishedDate>2016-12-21T08:59:30Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IW4PtIAL"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2016-12-21T02:47:24Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2016-12-21T02:47:24Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>RAC구성되 환경에서 2호기에서 아래와 같은 메시지가 지속적으로 발생 하고 <br>있다고 하셨습니다. <br><br>arning (SLPAFIDL02) (Syslog)  Dec 20 21:20:57 SLPAFIDL02 kernel: sd 15:0:0:4: [sdw] Synchronizing SCSI cache (TIME 12/20 21:20)<br><br><br>관련 해서 좀더 확인 할 부분이 있습니다. <br>1) sdw 장비는 1호기 또한 2호기간에서 사용 하게 되는 공유 스토리지인가요?<br>2) RAC 로 구성된 1호기 또한 2호기는 VM인가요? 아니면 Physical 서버인가요?<br>3) 해당 메시지는 어떤 작업을 하실때 발생 하게 되나요?<br>4) 양 노드의 sosreport를 수집 하여 보내 주시기 바랍니다. <br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연 드림<br><br><publishedDate>2016-12-21T02:47:24Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>현재 RAC구성되 있는 서버 1호기와 2호기중 <br>2호기에서 <br>arning (SLPAFIDL02) (Syslog)  Dec 20 21:20:57 SLPAFIDL02 kernel: sd 15:0:0:4: [sdw] Synchronizing SCSI cache (TIME 12/20 21:20)<br>메시지가 지속적으로 발생하고 있습니다.<br>전 후로그상에서는 error의 메시지는 보이지 않습니다.<br>예상으로는<br>스토리지 샌스위치 서버간 라인 혹은  포트 및 HBA장치에러로 예상됩니다.<br>어떤한 문제로 위의 로그가 지속적으로 발생하는지 알려주시기 바랍니다</issue><environment>RAC구성중인 서버</environment><cep>false</cep></case>