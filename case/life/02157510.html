======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-08-08T05:51:51Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2018-08-09T12:34:35Z</b><br><b>id : 500A000000bWQMgIAO</b><br>======================<br><br><b><font size=15>
제목  : messages 로그 발생관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요. <br>송기호입니다.<br><br>messages에 예전날짜의 로그가 삽입이 되서 문의드립니다.<br>아래를 보시면 8월 7일 정상로그 생성되던중<br>갑자기 4월 ~ 5월간의 로그가 삽입이되었습니다. 그후 다시 정상적으로 해당 날짜의 로그가 생성되었습니다.<br>Aug  7 16:07:54 SLTDIGAL01 rsyslogd: [origin software=&quot;rsyslogd&quot; swVersion=&quot;7.4.7&quot; x-pid=&quot;1019&quot; x-info=&quot;http://www.rsyslog.com&quot;] exiting on signal 15.<br>Aug  7 16:07:55 SLTDIGAL01 rsyslogd: [origin software=&quot;rsyslogd&quot; swVersion=&quot;7.4.7&quot; x-pid=&quot;110422&quot; x-info=&quot;http://www.rsyslog.com&quot;] start<br>Apr 24 10:36:48 SLTDIGAL01 journal: Runtime journal is using 8.0M (max allowed 1.5G, trying to leave 2.3G free of 15.4G available → current limit 1.5G).<br>Apr 24 10:36:48 SLTDIGAL01 kernel: Initializing cgroup subsys cpuset<br>Apr 24 10:36:48 SLTDIGAL01 kernel: Initializing cgroup subsys cpu<br>Apr 24 10:36:48 SLTDIGAL01 kernel: Initializing cgroup subsys cpuacct<br>...........생략<br>May  4 06:50:01 SLTDIGAL01 CROND[42287]: (root) CMD (test -f /var/lock/subsys/ods-enforcerd &amp;&amp; kill -s SIGHUP `cat /var/run/opendnssec/enforcerd.pid` &gt; /dev/null 2&gt; /dev/null)<br>May  4 06:51:01 SLTDIGAL01 CROND[42323]: (root) CMD (/usr/lib64/sa/sa1 1 1)<br>May  4 06:52:01 SLTDIGAL01 CROND[42357]: (root) CMD (/usr/lib64/sa/sa1 1 1)<br>May  4 06:53:01 SLTDIGAL01 CROND[42390]: (root) CMD (/usr/lib64/sa/sa1 1 1)<br>Aug  7 16:07:56 SLTDIGAL01 rsyslogd-2177: imjournal: begin to drop messages due to rate-limiting<br>Aug  7 16:18:01 SLTDIGAL01 rsyslogd-2177: imjournal: 223177 messages lost due to rate-limiting<br>Aug  7 16:18:01 SLTDIGAL01 CROND[114723]: (root) CMD (/usr/lib64/sa/sa1 1 1)<br>이와같이 발생된 원인 분석 부탁드립니다.~<br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLTDIGAL01</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000NLNoGIAX"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-08-09T12:34:34Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-08-09T12:34:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>해당 케이스를 직접 close 처리해주셔서 감사드립니다.<br><br>케이스가 처리 완료되면 고객 설문조사 메일이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-09T12:34:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NLIAnIAP"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-08-09T05:04:30Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-08-09T05:04:30Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>관련 내용에 대하여 개선을 요청하는 버그질라가 오픈되었고, 패치되어 개선된 패키지가 제공되고 있습니다.<br><br>버그질라는 다음과 같습니다.<br><br>Bug 1216957 - rsyslog restart pulls lots of older log entries again, runs into rate-limiting<br>  https://bugzilla.redhat.com/show_bug.cgi?id=1216957<br><br>패치된 패키지: rsyslog-7.4.7-16 이후<br>사용하시는 패키지: rsyslog-7.4.7-12.el7.x86_64 <br><br><br>감사합니다.<br><br><publishedDate>2018-08-09T05:04:30Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NLH7aIAH"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-08-09T02:23:32Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-08-09T02:23:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>특정 날짜만 들어갔다기보다는 너무 메시지가 많아서 추가 로그 기록이 중지(드랍)된 것입니다.<br><br>Aug  7 16:07:56 SLTDIGAL01 rsyslogd-2177: imjournal: begin to drop messages due to rate-limiting<br>Aug  7 16:18:01 SLTDIGAL01 rsyslogd-2177: imjournal: 223177 messages lost due to rate-limiting<br><br>$IMJournalStateFile 설정이 되어 있음에도 불구하고 기존 imjournal.state 파일에 문제가 있어 이중 출력이 발생한 사례도 있으므로<br>다음과 같이 작업하시면 이중 출력을 방지하는데 보다 안전한 방법입니다.<br><br>  # rm -f /var/lib/rsyslog/imjournal.state<br>  # systemctl restart rsyslog<br><br>마지막으로 rsyslog-7.4.7-16 이후에는 기본적으로 상기 증상이 개선되었습니다.<br><br>사용하시는 패키지: rsyslog-7.4.7-12.el7.x86_64 <br><br>감사합니다.<br><br><publishedDate>2018-08-09T02:23:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NLGnLIAX"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-08-09T01:37:35Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-08-09T01:37:35Z</b><br><br>답변감사합니다.<br>작업당시 히스토리 안내해 드립니다.<br><br>작업당일 10대의 서버에서 보안어플이 설치&amp;업데이트 작업을 진행하였고<br>작업업체에서 iptable관련 내용을 rsyslog.conf에 추가후 rsyslogd를 재시작하였습니다.<br><br>보내주신 문서가 정확히 이해가 안되서 추가 질의를 드리는데요.<br>rsyslog.conf에 <br>$ModLoad imuxsock # provides support for local system logging (e.g. via logger command)<br>$ModLoad imjournal # provides access to the systemd journal<br>$WorkDirectory /var/lib/rsyslog<br>$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat<br>$IncludeConfig /etc/rsyslog.d/*.conf<br>$OmitLocalLogging on<br>$IMJournalStateFile imjournal.state<br>기능이 추가되어있다면  <br>rsyslogd가 재시작될때 journal이 생성한 로그는 rsyslogd에서 어디부터 읽혀졌는데 알수없어 <br>journal로그의 전체부분을 읽어들여 해당 로그를 messages에서 삽입하는 정상적인 과정이라는 건가요.<br><br>그러면 의문점이 드는데 왜 특정 날짜의 부분만 들어간건가요?<br>답변부탁드립니다.<br><br>감사합니다<br><br><publishedDate>2018-08-09T01:37:35Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NLGIhIAP"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-08-09T00:31:17Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-08-09T00:31:39Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대하여 안내를 드리면 다음과 같습니다.<br><br>조사 결과, 해당 현상은 RHEL7 에서 rsyslog 가 재시작될 때 발생할 수 있습니다.<br>문제를 나타내는 것은 아닙니다.<br><br>관련 공식문서는 다음과 같습니다.<br><br>systemctl restart rsyslog appends older duplicate log entries (everything in the journal) to log files <br>  https://access.redhat.com/solutions/2112651<br><br>감사합니다.<br><br><publishedDate>2018-08-09T00:31:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NL1IMIA1"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-08-08T05:56:31Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-08-08T05:56:31Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>저는 Platform Support 를 담당하고 있는<br>Senior Technical Support Engineer 신재욱입니다.<br><br>현재 올려주신 문의내용은 자세히 살펴보고 있는중이며,<br>곧 관련된 내용을 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-08T05:56:31Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>