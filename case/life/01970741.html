======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2017-11-09T22:01:37Z</b><br><b>마지막 답변자 : 타임게이트 (주)</b><br><b>마지막 수정 일자 : 2017-11-13T06:38:24Z</b><br><b>id : 500A000000Z2OJ1IAN</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] 번들 http server httpd.conf 옵션 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br>삼생생명 차세대 ERP 관련 이슈에 대하여 하기와 같이 문의가 요청되어 SR 생성드립니다. <br><br>## 고객정보 ##<br>고객사 : 삼성생명<br>고객명 : 박현우 선임<br>연락처 : 010-9104-2853<br>##<br><br>## 환경 ##<br>-OS : RHEL7<br>-WEB : 번들 HTTP<br>rpm -qf /usr/sbin/httpd<br>httpd-2.4.6-40.el7.x86_64<br>-WAS : SAP netweaver 7.x<br><br>##  협력사정보 ##<br>회사명 : 타임게이트<br>담당자 : 안상훈 책임<br>연락처 : 010-3957-1209<br>##<br><br>## 문의사항 ##<br>AcceptFilter http none<br>AcceptFilter https none<br> <br>이 설정의 의미와 반영했을 때 결과(side effect 포함)를 문의드립니다.<br>##<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags><tag><name>rpm</name></tag></tags><br><comment id="a0aA000000KxopfIAB"><br>======================<br><b>생성계정 : Won, Ted</b><br><b>생성날짜 : 2017-11-13T06:35:23Z</b><br><b>마지막 답변자 : Won, Ted</b><br><b>마지막 수정 일자 : 2017-11-13T06:35:22Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>죄송하지만 새로 케이스를 생성해주시기 바랍니다. 처음 올려주신 이슈와 개별적으로 추가적인 조사가 필요한 내용입니다.<br>히스토리 관리 및 이슈 진행 중 엔지니어팀 컨택이 필요한 경우 2가지 이상의 이슈가 하나의 케이스에 있는 경우 진행이 잘 되지 않습니다.<br>귀찮으시더라도 이슈별로 케이스를 분리해서 올려주시면 감사하겠습니다.<br><br>또한 이번 케이스건에 대한 더 궁금한 사항이나 도움이 필요하신건가요? 아니면 종료해도 될까요? <br>이번 케이스건에 대한 더 궁금한 사항이 없으시거나 지원이 필요하지 않다면 케이스를 close 하려고 합니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-13T06:35:22Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxnrdIAB"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-11-13T04:40:15Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-11-13T04:40:15Z</b><br><br>안녕하세요! 빠른 확인 감사드립니다 <br><br>추가로 하기의 옵션을 고객사에서 추가하였다고 합니다. <br><br>&lt;httpd.conf&gt;<br>## 중략 ##<br><br>MaxKeepAliveRequests 0<br>KeepAliveTimeout 600<br>EnableSendfile Off<br>EnableMMAP Off<br>ExpiresActive On<br>ExpiresDefault A600<br>AllowEncodedSlashes On<br><br>&lt;Location /&gt;<br>   SetEnv force-proxy-request-1.0 1<br>   SetEnv proxy-nokeepalive 1<br>   SetEnv proxy-initial-not-pooled 1<br>   SetEnv proxy-sendchunked 1<br>   SetEnv proxy-sendchunks 1<br>&lt;/Location&gt;<br><br>각 옵션의 정의는 하기와 같이 확인하였는데 고객사에서 추가로 각 옵션을 명시적으로 설정하였을 경우에 대하여 side-effect를 확인을 요청하고 있어  SR 업데이트 드립니다. <br><br>- MaxKeepAliveRequests :  The maximum number of requests a single persistent connection will service. A number between 50 and 75 would be plenty.<br>- EnableSendfile : Apache에서 커널단의 sendfile 를 이용하여 정적파일을 캐쉬하여 요청에 대한 응답을 처리하는 옵션.<br>- enableMMAP:  Apache 서버에 접속 할때 웹문서의 로딩 중 내부문서인 파일을 메모리 매핑하여 처리하는 옵션.<br>-ExpiresActive :  Expires 헤더를 생성한다 이 지시어는 해당 영역에 대해 Expires와 Cache-Control 헤더를 생성할지 유무를 결정하는 옵션<br>-ExpiresDefault : 특정 MIME type에 대해서만 만기시간을 설정 할 수 있는 옵션.<br>- AllowEncodedSlashes : Determines whether encoded path separators in URLs are allowed to be passed through<br>- force-proxy-request-1.0 :   Forces the proxy to send requests to the backend as HTTP/1.0 and disables HTTP/1.1 features.<br>-proxy-nokeepalive :  Forces the proxy to close the backend connection after each request.<br>-proxy-initial-not-pooled :  If this variable is set, no pooled connection will be reused if the client request is the initial request on the frontend connection. This avoids the &quot;proxy: error reading status line from remote server&quot; error message caused by the race condition that the backend server closed the pooled connection after the connection check by the proxy and before data sent by the proxy reached the backend.<br>-proxy-sendchunked or proxy-sendchunks : It allows request bodies to be sent to the backend using chunked transfer encoding.<br><br><publishedDate>2017-11-13T04:40:15Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Kxn8xIAB"><br>======================<br><b>생성계정 : Won, Ted</b><br><b>생성날짜 : 2017-11-13T02:27:35Z</b><br><b>마지막 답변자 : Won, Ted</b><br><b>마지막 수정 일자 : 2017-11-13T02:27:35Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>문의하신 설정의 의미에 관하여 Apache 공식 문서[1]와 글로벌 엔지니어의 도움말을 참고하여 답변 드립니다.<br><br>AcceptFilter는 http과 https등과 같은 socket 통신 사용시 platform native 최적화 기능을 사용할 것이냐 사용하지 않을 것이냐의 설정입니다. Linux에서는 기본값으로 AcceptFilter http data, AcceptFilter https data 가 적용되며, &quot;none&quot; 옵션 사용시는 platform native 최적화 기능을 사용하지 않겠다는 설정입니다.<br>AcceptFilter Directive[1]:<br>~~~<br>Description:<br>Configures optimizations for a Protocol's Listener Sockets<br><br>This directive enables operating system specific optimizations for a listening socket by the Protocol type. The basic premise is for the kernel to not send a socket to the server process until either data is received or an entire HTTP Request is buffered. Only FreeBSD's Accept Filters, Linux's more primitive TCP_DEFER_ACCEPT, and Windows' optimized AcceptEx() are currently supported.<br>Using none for an argument will disable any accept filters for that protocol. This is useful for protocols that require a server send data first, such as ftp: or nntp:<br>AcceptFilter nntp none<br>~~~<br><br>AcceptFilter http none, AcceptFilter https none:<br>~~~<br>It will disable any accept filters for http and https protocols.<br>~~~<br><br>특히 Linux상에서는 none을 제외한 모든 설정에서 TCP_DEFER_ACCEPT가 enable됩니다. TCP_DEFER_ACCEPT 설정은 socket에 실제로 데이터들어 오는 경우에만 동작하도록 하는 성능 최적화 옵션입니다. 자세한 내용은 [2],[3]을 참조하실 수 있습니다.<br>side effect 관련하여서는, 실제로 데이터 전송이 없는 경우에도 많은 수의 socket이 열려서 동작하므로써 성능 저하가 발생할 수 있습니다.<br>~~~<br>On linux, any option beside none enables TCP_DEFER_ACCEPT, which means &quot;Allows a listener to be awakened only when data arrives on the socket.  Takes an integer value (seconds),  this  can  bound  the maximum  number  of  attempts  TCP  will make to complete the connection.  This option should not be used in code intended to be portable.&quot; Refer [2] .<br><br>So if the value is set to none which means TCP_DEFER_ACCEPT is disabled then there will most likely be a performance degradation as the system will have a large number of sockets that perpetually stay open with no data being transmitted.<br>~~~<br><br><br>감사합니다.<br><br>[1] https://httpd.apache.org/docs/2.4/mod/core.html#acceptfilter<br>[2] http://man7.org/linux/man-pages/man7/tcp.7.html<br>[3] https://www.techrepublic.com/article/take-advantage-of-tcp-ip-options-to-optimize-data-transmission/<br><br><publishedDate>2017-11-13T02:27:35Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxSb1IAF"><br>======================<br><b>생성계정 : Won, Ted</b><br><b>생성날짜 : 2017-11-10T01:47:54Z</b><br><b>마지막 답변자 : Won, Ted</b><br><b>마지막 수정 일자 : 2017-11-10T01:47:53Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>현재 문의하신 내용을 자세히 살펴보는 중입니다만, 해당 내용은 Red Hat 공식 문서 또는 solution article에서 찾을 수 없어서 <br><br>현재 글로벌 Red Hat Web Servers speciality group 에 문의한 상태입니다. 답변이 확인이 되는데로 업데이트 하도록 하겠습니다.<br><br>하루 정도 시간이 걸릴 수 있는 점 양해부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-10T01:47:53Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxSYlIAN"><br>======================<br><b>생성계정 : Won, Ted</b><br><b>생성날짜 : 2017-11-10T01:43:40Z</b><br><b>마지막 답변자 : Won, Ted</b><br><b>마지막 수정 일자 : 2017-11-10T01:43:40Z</b><br><br>[Red Hat Internal Collaboration Note: #sbr-webservers]<br><br>* Environment:<br> + RHEL 7.2<br> + httpd-2.4.6-40.el7.x86_64<br> + SAP netweaver 7.x<br><br>* Question:<br>By the configuration as below:<br>##<br>AcceptFilter http none<br>AcceptFilter https none<br>##<br><br>Customer question is<br>1. What is the meaning of the configuration ?<br>2. Is there any result include side effect ?<br><br>I referred [1] for the no.1 question. I understood by using AcceptFilter, enabling operating system specific optimizations for a listening socket http and https, however, with &quot;none&quot; it makes disabled(like off) operating system specific optimizations feature.<br>Can someone confirm this and provide any possible specific side effect for this configuration ?<br>Thanks in advanced<br><br>[1] https://httpd.apache.org/docs/2.4/mod/core.html#acceptfilter<br><br><publishedDate>2017-11-10T01:43:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxRwhIAF"><br>======================<br><b>생성계정 : Won, Ted</b><br><b>생성날짜 : 2017-11-10T00:22:46Z</b><br><b>마지막 답변자 : Won, Ted</b><br><b>마지막 수정 일자 : 2017-11-10T00:22:46Z</b><br><br>안녕하세요<br>  <br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br>  <br>저는 원종석이라고 하고 앞으로 이 케이스를 담당하게 되었습니다.<br>  <br>현재 이 케이스의 내용을 자세히 살펴보는 중이며, 곧 업데이트 하도록 하겠습니다.<br>  <br>감사합니다.<br>  <br>Best Regards,<br>Ted Won<br>Senior Software Maintenance Engineer<br>Red Hat Global Support Services<br><br><publishedDate>2017-11-10T00:22:46Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>