======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2019-02-22T04:01:32Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2019-03-13T04:25:26Z</b><br><b>id : 5002K00000dHLoIQAW</b><br>======================<br><br><b><font size=15>
제목  : ulimit openfile관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까 타임게이트 오선우입니다<br>타임게이트 / 오선우 / 수석보 / 010-4630-3171 / sw.oh@time-gate.com<br><br>고객이 ulimit관련하여 문의사항이 있어 문의드립니다<br><br><br>1. ulimit에 보면 openfile개수 설정시 최대값이 따로 있는건가요?<br><br>2. openfile 이 ulimit 설정시 해당 계정으로 생성되는 프로세스가 생성할수 있는 최대 갯수라고 생각하면 되는건가요?<br><br>3. 검색을 해보면 fs.file-max와 fs.file-nr 파라미터와 연관성이 있는것 같은데요 <br>연관관계에 대해서 설명 부탁드립니다<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>-</hostname><br><br><br><comment id="a0a2K00000PPddNQAT"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-02-25T06:04:13Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-02-25T06:11:20Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br>확인된 내용 업데이트해 드리겠습니다.<br><br>사용자가 별도로 /proc/sys/fs/file-max 에 설정하지 않으면,<br><br>fs.file-max 값은 아래 공식에 의해 커널이 결정을 합니다. 메모리 사이즈의 약 10분의 1 정도 됩니다.<br>fs.file-max = _PHYS_PAGES * ( PAGE_SIZE / 1024 ) / 10<br><br>위 인자들은 아래 명령을 통해 확인 가능합니다.<br># getconf -a | grep PAGES<br>PAGESIZE                           4096<br>_PHYS_PAGES                        XXXXXXX<br><br># sysctl fs.file-max<br>- 기본값 : random (시스템 메모리 사이즈에 따라 다름, 위 계산공식에 근거하여 설정)<br>- 최대값 : 2^32-1<br>- 시스템에서 최대 오픈할 수 있는 파일(FD) 수<br><br># sysctl fs.nr_open<br>- 기본값 : 1048576<br>- 최대값 : 3^32-63<br>- 하나의 프로세스당 최대 오픈할 수 있는 파일(FD) 수<br><br># ulimit -n<br>- 기본값 : 1024<br>- 최대값 : fs.nr_open (fs.nr_open보다 작거나 같아야 함)<br>- 일반 계정(root 제외)의 프로세스(세션)별 최대 오픈할 수 있는 파일(FD) 수<br><br>즉, 아래와 같은 관계로 볼 수 있습니다.<br>fs.file-max &gt; fs.nr_open &gt; ulimit <br><br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-02-25T06:04:12Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PPdWbQAL"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-02-25T05:56:26Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-02-25T05:56:26Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>문의주신 내용 확인하여 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br>김마현 드림.<br><br><publishedDate>2019-02-25T05:56:26Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000PPbfdQAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2019-02-25T02:14:00Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2019-02-25T02:14:00Z</b><br><br>자세한 답변 감사합니다<br><br>내용 중 한가지 문의사항 추가로 드립니다<br><br>fs.file-max 값이 결정되는것은 어떠한 조건으로 결정되는건가요? 메모리 size와 관련이 있는것 같은데요<br><br>결정되는 조건과 해당 file-max값의 최대값이 따로 있는건가요?  openfile 설정시 file-max를 초과되도록 설정하면 안되는건가요?<br><br>추가확인 부탁드립니다<br><br>감사합니다<br><br><publishedDate>2019-02-25T02:14:00Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0a2K00000PPJVmQAP"><br>======================<br><b>생성계정 : Kim, Mahyun</b><br><b>생성날짜 : 2019-02-22T07:14:50Z</b><br><b>마지막 답변자 : Kim, Mahyun</b><br><b>마지막 수정 일자 : 2019-02-22T07:14:50Z</b><br><br>안녕하세요. Red Hat 김마현입니다.<br><br>문의주신 내용에 대해 안내해 드리겠습니다.<br><br>1. ulimit에 보면 openfile개수 설정시 최대값이 따로 있는건가요?<br>&gt;&gt; unlimit 설정 시 fs.file-max 의 최대값 만큼 open 가능합니다.<br><br>2. openfile 이 ulimit 설정시 해당 계정으로 생성되는 프로세스가 생성할수 있는 최대 갯수라고 생각하면 되는건가요?<br>&gt;&gt; 해당 계정으로 open 할 수 있는 FD(File Discriptor) 입니다.<br><br>3. 검색을 해보면 fs.file-max와 fs.file-nr 파라미터와 연관성이 있는것 같은데요 <br>&gt;&gt;<br>fs.file-max 값<br>/proc/sys/fs/file-max (sysctl의 fs.file-max) 값 : 시스템 전체에서 열수 있는 파일 수(파일 디스크립터)<br><br>file-nr 은 현행 오픈된 FD 수와 최대 FD 수(fs.file-max)에 대한 정보를 가진 값 입니다.<br># cat /proc/sys/fs/file-nr<br>896     0       146060<br>|        |            |<br>|        |            최대 오픈 파일 디스크립터 수(fs.file-max)<br>|        할당되지 않은 파일 디스크립터 수(Kernel 2.6 이상에선 0으로만 표기)<br>할당된 파일 디스크립터 수<br><br>아래는 man page 원문입니다.<br># cat /proc/sys/fs/file-nr<br>896     0       146060<br>The file-nr file displays three parameters:<br>the total allocated file handles.<br>the number of currently used file handles (with the 2.4 kernel); or the number of currently unused file handles (with the 2.6 kernel).<br>the maximum file handles that can be allocated (also found in /proc/sys/fs/file-max). <br><br>감사합니다.<br><br><publishedDate>2019-02-22T07:14:50Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>