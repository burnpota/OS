======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-07-09T02:06:59Z</b><br><b>마지막 답변자 : Xingbin Li</b><br><b>마지막 수정 일자 : 2018-07-25T07:37:53Z</b><br><b>id : 500A000000bBTWGIA4</b><br>======================<br><br><b><font size=15>
제목  : oracle RAC(ASM) bonding 구성시 문의사항
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까 타임게이트 오선우입니다<br><br>하기와 같이 RHEL 에 bonding 구성시 아래와 같은 현상이 발생했습니다<br><br>oracle쪽에 문의는 진행중이나 OS단에 이슈되거나 해당 관련 사례가 있는지 확인 부탁드립니다<br><br>sosreport가 필요하시면 말씀해주시면 추가 업로드하도록 하겠습니다<br><br>감사합니다<br><br><br>----------------------<br>7월 8일 삼성생명 네트워크 스위치 작업이 있었습니다.<br><br> <br><br>Redhat + Oracle RAC(ASM) 구성된 서버들에서 조금 이슈가 발생했었는데요.<br><br> <br><br>관련해서 어제 연락드렸었는데 아래 SLPHPSDL02 서버의 예를 들면 bond0 (p3p1,p4p4) 구성된 서버에서<br><br>p4p4가 down이 되었는데 ntpd에 의해 체크된 메세지를 보면 Oracle RAC(ASM)에서 가동되어있는 VIP가 bond0/bond1에서 둘다 삭제가된 것 처럼 보이는데요.<br><br> <br><br>bond0 구성된 구조에서 1라인이 절체되어있을 때 다른 라인은 살아있는데 vip에 영향을 받는 것 관련해서 맞는 상황인지 문의드리려고 합니다.<br><br>이 부분은 추가로 oracle쪽에도 문의를 진행할 수 있도록 하겠습니다. OS 상황에서 일단 사례나 그런 부분을 문의드리려고 합니다.<br><br> <br><br> - /var/log messages 내용<br><br>Jul  8 08:21:43 SLPHPSDL02 kernel: tg3 0000:82:00.3: p4p4: Link is down<br>Jul  8 08:21:43 SLPHPSDL02 kernel: bond0: link status definitely down for interface p4p4, disabling it<br><br>(vip도 down 예상)<br>Jul  8 08:22:14 SLPHPSDL02 ntpd[10214]: Deleting interface #21 bond0:1, 100.254.55.202#123, interface stats: received=0, sent=0, dropped=0, active_time=5352330 secs<br>Jul  8 08:22:21 SLPHPSDL02 ntpd[10214]: Deleting interface #20 bond1:1, 169.254.3.112#123, interface stats: received=0, sent=0, dropped=0, active_time=5352365 secs<br><br>Jul  8 08:29:45 SLPHPSDL02 kernel: tg3 0000:82:00.3: p4p4: Link is up at 1000 Mbps, full duplex<br>Jul  8 08:29:45 SLPHPSDL02 kernel: tg3 0000:82:00.3: p4p4: Flow control is off for TX and off for RX<br>Jul  8 08:29:45 SLPHPSDL02 kernel: tg3 0000:82:00.3: p4p4: EEE is disabled<br>Jul  8 08:29:45 SLPHPSDL02 kernel: bond0: link status definitely up for interface p4p4, 1000 Mbps full duplex<br><br> <br><br> - SLPHPSDL02 네트워크 구성 (bond0)<br><br>root@SLPHPSDL02 /var/log # cat /proc/net/bonding/bond0<br>Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)<br><br>Bonding Mode: fault-tolerance (active-backup)<br>Primary Slave: None<br>Currently Active Slave: p3p1<br>MII Status: up<br>MII Polling Interval (ms): 100<br>Up Delay (ms): 0<br>Down Delay (ms): 0<br><br>Slave Interface: p3p1<br>MII Status: up<br>Speed: 1000 Mbps<br>Duplex: full<br>Link Failure Count: 0<br>Permanent HW addr: 00:0a:f7:8d:dd:30<br>Slave queue ID: 0<br><br>Slave Interface: p4p4<br>MII Status: up<br>Speed: 1000 Mbps<br>Duplex: full<br>Link Failure Count: 0<br>Permanent HW addr: 00:0a:f7:8e:8e:e7<br>Slave queue ID: 0<br><br> <br><br>root@SLPHPSDL02 /root # cat /proc/net/bonding/bond1<br>Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)<br><br>Bonding Mode: fault-tolerance (active-backup)<br>Primary Slave: None<br>Currently Active Slave: p3p2<br>MII Status: up<br>MII Polling Interval (ms): 100<br>Up Delay (ms): 0<br>Down Delay (ms): 0<br><br>Slave Interface: p3p2<br>MII Status: up<br>Speed: 1000 Mbps<br>Duplex: full<br>Link Failure Count: 0<br>Permanent HW addr: 00:0a:f7:8d:dd:31<br>Slave queue ID: 0<br><br>Slave Interface: p4p3<br>MII Status: up<br>Speed: 1000 Mbps<br>Duplex: full<br>Link Failure Count: 0<br>Permanent HW addr: 00:0a:f7:8e:8e:e6<br>Slave queue ID: 0<br><br> <br><br> - reference<br><br>https://access.redhat.com/solutions/261123<br><br> <br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPHPSDL02</hostname><br><br><br><comment id="a0aA000000NI3O0IAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-25T07:37:50Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-25T07:37:50Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>오랜기간동안 본 케이스에 관련해 추가 문의사항이 없으셔서 본 케이스를 close 처리 하려고 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기 신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-07-25T07:37:50Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NAnMtIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-11T02:00:43Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-11T02:00:43Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 추가적으로 문의하실 사항이 있으신가요?<br><br>본 안내 후 일정기간 답변이 없다면 본 케이스는 자동으로 종료 상태가 됨을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하시다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-11T02:00:43Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NAEaDIAX"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-09T06:40:34Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-09T06:40:34Z</b><br><br>안녕하세요, 오선우님<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>만약 OS단에서 bonding 인터페이스의 동작에 문제가 없는 경우: 예를 들어 본딩의 active-backup 동작이<br>제대로 작동한다면 (active slave를 down 시켜도 backup slave로 정상적으로 페일오버가 되고 bond0:X 인터페이스도 정상일경우)<br>RHEL 측에서는 더 확인할 사항은 없을 것으로 보입니다. <br><br>만약 해당 메세지와 함께 클러스터 서비스에 장애가 발생된다면 오라클 쪽으로 문의를 하시는 것이 좋을 것 같습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-09T06:40:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NAEC1IAP"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-09T06:06:56Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-09T06:06:56Z</b><br><br>안녕하십니까 타임게이트 오선우입니다<br><br>답변 감사합니다<br><br>위와 같은 해당 상황에서 bonding 구성상황에서 bonding구성된 한쪽 노드가 절체되었을 경우<br><br>vip에 영향도가 있을까요?<br><br>아니면 이것은 오라클RAC 구성상에서 확인해야 하는 것인가요?<br><br><publishedDate>2018-07-09T06:06:56Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NAD5tIAH"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-09T03:27:41Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-09T03:27:40Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>Message similar to &quot;ntpd Deleting interface #16 ethX:1 , x.x.x.x#123&quot; in /var/log/messages<br>https://access.redhat.com/solutions/261123<br><br>보내주신 링크에서 직접 확인 하셨겠지만 가상 디바이스가 다운, 업 되었을 경우 해당 메세지가 발생할 수 있습니다만,<br>기존 사례 등을 보면, 해당 가상 디바이스를 사용하는 어플리케이션의 서비스 재기동 등에 의해 발생한 경우가 보고되어 있습니다.<br>예를 들어, 오라클의 CRS 데몬 재기동시에 발생할 수 있습니다.<br><br><br>감사합니다.<br><br><publishedDate>2018-07-09T03:27:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NACqiIAH"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-09T02:52:18Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-09T02:52:18Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>저는 이성빈이라고 하며 본 케이스를 담당하게 되었습니다.<br>현재 문의주신 내용에 관련해 확인 중에 있으며 답변이 정리되는대로 코멘트를 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-09T02:52:18Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>