======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-01-12T01:46:59Z</b><br><b>마지막 답변자 : 타임게이트 타임게이트</b><br><b>마지막 수정 일자 : 2018-01-23T00:28:43Z</b><br><b>id : 500A000000ZQYaBIAX</b><br>======================<br><br><b><font size=15>
제목  : pacemaker, fence_scsi 구성 방식 관련 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요, <br>fence_scsi 구성 방식에 대해 문의드립니다.<br><br>fencing device 추가 시 아래 방법들 중 어떤 방식으로 하는것이 맞는지, 그리고 이유에 대해서 가이드 부탁드립니다.<br>예전 다른 이슈와 관련하여 케이스를 오픈했을 때, <br>&quot; &lt;1.&gt; 방식으로 구축하게되면 key값이 두번 들어가게 되어 문제가 생길 수 있으니 &lt;2.&gt; 방식으로 설정하라 &quot; 라고 답변을 받았었는데요,  자체적으로 테스트 한 결과  &lt;1.&gt; 방식으로 구축하여도 reservation key 관련하여 문제가 발생한 점은 없었습니다.<br><br>&lt;1.&gt;<br>pcs stonith create scsi fence_scsi pcmk_host_list=&quot;node1-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot; delay=15<br>pcs stonith create scsi1 fence_scsi pcmk_host_list=&quot;node1-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot;<br>pcs constraint location scsi avoids node1-hb <br>pcs constraint location scsi1 avoids node2-hb <br><br><br>&lt;2.&gt;<br>pcs stonith create scsi fence_scsi pcmk_host_list=&quot;node1-hb;node2-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot;<br><br><br>&lt;1&gt; 방식으로 구축한 테스트 결과입니다. (iscsi 로 shared volume 구성) <br>Stack: corosync<br>Current DC: node2-hb (version 1.1.16-12.el7-94ff4df) - partition with quorum<br>Last updated: Fri Jan 12 10:36:38 2018<br>Last change: Fri Jan 12 10:36:35 2018 by root via cibadmin on node1-hb<br><br>2 nodes configured<br>6 resources configured<br><br>Online: [ node1-hb node2-hb ]<br><br>Full list of resources:<br><br> Resource Group: grp<br>     VIP        (ocf::heartbeat:IPaddr2):<br>Started node1-hb<br>     VG (ocf::heartbeat:LVM):   Started node1-hb<br>     FS (ocf::heartbeat:Filesystem):    Started node1-hb<br>     NTP        (lsb:ntp.sh):   Started node1-hb<br>scsi    (stonith:fence_scsi):   Started node2-hb<br>scsi2   (stonith:fence_scsi):   Started node1-hb<br><br>Negative Location Constraints:<br> location-scsi2-node2-hb--INFINITY<br>prevents scsi2 from running on node2-hb<br> location-scsi-node1-hb--INFINITY<br>prevents scsi from running on node1-hb<br><br><br>[root@node1 ~]# sg_persist -i -k /dev/sdb<br>  LIO-ORG   storage           4.0<br>  Peripheral device type: disk<br>  PR generation=0x6, 2 registered reservation keys follow:<br>    0xfb0c0000<br>    0xfb0c0001<br><br>key 값은 &lt;1&gt; , &lt;2&gt; 방식 모두 결과가 동일합니다.<br><br><br>확인 부탁드립니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.4</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 4 (Low)</b><br><br><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-01-15T02:02:17Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-01-15T02:02:17Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>&gt; 예전 다른 이슈와 관련하여 케이스를 오픈했을 때, <br>&gt; &quot; &lt;1.&gt; 방식으로 구축하게되면 key값이 두번 들어가게 되어 문제가 생길 수 있으니 &lt;2.&gt; 방식으로 설정하라 &quot; 라고 답변을 받았었는데요,<br>&gt; 자체적으로 테스트 한 결과  &lt;1.&gt; 방식으로 구축하여도 reservation key 관련하여 문제가 발생한 점은 없었습니다.<br><br>이슈 상황에 대하여 명확하게 파악하기 위해 상기 말씀하신 케이스 번호를 남겨주시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-15T02:02:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LMEi6IAH"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-01-12T08:44:23Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-01-12T08:44:22Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>저는 신재욱 차장이라고 하며 앞으로 해당 케이스를 담당하게 되었습니다.<br><br>현재 케이스 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-12T08:44:22Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>fence_scsi 구성 방식에 대해 문의드립니다.<br><br>fencing device 추가 시 아래 방법들 중 어떤 방식으로 하는것이 맞는지, 그리고 이유에 대해서 가이드 부탁드립니다.<br>예전 다른 이슈와 관련하여 케이스를 오픈했을 때, <br>&quot; &lt;1.&gt; 방식으로 구축하게되면 key값이 두번 들어가게 되어 문제가 생길 수 있으니 &lt;2.&gt; 방식으로 설정하라 &quot; 라고 답변을 받았었는데요,  자체적으로 테스트 한 결과  &lt;1.&gt; 방식으로 구축하여도 reservation key 관련하여 문제가 발생한 점은 없었습니다.<br><br>&lt;1.&gt;<br>pcs stonith create scsi fence_scsi pcmk_host_list=&quot;node1-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot; delay=15<br>pcs stonith create scsi1 fence_scsi pcmk_host_list=&quot;node1-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot;<br>pcs constraint location scsi avoids node1-hb <br>pcs constraint location scsi1 avoids node2-hb <br><br><br>&lt;2.&gt;<br>pcs stonith create scsi fence_scsi pcmk_host_list=&quot;node1-hb;node2-hb&quot; pcmk_reboot_action=&quot;off&quot; devices=&quot;/dev/vg01/lv01&quot; meta provides=&quot;unfencing&quot;<br><br><br>&lt;1&gt; 방식으로 구축한 테스트 결과입니다. (iscsi 로 shared volume 구성) <br>Stack: corosync<br>Current DC: node2-hb (version 1.1.16-12.el7-94ff4df) - partition with quorum<br>Last updated: Fri Jan 12 10:36:38 2018<br>Last change: Fri Jan 12 10:36:35 2018 by root via cibadmin on node1-hb<br><br>2 nodes configured<br>6 resources configured<br><br>Online: [ node1-hb node2-hb ]<br><br>Full list of resources:<br><br> Resource Group: grp<br>     VIP        (ocf::heartbeat:IPaddr2):<br>Started node1-hb<br>     VG (ocf::heartbeat:LVM):   Started node1-hb<br>     FS (ocf::heartbeat:Filesystem):    Started node1-hb<br>     NTP        (lsb:ntp.sh):   Started node1-hb<br>scsi    (stonith:fence_scsi):   Started node2-hb<br>scsi2   (stonith:fence_scsi):   Started node1-hb<br><br>Negative Location Constraints:<br> location-scsi2-node2-hb--INFINITY<br>prevents scsi2 from running on node2-hb<br> location-scsi-node1-hb--INFINITY<br>prevents scsi from running on node1-hb<br><br><br>[root@node1 ~]# sg_persist -i -k /dev/sdb<br>  LIO-ORG   storage           4.0<br>  Peripheral device type: disk<br>  PR generation=0x6, 2 registered reservation keys follow:<br>    0xfb0c0000<br>    0xfb0c0001<br><br>key 값은 &lt;1&gt; , &lt;2&gt; 방식 모두 결과가 동일합니다.<br><br><br>확인 부탁드립니다.<br><br>감사합니다.</issue><cep>false</cep></case>