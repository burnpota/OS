======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-01-10T01:13:50Z</b><br><b>마지막 답변자 : Xingbin Li</b><br><b>마지막 수정 일자 : 2018-01-26T08:42:17Z</b><br><b>id : 500A000000ZQDCIIA5</b><br>======================<br><br><b><font size=15>
제목  : [생명]네트워크 I/O 증가로 인한 서비스 지연
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br><br>해당 접속포탈 인증 서버의 네트워크 I/O 증가로 인해 <br><br>업무 서비스 지연으로 고객의 분석 및 구성 변경 요청이 왔습니다.<br><br>온튠 모니터링으로 17시를 기준으로 네트워크 IORate 가 크게 증가 합니다.<br><br>17년12월29,18년1월2일 -&gt; 서비스 응답 지연으로 인한 서버 재기동<br><br>18년1월3일,18년1월8일 -&gt; 서버 재기동 안함<br><br>현재 오라클 측에도 문의한결과 현재까지는 네트워크 이슈가 있다는 정도 입니다.<br><br>이런 이슈로 인하여 고객측에서 아래 파라미터 값을 다른 서버와 같은 파라미터 값<br><br>으로 수정하려고 합니다.<br><br>root@SLPOAMAL01 /root # sysctl -a | grep backlog <br>net.core.netdev_max_backlog = 1000<br>net.ipv4.tcp_max_syn_backlog = 2048 <br><br>root@PECCAL01SL /root # sysctl -a | grep backlog <br>net.core.netdev_max_backlog = 8192 <br>net.ipv4.tcp_max_syn_backlog = 8192 <br><br>파라미터 변경으로 해당 이슈와 시스템에 대한 영향도를 알고 싶습니다.<br><br>네트워크 관련 다른 파라미터 변경 권고값이 있다면 알려주시면 감사하겠습니다.<br><br>sosreport 첨부 합니다.<br><br>감사합니다.<br><br>해결 기간이나 업무에 미치는 영향에 대한 정보를 제공해 주시겠습니까?<br><br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 송기용 (책임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-9006-9506  <br>- 메일주소 : 송기용 &lt;kyyong.song@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민 (책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.6</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPOAMAL01, SLPOAMAL02</hostname><br><br><br><comment id="a0aA000000LXhb7IAD"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-01-26T08:42:14Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-01-26T08:42:14Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>마지막 안내후 일정기간동안 답변이 없으셔서 본 케이스를 close 처리 하려고 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-01-26T08:42:14Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LMZsJIAX"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-01-15T06:37:00Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-01-15T06:37:00Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2018-01-15T06:37:00Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LLc1QIAT"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-01-10T07:44:27Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-01-10T07:44:27Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>해당 커널 파라메터와 같이 변경해야 하는 커널파라메터는 없습니다.<br>대량의 패킷이 드롭되거나 에러가 발생하는 경우에 링버퍼 크기를 <br>조절하거나 다른 파라메터 값을 조절할 수 있지만 sosreport상으로 <br>봤을때 해당사항이 없어서 별도로 조절할 필요는 없는 것으로 보입니다.<br><br>본 케이스에 관련하여 추가적인 문의사항이 있다면 연락부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-10T07:44:27Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LLbdEIAT"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-01-10T07:06:07Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-01-10T07:06:06Z</b><br><br>답변 감사합니다.<br>이부분에 관해서는 올려주신 두 서버에서 발생했던 상황인가요?<br>-&gt; 두서버 같은 시간대에 발생했던 상황입니다.<br><br>추가로 아래 파라미터 값 변경시 같이 변경해야 하는 다른 파라미터가 있는지 알수 있을까요?<br><br>net.core.somaxconn = 8192<br>net.core.netdev_max_backlog = 8192 <br>net.ipv4.tcp_max_syn_backlog = 8192<br><br><publishedDate>2018-01-10T07:06:06Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LLbKqIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-01-10T06:40:24Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-01-10T06:40:23Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>아래는 문의주신 커널파라메터에 대한 안내가 되겠습니다.<br><br>net.core.netdev_max_backlog<br><br>해당 파라미터는 커널이 처리하는 속도보다 network interface에 들어오는 속도가 빠를 경우, <br>network interface단에서 임시 저장할 수 있는 최대 패킷 수를 표시합니다. <br>이는 일반적으로 동시에 들어오는 네트워크 connection 요청이 많을 경우 설정하게 됩니다. <br>해당값은 10000 이상 적용하시지 않을 것을 권장드립니다.<br>~~~ <br>netdev_max_backlog Maximum number of packets, queued on the INPUT side, <br>when the interface receives packets faster than kernel can process them. <br>~~~ <br><br>[1] What is 'netdev_max_backlog' and what is its optimal value ? <br>https://access.redhat.com/solutions/68589<br><br>net.ipv4.tcp_max_syn_backlog<br><br>해당 파라미터는 TCP 3 hand-shaking 과정에서 클라이언트가 처음으로 보내 SYN를 <br>서버에서 기록 할수 있는 최대치를 의미하고 있습니다. <br><br>~~~ <br>tcp_max_syn_backlog - INTEGER Maximal number of remembered connection <br>requests, which are still did not receive an acknowledgment from connecting <br>client. Default value is 1024 for systems with more than 128Mb of memory, <br>and 128 for low memory machines. If server suffers of overload, try to increase this number.<br>~~~ <br><br><br>net.core.somaxconn<br><br>서버에서 socket listen() backlog의 최대치를 지정 하는 파라미터입니다. <br><br>~~~ <br>somaxconn - INTEGER Limit of socket listen() backlog, known in <br>userspace as SOMAXCONN. Defaults to 128. See also tcp_max_syn_backlog <br>for additional tuning for TCP sockets. <br>~~~ <br><br>네트워크 관련 커널파라메터 튜닝은 실제 운영환경에 의존적이기 때문에 구체적인<br>수치는 제공해드리기 어려운점 양해의 말씀을 드리며 튜닝에 관한 내용은 <br>아래의 링크의 Performance Tunig 부분을 참고 하실수 있습니다.<br><br>Red Hat Enterprise Linux Network Performance Tuning Guide<br>https://access.redhat.com/articles/1391433<br><br>그리고 올려주신 sosreport를 보면 drop 되거나 error 가 발생한 패킷이 없는 것으로 보아<br>OS 단에서는 큰 문제는 없는 것으로 보입니다. <br><br>SLPOAMAL01-2018010915581515481103]# cat ifconfig <br>eth1      Link encap:Ethernet  HWaddr 00:50:56:BC:63:64  <br>          inet addr:100.254.170.97  Bcast:100.254.170.255  Mask:255.255.255.0<br>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>          RX packets:36064132240 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:36459926211 errors:0 dropped:0 overruns:0 carrier:0<br>SLPOAMAL02-2018010915581515481105]# cat ifconfig <br>eth2      Link encap:Ethernet  HWaddr 00:50:56:BC:0A:74  <br>          inet addr:100.254.170.98  Bcast:100.254.170.255  Mask:255.255.255.0<br>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1<br>          RX packets:33826855879 errors:0 dropped:0 overruns:0 frame:0<br>          TX packets:35001564076 errors:0 dropped:0 overruns:0 carrier:0<br><br>&gt;온튠 모니터링으로 17시를 기준으로 네트워크 IORate 가 크게 증가 합니다.<br><br>&gt;17년12월29,18년1월2일 -&gt; 서비스 응답 지연으로 인한 서버 재기동<br><br>&gt;18년1월3일,18년1월8일 -&gt; 서버 재기동 안함<br><br>이부분에 관해서는 올려주신 두 서버에서 발생했던 상황인가요?<br><br> <br><br>감사합니다.<br><br><publishedDate>2018-01-10T06:40:23Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LLYuQIAX"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-01-10T01:41:52Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-01-10T01:41:52Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>저는 이성빈이라고 하며 본 케이스를 담당하게 되었습니다.<br>현재 문의주신 내용을 자세히 살펴보고 있으며 답변이 정리되는 대로<br>코멘트를 업데이트 드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-10T01:41:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LLYtNIAX"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-01-10T01:40:43Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-01-10T01:40:43Z</b><br><br>추가로 아래 파라미터도 같이 변경 하려고 합니다.<br><br>3개 파라미터의 의미도 얄려주시면 감사하겠습니다.<br><br>root@SLPOAMAL01 /root # sysctl -a | grep somax<br>net.core.somaxconn = 128<br> <br>root@PECCAL01SL /root # cat /etc/sysctl.conf<br>net.core.somaxconn = 8192<br><br><publishedDate>2018-01-10T01:40:43Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br>해당 접속포탈 인증 서버의 네트워크 I/O 증가로 인해 <br><br>업무 서비스 지연으로 고객의 분석 및 구성 변경 요청이 왔습니다.<br><br>온튠 모니터링으로 17시를 기준으로 네트워크 IORate 가 크게 증가 합니다.<br><br>17년12월29,18년1월2일 -&gt; 서비스 응답 지연으로 인한 서버 재기동<br><br>18년1월3일,18년1월8일 -&gt; 서버 재기동 안함<br><br>현재 오라클 측에도 문의한결과 현재까지는 네트워크 이슈가 있다는 정도 입니다.<br><br>이런 이슈로 인하여 고객측에서 아래 파라미터 값을 다른 서버와 같은 파라미터 값<br><br>으로 수정하려고 합니다.<br><br>root@SLPOAMAL01 /root # sysctl -a | grep backlog <br>net.core.netdev_max_backlog = 1000<br>net.ipv4.tcp_max_syn_backlog = 2048 <br><br>root@PECCAL01SL /root # sysctl -a | grep backlog <br>net.core.netdev_max_backlog = 8192 <br>net.ipv4.tcp_max_syn_backlog = 8192 <br><br>파라미터 변경으로 해당 이슈와 시스템에 대한 영향도를 알고 싶습니다.<br><br>네트워크 관련 다른 파라미터 변경 권고값이 있다면 알려주시면 감사하겠습니다.<br><br>sosreport 첨부 합니다.<br><br>감사합니다.</issue><timeFramesAndUrgency>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 송기용 (책임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-9006-9506  <br>- 메일주소 : 송기용 &lt;kyyong.song@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민 (책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com</timeFramesAndUrgency><cep>false</cep></case>