======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-07-13T07:01:26Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2018-07-23T01:43:30Z</b><br><b>id : 500A000000bSyShIAK</b><br>======================<br><br><b><font size=15>
제목  : [문의]옵션 타임아웃 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요. <br> &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt;<br>   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt;<br> &lt;/quorumd&gt;<br> &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt;<br><br>&lt;cluster&gt;<br> &lt;totem token=&quot;75000&quot;/&gt;<br>&lt;/cluster&gt;<br><br>위와같은 설정을 추가하였는데요.<br>몇가지 옵션및 타임아웃 문의 드립니다.<br><br>1. 현재  &lt;totem token=&quot;75000&quot;/&gt; 로 설정이 되어있는데<br>노드들(쿼럼포함)에게 신호를 날리고 75초 안에 응답을 받지 못하면 해당 노드가 장애가 났다 판단하는 의미가 맞나요?<br><br>2.  &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt; 에서  quorum_dev_poll=&quot;75000&quot; 의미는 쿼럼에게 시그널을 날리는데 75초 안에 응답을 받지 못하면 문제가 있다고 판단하는 의미가 맞나요?<br><br>3.  &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt; 에서<br>3초를 주기로 SAN체크를 하는데 10번의 실패 카운트가 올라가면 장애가 났다고 판단하는 의미가 맞나요?<br><br>4.   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt; 에서도 3번과 마찬가지로 2초(default)간격으로 체크를 하는데 5번의 실패카운트가 올라가면 score가 0이되어 min_score값보다 작아져 리부팅 되는 것이 맞나요?<br><br>5.  &lt;totem token=&quot;75000&quot;/&gt; 값을 계산할때 쿼럼의 (interval*tko)*2 값보다 커야 하는 이유를 알수 있을까요??<br><br>감사합니다.<br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 송기용 (책임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  82-10-9006-9506 <br>- 메일주소 : 송기용 &lt;kyyong.song@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>구성정보문의<br><br>언제 문제가 발생했습니까? 이러한 문제가 자주 발생합니까? 반복적으로 발생합니까? 특정 시간에 발생합니까?<br><br>구성 후 타임아웃값문의<br><br>해결 기간이나 업무에 미치는 영향에 대한 정보를 제공해 주시겠습니까?<br><br>운영서버 DB서버<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.4</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>FLPIDMM01</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000NHQMgIAP"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-23T01:43:29Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-23T01:43:29Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>해당 케이스에 대하여 직접 close 처리해주셔서 감사합니다!!!<br><br>케이스가 처리 완료되면 고객 설문조사 메일이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-23T01:43:29Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NCbN0IAL"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-19T05:11:44Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-19T05:11:44Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>테스트하시는데 도움이 되도록 계산법에 대해서 남겨드립니다.<br><br>다음은 페일오버 전체가 끝나는 시간을 공식이라기보다는 최소 Totem token timeout 값을 구하는 공식입니다.<br><br>Totem's token timeout &gt;= interval * (tko + master_wait + upgrade_wait)+interval<br><br>interval = quorumd's interval  =&gt; * 단위는 초수 *<br>master_wait = floor(quormd's tko/2) =&gt; * 단위는 cycle 수 *<br>upgrade_wait = 2 =&gt; * 단위는 cycle 수 *<br><br>각 파라메터 정의)<br>====<br>upgrade_wait=&quot;2&quot;<br>This  is  the  number of cycles a node must wait before initiating a bid for master status after heuristic scoring becomes sufficient.  The default is 2.  This can not be set to 0, and should not exceed tko.<br><br>master_wait=&quot;X&quot;<br>This is the number of cycles a node must wait for votes before declaring itself master after making a bid.  Default is floor(tko/2).  This can not be less than 2, must be greater than tko_up, and should not exceed tko.<br>====<br><br>상기를 기반으로 계산해보면,<br><br>예)<br>====<br>        &lt;quorumd interval=&quot;3&quot; label=&quot;Qdisk&quot; min_score=&quot;1&quot; tko=&quot;5&quot;&gt; //tko 값변경<br>                &lt;heuristic program=&quot;ping -c1 -w1 10.1.0.1&quot; tko=&quot;5&quot;/&gt; <br>        &lt;/quorumd&gt;<br>====<br><br>interval == 3 sec<br>master_wait == floor(5/2) == 2 cycle<br>upgrade_wait == 2 cycle<br><br>Totem's token timeout &gt;= 3*(5+2+2)+3 == 30 sec == 30000 msec<br><br>즉, 토템 토큰 타임아웃의 최소값은 적어도 30000 이 되어야하는 것을 나타냅니다.<br><br>====<br>제가 궁금한 것은 75초일 상황에서는 게이트웨이와 통신이 안된다는 상황일때 2*5=10초 최소85초후에 펜싱후 페일오버가 되어야 하는데  그전에 펜싱이 되는점 마찬가지로<br>45초일때는 55초후에 펜싱후 페일오버가 되야하는데 그전에 펜싱이 되는고 페일오버가 되어야하는데 시간이 안맞네요...<br>왜 그럴까요? 이게 환경에 따라서 값이 다른 부분인거 같기두 하고요...<br>====<br><br>상기 질문 하신 내용이 다소 이해가 안되서 확인요청 드립니다.<br>&quot;그전에 펜싱이 되는점&quot; 이라는게 무엇을 말씀하시는 것인가요?<br>nic 를 내려서 heuristic 체크가 실패하면 다운그레이딩 되면서 상대에 의한 펜싱이 아닌 스스로 재부팅되었을 것으로 예상됩니다만.<br>====<br>예) node01 의 Heuristic 프로그램에 이상이 감지 되었을 경우.<br><br>Jul 19 11:14:03 node01 qdiskd[xxxx]: Heuristic: 'ping -c1 -w1 xxxx.xxx.xxx.xxx' DOWN (3/3)<br>Jul 19 11:14:03 node01 corosync[xxxx]:   [QUORUM] Members[2]: 1 2<br>Jul 19 11:14:03 node01 fenced[xxxx]: node_history_cluster_remove no nodeid 0<br>Jul 19 11:14:03 node01 qdiskd[xxxx]: Score insufficient for master operation (0/1; required=1); downgrading<br>===&gt; 재부팅 발생<br>====<br><br>현 단계에서는 이때까지 안내드린 내용을 토대로 다시한번 정리 테스트해보시고 궁금하신 내용을 다시 정리해서 올려주실 필요가 있어보입니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-19T05:11:44Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NCJ45IAH"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-18T05:38:38Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-19T03:58:17Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>해당 케이스는 저희 클러스터 전문 그룹의 개발자인 Zimek 의 도움을 받아 진행하고 있습니다.(Thanks, Zimek)<br><br>우선, 네트워크,스토리지 등 사용 환경에 의존적인 부분이 있어 실제로 테스트를 통해 값을 도출하는 것이<br>가장 좋은 방법임을 말씀드립니다.<br><br>&gt; 1. 만약 쿼럼의 장애로 문제가 발생다면 페일오버가(장애 판정부터 서비스가 다른노드에서 액티브가 되는 시간)을 계산해보면<br>&gt; 3*(10+2+5)+3=45초 가되나요? -&gt; upgrade_wait=2초/ time_wait=floor(tko/2)=5초<br><br>예를 들어 node1 에 쿼럼 장애가 인식되면 quorumd 의 상태를 interval 과 tko 만큼 체크하게 됩니다.<br>이 결과 실패하면, node2 는 qdisk 상에 node1 이 evict 되었다고 마크하며<br>동시에 node2 에 의해 node1 의 cman 이 kill 됩니다.<br>이후, node2 상에 node1 에 대한 totem 타임아웃 시간(75초)이 초과하게 되면 node1 을 펜싱하게 됩니다.<br>정상적으로 펜싱이 완료된 후, node2 상에서 서비스들이 액티브되기 시작합니다.<br><br>&gt; 2. 휴스트릭 장애가 발견되어 해당노드가 펜싱되는 시간?<br>&gt; 3*5=15초 인가요?<br><br>3초간격으로 5번 연속 실패하면(15초) 상대 노드에 의해서 펜싱되는 것이 아닌 스스로 시스템을 리부팅 처리하게 됩니다.<br>이 때 실제 시스템 리부팅을 위해 커널에 의한 일부 처리(디바이스 정지, 캐쉬 동기화 등)가 필요하므로 실제로는 15초보다 더 걸릴 수도 있습니다.<br>휴리스틱으로 재부팅 후, 리조인 시간이 totem 타임아웃 시간(75초)을 초과하면 추가로 상대노드에 의해 펜싱까지 걸리게 됩니다. <br><br>&gt; 3. 만약 노드의 문제로 페일오버되는 시간은 어떻게 계산하는지 알고 싶습니다.<br><br>이는 totem token 시간(75초)에 주로 영향을 받습니다만 문제 발생 노드에 대한 펜싱이 성공해야<br>페일오버가 되므로 실제테스트를 통해 정확한 시간을 도출해야 합니다.<br><br>우선 7/16일자로 문의하신 내용에 대하여 확인한 내용을 답변 드립니다.<br>금일 문의하신 내용에 대해서는 추가 확인 후 연락드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-18T05:38:38Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NCa34IAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-19T01:56:41Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-19T01:56:40Z</b><br><br>안녕하세요. <br>제가 현재 <br>        &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;&gt;<br>                &lt;multicast addr=&quot;239.192.170.205&quot;/&gt;<br>        &lt;/cman&gt;<br>   ...생략<br>        &lt;quorumd interval=&quot;3&quot; label=&quot;Qdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot;&gt;<br>                &lt;heuristic program=&quot;ping -c1 -w1 10.1.0.1&quot; tko=&quot;5&quot;/&gt;<br>        &lt;/quorumd&gt;<br>        &lt;totem token=&quot;75000&quot;/&gt;<br>이런식으로 구성되어있는 상태에서 테스트 해보았습니다.<br>RRP는 구성되어있지 않고 서비스망과 헛빗망을 같은 대역으로 사용중인 구성입니다.<br>ifdown을 하게되면 게이트웨이와 통신이 되지 않는 구성입니다.<br><br>현재 상태에서 서비스망&amp;헛빗망을 ifdown을 해보니<br>ifdown 시간 - 10:12:14<br>Jul 19 10:13:03 node1 kernel: rport-4:0-9: blocked FC remote port time out: removing rport<br>Jul 19 10:13:03 node1 kernel: rport-4:0-8: blocked FC remote port time out: removing rport<br>Jul 19 10:13:03 node1 kernel: rport-3:0-9: blocked FC remote port time out: removing rport<br>Jul 19 10:13:03 node1 kernel: rport-3:0-8: blocked FC remote port time out: removing rport<br>Jul 19 10:13:04 node1 qdiskd[4029]: Writing eviction notice for node 2<br>Jul 19 10:13:07 node1 qdiskd[4029]: Node 2 evicted<br>Jul 19 10:13:26 node1 corosync[3976]:   [TOTEM ] A processor failed, forming new configuration.<br>Jul 19 10:13:28 node1 corosync[3976]:   [QUORUM] Members[1]: 1<br>Jul 19 10:13:28 node1 corosync[3976]:   [TOTEM ] A processor joined or left the membership and a new <br><br>membership was formed.<br>Jul 19 10:13:28 node1 corosync[3976]:   [CPG   ] chosen downlist: sender r(0) ip(10.1.0.200) ; members(old:2 <br><br>left:1)<br>Jul 19 10:13:28 node1 kernel: dlm: closing connection to node 2<br>Jul 19 10:13:28 node1 corosync[3976]:   [MAIN  ] Completed service synchronization, ready to provide service.<br>Jul 19 10:13:28 node1 fenced[4201]: fencing node node2-hb<br>Jul 19 10:13:28 node1 fenced[4201]: fence node2-hb success<br>Jul 19 10:13:29 node1 rgmanager[28198]: Taking over service service:C1-SERVICE from down member node2-hb<br>Jul 19 10:13:31 node1 rgmanager[18791]: [fs] mount -t ext4 -o rw,nobarrier /dev/dm-2 /data<br>Jul 19 10:13:31 node1 kernel: EXT4-fs (dm-2): barriers disabled<br>Jul 19 10:13:31 node1 kernel: EXT4-fs (dm-2): warning: maximal mount count reached, running e2fsck is <br><br>recommended<br>Jul 19 10:13:31 node1 kernel: EXT4-fs (dm-2): recovery complete<br>Jul 19 10:13:31 node1 kernel: EXT4-fs (dm-2): mounted filesystem with ordered data mode. Opts:<br>Jul 19 10:13:34 node1 rpc.mountd[19022]: Version 1.2.3 starting<br>Jul 19 10:13:34 node1 ntpd[2046]: Listening on interface #8 eth0, 10.1.0.206#123 Enabled<br>Jul 19 10:13:34 node1 kernel: NFSD: Using /var/lib/nfs/v4recovery as the NFSv4 state recovery directory<br>Jul 19 10:13:34 node1 kernel: NFSD: starting 90-second grace period<br>Jul 19 10:13:34 node1 rgmanager[28198]: Service service:C1-SERVICE started<br>발생후 서비스가 넘어갔습니다.<br><br>마찬가지로 <br>        &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;45000&quot;&gt;  //quorum_dev_poll 변경<br>                &lt;multicast addr=&quot;239.192.170.205&quot;/&gt;<br>        &lt;/cman&gt;<br>   ...생략<br>        &lt;quorumd interval=&quot;3&quot; label=&quot;Qdisk&quot; min_score=&quot;1&quot; tko=&quot;5&quot;&gt; //tko 값변경<br>                &lt;heuristic program=&quot;ping -c1 -w1 10.1.0.1&quot; tko=&quot;5&quot;/&gt; <br>        &lt;/quorumd&gt;<br>        &lt;totem token=&quot;45000&quot;/&gt; //totem token 값변경<br>을 한후 다시 ifdown을 하였습니다.<br>ifdown 시간 - 10:30:34<br><br>Jul 19 10:31:03 node1 qdiskd[2496]: Writing eviction notice for node 2<br>Jul 19 10:31:06 node1 qdiskd[2496]: Node 2 evicted<br>Jul 19 10:31:16 node1 kernel: rport-4:0-3: blocked FC remote port time out: removing rport<br>Jul 19 10:31:16 node1 kernel: rport-4:0-4: blocked FC remote port time out: removing rport<br>Jul 19 10:31:16 node1 kernel: rport-3:0-2: blocked FC remote port time out: removing rport<br>Jul 19 10:31:16 node1 kernel: rport-3:0-3: blocked FC remote port time out: removing rport<br>Jul 19 10:31:19 node1 corosync[2443]:   [TOTEM ] A processor failed, forming new configuration.<br>Jul 19 10:31:21 node1 corosync[2443]:   [QUORUM] Members[1]: 1<br>Jul 19 10:31:21 node1 corosync[2443]:   [TOTEM ] A processor joined or left the membership and a new <br><br>membership was formed.<br>Jul 19 10:31:21 node1 kernel: dlm: closing connection to node 2<br>Jul 19 10:31:21 node1 corosync[2443]:   [CPG   ] chosen downlist: sender r(0) ip(10.1.0.200) ; members(old:2 <br><br>left:1)<br>Jul 19 10:31:21 node1 corosync[2443]:   [MAIN  ] Completed service synchronization, ready to provide service.<br>Jul 19 10:31:21 node1 fenced[2675]: fencing node node2-hb<br>Jul 19 10:31:21 node1 fenced[2675]: fence node2-hb success<br>Jul 19 10:31:22 node1 rgmanager[2910]: Taking over service service:C1-SERVICE from down member node2-hb<br>Jul 19 10:31:23 node1 rgmanager[5401]: [fs] mount -t ext4 -o rw,nobarrier /dev/dm-2 /data<br>Jul 19 10:31:24 node1 kernel: EXT4-fs (dm-2): barriers disabled<br>Jul 19 10:31:24 node1 kernel: EXT4-fs (dm-2): warning: maximal mount count reached, running e2fsck is <br><br>recommended<br>Jul 19 10:31:24 node1 kernel: EXT4-fs (dm-2): recovery complete<br>Jul 19 10:31:24 node1 kernel: EXT4-fs (dm-2): mounted filesystem with ordered data mode. Opts:<br>Jul 19 10:31:27 node1 ntpd[2050]: Listening on interface #7 eth0, 10.1.0.206#123 Enabled<br>Jul 19 10:31:27 node1 rpc.mountd[5623]: Version 1.2.3 starting<br>Jul 19 10:31:27 node1 kernel: NFSD: Using /var/lib/nfs/v4recovery as the NFSv4 state recovery directory<br>Jul 19 10:31:27 node1 kernel: NFSD: starting 90-second grace period<br>Jul 19 10:31:27 node1 rgmanager[2910]: Service service:C1-SERVICE started<br><br>로그가 발생하였습니다.<br><br>75초와 45초의 각각의 시간을 계산해보니<br>75초일때는 최초 ifdown 후 80초 후에 서비스가 페일오버가 되었고<br>45초일때는 최초 ifdown후 53초 후에 서비스가 페일오버가 되었습니다.<br><br>제가 궁금한 것은 75초일 상황에서는 게이트웨이와 통신이 안된다는 상황일때 2*5=10초 최소85초후에 펜싱후 페일오버가 되어야 하는데  그전에 펜싱이 되는점 마찬가지로<br>45초일때는 55초후에 펜싱후 페일오버가 되야하는데 그전에 펜싱이 되는고 페일오버가 되어야하는데 시간이 안맞네요...<br>왜 그럴까요? 이게 환경에 따라서 값이 다른 부분인거 같기두 하고요...<br><br>추가적으로 쿼럼의 이상으로 페일오버를 계산할때<br>interval * ( tko + master_wait + upgrade_wait) + interval 로 알고 있는데요<br>master_wait가 쿼럼이 업데이트 되는 시간 즉 노드가 쿼럼의 소유권을 가져가는 시간<br>upgrade_wait는 휴스트릭 업데이트 시간 즉 노드가 휴스트릭의 소유권을 가져가는 시간이 맞나요??<br><br>여러가지 질문을 고객에서 요청이 오는데 제가 아는 한도내에서 답변을 계속보내고는 있는데요. 맞는지 모르겟네요ㅠ<br><br>그럼 좋은하루되세요<br><br><publishedDate>2018-07-19T01:56:40Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NCJg0IAH"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-18T06:37:30Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-18T06:37:30Z</b><br><br>안녕하세요.<br>각 서비스의 타임아웃은 <br>rg_test rules<br>로 확인이 가능 한것을 찾았습니다.<br><br>아래의 질의에 대해서는 무시하셔도 될것 같습니다.<br><br>혹시 페일오버 되었을때 시간에 대한 정의가 있을까요??<br><br>예를 들면 ip에 대한 타임아웃을 보면 아래와 같은데요.<br>Resource Rules for &quot;ip&quot;<br>Max instances: 1<br>Agent: ip.sh<br>Flags: init_on_add destroy_on_delete<br>Attributes:<br>  address [ primary unique ]<br>  family<br>  monitor_link default=&quot;1&quot;<br>  nfslock [ inherit ] default=&quot;service%nfslock&quot;<br>  sleeptime<br>  disable_rdisc<br>  prefer_interface<br>Actions:<br>  start<br>    Timeout (hint): 20 seconds<br>  stop<br>    Timeout (hint): 20 seconds<br>  status<br>    Timeout (hint): 10 seconds<br>    Check Interval: 20 seconds<br>  monitor<br>    Timeout (hint): 10 seconds<br>    Check Interval: 20 seconds<br>  status<br>    Timeout (hint): 20 seconds<br>    OCF Check Depth (status/monitor): 10 seconds<br>    Check Interval: 60 seconds<br>  monitor<br>    Timeout (hint): 20 seconds<br>    OCF Check Depth (status/monitor): 10 seconds<br>    Check Interval: 60 seconds<br>  meta-data<br>    Timeout (hint): 20 seconds<br>  validate-all<br>    Timeout (hint): 20 seconds<br>Explicitly defined child resource types:<br>  nfsclient (forbidden)<br>  nfsexport (forbidden)<br><br>물론depth에 따라 다르겠지만<br>20초의 타임아웃동안 서비스의 정상신호를 받지 못하여<br>페일오버가 될시 얼마만에 페일오버가 되는 시간을 알고 싶습니다.<br><br>제가 설명을 잘못해서<br>필요하시면 <br>송기호 01036209917로 연락주셔도 괜찮습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-18T06:37:30Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NCIbPIAX"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-18T04:42:29Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-18T04:42:28Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>현재 정리중입니다. 오후중 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-18T04:42:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBxo0IAD"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-07-16T22:39:01Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-07-16T22:39:00Z</b><br><br>죄송합니다. 이전 답변은 무시하시기 바랍니다.<br>금일은 정상 영업일로 담당에 의해서 답변드릴 수 있도록 하겠습니다.<br><br><publishedDate>2018-07-16T22:39:00Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBxmxIAD"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-07-16T22:36:07Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-07-16T22:36:07Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>금일은 대한민국 국경일입니다. 돌아오는 영업일에 업무가 재개될 예정이오니 양해해주시기 바랍니다. <br><br>감사합니다.<br><br><publishedDate>2018-07-16T22:36:07Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBnZYIA1"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-16T11:25:37Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-16T11:25:37Z</b><br><br>추가질문드립니다. <br>만약 서비스망이 단절되었을때 페일오버되는 기준값이 있을까요??<br><br><publishedDate>2018-07-16T11:25:37Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBl17IAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-16T07:59:43Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-16T07:59:42Z</b><br><br>답변감사합니다.<br>추가 질문 드립니다.<br><br>&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;cluster config_version=&quot;40&quot; name=&quot;cl_TRSD&quot;&gt;<br><br>&lt;fence_daemon post_fail_delay=&quot;0&quot; post_join_delay=&quot;3&quot;/&gt;<br>..생략..<br> &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt;<br>   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt;<br> &lt;/quorumd&gt;<br> &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt;<br> &lt;totem token=&quot;75000&quot;/&gt;<br>..생략..<br>&lt;/cluster&gt;<br><br>위와 같은 구성상태에서<br><br>1. 만약 쿼럼의 장애로 문제가 발생다면 페일오버가(장애 판정부터 서비스가 다른노드에서 액티브가 되는 시간)을 계산해보면<br>3*(10+2+5)+3=45초 가되나요? -&gt; upgrade_wait=2초/ time_wait=floor(tko/2)=5초<br><br>2. 휴스트릭 장애가 발견되어 해당노드가 펜싱되는 시간?<br>3*5=15초 인가요?<br><br>3. 만약 노드의 문제로 페일오버되는 시간은 어떻게 계산하는지 알고 싶습니다.<br><br>4. 마지막으로 quorumd interval의 기본값 heuristic 기본값과 같이 수동으로 적용하지 않은 설정값에 대한 기본값을 <br>볼수 있는 명령어가 있을까요? ex) pcs stonith show --full / pcs constraint show --full<br><br>감사합니다.<br><br><publishedDate>2018-07-16T07:59:42Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBRedIAH"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-13T08:11:58Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-16T01:56:18Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대하여 안내를 드리면 다음과 같습니다.<br><br>&gt; 1. 현재  &lt;totem token=&quot;75000&quot;/&gt; 로 설정이 되어있는데<br>&gt; 노드들(쿼럼포함)에게 신호를 날리고 75초 안에 응답을 받지 못하면 해당 노드가 장애가 났다 판단하는 의미가 맞나요?<br><br>지정된 토큰 간격 내에서 heartbeat을 반환하지 않는 경우 펜싱될 수 있습니다. 토큰 간격의 디폴트값은 10초입니다.<br>이는 원하는 값 (밀리초 단위)을 cluster.conf 파일에 있는 totem 태그의 토큰 매개변수에 추가하여 지정할 수 있습니다.<br><br>&gt; 2.  &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt; 에서  quorum_dev_poll=&quot;75000&quot; 의미는 쿼럼에게 시그널을 날리는데<br>&gt; 75초 안에 응답을 받지 못하면 문제가 있다고 판단하는 의미가 맞나요?<br><br>qdisk 데몬이 cman 으로 hello 시그널을 보낼 때의 타임아웃입니다.<br>말씀하신 바와 같이 75 초 안에 cman 이 qdisk 데몬으로 부터 시그널을 받지 못하면 cman 은 qdisk 가 죽었다고 판단하게 됩니다.<br><br>&gt; 3.  &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt; 에서<br>&gt; 3초를 주기로 SAN체크를 하는데 10번의 실패 카운트가 올라가면 장애가 났다고 판단하는 의미가 맞나요?<br><br>고객 환경에 따라 SAN 일순 있지만 보다 정확하게는 해당 시간동안(interval*tko) 쿼럼디바이스상에 업데이트가 실패했을 경우 장애로 판단하게 됩니다.<br><br>&gt; 4.   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt; 에서도 3번과 마찬가지로 2초(default)간격으로 체크를 하는데 5번의 실패카운트가 올라가면<br>&gt; score가 0이되어 min_score값보다 작아져 리부팅 되는 것이 맞나요?<br><br>말씀과 같이,<br>각 heuristic 의 default score 가 1 이므로 현재 하나의 heruistic 프로그램만 설정되어 있고 quorumd 의 min_score 가 1일 경우,<br>heruistic 이 해당 시간동안(interval*tko) 체크에 실패하면 리부팅이 발생합니다. <br><br>&gt; 5.  &lt;totem token=&quot;75000&quot;/&gt; 값을 계산할때 쿼럼의 (interval*tko)*2 값보다 커야 하는 이유를 알수 있을까요??<br><br>내부 자료상, 모든 실패 시나리오에 동작할 것을 고려해서 권장 값은 totem token 이 더 커야하는 것으로 명시되어 있습니다.<br>====<br>qdiskd auto-calculates the value for tko in most RHEL 6 releases to make it simpler for administrators to achieve the optimal configuration.<br>It is recommended that qdiskd be given a timeout that is less than half of totem token,<br>as this is necessary for all failure scenarios to fully work themselves out and have qdiskd take the expected action<br>before the cluster stack reaches the point of recognizing a member has not sent its token in the allowed timeframe.<br>Not adhering to these recommendations can cause unexpected losses of quorum on some nodes<br>when a node becomes unresponsive or is evicted, or can cause other unexpected behavior.<br>====<br><br>감사합니다.<br><br><publishedDate>2018-07-13T08:11:57Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBRSeIAP"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2018-07-13T07:57:47Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2018-07-13T07:57:47Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>한국 레드햇 신재욱 차장입니다.<br>앞으로 해당 케이스를 담당하게 되었습니다.<br><br>현재 이 케이스의 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-13T07:57:47Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br> &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt;<br>   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt;<br> &lt;/quorumd&gt;<br> &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt;<br><br>&lt;cluster&gt;<br> &lt;totem token=&quot;75000&quot;/&gt;<br>&lt;/cluster&gt;<br><br>위와같은 설정을 추가하였는데요.<br>몇가지 옵션및 타임아웃 문의 드립니다.<br><br>1. 현재  &lt;totem token=&quot;75000&quot;/&gt; 로 설정이 되어있는데<br>노드들(쿼럼포함)에게 신호를 날리고 75초 안에 응답을 받지 못하면 해당 노드가 장애가 났다 판단하는 의미가 맞나요?<br><br>2.  &lt;cman expected_votes=&quot;3&quot; quorum_dev_poll=&quot;75000&quot;/&gt; 에서  quorum_dev_poll=&quot;75000&quot; 의미는 쿼럼에게 시그널을 날리는데 75초 안에 응답을 받지 못하면 문제가 있다고 판단하는 의미가 맞나요?<br><br>3.  &lt;quorumd interval=&quot;3&quot; label=&quot;quorumdisk&quot; min_score=&quot;1&quot; tko=&quot;10&quot; votes=&quot;1&quot;&gt; 에서<br>3초를 주기로 SAN체크를 하는데 10번의 실패 카운트가 올라가면 장애가 났다고 판단하는 의미가 맞나요?<br><br>4.   &lt;heuristic program=&quot;ping -c1 -w1 100.254.180.1&quot; tko=&quot;5&quot;/&gt; 에서도 3번과 마찬가지로 2초(default)간격으로 체크를 하는데 5번의 실패카운트가 올라가면 score가 0이되어 min_score값보다 작아져 리부팅 되는 것이 맞나요?<br><br>5.  &lt;totem token=&quot;75000&quot;/&gt; 값을 계산할때 쿼럼의 (interval*tko)*2 값보다 커야 하는 이유를 알수 있을까요??<br><br>감사합니다.<br>==============================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 송기용 (책임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  82-10-9006-9506 <br>- 메일주소 : 송기용 &lt;kyyong.song@samsung.com&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 송기호(책임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01036209917<br>- 메일주소 : kh.song@time-gate.com<br>==============================================================================</issue><environment>구성정보문의</environment><periodicityOfIssue>구성 후 타임아웃값문의</periodicityOfIssue><timeFramesAndUrgency>운영서버 DB서버</timeFramesAndUrgency><cep>false</cep></case>