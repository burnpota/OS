======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2018-02-23T01:10:47Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-03-21T10:02:32Z</b><br><b>id : 500A000000Zr1ZFIAZ</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] 번들 http server SSL ciphersuite 관련 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요 고객사인 삼성생명에서 SSL ciphersuite 관련 문의가 요청되어 SR 진행드립니다. <br><br>##환경 ##<br>OS : Red Hat Enterprise Linux Server release 7.4 (Maipo)<br>Apache : Apache/2.4.6 (Red Hat Enterprise Linux)<br>##<br><br>## 고객정보 ##<br>고객사 : 삼성생명 정보전략그룹<br>고객명 : 이태우 선임<br>연락처 : 010-7575-3596<br>##<br><br>## 파트너 정보 ##<br>파트너사 : 타임게이트<br>담당자 : 안상훈 책임<br>연락처 :  010-3957-1209<br>##<br><br>## 문의 ##<br>삼성생명 보안팀으로부터 특정 보안알고리즘이 취약(DES-CBC3-SHA)하여 제거를 요청하여 하기와 같이 설정한 이후 기동 시 에러와 함께 정상기동이 안됩니다. <br>구글링을 통한 검색 시 TLS_RSA_WITH_3DES_EDE_CBC_SHA등과 같은 대체 알고리즘이 필요하다고 확인되는데 DES-CBC3-SHA을 disable 하기위한 가이드를 요청드립니다. <br>##<br><br>## 기동시 로그스택 ##<br>[Thu Feb 22 14:22:08.490007 2018] [ssl:emerg] [pid 80838:tid 139800181278848] AH01898: Unable to configure permitted SSL ciphers<br>[Thu Feb 22 14:22:08.490147 2018] [ssl:emerg] [pid 80838:tid 139800181278848] SSL Library Error: error:1410D0B9:SSL routines:SSL_CTX_set_cipher_list:no cipher match<br>##<br>## httpd.conf 일부 ##<br> SSLEngine on<br> SSLProtocol all -SSLv2 -SSLv3<br><br>        SSLCipherSuite !DH:!ECDH:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:!kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:!ECDHE-RSA-AES128-SHA:!ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:!DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:!AES128-SHA:AES256-SHA:!AES:!CAMELLIA:!DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA<br>        SSLHonorCipherOrder on<br>##<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><br><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-03-05T08:10:11Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-03-05T08:10:10Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>유선상으로 설명드린데로 SSLv2, SSLv3가 제외된 상태에서 사용할 수 있는 ciphers 가 많지 않습니다.<br>이 상태에서 SSLCipherSuit 지시어로 제외를 하다보면 사용할 수 있는 cipher가 전혀 없는 상황이 발생합니다.<br><br>따라서 openssl ciphers -v 명령을 이용하여 사용가능한 cipher 목록을 확인하고 사용가능한 cipher 중에서 추가로 제외가 필요한 사항이 있는 경우에 SSLCipherSuit 지시어에 적용하실 수 있습니다.<br><br>또한, 보안 적용 요건으로 해당하는 cipher 알고리즘 제외는 단순히 설정 파일에 적용해서 확인하시는 것보다는 해당 알고리즘에 대한 적용 여부 테스트를 통해서 확인하셔서 보안 정책 담당자 분께 그 결과를 전달하여 적절한 조치가 취해졌음을 확인시켜주시는 것이 좋을 것 같습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-03-05T08:10:10Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LsFzSIAV"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-03-02T09:50:27Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-03-05T01:12:19Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>이미 알려드린데로 DES-CBC3-SHA 는 SSLv3에 포함된 것 중 하나이기 때문에 아래 설정에 의해서 이미 제거되어 있습니다.<br><br>SSLProtocol all -SSLv2 -SSLv3<br><br># openssl ciphers -v 'SSLv3'<br>...중략...<br>DES-CBC3-SHA            SSLv3 Kx=RSA      Au=RSA  Enc=3DES(168) Mac=SHA1<br>...중략...<br><br>현재 SSLCipherSuite 에 지정한 스펙으로 openssl ciphers -v '지정한 스펙' 명령을 하시면 동일한 에러메시지를 보게됩니다.<br>SSLCipherSuite 지시어에는 SSLProtocol에서 사용가능한 cipher들 중에서 포함할 것과 제외할 것을 명시해야 하는 것입니다.<br>지금 현재 설정으로는 사용할 수 있는 cipher가 하나도 없습니다. 이로 인해 SSL 작동을 할 수 없는 설정이기 때문에 서비스를 시작하지 못하는 것입니다.<br><br>openssl ciphers 명령으로 현재 시스템에서 사용가능한 ciphers 목록을 확인하시고, 제외해야할 항목이 있는 경우에만<br>SSLCipherSuite 지시어에 명시하시는 것이 좋을 것 같습니다.<br><br># openssl ciphers -v 'ALL:!SSLv2:!SSLv3'<br><br>현재 SSLCipherSuite에 제외하기 위해 지정한 알고리즘이 아래 명령의 결과에 나오지 않는다면 이미 제외 적용된 것입니다.<br>따라서 위의 명령 출력 내용중에 제거해야할 항목에 대해서만 SSLCipherSuite 지시어에 적용하시는 것이 좋을 것 같습니다.<br><br>설정을 변경하여 적용하시기 전에 아래와 같은 방법으로 SSLCipherSuite에 추가하신 스펙과 함께 테스트 하셔서 에러가 나지 않아야만 정상적용이 가능할 것으로 보입니다.<br><br># openssl ciphers -v 'ALL:!SSLv2:!SSLv3:&lt;SSLCipherSuite추가스펙&gt;'<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-03-02T09:50:27Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LsBopIAF"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2018-03-02T01:03:03Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2018-03-02T01:03:03Z</b><br><br>안녕하세요<br>내부테스트 결과 문의드린 DES-CBC3-SHA 옵션을 제거 시 동일하게 에러가 발생하며 정상 기동이 안됩니다. <br><br>case1. 설정파일 상 해당 옵션 미명시<br>case2. !DES-CBC3-SHA 로 diasble 하게 명시적으로 설정<br><br>하기의 프로토콜처럼 SSLv3를 미사용하는 환경에서 해당 알고리즘을 제거할 수 있는 방법을 요청드립니다. <br> SSLProtocol all -SSLv2 -SSLv3<br><br>감사합니다.<br><br><publishedDate>2018-03-02T01:03:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LqcVNIAZ"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-02-23T07:43:54Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-02-23T07:43:53Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>추가로 업데이트 드립니다.<br><br>현재 설정하신 것처럼 SSLv3, DH, ECHD를 제외하면 사용할 수 있는 cipher들이 아래와 같이 4개 뿐입니다.<br><br># openssl ciphers -v 'ALL:!SSLv3:!DH:!ECDH'<br>AES256-GCM-SHA384       TLSv1.2 Kx=RSA      Au=RSA  Enc=AESGCM(256) Mac=AEAD<br>AES256-SHA256           TLSv1.2 Kx=RSA      Au=RSA  Enc=AES(256)  Mac=SHA256<br>AES128-GCM-SHA256       TLSv1.2 Kx=RSA      Au=RSA  Enc=AESGCM(128) Mac=AEAD<br>AES128-SHA256           TLSv1.2 Kx=RSA      Au=RSA  Enc=AES(128)  Mac=SHA256<br><br>SSLv3만 제외하셔도 40 가지만 사용하실 수 있습니다. 아래 내용을 참고하셔서 추가로 제외하실 것만 지정하시면 좋을 것 같습니다.<br><br># openssl ciphers -v 'ALL:!SSLv3'<br>ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(256) Mac=AEAD<br>ECDHE-ECDSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AESGCM(256) Mac=AEAD<br>ECDHE-RSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(256)  Mac=SHA384<br>ECDHE-ECDSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(256)  Mac=SHA384<br>DH-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH/DSS   Au=DH   Enc=AESGCM(256) Mac=AEAD<br>DHE-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(256) Mac=AEAD<br>DH-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH/RSA   Au=DH   Enc=AESGCM(256) Mac=AEAD<br>DHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(256) Mac=AEAD<br>DHE-RSA-AES256-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(256)  Mac=SHA256<br>DHE-DSS-AES256-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(256)  Mac=SHA256<br>DH-RSA-AES256-SHA256    TLSv1.2 Kx=DH/RSA   Au=DH   Enc=AES(256)  Mac=SHA256<br>DH-DSS-AES256-SHA256    TLSv1.2 Kx=DH/DSS   Au=DH   Enc=AES(256)  Mac=SHA256<br>ADH-AES256-GCM-SHA384   TLSv1.2 Kx=DH       Au=None Enc=AESGCM(256) Mac=AEAD<br>ADH-AES256-SHA256       TLSv1.2 Kx=DH       Au=None Enc=AES(256)  Mac=SHA256<br>ECDH-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH/RSA Au=ECDH Enc=AESGCM(256) Mac=AEAD<br>ECDH-ECDSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH/ECDSA Au=ECDH Enc=AESGCM(256) Mac=AEAD<br>ECDH-RSA-AES256-SHA384  TLSv1.2 Kx=ECDH/RSA Au=ECDH Enc=AES(256)  Mac=SHA384<br>ECDH-ECDSA-AES256-SHA384 TLSv1.2 Kx=ECDH/ECDSA Au=ECDH Enc=AES(256)  Mac=SHA384<br>AES256-GCM-SHA384       TLSv1.2 Kx=RSA      Au=RSA  Enc=AESGCM(256) Mac=AEAD<br>AES256-SHA256           TLSv1.2 Kx=RSA      Au=RSA  Enc=AES(256)  Mac=SHA256<br>ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(128) Mac=AEAD<br>ECDHE-ECDSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AESGCM(128) Mac=AEAD<br>ECDHE-RSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(128)  Mac=SHA256<br>ECDHE-ECDSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(128)  Mac=SHA256<br>DH-DSS-AES128-GCM-SHA256 TLSv1.2 Kx=DH/DSS   Au=DH   Enc=AESGCM(128) Mac=AEAD<br>DHE-DSS-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(128) Mac=AEAD<br>DH-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=DH/RSA   Au=DH   Enc=AESGCM(128) Mac=AEAD<br>DHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(128) Mac=AEAD<br>DHE-RSA-AES128-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(128)  Mac=SHA256<br>DHE-DSS-AES128-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(128)  Mac=SHA256<br>DH-RSA-AES128-SHA256    TLSv1.2 Kx=DH/RSA   Au=DH   Enc=AES(128)  Mac=SHA256<br>DH-DSS-AES128-SHA256    TLSv1.2 Kx=DH/DSS   Au=DH   Enc=AES(128)  Mac=SHA256<br>ADH-AES128-GCM-SHA256   TLSv1.2 Kx=DH       Au=None Enc=AESGCM(128) Mac=AEAD<br>ADH-AES128-SHA256       TLSv1.2 Kx=DH       Au=None Enc=AES(128)  Mac=SHA256<br>ECDH-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH/RSA Au=ECDH Enc=AESGCM(128) Mac=AEAD<br>ECDH-ECDSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH/ECDSA Au=ECDH Enc=AESGCM(128) Mac=AEAD<br>ECDH-RSA-AES128-SHA256  TLSv1.2 Kx=ECDH/RSA Au=ECDH Enc=AES(128)  Mac=SHA256<br>ECDH-ECDSA-AES128-SHA256 TLSv1.2 Kx=ECDH/ECDSA Au=ECDH Enc=AES(128)  Mac=SHA256<br>AES128-GCM-SHA256       TLSv1.2 Kx=RSA      Au=RSA  Enc=AESGCM(128) Mac=AEAD<br>AES128-SHA256           TLSv1.2 Kx=RSA      Au=RSA  Enc=AES(128)  Mac=SHA256<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-02-23T07:43:53Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LqbzWIAR"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-02-23T06:46:02Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-02-23T06:46:02Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>이미 설정에서 아래와 같이 SSLv3를 제외하셨기 때문에 DES-CBC3-SHA는 제외되어 있습니다.<br>DES-CBC3-SHA는 SSLv3에 포함되어 있습니다.<br><br> SSLProtocol all -SSLv2 -SSLv3<br><br># openssl ciphers -v 'SSLv3' | grep DES-CBC3-SHA<br>ECDHE-RSA-DES-CBC3-SHA  SSLv3 Kx=ECDH     Au=RSA  Enc=3DES(168) Mac=SHA1<br>ECDHE-ECDSA-DES-CBC3-SHA SSLv3 Kx=ECDH     Au=ECDSA Enc=3DES(168) Mac=SHA1<br>EDH-RSA-DES-CBC3-SHA    SSLv3 Kx=DH       Au=RSA  Enc=3DES(168) Mac=SHA1<br>EDH-DSS-DES-CBC3-SHA    SSLv3 Kx=DH       Au=DSS  Enc=3DES(168) Mac=SHA1<br>DH-RSA-DES-CBC3-SHA     SSLv3 Kx=DH/RSA   Au=DH   Enc=3DES(168) Mac=SHA1<br>DH-DSS-DES-CBC3-SHA     SSLv3 Kx=DH/DSS   Au=DH   Enc=3DES(168) Mac=SHA1<br>AECDH-DES-CBC3-SHA      SSLv3 Kx=ECDH     Au=None Enc=3DES(168) Mac=SHA1<br>ADH-DES-CBC3-SHA        SSLv3 Kx=DH       Au=None Enc=3DES(168) Mac=SHA1<br>ECDH-RSA-DES-CBC3-SHA   SSLv3 Kx=ECDH/RSA Au=ECDH Enc=3DES(168) Mac=SHA1<br>ECDH-ECDSA-DES-CBC3-SHA SSLv3 Kx=ECDH/ECDSA Au=ECDH Enc=3DES(168) Mac=SHA1<br>DES-CBC3-SHA            SSLv3 Kx=RSA      Au=RSA  Enc=3DES(168) Mac=SHA1<br>KRB5-DES-CBC3-SHA       SSLv3 Kx=KRB5     Au=KRB5 Enc=3DES(168) Mac=SHA1<br><br>따라서, SSLCipherSuite 설정에 관련 문자열을 넣을 경우 해당 내용을 찾을 수 없어서 에러가 나는 것으로 보입니다.<br><br>ciphersuite에 설정한 내용이 적절한지 아래와 같이 테스트 하실 수 있습니다. 현재 설정 내용으로 테스트를 수행하면 로그의 내용과 동일한 내용이 출력됩니다.<br><br># openssl ciphers -v '!DH:!ECDH:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:!kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:!ECDHE-RSA-AES128-SHA:!ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:!DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:!AES128-SHA:AES256-SHA:!AES:!CAMELLIA:!DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA'<br>Error in cipher list<br>140320060684192:error:1410D0B9:SSL routines:SSL_CTX_set_cipher_list:no cipher match:ssl_lib.c:1383:<br><br>SSLCipherSuite 항목에 이미 제외된 항목들을 제거한 후 적용되는 cipher들만 출력되는지 확인하시고 적용하시면 될 것 같습니다.<br><br>자세한 사항은 아래 내용을 참고하시기 바랍니다.<br><br>Resolution for POODLE SSLv3.0 vulnerability (CVE-2014-3566) in httpd<br>https://access.redhat.com/solutions/1232413<br><br>How to test which SSL/TLS protocols &amp; ciphersuites are offered by a server<br>https://access.redhat.com/solutions/2317691<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-02-23T06:46:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>