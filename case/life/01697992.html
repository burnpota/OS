======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2016-09-05T11:33:35Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2016-09-28T10:02:05Z</b><br><b>id : 500A000000V86F3IAJ</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] JBOSS EWS - AS 연동 간 ajp port SSL 설정 가능
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>.<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>.<br><br>언제 문제가 발생했습니까? 이러한 문제가 자주 발생합니까? 반복적으로 발생합니까? 특정 시간에 발생합니까?<br><br>.<br><br>문제 해결 기간 및  긴급도와 관련된 정보를 제공해 주시겠습니까?<br><br>.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat JBoss Web Server</b><br><b>버젼  : 3.0.1</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 2 (High)</b><br>======================<br><comment id="a0aA000000HcY9LIAV"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2016-09-19T00:42:58Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2016-09-19T00:42:57Z</b><br><br>안녕하세요,<br><br>mod_jk, mod_proxy는 apache에서 제공되는 load balancer 기능입니다.<br><br>mod_cluster의 경우, mod_jk의 기능에 추가적인 기능이 더해진 EAP에서 제공되는 load balancer입니다.<br>예를 들어, advertisement를 통해 매뉴얼하게 서버리스트를 추가하지 않고도 다이나믹하게 적용이 가능하거나 server-side load balance factor를 이용한 발랜싱이 수행됩니다.<br><br>고객사 환경에 따라 (네트웍이나 아키텍처 등) dynamic한 서버리스트 추가/삭제가 원하는 대로 안될 수 있고,<br>아파치 앞단에 F5와 같은 추가적인 load balancer를 같이 사용하면서 sticky session이 깨질 수 있고,<br>이러한 문제들이 발생할 수는 있습니다.<br>그러나 mod_cluster 자체의 문제로 인한 큰 이슈는 보지 못했으며, 발생한다해도 case를 통해 추가적으로 진행이 가능합니다.<br><br>제품 설명 시, 안되는 부분이나 단점을 부각시키는 경우는 없습니다.<br>잎서 말씀드린 것처럼 mod_cluster가 mod_jk, mod_proxy에서 제공하지 않는 기능이 추가된 것이기 때문에 단점에 대해 나와 있는 것은 찾기 힘들다고 보실 수 있습니다.<br><br>감사합니다.<br><br><publishedDate>2016-09-19T00:42:57Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HcXzGIAV"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2016-09-19T00:01:00Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2016-09-19T00:01:00Z</b><br><br>안녕하세요!<br><br>혹시 mod_jk 가 아닌 mod_proxy나 mod_cluster를 이용할 때 고려해야 될 점이나 단점으로 부각될 수 있는 것이 있을까요?<br><br>문서상 검색되는 것은 장점만 정리되어 있는 것으로 확인되어 문의드립니다. <br>(https://access.redhat.com/solutions/101793)<br><br>감사합니다.<br><br><publishedDate>2016-09-19T00:01:00Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Hs7dVIAR"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2016-09-12T08:33:23Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2016-09-12T08:33:23Z</b><br><br>안녕하세요,<br><br>https://access.redhat.com/solutions/26732의 Listener 클래스에 미스가 있어 보입니다.<br>JWS에서 mod_cluster 사용시 org.jboss.web.tomcat.service.deployers.MicrocontainerIntegrationLifecycleListener 가 아닌 org.jboss.modcluster.catalina.ModClusterListener 클래스를 사용해야 합니다.<br><br>기존에 알려드렸던 kcs 중 https://access.redhat.com/solutions/2299061 를 참고바랍니다.<br>(mod_cluster 부분은 JWS document https://access.redhat.com/documentation/en-US/Red_Hat_JBoss_Web_Server/3/html/HTTP_Connectors_and_Load_Balancing_Guide/chap-mod_cluster_Connector.html 도 참고 가능합니다.)<br><br>감사합니다.<br><br><publishedDate>2016-09-12T08:33:23Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Hs6RlIAJ"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2016-09-12T06:40:40Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2016-09-12T06:40:40Z</b><br><br>## 삼성생명 담당자 ##<br>성명 : 이해인 선임<br>연락처 : 010-7191-8130<br>################<br>###<br>OS version : Windows 2012 R2<br>JBOSS EWS version : jws-httpd-3.0.2-win6.x86_64<br>JBOSS EWS-AS version :  jws-3.0(apache-tomcat-7.0.59)<br>###<br><br>안녕하세요! <br>답변주신 하기의 문서로 mod_cluster 연동 내부 테스트 중에 있습니다. <br><br>[3] How to encrypt the connection between Apache mod_proxy / mod_cluster and JBoss with ssl<br>https://access.redhat.com/solutions/26732<br>## 가이드 문서 중략 ##<br>$JBOSS_HOME/server/$PROFILE/deploy/$JBOSSWEB/server.xml:<br>##########################################################################################<br>&lt;Server&gt;<br>&lt;Listener className=&quot;org.apache.catalina.core.AprLifecycleListener&quot; SSLEngine=&quot;on&quot; /&gt;<br>&lt;Listener className=&quot;org.apache.catalina.core.JasperListener&quot; /&gt;<br>&lt;Listener className=&quot;org.jboss.web.tomcat.service.deployers.MicrocontainerIntegrationLifecycleListener&quot; delegateBeanName=&quot;ModClusterService&quot; /&gt;<br>########<br><br><br>Jboss AS(apache-tomcat-7.0.59)의 config/server.xml에 하기와 같이 적용 후 기동 시 에러가 발생합니다. <br>##에러 로그 중략 ##<br>정보: Cluster RuleSet not found due to [java.lang.ClassNotFoundException: org.apache.catalina.ha.ClusterRuleSet]. Cluster configuration disabled.<br>9월 12, 2016 3:00:55 오후 org.apache.tomcat.util.digester.Digester startElement<br>심각: Begin event threw exception<br>java.lang.ClassNotFoundException: org.jboss.web.tomcat.service.deployers.MicrocontainerIntegrationLifecycleListener<br><br>at java.net.URLClassLoader.findClass(URLClassLoader.java:381)<br><br>at java.lang.ClassLoader.loadClass(ClassLoader.java:424)<br><br>at java.lang.ClassLoader.loadClass(ClassLoader.java:357)<br><br>##이하 생략 ##<br><br>현재 tomcat내에 포함된 mod_cluster 관련 library는 하기와 같고 모든 jar파일을 압축 풀어서 확인결과 <br>해당 org.jboss.web.tomcat.service.deployers.MicrocontainerIntegrationLifecycleListener가 존재하지 않습니다. <br>## 하기 ##<br>mod_cluster-core.jar<br>mod_cluster-container-tomcat7.jar<br>mod_cluster-container-spi.jar<br>mod_cluster-container-catalina-standalone.jar<br>mod_cluster-container-catalina.jar<br>###<br><br>하여 jboss.org 사이트에서 (http://mod-cluster.jboss.org/mod_cluster/downloads/1-3-1-Final-bin) 를 하기의 lib를 다운로드하여<br>mod_cluster-1.1.3.Final.jar<br>server.xml에 하기의 classname을 적용결과 http://${WEBSERVER PORT}/mod_cluster_manager의 화면은 정상적으로 뜨나 실제 apache-tomcat 연동은 이루어 지지 않았습니다. <br>## server.xml 일부##<br>&lt;Listener className=&quot;org.jboss.modcluster.catalina.ModClusterListener&quot;/&gt;<br>##<br><br>1. tomcat에 적용될 mod_cluster.jar 다운로드 경로와 EWS-AS 연동가이드를 다시한번 요청드립니다. <br>2. mod_proxy의 경우 뒷단의 tomcat을 ssl(8443)으로 구성 시 앞단의 webserver가 https(443)으로 구성되어야만 한다고 하는데 혹시 mod_cluster의 경우도 마찮가지인지 확인 요청드립니다 <br>Note: The ProxyPass, etc. configuration for https connections should be defined inside the ssl VirtualHost in apache. This is how apache knows to send the requests from https on port 443 to the https port on JBoss.<br><br>감사합니다.<br><br><publishedDate>2016-09-12T06:40:40Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000HmWWrIAN"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2016-09-06T06:04:19Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2016-09-06T06:04:19Z</b><br><br>안녕하세요 <br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>요청에 의해 본 케이스를 처리완료하도록 하겠습니다<br><br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>     <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. 고객님께서 남기 신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. 향후 기술  지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다. <br><br>그리고 아래 Red Hat Customer Portal group을 통하여 많은 유용한 정보들을 볼수 있으니 참고하시기 바랍니다.<br><br>Featured Groups:<br>Red Hat Enterprise Linux - https://access.redhat.com/groups/red-hat-enterprise-linux<br>Red Hat Enterprise Linux 7 Ideas - https://access.redhat.com/groups/red-hat-enterprise-linux-7-ideas<br>Red Hat Enterprise Linux Developer Program (beta) - https://access.redhat.com/groups/red-hat-enterprise-linux-developer-program-beta<br>Red Hat Enterprise Virtualization - https://access.redhat.com/groups/red-hat-enterprise-virtualization<br>Red Hat Storage - https://access.redhat.com/groups/red-hat-storage<br>JBoss Enterprise Middleware - https://access.redhat.com/groups/jboss-enterprise-middleware<br>Red Hat Network Satellite - https://access.redhat.com/groups/red-hat-network-satellite<br><br>Regards,  <br>Minwoo Park  <br>Senior Technical Support Engineer  <br>Customer Experience and Engagement (CEE)<br><br><publishedDate>2016-09-06T06:04:19Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HmWM8IAN"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2016-09-06T05:37:49Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2016-09-06T05:37:49Z</b><br><br>확인감사합니다. <br>SR 종료 요청드립니다. <br>감사합니다.<br><br><publishedDate>2016-09-06T05:37:49Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000HmUrNIAV"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2016-09-06T01:04:07Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2016-09-06T01:04:06Z</b><br><br>안녕하세요,  <br>  <br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>AJP Protocol은 https와 같이 encryption을 지원하지 않습니다. 따라서 ajp 자체에 ssl 적용은 할 수 없습니다.<br>spec을 요청하신다는 것이 정확히 뭘 요청하시는 건가요?<br><br>일반적으로 보안을 위해 사용하는 형태는 아래와 같습니다.<br>browser-----https-----Apache----mod_jk(ajp)----tomcat<br><br>즉, Apache에서 https를 이용하여 서비스를 제공하고, tomcat과의 연동은 defautl mod_jk 이용시 ajp 프로토콜을 이용하여 통신이 이루어집니다.<br>이것이 알고 계시는 redirect 방식이고, 자세한 설정 방법은 kcs [1]을 참고하실 수 있습니다.<br><br>[1] How do I configure mod_jk to work with SSL in Apache?<br>https://access.redhat.com/solutions/20116<br><br><br>고객사 보안상 WAS(tomcat)도 ssl을 이용해야 하고 apach-tomcat 구간도 ssl이 적용되어야 한다면, mod_jk가 아닌 mod_proxy나 mod_cluster를 이용하셔야 합니다.<br>이에 대한 설정은 아래 kcs [2], [3], [4]를 참고하실 수 있습니다.<br><br>[2] How do I setup SSL on Tomcat? <br>https://access.redhat.com/solutions/6678<br><br>[3] How to encrypt the connection between Apache mod_proxy / mod_cluster and JBoss with ssl<br>https://access.redhat.com/solutions/26732<br><br>[4] Configure https between mod_cluster and tomcat <br>https://access.redhat.com/solutions/2299061<br><br><br>감사합니다. <br>Minwoo Park  <br>Senior Technical Support Engineer  <br>Customer Experience and Engagement (CEE)<br><br><publishedDate>2016-09-06T01:04:06Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HmRI8IAN"><br>======================<br><b>생성계정 : Zabello, Kseniya</b><br><b>생성날짜 : 2016-09-05T12:56:08Z</b><br><b>마지막 답변자 : Zabello, Kseniya</b><br><b>마지막 수정 일자 : 2016-09-05T12:56:08Z</b><br><br>안녕하세요,<br> <br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br> <br><br>고객님께서는 프리미엄 서브스크립션을 보유하고 계시며, 현재 한국 업무 시간이 종료되어 기술 지원은 영어로만 진행이 됨을 안내해드립니다.<br><br>한국어 지원은 돌아오는 한국 업무 시간에 진행됩니다.<br> <br><br>한국 업무 시간 : 월 - 금, 오전 9시 - 오후 5시<br><br><br>감사합니다.<br><br><br>Dear Customer,<br><br>My name is Kseniya and I am working on this case.<br><br>I see that you have Premium subscriptions and have submitted a Severity-2 case.  It's outside of your local business hours at this moment, so your case will be supported in English.<br><br>If you would  like to continue the support, can you please let us know the following details in English:<br><br>a) Problem description.<br><br>b) Business impact of the issue.<br><br>c) Contact point for this particular case whom we can reach 24x7, if needed.<br><br><br>I would also encourage you to call us on below phone numbers for Severity-1/Severity-2 which has very high impact on your business and needs to be worked through 24x7 ;<br><br>https://access.redhat.com/ko/support/contact/technicalSupport<br> <br><br>Please let us know if you are able to continue this case in English or if you prefer to wait for your local support during your next business day.<br><br> <br>Kind Regards,<br><br>Kseniya Zabello<br><br>Red Hat Global Support Delivery<br><br><publishedDate>2016-09-05T12:56:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HmQiKIAV"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2016-09-05T11:44:23Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2016-09-05T11:44:23Z</b><br><br>keystore 파일 내용이 잘못되어 다시 업데이트 드립니다. <br><br>## http port ssl 적용 테스트 ##<br>server.xml<br>## 중략 ## <br>               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot;<br>               KeystoreFile=&quot;${TOMCAT_HOME}/ssl/.keystore&quot;<br>               KeystorePass=&quot;password&quot; KeystoreTpye=&quot;pkcs12&quot;<br>               secure=&quot;true&quot; scheme=&quot;https&quot; SSLEnabled=&quot;true&quot;   <br>##<br><br><br>감사합니다.<br><br><publishedDate>2016-09-05T11:44:23Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000HmQgTIAV"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2016-09-05T11:39:26Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2016-09-05T11:39:26Z</b><br><br>## 삼성생명 담당자 ##<br>성명 : 이해인 선임<br>연락처 : 010-7191-8130<br>################<br><br>JBOSS EWS version : jws-httpd-3.0.2-win6.x86_64<br>JBOSS EWS-AS version :  jws-3.0(apache-tomcat-7.0.59)<br><br><br>web-was 연동 ajp 정보<br>worker.properties<br><br>## 중략 ##<br># Define template worker<br>worker.template.port=8109<br>worker.template.type=ajp13<br>worker.template.ping_mode=A<br>worker.template.reply_timeout=60000<br>worker.template.socket_connect_timeout=10000<br>## 이하생략 ##<br><br>고객사의 보안 적용으로 인한 tomcat 자체의 ssl 적용 문의<br>1. web-was를 ajp 를 통한 연동 시 ajp 자체에 대한 ssl 적용여부 및 가이드(redirect 가 아님)<br><br>##     내부 http port에 적용 시 적용 기동 및 테스트 확인 ##<br><br>&lt;Connector port=&quot;8180&quot; protocol=&quot;HTTP/1.1&quot;<br>               connectionTimeout=&quot;20000&quot;<br>               clientAuth=&quot;false&quot; sslProtocol=&quot;TLS&quot; <br>               SSLCertificateFile=&quot;${TOMCAT_HOME}/ssl/server.csr&quot;<br>               SSLCertificateType=&quot;pkcs12&quot;<br>               secure=&quot;true&quot; scheme=&quot;https&quot; SSLEnabled=&quot;true&quot;  <br>               redirectPort=&quot;8443&quot; /&gt;<br>####<br><br>2. ajp ssl 적용이 불가 시 spec 을 요청합니다. <br><br>감사합니다.<br><br><publishedDate>2016-09-05T11:39:26Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>