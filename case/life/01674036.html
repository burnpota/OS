======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2016-07-26T06:33:05Z</b><br><b>마지막 답변자 : Jake Jaewook Shin</b><br><b>마지막 수정 일자 : 2016-08-05T00:38:48Z</b><br><b>id : 500A000000UreSwIAJ</b><br>======================<br><br><b><font size=15>
제목  : [기술문의]multipath volume
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br><br>사용하지 않은 아래 스토리지 볼륨을 multipath 에서 매핑 안하고 싶은데<br><br>mpath1 (360060e80100570f0052fb3bf0000020d)<br>[size=203 GB][features=&quot;0&quot;][hwhandler=&quot;0&quot;]<br>\_ round-robin 0 [enabled]<br> \_ 2:0:0:0  sda  8:0    [failed][faulty]<br><br>작업내용<br>1. /etc/multipath.conf 설정 변경<br>blacklist {<br>           wwid &quot;360060e80100570f0052fb3bf0000020d&quot;<br>}<br><br>2. service multipathd reload<br><br>3. multipath -f 360060e80100570f0052fb3bf0000020d<br><br>4.multipath -ll 확인<br><br>서비스 재시작 없이 reload 만으로 가능 한지 여부 확인 부탁드립니다.<br><br>그리고 위 작업 전에 아래 로그 메세지를 안뜨게 하기 위해서<br><br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br>Jul 22 14:21:07 send-ctl2 multipathd: error calling out /sbin/mpath_prio_hds_modular 8:0<br><br>/etc/syslog.conf 에서 필터링 할수 있는 방법 부탁드립니다.<br><br>감사합니다.<br><br>문제 해결 기간 및  긴급도와 관련된 정보를 제공해 주시겠습니까?<br><br>=================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김종휘 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-9580-6587 <br>- 메일주소 : 김종휘 &lt;jjpaper.kim@samsung.com'&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com'''<br>=================================================================<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 4 - ELS</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags><tag><name>multipath</name></tag><tag><name>storage</name></tag></tags><br><comment id="a0aA000000HZ8HfIAL"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-08-05T00:38:44Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-08-05T00:38:43Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>피드백 주셔서 정말 감사합니다!<br>이상으로 해당 케이스는 close 처리 하도록 하겠습니다.<br><br>케이스가 처리 완료되면 고객 설문조사 메일이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-08-05T00:38:43Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HYxdWIAT"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-08-04T09:45:14Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-08-04T09:45:14Z</b><br><br>안녕하세요. 해당 케이스는 잘 해결되었습니다.<br><br>감사 합니다.<br><br><publishedDate>2016-08-04T09:45:14Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000HYxYRIA1"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-08-04T09:35:36Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-08-04T09:35:36Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>해당 케이스에 대한 진행상황은 어떠신지요?<br>확인 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2016-08-04T09:35:36Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HWLPYIA5"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-07-28T05:06:06Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-07-28T05:06:06Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>&gt; 현재 운용중인 서비스 가 있는 서버 인데 온라인중에 작업이 가능 한지요? <br>&gt; 매핑되어 있는 스토리지 볼륨이 많은  reload 로 인한 부하가 있을 가능성이 있을까요?<br><br>아래의 문서를 보시다시피 &quot;multipathd&quot; 데몬 reload 작업은 안전한것으로 것으로 보이며<br>온라인중에 작업을 진행하셔서 문제가 없을것으로 확인됩니다.<br><br>&quot;Does 'service multipathd reload' command interrupt any previous multipathd working connections ?&quot;<br> https://access.redhat.com/solutions/261243<br><br><br>추가적으로 sda 디바이스에 'SCSI error: return code = 0x00010000' 에러와 함께 IO 커맨드가 실패되는것으로<br>확인되는데 혹시 해당 서버와 sda 디바이스 사이에 connection 이슈가 있는지 확인 부탁드립니다.<br><br>As per the command outputs, logs in description section. There is following multipath device created on server, and this multipath device map has only 1 sub path &quot;sda&quot; associated with it:<br>======================<br>mpath1 (360060e80100570f0052fb3bf0000020d)<br><br>[size=203 GB][features=&quot;0&quot;][hwhandler=&quot;0&quot;]<br><br>\_ round-robin 0 [enabled]<br><br> \_ 2:0:0:0  sda  8:0    [failed][faulty]<br><br><br>Above device is marked as failed/faulty and there is a following blacklist entry added for above device:<br>======================<br>1. /etc/multipath.conf 설정 변경<br><br>blacklist {<br><br><br>   wwid &quot;360060e80100570f0052fb3bf0000020d&quot;<br><br>}<br><br><br>Also, the following error messages indicates that SCSI, IO commands issued to the sub path &quot;sda&quot; for above multipath device were getting failed with SCSI error return code of 0x10000<br>======================<br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br><br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br><br>Jul 22 14:21:07 send-ctl2 multipathd: error calling out /sbin/mpath_prio_hds_modular 8:0<br><br>[...]<br><br><br>The SCSI error return code of &quot;0x00010000&quot; could be decoded as shown below:<br><br><br>        0x00 01 00 00<br>        -------------<br>                   00   status byte : {likely} not valid, see other fields<br>                00         msg byte : {likely} not valid, see other fields<br>             01           host byte : DID_NO_CONNECT - couldn't connect before timeout period {possibly device doesn't exist}<br>          00            driver byte : {likely} not valid, see other fields<br><br><br>This SCSI error indicates that IO command is being rejected with an error status of DID_NO_CONNECTION. Either access to the device is temporarily unavailable (a LOOP or LINK DOWN condition has occurred - we don't know when the connection will return), or the device is no longer available within the configuration. <br><br>참고문서:<br>&quot;Getting error: 'SCSI error: return code = 0x00010000'&quot;<br> https://access.redhat.com/solutions/163203<br><br>&quot;What does return code = 0x10000 mean?&quot;<br> https://access.redhat.com/articles/280653#00.01.00.00<br><br><br>또한 더 상세한 logs, storage, dm-multipath, filesystem 설정을 확인해 보기 위하여 <br>서버 &quot;send-ctl2&quot; 의 sosreport를 수집하셔서 케이스에 업로드 부탁드립니다.<br><br>참고문서:<br>&quot;sosreport란 무엇인가? Red Hat Enterprise Linux 4.6 또는 이후 버전에서 생성 방법은 무엇인가?&quot;<br>https://access.redhat.com/knowledge/ko/solutions/82033<br><br><br>감사합니다.<br><br><publishedDate>2016-07-28T05:06:06Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HW6DmIAL"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2016-07-27T06:31:15Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2016-07-27T06:31:15Z</b><br><br>안녕하세요.<br><br>현재 운용중인 서비스 가 있는 서버 인데 온라인중에 작업이 가능 한지요? <br><br>매핑되어 있는 스토리지 볼륨이 많은  reload 로 인한 부하가 있을 가능성이 있을까요?<br><br>감사합니다.<br><br><publishedDate>2016-07-27T06:31:15Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000HW5tbIAD"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-07-27T05:49:56Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-07-27T05:49:56Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대하여 안내를 드리면 다음과 같습니다.<br><br>&gt; 서비스 재시작 없이 reload 만으로 가능 한지 여부 확인 부탁드립니다.<br><br>reload 만으로 가능합니다. 다음 자료를 참고하시기 바랍니다.<br><br>참고 자료:<br>3.2. Ignoring Local Disks when Generating Multipath Devices<br>https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/DM_Multipath/index.html#ignore_localdisk_procedure<br><br>&gt; /etc/syslog.conf 에서 필터링 할수 있는 방법 부탁드립니다.<br><br>메세지 필터링과 관련해서는 다음을 참고하시기 바랍니다.<br>====================================================================================<br>예)<br><br>*** /etc/rsyslog.d/ 밑에 rsyslog 관련 커스텀 config 파일을 작성 후 저장(룰 추가, ~ 는 메세지를 기록하지 않는 경우 사용)<br><br>~~~ 생략<br><br>#### RULES ####<br>if $msg contains '필터링할 메세지' then ~<br><br>~~~ 생략<br><br><br>*** 서비스 재기동<br><br># service rsyslog restart<br>====================================================================================<br><br>자세한 내용은 다음 KBase를 참고하시길 바랍니다.<br><br>How to filter logs using rsyslog?<br>- https://access.redhat.com/solutions/539093<br><br>또는, man rsyslog.conf 도 참고하시면 여러 옵션을 참고하실 수 있습니다.<br><br>이상으로 업무에 도움이 되시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2016-07-27T05:49:56Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000HW2YTIA1"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-07-27T00:32:21Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-07-27T00:32:20Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>저는 신재욱이라고 하며 앞으로 이 케이스를 담당하게 되었습니다.<br><br>현재 이 케이스의 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-07-27T00:32:20Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br><br>사용하지 않은 아래 스토리지 볼륨을 multipath 에서 매핑 안하고 싶은데<br><br>mpath1 (360060e80100570f0052fb3bf0000020d)<br>[size=203 GB][features=&quot;0&quot;][hwhandler=&quot;0&quot;]<br>\_ round-robin 0 [enabled]<br> \_ 2:0:0:0  sda  8:0    [failed][faulty]<br><br>작업내용<br>1. /etc/multipath.conf 설정 변경<br>blacklist {<br>           wwid &quot;360060e80100570f0052fb3bf0000020d&quot;<br>}<br><br>2. service multipathd reload<br><br>3. multipath -f 360060e80100570f0052fb3bf0000020d<br><br>4.multipath -ll 확인<br><br>서비스 재시작 없이 reload 만으로 가능 한지 여부 확인 부탁드립니다.<br><br>그리고 위 작업 전에 아래 로그 메세지를 안뜨게 하기 위해서<br><br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br>Jul 22 14:21:07 send-ctl2 kernel: SCSI error : &lt;2 0 0 0&gt; return code = 0x10000<br>Jul 22 14:21:07 send-ctl2 multipathd: error calling out /sbin/mpath_prio_hds_modular 8:0<br><br>/etc/syslog.conf 에서 필터링 할수 있는 방법 부탁드립니다.<br><br>감사합니다.</issue><timeFramesAndUrgency>=================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>- 성함(직급) : 김종휘 (선임)<br>- 회사명(부서명) : 삼성SDS<br>- 전화번호 :  +82-10-9580-6587 <br>- 메일주소 : 김종휘 &lt;jjpaper.kim@samsung.com'&gt;<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>- 성함(직급) : 진성민(선임)<br>- 회사명(부서명) : 타임게이트(오픈소스팀)<br>- 전화번호 : 01076761313<br>- 메일주소 : sm.jin@time-gate.com'''<br>=================================================================</timeFramesAndUrgency><cep>false</cep></case>