======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2018-07-13T01:28:36Z</b><br><b>마지막 답변자 : Xingbin Li</b><br><b>마지막 수정 일자 : 2018-08-16T01:32:22Z</b><br><b>id : 500A000000bSxiKIAS</b><br>======================<br><br><b><font size=15>
제목  : Connection reset 관련 회피 방법 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까 타임게이트 오선우입니다<br><br>RHEL7.2 환경에 Server Client 환경에서 N/W Connection reset 현상이 발생하여 문의드립니다<br><br>아래와 같은 환경에서 네트워크 Conetction reset현상이 있습니다<br>정상적인 세션 종료 후 새로운 신규세션이 같은 포트로 접속하면서 connetction reset이 발생하는것으로 추정하고 있습니다<br>1. 추정한 내용이 맞는지 확인 부탁드립니다<br>2. 포트 재사용을 위한 파라미터 조정으로 조치가 가능한가요? 가능하다면 방법 부탁드립니다<br>3. 아래 현상으로 회피할 방법이 있나요? <br>4. 내용 그림피알 포함하여 pdf파일 추가로 첨부드립니다<br><br><br>ERP PO-대외계 AP 간 N/W Connection reset 현상 발생하여 문의 및 분석 요청드립니다.<br> <br> - Source (Client) : ERP PO AP (5대) / RHEL 7.2<br> - Target (Server) : 대외계 AP (2대, L4 연결) / RHEL 7.2<br> - 현상 : ERP PO AP → 대외계 AP(L4) 접속 시 간헐적으로 'Connection reset' 발생하며 신규 세션 끊김<br> - 추정원인 :<br>   . 정상적으로 세션 종료 후 신규 세션이 2초내 동일한 Client Port로 접속할 경우 발생<br>     ※ Active closer (먼저 연결 끊는 쪽) : 대외계 AP (Target (Server))<br>   . 신규 접속 세션이 reuse 된 port를 사용할 때 이전 연결 종료 후<br>     L4 스위치 세션 타임아웃 시간(2초) 내에 남아있던 Client port 정보 충돌로 Connection reset 발생<br>     ※ L4 스위치 담당자 분석 내용, 아래 그림/메일 참조<br> - 문의사항 :<br>   . TCP Client port 재사용을 위한 타임아웃 관련 파라미터 설정 가능 여부<br>    (또는 커널에 하드코딩된 설정 값 확인)<br>   . 해당 현상을 회피하기 위한 Client/Server 관련 설정<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>.</hostname><br><br><br><comment id="a0aA000000LdbrdIAB"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-08-16T01:32:20Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-08-16T01:32:20Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>마지막 안내후 일정기간동안 답변이 없으셔서 본 케이스를 close 처리 하려고 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-08-16T01:32:20Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NPnNLIA1"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-08-10T07:49:00Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-08-10T07:49:00Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 추가적으로 문의하실 사항이 있으신가요?<br><br>본 안내 후 일정기간 답변이 없다면 본 케이스는 자동으로 종료 상태가 됨을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하시다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-10T07:49:00Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NJmTbIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-08-02T01:22:44Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-08-02T01:22:43Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>RHEL 에서 로컬포트를 선택하는 방법은 아래와 같습니다.<br><br>*주의* 어플리케이션이 특정 포트를 사용할 것을 지정하지 않았을 경우에 해당됩니다.<br><br>1) net.ipv4.ip_local_port_range 파라메터 값의 범위내에서 랜덤하게 포트 N 을 지정합니다<br>2) 처음 지정한 N 포트가 이미 사용되어 있어서 사용이 불가능하다면 N+1 포트를 지정합니다.<br>3) net.ipv4.ip_local_port_range 범위 내에서 사용가능한 포트를 찾을때까지 상기의 1,2 번을 반복합니다.<br><br>해당 질문은 최초의 케이스 문의사항 (Connection Reset)에 연관된 질문이 아니므로 저희 기술지원 정책상 새로운 기술문의를 생성해주셔야 합니다.<br>따라서 만약 본 답변을 받으신후 포트지정에 관해 추가 문의사항이 생기신다면 새로운 케이스를 열어주시면 새로운 케이스에서 계속해서 지원해드릴수 있도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-02T01:22:43Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NJXzeIAH"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-08-01T08:18:57Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-08-01T08:18:57Z</b><br><br>안녕하세요. 고객의 요청에 의해 케이스 관련 문의 드립니다.<br>신규 연결 생성시 client port 선택 로직(알고리즘)이 있는지 및 대략적인 절차/방법등 문의 드립니다.<br>  e.g.) 미사용 포트 중 랜덤하게 선택<br>       또는 미사용 포트 중 선택 가능한 낮은 숫자 port 부터 순차적으로 할당 등<br>감사합니다.<br><br><publishedDate>2018-08-01T08:18:57Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NIvWzIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-30T02:53:42Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-30T02:53:42Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>마지막 안내후 일정기간동안 답변이 없으셔서 본 케이스를 close 처리 하려고 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-07-30T02:53:42Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NI3V1IAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-25T07:46:09Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-25T07:46:08Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 추가적으로 문의하실 사항이 있으신가요?<br><br>본 안내 후 일정기간 답변이 없다면 본 케이스는 자동으로 종료 상태가 됨을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하시다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-25T07:46:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBjZ2IAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-16T05:34:33Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-16T05:34:33Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>아래의 로그를 보면 해당 값은 saphostexec라는 프로세스에 의해 부팅시 적용이 되는 것으로 보입니다.<br>해당 프로세스가 새로운 커널파라메터값을 적용하는 자세한 원인에 관해서는 SAP에 문의하시기 바랍니다.<br><br>$ cat sos_commands/logs/journalctl_--all_--this-boot_--no-pager | grep &quot;/proc/sys/net/ipv4/&quot;<br>May 06 14:16:00 PPOSAL01SL saphostexec[3329]: modified /proc/sys/net/ipv4/ip_local_port_range from 32768-60999 to 9000-65300 (SAP note 401162)<br>May 06 14:16:00 PPOSAL01SL saphostexec[3329]: modified /proc/sys/net/ipv4/ip_local_reserved_ports for SAP applications (SAP note 401162)  &lt;---- <br><br>감사합니다.<br><br><publishedDate>2018-07-16T05:34:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBim5IAD"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-16T03:01:35Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-16T03:01:35Z</b><br><br>안녕하십니까 타임게이트 오선우입니다<br><br>close 했는데 다시 오픈합니다 <br><br>한가지 문의사항이 있습니다<br><br>커널 파라미터중 reserved_port부분을 어떠한 값으로 생성되는지 문의드립니다<br><br>하기 내용은 고객의 문의사항입니다 <br>---------------------------------------------------------------<br><br> source PO서버에는 아래와 같이 reserved_port 설정이 되어있는데 sysctl.conf에 별도로 설정한 내용은 없습니다<br><br> (target 대외계 서버는 reserved_port 별도 설정 없음)<br><br> <br><br> 해당 설정이 어떤 부분에 의해 되는 것인지 확인 요청드립니다.<br><br> <br><br>root@PPOSAL01SL /root # sysctl -a | grep port | grep reserv<br>net.ipv4.ip_local_reserved_ports = 1089-1090,1095,1099,1128-1129,1200-1298,1300-1398,1400-1498,1500-1598,2000-2002,3031,3125,3140,3145,3197,3200-3398,3434,3496,3500,3519,3568,3600-3698,3802,3805,3827,3877,3893,3900-4001,4008,4010-4013,4076,4145,4213,4238-4241,4281,4349,4363,4417,4440,4444-4445,4486,4554,4622,4690,4758,4800-4898,4900-4912,4963,5001,5062,5068,5131,5177,5285,5393,5501,5610,5912,5914-5917,5931,6000-6009,6400-6498,7200,7210,7269-7270,7575,8000-8098,8100-8198,8200,8210,8220,8230,8351-8353,8355,8357,8366,8443,9800-9999,20003-20007,20201,21212-21213,30000-31254,31256-31970,31972-32596,32598-32636,32638-34968,34970-35684,35686-38024,38026-38056,38058-39398,39400-39438,39440-39899,40000-40085,40087-40767,40769-41449,41451-42131,42133-42813,42815-43495,43497-44177,44179-44859,44861-45541,45543-46223,46225-46905,46907-47587,47589-48269,48271-48951,48953-49633,49635-49899,50000-50628,50630-51310,51312-51508,51510,51513-51521,51525-51526,51530-51531,51535-51536,51540-51541,51545-51546,51550-51551,51555-51556,51560-51561,51565-51566,51570-5<br>net.ipv4.ip_local_reserved_ports = 1<br>root@PPOSAL01SL /root #<br>root@PPOSAL01SL /root # cat /etc/sysctl.conf<br># System default settings live in /usr/lib/sysctl.d/00-system.conf.<br># To override those settings, enter new settings here, or in an /etc/sysctl.d/&lt;name&gt;.conf file<br>#<br># For more information, see sysctl.conf(5) and sysctl.d(5).<br><br>kernel.sysrq = 1<br>kernel.panic_on_io_nmi = 1<br>kernel.panic_on_unrecovered_nmi = 1<br>kernel.unknown_nmi_panic = 1<br>net.ipv6.conf.all.disable_ipv6 = 1<br>net.ipv4.ip_forward = 0<br>net.ipv4.conf.default.accept_source_route = 0<br>net.core.somaxconn = 8192<br>net.ipv4.tcp_max_syn_backlog = 8192<br><br>vm.dirty_ratio = 30<br>vm.swappiness = 30<br><br>kernel.core_pattern = /var/crash/core_%e_%p_%h_%u_%t<br>kernel.pid_max = 120000<br><br>kernel.sem = 1250 256000 100 8192<br>kernel.msgmni = 1024<br>vm.max_map_count = 4000000<br>kernel.shmmax = 303868936192<br>kernel.shmall = 18991808512<br><br>### 201707 advice from HITACHI for NAS ###<br>sunrpc.tcp_max_slot_table_entries = 128<br><br>### PISA ###<br>kernel.numa_balancing = 0<br>net.core.netdev_max_backlog = 8192<br><br> <br><br> 감사합니다.<br><br><publishedDate>2018-07-16T03:01:35Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBiLsIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-16T01:35:58Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-16T01:35:57Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>본 케이스를 직접 close 해주셔서 감사합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2018-07-16T01:35:57Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBiKzIAL"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-16T01:34:15Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-16T01:34:14Z</b><br><br>안녕하십니까 타임게이트 오선우입니다<br><br>우선 해당 케이스 클로즈하고 특이사항이나 필요하면 다시 오픈하도록 하겠습니다<br><br>감사합니다<br><br><publishedDate>2018-07-16T01:34:14Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBiFzIAL"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-16T01:18:50Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-16T01:18:50Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>피드백 감사하드립니다.<br>본 케이스는 waiting on customer로 변경하도록 하겠습니다.<br>본 케이스 진행중 Red Hat 의 지원이 필요한 사항이 있으시다면 코멘트를 업데이트해주시면 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-16T01:18:50Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBSNKIA5"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-13T09:07:02Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-13T09:07:02Z</b><br><br>답변 감사합니다<br><br>TCP Client port 재사용을 위한 타임아웃 관련 파라미터 설정 가능 여부 또는  해당 현상을 회피하기 위한 Client/Server 관련 설정<br>부분은 없는것으로 이해하며 고객에게 답변하도록 하겠습니다<br><br>감사합니다<br><br><publishedDate>2018-07-13T09:07:02Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBS6iIAH"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-13T08:48:02Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-13T08:48:02Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>RHEL 에서는 MSL은 30초로 하드코딩 되어있고 해당 값을 바꿀수 없습니다. <br>또한 프로토콜상 TCP 소켓은 TIME_WAIT 상태에 진입후 두배의 MSL동안 즉 60초동안 머물게 됩니다. <br>그리고 MSL 관련 값을 조정할수 있다고 해도 본 이슈해결에 도움이 되지 못할 것으로 예상합니다. 그 원인은 아래와 같습니다.<br>~~~~~~ <br>현재 양 노드의 TCP 연결의 맺고 끊음 상황이 아래와 같습니다.<br><br>ERP PO AP (5대)/ RHEL7.2  : 이하 A 서버<br>대외계 AP (2대, L4 연결)/ RHEL7.2 : 이하 B 서버.<br><br>(35685)    A                B(active closer) : LISTEN port 10001<br>           |                |<br>CLOSE_WAIT | &lt;-- FIN M --   |  FIN_WAIT1<br>           | -- ACK M+1 --&gt; |  FIN_WAIT2<br> LAST_ACK  | --  FIN N --&gt;  |  TIME_WAIT<br> CLOSED    | &lt;-- ACK N+1--  | <br>    '      |                |  (RHEL에서 MSL 시간은 30초입니다. 때문에 ack를 보낸후 <br>    '      |                |   TIME_WAIT 상태에서 60초 기다립니다.)              <br>    '      |  -- SYN N--&gt;   |     <br>    '            &lt;생략&gt;<br>    '<br>     `---&gt;  이 시점에 A 서버의 35685포트는 이미 릴리즈 되었습니다. <br>            이때는 B 서버의 전 소켓의 time_wait 시간과 (2*MSL = 60초) <br>            상관없이 A 서버에서 35685 포트로부터 다시 syn 연결 요청을 <br>            보낼수 있고 새 tcp 소켓을 맺을수 있습니다.<br>            (B 서버에서는 10001포트를 계속 리스닝 하고 있기 때문에)          <br>~~~~~~~~~~~~~~~~~~~~~<br><br>따라서 다시한번 결론을 말씀드리자면 본 이슈는 MSL 값과 연관이 없을 것으로 보이며 <br>또한 MSL 값은 30초로 하드코딩 되어 있기 때문에 변경이 불가능합니다.<br><br>이상 답변이 업무에 도움이 되기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-13T08:48:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBR19IAH"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-13T07:22:04Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-13T07:22:03Z</b><br><br>답변 감사합니다 <br><br>현재로는 L4 스위치 2초 time-out 설정을 disable하는 설정과 L4 스위치를 거치지 않고 두 서버를 통신하게 해보는 것은 운영중인서버라서 어려움이 있습니다<br><br>해당 증상시 조치할 부분이나 다른 방법은 없는건가요?<br><br>아래와 같은 방법이 있다고 하는데요 관련하여 OS단에 필요한 부분이 있을까요? <br><br>확인 부탁드립니다<br><br>감사합니다<br><br><br>-----------------------------------------------------------<br><br><br>ㅁ 원인 : L4의 Architecture와 PO서버의 잦은 source port reuse 건이 맞물리면서  reset이 발생<br><br>    1. L4에서는 안정적인 세션관리를 위해 종료된 이후 2초간 세션 table을 유지하는데<br><br>    2. 해당 2초 내에 PO서버에서 같은 source port로 통신을 시도할 경우<br><br>  reset이 발생하는 것으로 보입니다.<br><br><br>ㅁ Workaroud<br><br>  아시겠지만, RFC 793에서는 port reuse의 term인 MSL(Max Segment Lifetime)의 시간을 2분정도로 권고하는데요.<br><br>  해당 현상으로 봤을때 PO서버의 MSL은 무척 짧을 것으로 추정이 됩니다.<br><br>  이를 RFC 권고안대로 늘리면 해당 현상은 발생하지 않을 것으로 보입니다.<br><br>  <br><br>PO서버의 현재 설정값 및 조정가능여부 확인을 부탁드립니다.<br><br>감사합니다.<br><br>아래는 MSL과 관련된 내용으로 참고하시면 될 것 같습니다.<br>======================<br>A가 먼저 close를 요청하고 B에서도 종료하겠다는 FIN을 전송한다. 그럼 B에서 전송한 FIN을 A (Active close side) 쪽에서 수신하게 되면 TIME-WAIT 상태로 전환된다. 이 때 기다리는 시간은 2MSL (Maximum Segment Lifetime) 이 된다.<br>ㅁ TIME-WAIT의 세 가지 사항<br>1. 보통 Active close side만 TIME-WAIT이 발생한다.<br>먼저 FIN을 전송하는 쪽을 의미한다. 반대로 수신하는쪽은 Passive close한다. 양쪽에서 동시에 close를 전송하는 것을 Simultaneous close라고한다. 이때에는 양쪽 모두 TIME-WAIT 상태가 도니다.<br><br>2. RFC 793에서는 MSL의 시간을 2분으로 정의한다. 하지만, 현실에서는 잘 지켜지지 않는다. 보통 30초 ~ 2분정도 TIME-WAIT 시간을 갖는다.<br><br>3. TIME-WAIT 상태에서 어떠한 세그먼트가 도착하면 TIME-WAIT의 시간 값은 초기화 된다.<br><br>4. TIME-WAIT 상태에서는 동일한 IP, PORT로 재할당이 되지 않는다.<br>아직 커널에서 해당 자원을 사용중이라고 판단하기 때문이다. 서버 테스트 프로그램을 하다가 SIGINT와 같은 방법으로 강제 종료했을 때, 서버의 Listen Socket이 TIME-WAIT 상태가 되어 쉽게 이를 확인할 수 있다.<br><br>ㅁ TIME-WAIT 상태를 왜 사용해야 하는가?<br>1. active close side의 마지막 FIN-ACK가 유실된 상황에서 연결을 유지하여 다른쪽에서 FIN을 전송할 수 있도록 한다.<br><br>2.  연결이 네트워크로부터 사라지기 전에 &quot;늦게 들어오는 세그먼트&quot;를 위한 시간 제공<br><br>[출처] [Effective TCP/IP Prog.] 22. 연결을 닫기 위해 TIME-WAIT 정보 사용을 폐기하지 말라|작성자 cobus<br><br>---------------------------------------------<br><br><publishedDate>2018-07-13T07:22:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBPQlIAP"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-13T04:42:51Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-13T04:42:51Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>커널 파라메터를 올려주셔서 감사합니다.<br>L4 스위치의 해당 2초 time-out 설정을 disable 해놓고 테스트를 해보실수 있는지요?<br>혹은 L4 스위치를 거치지 않고 두 서버가 통신을 하게끔 테스트 하실수 있는 방법은 있는지요?<br><br>현재로서는 OS 단에서 조정하여 테스트 할만한 사항이 있어보이지 않습니다. 테스트후 공유해주시면 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-13T04:42:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NBPIhIAP"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-13T04:24:02Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-13T04:24:02Z</b><br><br>sosreport는 파일전송시스템으로 전달이되서 시간이 약간 소요됩니다<br>도착하는데로 올려드리도록 하겠습니다<br><br>우선 커널파라미터값은 수집된것이 있어서 올려드립니다<br><br>감사합니다<br><br><publishedDate>2018-07-13T04:24:02Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBPDrIAP"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2018-07-13T04:09:55Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2018-07-13T04:09:55Z</b><br><br>네 맞습니다 L4 스위치에서는 세션 타임아웃이 2초로 셋업되어 있다고 합니다<br><br><publishedDate>2018-07-13T04:09:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NBOmnIAH"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2018-07-13T03:01:56Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2018-07-13T03:01:56Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>먼저 시스템의 설정상황을 확인 해볼 필요가 있으므로 양 노드의 sosreport를 수집하신후 본 케이스에 첨부 부탁드립니다.<br><br>&gt;&gt; L4 스위치 세션 타임아웃 시간(2초) 내에 남아있던 Client port 정보 충돌로 Connection reset 발생<br>해당 문구의 뜻은 L4 스위치에 별도로 세션 타임아웃 시간이 2초로 설정이 되어 있다는 뜻인가요?<br><br>확인 부탁드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-07-13T03:01:56Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>