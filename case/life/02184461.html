======================<br><b>생성계정 : JIMIN KIM</b><br><b>생성날짜 : 2018-09-18T06:28:18Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-10-05T10:06:14Z</b><br><b>id : 500A000000bynXNIAY</b><br>======================<br><br><b><font size=15>
제목  : ntpdate 서비스 가동시 ntpdate[4851]: no server suitable for synchronization found 로그 관ㄹ
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 상암센터 김지민 선임입니다.<br><br>ntpdate 서비스 동작 관련해서 문의드리려고 합니다.<br><br>아래와 같이 ntpdate 서비스 가동 중간에<br>Sep 16 15:38:47 SLQAFIAL01 ntpdate[4851]: no server suitable for synchronization found<br>위와 같이 에러가 발생하는데 해당 메시지 발생 이유 관련해서 문의드리려고 합니다.<br><br>root@SLQAFIAL01 /root #systemctl status ntpdate.service<br>* ntpdate.service - Set time via NTP<br>   Loaded: loaded (/usr/lib/systemd/system/ntpdate.service; enabled; vendor preset: disabled)<br>   Active: active (exited) since Sun 2018-09-16 15:39:24 KST; 1 day 23h ago<br> Main PID: 4833 (code=exited, status=0/SUCCESS)<br>   CGroup: /system.slice/ntpdate.service<br><br>Sep 16 15:38:43 SLQAFIAL01 systemd[1]: Starting Set time via NTP...<br>Sep 16 15:38:47 SLQAFIAL01 ntpdate[4851]: no server suitable for synchronization found<br>Sep 16 15:39:24 SLQAFIAL01 systemd[1]: Started Set time via NTP.<br><br>혹시 추가 정보 필요하신 내역있으면 답변 부탁드립니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLQAFIAL01</hostname><br><br><br><comment id="a0aA000000Nmi6sIAB"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-09-19T07:28:21Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-09-19T07:28:21Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>아래의 문서를 참고 하시기 바랍니다.<br>- Best practices for NTP<br>https://access.redhat.com/solutions/778603<br><br>감사합니다.<br><br><publishedDate>2018-09-19T07:28:21Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Nmg4DIAR"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-09-19T04:07:04Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-09-19T04:07:04Z</b><br><br>안녕하세요<br><br>빠른 답변 감사드립니다.<br><br>ntp 관련해서 추가로 문의드릴 점은<br><br>혹시 redhat의 recommendation 설정으로 4개 혹은 1개의 ntp 서버 사용 관련해서<br>가이드 문서가 있는지 한번 확인 부탁드리려고 합니다.<br><br>감사합니다.<br><br><publishedDate>2018-09-19T04:07:04Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Nmf92IAB"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-09-19T01:50:48Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-09-19T01:50:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>ntp 정상 여부는 서비스 기동후 약 20분 지난후에 아래와 같은 명령어로 확인 가능 하십니다. <br>만일 *으로 표기된 서버가 있다면 시간 동기화가 정상적으로 될것입니다.<br><br># ntpq -p<br><br>또한 만일 서버가 지속적으로 ntp 서버와 시간 동기화를 진행하시는것을 원하신다면<br>ntpd 서비스를 기동해야 하며 ntpdate 서비스는 비활성화 해주셔야 합니다.<br><br>추가적으로 ntp 서버를 2개 설정하신것으로 확인되는데 가능하시면 저희 recommendation에<br>따라 4개 혹은 1개 ntp 서버를 사용하시는것을 권장 드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-09-19T01:50:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NmPOPIA3"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-09-18T08:03:01Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-09-18T08:03:01Z</b><br><br>안녕하세요<br><br>김지민 선임입니다.<br><br>ntpd 상태 보내드립니다.<br>지금 ntpd의 상태는 정상처럼 입니다.<br><br>root@SLQAFIAL01 /root #systemctl status ntpd.service<br>* ntpd.service - Network Time Service<br>   Loaded: loaded (/usr/lib/systemd/system/ntpd.service; enabled; vendor preset: disabled)<br>   Active: active (running) since Sun 2018-09-16 17:27:21 KST; 1 day 23h ago<br> Main PID: 43107 (ntpd)<br>   CGroup: /system.slice/ntpd.service<br>           `-43107 /usr/sbin/ntpd -u ntp:ntp -g -4 -x<br><br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: ntp_io: estimated max descriptors: 1024, initial socke... 16<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listen and drop on 0 v4wildcard 0.0.0.0 UDP 123<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listen normally on 1 lo 127.0.0.1 UDP 123<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listen normally on 2 bond0 25.254.200.111 UDP 123<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listen normally on 3 bond2 25.254.200.121 UDP 123<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listen normally on 4 bond3 25.254.200.131 UDP 123<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: Listening on routing socket on fd #21 for interface updates<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: 0.0.0.0 c016 06 restart<br>Sep 16 17:27:21 SLQAFIAL01 ntpd[43107]: 0.0.0.0 c012 02 freq_set ntpd 4.349 PPM<br>Sep 16 17:30:37 SLQAFIAL01 ntpd[43107]: 0.0.0.0 c615 05 clock_sync<br>Hint: Some lines were ellipsized, use -l to show in full.<br><br>감사합니다.<br><br><publishedDate>2018-09-18T08:03:01Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NmPLaIAN"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-09-18T08:00:08Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-09-18T08:00:08Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>ntpd 서비스 상태는 어떠한지 확인 부탁 드립니다.<br>ntpd 서비스 또한 중지한 상태 이시다면 아래와 같이 <br>ntpdate 명령어 실행시 시간 동기화 작업이 진행 되는지 확인 부탁 드립니다.<br><br># ntpdate PNTPML01SL<br>&lt;=== PNTPML01SL 대신 ntp 서버의 IP를 사용하셔도 됩니다.<br><br>감사합니다.<br><br><publishedDate>2018-09-18T08:00:08Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NmPEKIA3"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-09-18T07:51:09Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-09-18T07:51:09Z</b><br><br>안녕하세요 <br><br>빠른 답변 감사드립니다.<br><br>chrony 서비스는 mask 처리 하였습니다.<br><br>추가로 요청하신 내역 보내드립니다.<br><br>root@SLQAFIAL01 /root #cat /etc/ntp.conf<br># For more information about this file, see the man pages<br># ntp.conf(5), ntp_acc(5), ntp_auth(5), ntp_clock(5), ntp_misc(5), ntp_mon(5).<br><br>driftfile /var/lib/ntp/drift<br><br># Permit time synchronization with our time source, but do not<br># permit the source to query or modify the service on this system.<br>restrict default nomodify notrap nopeer noquery<br><br># Permit all access over the loopback interface.  This could<br># be tightened as well, but to do so would effect some of<br># the administrative functions.<br>restrict 127.0.0.1<br>#restrict ::1<br><br># Hosts on local network are less restricted.<br>#restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap<br><br># Use public servers from the pool.ntp.org project.<br># Please consider joining the pool (http://www.pool.ntp.org/join.html).<br>#server 0.rhel.pool.ntp.org iburst<br>#server 1.rhel.pool.ntp.org iburst<br>#server 2.rhel.pool.ntp.org iburst<br>#server 3.rhel.pool.ntp.org iburst<br><br>#broadcast 192.168.1.255 autokey        # broadcast server<br>#broadcastclient                        # broadcast client<br>#broadcast 224.0.1.1 autokey            # multicast server<br>#multicastclient 224.0.1.1              # multicast client<br>#manycastserver 239.255.254.254         # manycast server<br>#manycastclient 239.255.254.254 autokey # manycast client<br><br># Enable public key cryptography.<br>#crypto<br><br>includefile /etc/ntp/crypto/pw<br><br># Key file containing the keys and key identifiers used when operating<br># with symmetric key cryptography.<br>keys /etc/ntp/keys<br><br># Specify the key identifiers which are trusted.<br>#trustedkey 4 8 42<br><br># Specify the key identifier to use with the ntpdc utility.<br>#requestkey 8<br><br># Specify the key identifier to use with the ntpq utility.<br>#controlkey 8<br><br># Enable writing of statistics records.<br>#statistics clockstats cryptostats loopstats peerstats<br><br># Disable the monitoring facility to prevent amplification attacks using ntpdc<br># monlist command when default restrict does not include the noquery flag. See<br># CVE-2013-5211 for more details.<br># Note: Monitoring will not be disabled with the limited restriction flag.<br>disable monitor<br><br>server PNTPML01SL true<br>restrict PNTPML01SL mask 255.255.255.255 nomodify notrap noquery<br>server PNTPML02SL<br>restrict PNTPML02SL mask 255.255.255.255 nomodify notrap noquery<br>root@SLQAFIAL01 /root #cat /etc/sysconfig/ntpdate<br># Options for ntpdate<br>OPTIONS=&quot;-p 2 -4&quot;<br><br># Number of retries before giving up<br>RETRIES=2<br><br># Set to 'yes' to sync hw clock after successful ntpdate<br>SYNC_HWCLOCK=yes<br><br>감사합니다.<br><br><publishedDate>2018-09-18T07:51:09Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NmOqBIAV"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-09-18T07:16:33Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-09-18T07:16:33Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>저는 Platform Support 를 담당하고 있는 Senior Technical Support Engineer 황 영 입니다.<br><br>ntpdate 서비스를 기동하면 /etc/ntp.conf 파일에 설정된 서버와 시간 동기화 작업을 한번 하게 됩니다.<br>즉 &quot;ntpdate &lt;ntp_server&gt;&quot; 명령어를 실행합니다. 원인 분석에는 시간을 동기화 하시려는 ntp_server<br>서버와의 통신이 정상적인지 확인 부탁 드립니다.<br>또한 해당 서비스는 ntpd 혹은 chrony 서비스와 동시에 사용하지 말아야 합니다.<br><br>고객님 서버에 ntpd 혹은 chrony 서비스가 기동되어 있는지 확인 부탁 드립니다.<br># systemctl status ntpd.service<br># systemctl status chrony.service<br><br>ntp 설정을 확인 하기 위하여 /etc/ntp.conf 와 /etc/sysconfig/ntpdate 파일을 케이스에 올려주시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2018-09-18T07:16:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>