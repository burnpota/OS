======================<br><b>생성계정 : 타임게이트 타임게이트</b><br><b>생성날짜 : 2017-02-09T08:32:57Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-03-01T11:04:20Z</b><br><b>id : 500A000000WT1VhIAL</b><br>======================<br><br><b><font size=15>
제목  : RHCS fence_node관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요. 두개의 노드가 현재 RHCS로 구성이 되어있습니다.<br>여기에 fence_ipmilan 을 추가 해 파워펜싱을 진행하고자 하는데요.<br>ilO2를 사용중입니다.<br><br>cluster.conf에서 아래와 같이 추가를 하고<br>&lt;fencedevices&gt;<br>                &lt;fencedevice agent=&quot;fence_ipmilan&quot; ipaddr=&quot;10.1.0.202&quot; login=&quot;admin&quot; name=&quot;ipmifence1&quot; passwd=&quot;123qwe..&quot; lanplus=&quot;1&quot; privlvl=&quot;USER&quot; timeout=&quot;60&quot;/&gt;<br>                &lt;fencedevice agent=&quot;fence_ipmilan&quot; ipaddr=&quot;10.1.0.205&quot; login=&quot;admin&quot; name=&quot;ipmifence2&quot; passwd=&quot;123qwe..&quot; lanplus=&quot;1&quot; privlvl=&quot;USER&quot; timeout=&quot;60&quot;/&gt;<br>        &lt;/fencedevices&gt;<br><br>클러스터 노드에서  아래와 같이 추가를 하였습니다.<br>&lt;clusternodes&gt;<br>                &lt;clusternode name=&quot;flptrsd01.cs&quot; nodeid=&quot;1&quot;&gt;<br>                        &lt;fence&gt;<br>                                &lt;method name=&quot;Method1&quot;&gt;<br>                                        &lt;device name=&quot;ipmifence2&quot;/&gt;<br>                                &lt;/method&gt;<br>                        &lt;/fence&gt;<br>                &lt;/clusternode&gt;<br>                &lt;clusternode name=&quot;flptrsd02.cs&quot; nodeid=&quot;2&quot;&gt;<br>                        &lt;fence&gt;<br>                                &lt;method name=&quot;Method1&quot;&gt;<br>                                        &lt;device name=&quot;ipmifence1&quot;/&gt;<br>                                &lt;/method&gt;<br>                        &lt;/fence&gt;<br>                &lt;/clusternode&gt;<br><br><br>cman을 재기동후 정상적인 클러스터 상태를 확인하였습니다.<br><br>Cluster Status for cl_TRSD @ Thu Feb  9 17:23:54 2017<br>Member Status: Quorate<br><br> Member Name                                                     ID   Status<br> ------ ----                                                     ---- ------<br> flptrsd01.cs                                                        1 Online, Local<br> flptrsd02.cs                                                        2 Online<br><br>제가 궁금한 점은<br>fence_node 명령어를 이용하여 <br>현재 구성된 fence_ipmilan 테스트를 하고 싶은데요<br>flptrsd01 노드에서 fence_node flptrsd02.cs -vv 명령어를 사용하면 <br>[root@flptrsd01 ~]# fence_node flptrsd02.cs -vv<br>fence flptrsd02.cs dev 0.0 agent fence_ipmilan result: error from agent<br>agent args: nodename=flptrsd02.cs agent=fence_ipmilan ipaddr=10.1.0.202 login=admin passwd=123qwe.. lanplus=1 privlvl=USER timeout=60<br>fence flptrsd02.cs failed<br>메시지가 뜨면서 Success가 되지 않습니다.<br>자세한 사항은 sosreport를 첨부드리겠습니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.5</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 4 (Low)</b><br>======================<br><comment id="a0aA000000IoJ3iIAF"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2017-02-13T08:02:48Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2017-02-13T08:02:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용 해 주셔서 감사합니다. <br><br><br>먼저 확인에 감사 드립니다. <br><br>Power 상태를 확인시에는 문제가 없는 것을 보면은 fencing agent랑 통신 문제가 <br>없는 것입니다. 가능 하시면 action을 reboot으로 바꿔 보시고 문제가 없는지 <br>확인 부탁드립니다. <br><br>[root@flptrsd01 ~]# fence_ipmilan -a 10.1.0.205 -l admin -p 123qwe.. -o reboot -P -t 60 -L USER -vvv<br><br>참고로, fence_node [nodename] 으로 fencing 테스트 하시는게 문제가 없습니다. <br>실패 된 원인은 fence_ipmilan 호출시에 문제가 생긴듯합니다. <br>======================<br>감사합니다. <br><br>Red Hat GSS<br>정미연 드림<br><br><publishedDate>2017-02-13T08:02:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IoDV8IAN"><br>======================<br><b>생성계정 : 타임게이트, 타임게이트</b><br><b>생성날짜 : 2017-02-12T00:00:56Z</b><br><b>마지막 답변자 : 타임게이트, 타임게이트</b><br><b>마지막 수정 일자 : 2017-02-12T00:00:56Z</b><br><br>답변감사합니다.<br>flptrsd01 에서 flptrsd02.ipmi에 fence_ipmilan을 하였을때 결과입니다.<br>[root@flptrsd01 ~]# fence_ipmilan -a 10.1.0.205 -l admin -p 123qwe.. -o status -P -t 60 -L USER -vvv<br>Getting status of IPMI:10.1.0.205...Spawning: '/usr/bin/ipmitool -I lanplus -H '10.1.0.205' -U 'admin' -L 'USER' -P '[set]' -v -v -v chassis power status'...<br>Spawned: '/usr/bin/ipmitool -I lanplus -H '10.1.0.205' -U 'admin' -L 'USER' -P '[set]' -v -v -v chassis power status' - PID 36334<br>Looking for:<br>    'Password:', val = 1<br>    'Unable to establish LAN', val = 11<br>    'IPMI mutex', val = 14<br>    'Unsupported cipher suite ID', val = 2048<br>    'read_rakp2_message: no support for', val = 2048<br>    'Chassis Power is off', val = 4096<br>    'Chassis Power is on', val = 8192<br>ExpectToken returned 8192<br>Reaping pid 36334<br>Chassis power = On<br>Done<br><br>flptrsd02 에서  flptrsd01.ipmi 에 ipmilan을 하였을때 결과입니다.<br>[root@flptrsd02 ~]# fence_ipmilan -a 10.1.0.202 -l admin -p 123qwe.. -o status -P -t 60 -L USER -vvv<br>Getting status of IPMI:10.1.0.202...Spawning: '/usr/bin/ipmitool -I lanplus -H '10.1.0.202' -U 'admin' -L 'USER' -P '[set]' -v -v -v chassis power status'...<br>Spawned: '/usr/bin/ipmitool -I lanplus -H '10.1.0.202' -U 'admin' -L 'USER' -P '[set]' -v -v -v chassis power status' - PID 17469<br>Looking for:<br>    'Password:', val = 1<br>    'Unable to establish LAN', val = 11<br>    'IPMI mutex', val = 14<br>    'Unsupported cipher suite ID', val = 2048<br>    'read_rakp2_message: no support for', val = 2048<br>    'Chassis Power is off', val = 4096<br>    'Chassis Power is on', val = 8192<br>ExpectToken returned 8192<br>Reaping pid 17469<br>Chassis power = On<br>Done<br><br>정상적으로 통신이 되는것으로 보입니다.<br> 혹시  fence_node [nodename]하여서 현재 fence가 정상적인지 확인하는 방식이 잘못된 것인가요??<br><br><publishedDate>2017-02-12T00:00:56Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000InuFFIAZ"><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2017-02-10T05:29:34Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2017-02-10T05:29:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다. <br><br><br>아래와 같이 테스트 해 보시고 명령어의 출력 결과를 보내 주시기 바랍니다. <br># fence_ipmilan -a 10.1.0.202 -l admin -p 123qwe.. -o status -P -t 60 -L USER -vvv<br><br>참고 자료:<br> How can I diagnose fence_ipmilan failures in RHEL 5, 6, or 7? <br> - https://access.redhat.com/solutions/1153973<br><br><br>감사합니다. <br><br>Red Hat GSS<br>정미연 드림<br><br><publishedDate>2017-02-10T05:29:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>여기에 fence_ipmilan 을 추가 해 파워펜싱을 진행하고자 하는데요.<br>ilO2를 사용중입니다.<br><br>cluster.conf에서 아래와 같이 추가를 하고<br>&lt;fencedevices&gt;<br>                &lt;fencedevice agent=&quot;fence_ipmilan&quot; ipaddr=&quot;10.1.0.202&quot; login=&quot;admin&quot; name=&quot;ipmifence1&quot; passwd=&quot;123qwe..&quot; lanplus=&quot;1&quot; privlvl=&quot;USER&quot; timeout=&quot;60&quot;/&gt;<br>                &lt;fencedevice agent=&quot;fence_ipmilan&quot; ipaddr=&quot;10.1.0.205&quot; login=&quot;admin&quot; name=&quot;ipmifence2&quot; passwd=&quot;123qwe..&quot; lanplus=&quot;1&quot; privlvl=&quot;USER&quot; timeout=&quot;60&quot;/&gt;<br>        &lt;/fencedevices&gt;<br><br>클러스터 노드에서  아래와 같이 추가를 하였습니다.<br>&lt;clusternodes&gt;<br>                &lt;clusternode name=&quot;flptrsd01.cs&quot; nodeid=&quot;1&quot;&gt;<br>                        &lt;fence&gt;<br>                                &lt;method name=&quot;Method1&quot;&gt;<br>                                        &lt;device name=&quot;ipmifence2&quot;/&gt;<br>                                &lt;/method&gt;<br>                        &lt;/fence&gt;<br>                &lt;/clusternode&gt;<br>                &lt;clusternode name=&quot;flptrsd02.cs&quot; nodeid=&quot;2&quot;&gt;<br>                        &lt;fence&gt;<br>                                &lt;method name=&quot;Method1&quot;&gt;<br>                                        &lt;device name=&quot;ipmifence1&quot;/&gt;<br>                                &lt;/method&gt;<br>                        &lt;/fence&gt;<br>                &lt;/clusternode&gt;<br><br><br>cman을 재기동후 정상적인 클러스터 상태를 확인하였습니다.<br><br>Cluster Status for cl_TRSD @ Thu Feb  9 17:23:54 2017<br>Member Status: Quorate<br><br> Member Name                                                     ID   Status<br> ------ ----                                                     ---- ------<br> flptrsd01.cs                                                        1 Online, Local<br> flptrsd02.cs                                                        2 Online<br><br>제가 궁금한 점은<br>fence_node 명령어를 이용하여 <br>현재 구성된 fence_ipmilan 테스트를 하고 싶은데요<br>flptrsd01 노드에서 fence_node flptrsd02.cs -vv 명령어를 사용하면 <br>[root@flptrsd01 ~]# fence_node flptrsd02.cs -vv<br>fence flptrsd02.cs dev 0.0 agent fence_ipmilan result: error from agent<br>agent args: nodename=flptrsd02.cs agent=fence_ipmilan ipaddr=10.1.0.202 login=admin passwd=123qwe.. lanplus=1 privlvl=USER timeout=60<br>fence flptrsd02.cs failed<br>메시지가 뜨면서 Success가 되지 않습니다.<br>자세한 사항은 sosreport를 첨부드리겠습니다.</issue><cep>false</cep></case>