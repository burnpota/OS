======================<br><b>생성계정 : 타임게이트 (주)</b><br><b>생성날짜 : 2017-10-16T02:39:03Z</b><br><b>마지막 답변자 : 타임게이트 (주)</b><br><b>마지막 수정 일자 : 2017-10-17T05:40:55Z</b><br><b>id : 500A000000YTNkaIAH</b><br>======================<br><br><b><font size=15>
제목  : [삼성생명] 번들 http server 옵션문의(Timeout)
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요 apache - tomcat timeout 관련하여 재 문의가 있어 SR 생성드립니다. <br><br>## 고객정보 ## <br>고객사 : 삼성생명<br>고객명 : 박현우 선임<br>연락처 : 010-9104-2853<br>##<br><br>## 환경정보 ##<br>OS : RHEL 7.2<br>web : bundle http server 2.4.x<br>이전 SR 진행번호 : 기술 문의 01938049<br>##<br><br>현재  httpd.conf 내 timeout 관련 설정은 하기와 같이 Timeout 외에는 없는 것으로 확인됩니다. <br><br>## httpd.conf 일부 ##<br>TimeOut 600<br>##<br><br>i.e 상의 개발자도구를 이용하여 정상케이스와 비정상케이스를 확인결과 다수의 .do 요청이 호출되는 과정 중 지연이 발생할 경우(네트워크, 조회지연 등의 이슈) 약 30~40초 후 경고팝업이 발생하며 apache access 로그에는 404HTTP code가 발생합니다. <br>- client - web 간의 연결이 강제로 종료되는 것으로 추측됨.<br><br>문의1. 설정한 Timeout 600(초) 가 도달하지 않았는데 mod_proxy를 사용함에 있어 별도의 timeout 관련 설정이 존재하는지요?<br>관련 URL1: https://httpd.apache.org/docs/2.4/mod/core.html#timeout<br><br>문의2. 지난번 기술문의(01938049) 시 강제로 종료시키는 케이스에 대하여 말씀주셨는데 호출한 client의 설정(익스플로러) 의 연결유지시간이 Timeout에 영향을 미치는지요? <br>관련URL2 : https://support.microsoft.com/ko-kr/help/813827/how-to-change-the-default-keep-alive-time-out-value-in-internet-explor<br><br>확인요청드립니다 .<br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000KhYVrIAN"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-10-17T02:24:17Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-10-17T02:24:17Z</b><br><br>안녕하세요,<br><br>1. 현재 httpd.conf의 설정 상 TimeOut는 600초 외에는 없습니다. <br>apache에서 처리하는 request의 전체 처리에 대한 timeout을 의미한다고 정의되어 있는데 client - web 간 정상 connection을 못할 시 연결대기와는 무관한지요?<br>만약 무관하다면, 관련설정이 있는지 확인요청드립니다. <br>==&gt;<br>client - web 사이의 connection에 대한 timeout 관련 설정은 apache에서 정의하는 바가 없습니다.<br>보통은 platform(OS)에서 tcp parameter로 socket connection에 대한 timeout 설정들을 하게 됩니다.<br><br>2. 현재 keepAlive 옵션을 disable 하기위해 상기와 같이 적용하였습니다.  기 가이드 주신 것과 같이 적용해야만 적용되는지 다시한번 확인요청드립니다. <br>==&gt;<br>네, 다시한번 말씀드리지만 해당 keepalive는 client-web connection과는 무관하며, mod_proxy를 통한 connection에 대한 keepalive &amp; pool disable 설정입니다.<br><br>감사합니다.<br><br><publishedDate>2017-10-17T02:24:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KhXyJIAV"><br>======================<br><b>생성계정 : (주), 타임게이트</b><br><b>생성날짜 : 2017-10-17T01:03:23Z</b><br><b>마지막 답변자 : (주), 타임게이트</b><br><b>마지막 수정 일자 : 2017-10-17T01:03:23Z</b><br><br>안녕하세요! 빠른 답변에 감사드립니다. <br>질문이 잘못되어 다시 문의드립니다. <br><br>운영계에서 기 문의드린 것과 같이 web-was 간의 네트워크, 응답지연 등의 이유로 apache error_log  상 70007, 70008, 70014등의 스택이 적재되고 있어<br>개발계에서 동일 환경을 구축하여 테스트 중에 있습니다. <br>임의로 응답지연을 발생시키기 위해 i.e 개발자 도구의 디버거모드에서 강제로 pause를 하여 테스트 수행 시 약 20초~30초내외로 ap상 에러팝업이 발생하며 70007 TimeOut이 발생합니다. <br><br>우선 문의사항을 다시 정리드립니다 .<br>1. 현재 httpd.conf의 설정 상 TimeOut는 600초 외에는 없습니다. <br> apache에서 처리하는 request의 전체 처리에 대한 timeout을 의미한다고 정의되어 있는데 client - web 간 정상 connection을 못할 시 연결대기와는 무관한지요?<br>만약 무관하다면, 관련설정이 있는지 확인요청드립니다. <br>## httpd.conf 일부 ##<br>ServerRoot &quot;/etc/httpd&quot;<br>&lt;IfModule !mpm_winnt.c&gt;<br>&lt;IfModule !mpm_netware.c&gt;<br>&lt;/IfModule&gt;<br>&lt;/IfModule&gt;<br>&lt;IfModule !mpm_netware.c&gt;<br>&lt;IfModule !perchild.c&gt;<br>&lt;/IfModule&gt;<br>&lt;/IfModule&gt;<br>&lt;IfModule !mpm_netware.c&gt;<br>PidFile /APP/ep/apache/pid/ep_domain.pid<br>&lt;/IfModule&gt;<br>DefaultRuntimeDir /APP/ep/runtime<br>ServerTokens ProductOnly<br>TraceEnable Off<br>Timeout 600<br>KeepAlive OFF<br>## 이하 생략 ##<br><br>2. 현재 keepAlive 옵션을 disable 하기위해 상기와 같이 적용하였습니다.  기 가이드 주신 것과 같이 적용해야만 적용되는지 다시한번 확인요청드립니다. <br>&lt;Proxy&gt;<br>~~~<br>SetEnv proxy-nokeepalive 1<br>SetEnv proxy-initial-not-pooled 1<br>~~~<br>&lt;/Proxy&gt;<br><br>감사합니다<br><br><publishedDate>2017-10-17T01:03:23Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KhFlwIAF"><br>======================<br><b>생성계정 : Park, Min Woo</b><br><b>생성날짜 : 2017-10-16T05:39:00Z</b><br><b>마지막 답변자 : Park, Min Woo</b><br><b>마지막 수정 일자 : 2017-10-16T05:39:00Z</b><br><br>안녕하세요,  <br>  <br>Red Hat Global Support Services를 이용해주셔서 감사합니다.  <br><br><br>문의1. 설정한 Timeout 600(초) 가 도달하지 않았는데 mod_proxy를 사용함에 있어 별도의 timeout 관련 설정이 존재하는지요?<br>관련 URL1: https://httpd.apache.org/docs/2.4/mod/core.html#timeout<br>=&gt;<br>mod_proxy 사용시 ProxyTimeout을 설정할 수 있으며, ProxyTimeout 미설정시 Timout value를 디폴트로 합니다. (https://httpd.apache.org/docs/2.4/mod/mod_proxy.html#proxytimeout)<br><br>Timeout : Amount of time the server will wait for certain events before failing a request <br>ProxyTimeout : Network timeout for proxied requests<br><br>Timeout은 apache에서 처리하는 request의 전체 처리에 대한 timeout을 의미하고,<br>ProxyTimeout은 proxy request (mod_proxy를 통해 처리되는 request)의 처리에 대한 timeout을 의미합니다.<br><br><br>문의2. 지난번 기술문의(01938049) 시 강제로 종료시키는 케이스에 대하여 말씀주셨는데 호출한 client의 설정(익스플로러) 의 연결유지시간이 Timeout에 영향을 미치는지요? <br>관련URL2 : https://support.microsoft.com/ko-kr/help/813827/how-to-change-the-default-keep-alive-time-out-value-in-internet-explor<br>=&gt;<br>링크를 보면, 아래와 같이 설명이 되어 있습니다.<br>&quot;Internet Explorer에서 Connection: Keep-Alive 헤더를 사용하여 웹 서버와 영구 HTTP 연결을 설정하면 Internet Explorer는 초기 요청을 받는 데 사용한 TCP/IP 소켓의 유휴 시간이 1분을 경과할 때까지 이 소켓을 다시 사용합니다. 연결 유휴 시간이 1분을 경과하면 Internet Explorer는 연결을 다시 설정하고 새 TCP/IP 소켓을 사용하여 추가 요청을 받습니다. Internet Explorer에서 HTTP KeepAliveTimeout 값을 변경할 수 있습니다.<br><br>클라이언트 브라우저(Internet Explorer)의 KeepAlive 값이나 웹 서버의 KeepAlive 값 중 더 작은 값이 제한 값이 됩니다. 예를 들어, 클라이언트의 시간 제한 값이 2분이고 웹 서버의 시간 제한 값이 1분이면 최대 시간 제한 값은 1분이 됩니다. 클라이언트 값이나 서버 값 중 하나가 제한 값이 될 수 있습니다.&quot;<br><br>제가 이해하기로는 web server의 keepalive 설정과 동일한 설정으로 보이며, 이는 apache의 Timeout 설정과 아무 상관없습니다.<br><br>이전 케이스 01938049에서 설명드린 proxy-nokeepalive, proxy-initial-not-pooled 설정은 web(apache) - was 구간을 keepalive * pool 기능을 사용하지 않겠다는 의미입니다.<br>즉 web-was 구간에서는 request 마다 새로운 tcp 연결을 맺겠다는 뜻이며, 이 또한 링크주신 내용의 keepalive와는 상관없는 내용입니다.<br><br>링크상의 내용을 보면 web - was 구간이 아닌, client(browser) - web(apache) 구간의 연결에 대한 것으로 보입니다.<br><br>링크주신 MS에서 설명하는 keepalive 처럼 apache에서도 KeepAliveTimeout을 설정할 수 있습니다.<br>아시다시피 apache의 keepalive는 request 전송이 되면 client - web 구간에 tcp 연결을 해 놓고, 동일 client로부터 다음 request가 왔을때 새로 tcp socket을 생성하지 않고 기존에 생성한 socket을 사용하겠다는 의미힙니다.<br>이에 대해 다음 request가 올때까지 얼마나 기다릴지에 대한 timeout이 KeepAliveTimeout 입니다.<br>KeepAliveTimeout : Amount of time the server will wait for subsequent requests on a persistent connection (https://httpd.apache.org/docs/2.4/mod/core.html#keepalivetimeout)<br><br><br>i.e 상의 개발자도구를 이용하여 정상케이스와 비정상케이스를 확인결과 다수의 .do 요청이 호출되는 과정 중 지연이 발생할 경우(네트워크, 조회지연 등의 이슈) 약 30~40초 후 경고팝업이 발생하며 apache access 로그에는 404HTTP code가 발생합니다. <br>- client - web 간의 연결이 강제로 종료되는 것으로 추측됨.<br><br>=&gt;<br>&quot;경고팝업&quot;이 발생한다고 하셨는데, 이 팝업을 생성하는 주체가 어디인가요?<br>일반적으로 web이나 was 구간에서의 응답저하인 경우에는 http 500 'Internal Server Error' 또는 503 'Server Unavailable' 이 발생합니다.<br>client - web 간의 연결에 대해 지연이 발생한다고 apache side에서 강제 종료할 수 있는 부분은 없습니다.<br>우선은 &quot;경고팝업&quot;의 내용이 뭔지, 해당 팝업을 생성하는 주체가 어디인지를 파악하셔얄 할 것으로 보입니다.<br><br>감사합니다. <br>Minwoo Park<br><br><publishedDate>2017-10-16T05:39:00Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>