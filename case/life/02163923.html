======================<br><b>생성계정 : JIMIN KIM</b><br><b>생성날짜 : 2018-08-17T05:36:54Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-09-08T10:03:49Z</b><br><b>id : 500A000000bR3R6IAK</b><br>======================<br><br><b><font size=15>
제목  : ReaR backup config 관련 문의 (oracleasm 설정 관련)
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요<br><br>SDS 상암센터 <br>김지민 선임입니다.<br><br>아래와 같이 root@TDKREL01SL /root # view /usr/share/rear/conf/default.conf에 <br>oracleasm 관련 설정과 issue 관련 부분이 보이는데요.<br><br>oracleasm을 사용할 경우 ReaR 백업에서 아래 설정을 적용해야하는 것인지 문의드리려고 합니다.<br><br># files/dirs to copy as-is (with tar)<br>COPY_AS_IS=( $SHARE_DIR $VAR_DIR )<br># things to exclude from the copy<br># /dev/oracleasm contains internal files generated by Oracle ASM upon boot.<br># See https://github.com/rear/rear/issues/721 for more details<br>COPY_AS_IS_EXCLUDE=( dev/shm dev/shm/\* dev/oracleasm dev/.udev $VAR_DIR/output/\* )<br><br>추가로 COPY_AS_IS과 COPY_AS_IS_EXCLUDE 의미를 문의드리려고 합니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 1648604</b><br><b>심각도  : 3 (Normal)</b><br><hostname>TDKREL01SL</hostname><br><br><br><comment id="a0aA000000NUfAxIAL"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-24T08:27:17Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-24T08:27:16Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>현재 상황에 대하여 전달해주신 부분 감사드립니다.<br>이슈에 대한 설명뿐만 아니라 상황에 대한 설명을 같이 주셔서 좀 더 원활한 기술지원이 가능할 것 같습니다.<br>이전 문의는 안내드린 것 처럼 02168439 에 답변 드렸습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-24T08:27:16Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NUeJ5IAL"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-08-24T07:06:18Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-08-24T07:06:18Z</b><br><br>안녕하세요<br><br>네 확인 감사드립니다.<br><br>( efibootmgr programs가 없다고 error ) 문의의 경우에는<br>다른 서버들과 같이 구성하던 중 동일하게 설치를 진행하기는 하였는데<br><br>해당 서버만 위와 같은 메세지가 발생하여 문의드렸습니다.<br>동일한 구성에서 1대의 서버만 발생해서 혹시 다른 점이 있을 것 같아서<br>시스템 오픈 전에 문의드렸습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-24T07:06:18Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000NUdGjIAL"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-24T05:01:25Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-24T05:01:25Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>먼저 기술지원 범위에 대하여 말씀드리고자 합니다. 아래는 저희 기술지원 범위입니다.<br><br>Support<br>   • Installation<br>   • Usage<br>   • Configuration<br>   • Diagnosis<br>   • Bug reports (dependent on product life cycle)<br>   • Bug fixes1<br>   • Red Hat Extras channel4<br><br>가급적 문의하시는 모든 질문에 대하여 답변을 드리고자 항상 노력하고 있습니다만, 저희 기술지원은 이슈를 중심으로 진행되며 이슈와 직접적인 관련이 없는 추가적인 문의 사항에 대하여 답변이 제한적일 수 있습니다.<br>그 이유는 이슈가 발생하지 않은 상황에서 모든 설정이나 변수에 대하여 저희가 검증하고 확인해드리기 어려우며, 이 부분은 저희 기술지원 범위에 포함되지 않습니다.<br>현재 케이스에서 문의하신 질문의 유형은 아래와 같은 범주에 포함될 수 있습니다.<br><br>   • Installation<br>   • Usage<br>   • Configuration<br><br>이와 같은 경우 설치, 사용방법, 설정 방법에 대한 문의를 제공하여 드리고 있으며 이런 유형의 작업 도중에 문제가 발생한 경우 지원하고 있습니다.<br>따라서 이슈가 아닌 프로그램의 구조 및 옵션에 관련된 질문에 대하여 제한적일 수 있는 부분 양해부탁드립니다.<br>추가로 마지막 문의는 해당 케이스 최초 이슈와 다른 이슈이므로 새로 생성한 02168439  케이스에서 안내드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-24T05:01:25Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000NUOWcIAP"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-08-23T07:19:22Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-08-23T07:19:22Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br>답변 감사드립니다.<br><br>아래는 현재 ReaR 구축 중인 서버의 설정 정보입니다.<br><br>문의드릴 부분은 <br><br>1) disktodo.conf 부분에 todo와 done 부분이 있는데 혹시 todo가 백업이 되는 부분이고 done은 백업이 되지 않는(제외) 부분인지 문의드립니다.<br><br>2) disklayout.conf에서는 #이 없는 부분만 layout에 반영이 되는 것인지 문의드리려고 합니다.<br><br>3) diskdeps.conf 부분의 역할에 대해서도 문의드립니다.<br><br>4) 구성 중에 아래와 같이 efibootmgr programs가 없다고 error가 발생하였는데<br>   해당 부분의 발생 원인에 대해서도 문의드리려고 합니다.<br>2018-08-23 13:31:16.992656929 Including prep/NETFS/default/400_automatic_exclude_recreate.sh<br>2018-08-23 13:31:16.996337249 Including prep/default/400_save_mountpoint_details.sh<br>2018-08-23 13:31:17.027418253 Including prep/default/500_guess_bootloader.sh<br>4+0 records in<br>4+0 records out<br>2048 bytes (2.0 kB) copied, 8.0583e-05 s, 25.4 MB/s<br>2018-08-23 13:31:17.050726220 Including prep/default/950_check_missing_programs.sh<br>2018-08-23 13:31:17.053674548 ERROR: Cannot find required programs: efibootmgr<br>==== Stack trace ====<br>Trace 0: /sbin/rear:504 main<br>Trace 1: /usr/share/rear/lib/mkbackup-workflow.sh:9 WORKFLOW_mkbackup<br>Trace 2: /usr/share/rear/lib/framework-functions.sh:85 SourceStage<br>Trace 3: /usr/share/rear/lib/framework-functions.sh:45 Source<br>Trace 4: /usr/share/rear/prep/default/950_check_missing_programs.sh:15 source<br>Message: Cannot find required programs: efibootmgr<br>== End stack trace ==<br>2018-08-23 13:31:17.058041996 Running exit tasks.<br>2018-08-23 13:31:17.059784778 Exit task 'umount -f -v '/tmp/rear.W3oenlY7R4Bi9d7/outputfs' &gt;&amp;2'<br>/tmp/rear.W3oenlY7R4Bi9d7/outputfs: nfs mount point detected<br>/tmp/rear.W3oenlY7R4Bi9d7/outputfs: umounted<br>2018-08-23 13:31:17.084041266 Exit task 'rmdir -v /tmp/rear.W3oenlY7R4Bi9d7/outputfs &gt;&amp;2'<br>rmdir: removing directory, '/tmp/rear.W3oenlY7R4Bi9d7/outputfs'<br>2018-08-23 13:31:17.086256864 Exit task 'cleanup_build_area_and_end_program'<br>2018-08-23 13:31:17.087564396 Finished in 1 seconds<br>2018-08-23 13:31:17.088831195 You should also rm -Rf /tmp/rear.W3oenlY7R4Bi9d7<br>2018-08-23 13:31:17.090130741 End of program reached<br>2018-08-23 13:31:17.091469126 Exit task 'exec 8&gt;&amp;-'<br>2018-08-23 13:31:17.092852815 Exit task 'exec 7&gt;&amp;-'<br>2018-08-23 13:31:17.094085003 Exit task ''<br>======================<br> - 참고 정보 첨부<br>root@SLVTSSAL01 /var/lib/rear/layout # cat disktodo.conf | grep todo<br>todo /dev/sda disk<br>todo /dev/sda1 part<br>todo /dev/sda2 part<br>todo /dev/sda3 part<br>todo /dev/sda4 part<br>todo /dev/sda5 part<br>todo /dev/sda6 part<br>todo /dev/sda7 part<br>todo fs:/boot fs<br>todo fs:/ fs<br>todo fs:/var fs<br>todo fs:/home fs<br>todo swap:/dev/sda6 swap<br><br>root@SLVTSSAL01 /var/lib/rear/layout # cat disktodo.conf | grep done<br>done /dev/sdb disk<br>done /dev/sdc disk<br>done pv:/dev/sdc lvmdev<br>done pv:/dev/sdb lvmdev<br>done pv:/dev/sda7 lvmdev<br>done /dev/LLVTSSAPPVG lvmgrp<br>done /dev/vg9 lvmgrp<br>done /dev/vg0 lvmgrp<br>done /dev/mapper/LLVTSSAPPVG-APP lvmvol<br>done /dev/mapper/LLVTSSAPPVG-LIB lvmvol<br>done /dev/mapper/LLVTSSAPPVG-LOG lvmvol<br>done /dev/mapper/LLVTSSAPPVG-TSS lvmvol<br>done /dev/mapper/vg9-DUMP lvmvol<br>done /dev/mapper/vg9-CRASH lvmvol<br>done /dev/mapper/vg0-sysadmin lvmvol<br>done fs:/APP fs<br>done fs:/LIB fs<br>done fs:/LOG fs<br>done fs:/TSS fs<br>done fs:/sysadmin fs<br>done fs:/CRASH fs<br><br>root@SLVTSSAL01 /var/lib/rear/layout # cat disklayout.conf<br># Disk /dev/sda<br># Format: disk &lt;devname&gt; &lt;size(bytes)&gt; &lt;partition label type&gt;<br>disk /dev/sda 107374182400 msdos<br># Partitions on /dev/sda<br># Format: part &lt;device&gt; &lt;partition size(bytes)&gt; &lt;partition start(bytes)&gt; &lt;partition type|name&gt; &lt;flags&gt; /dev/&lt;partition&gt;<br>part /dev/sda 1073741824 1048576 primary boot /dev/sda1<br>part /dev/sda 32212254720 1074790400 primary none /dev/sda2<br>part /dev/sda 21474836480 33287045120 primary none /dev/sda3<br>part /dev/sda 1024 54761881600 extended none /dev/sda4<br>part /dev/sda 10737418240 54762930176 logical none /dev/sda5<br>part /dev/sda 25769803776 65501396992 logical none /dev/sda6<br>part /dev/sda 16101933056 91272249344 logical lvm /dev/sda7<br># Disk /dev/sdb<br># Format: disk &lt;devname&gt; &lt;size(bytes)&gt; &lt;partition label type&gt;<br>#disk /dev/sdb 107374182400 unknown<br># Partitions on /dev/sdb<br># Format: part &lt;device&gt; &lt;partition size(bytes)&gt; &lt;partition start(bytes)&gt; &lt;partition type|name&gt; &lt;flags&gt; /dev/&lt;partition&gt;<br># Disk /dev/sdc<br># Format: disk &lt;devname&gt; &lt;size(bytes)&gt; &lt;partition label type&gt;<br>#disk /dev/sdc 107374182400 unknown<br># Partitions on /dev/sdc<br># Format: part &lt;device&gt; &lt;partition size(bytes)&gt; &lt;partition start(bytes)&gt; &lt;partition type|name&gt; &lt;flags&gt; /dev/&lt;partition&gt;<br>#lvmdev /dev/LLVTSSAPPVG /dev/sdc PyaJKX-pECC-FryH-pf6S-z8cj-eqhu-QAC0XG 209715200<br>#lvmdev /dev/vg9 /dev/sdb BhgvwB-EsVp-3Xcb-axz5-3GbC-kKbd-zliCI7 209715200<br>#lvmdev /dev/vg0 /dev/sda7 ie3zQX-ZNQL-cjh6-681L-oo0I-VcG5-OngU2I 31449088<br>#lvmgrp /dev/LLVTSSAPPVG 4096 25599 104853504<br>#lvmgrp /dev/vg9 4096 25599 104853504<br>#lvmgrp /dev/vg0 4096 3838 15720448<br>#lvmvol /dev/LLVTSSAPPVG APP 7680 62914560<br>#lvmvol /dev/LLVTSSAPPVG LIB 5120 41943040<br>#lvmvol /dev/LLVTSSAPPVG LOG 7680 62914560<br>#lvmvol /dev/LLVTSSAPPVG TSS 2560 20971520<br>#lvmvol /dev/vg9 DUMP 12544 102760448<br>#lvmvol /dev/vg9 CRASH 13055 106946560<br>#lvmvol /dev/vg0 sysadmin 3838 31440896<br># Filesystems (only ext2,ext3,ext4,vfat,xfs,reiserfs,btrfs are supported).<br># Format: fs &lt;device&gt; &lt;mountpoint&gt; &lt;fstype&gt; [uuid=&lt;uuid&gt;] [label=&lt;label&gt;] [&lt;attributes&gt;]<br>#fs /dev/mapper/LLVTSSAPPVG-APP /APP xfs uuid=9fb0f8c8-776c-4031-a1a8-820a2286b64e label=  options=rw,relatime,attr2,inode64,noquota<br>#fs /dev/mapper/LLVTSSAPPVG-LIB /LIB xfs uuid=427f1691-b6ad-46c5-8aec-2f813b51532d label=  options=rw,relatime,attr2,inode64,noquota<br>#fs /dev/mapper/LLVTSSAPPVG-LOG /LOG xfs uuid=0d0b6e02-a5d3-409d-8250-205f395610e8 label=  options=rw,relatime,attr2,inode64,noquota<br>#fs /dev/mapper/LLVTSSAPPVG-TSS /TSS xfs uuid=30bce0e4-938b-45b6-957e-701245017aca label=  options=rw,relatime,attr2,inode64,noquota<br>#fs /dev/mapper/vg0-sysadmin /sysadmin xfs uuid=b626d6d6-b0b3-4891-9159-5d697470f8a9 label=  options=rw,relatime,attr2,inode64,noquota<br>#fs /dev/mapper/vg9-CRASH /CRASH xfs uuid=95f358c2-bcca-4c03-8dfd-0a76f3bfa67d label=  options=rw,relatime,attr2,inode64,noquota<br>fs /dev/sda1 /boot xfs uuid=6d9b7497-103b-47fc-85a5-0b5d2730b6ce label=  options=rw,relatime,attr2,inode64,noquota<br>fs /dev/sda2 / xfs uuid=a7220b49-8112-44d8-9aac-e0c6f248cd20 label=  options=rw,relatime,attr2,inode64,noquota<br>fs /dev/sda3 /var xfs uuid=a3d6e499-6f8c-4fef-8fd6-288ee1d5b4ef label=  options=rw,relatime,attr2,inode64,noquota<br>fs /dev/sda5 /home xfs uuid=7fd31662-a8e9-4b6a-a775-0125df10d75f label=  options=rw,relatime,attr2,inode64,noquota<br># Swap partitions or swap files<br># Format: swap &lt;filename&gt; uuid=&lt;uuid&gt; label=&lt;label&gt;<br>swap /dev/sda6 uuid=f57f46eb-6234-4b97-b25c-a1bffd368559 label=<br><br>root@SLVTSSAL01 /var/lib/rear/layout # cat diskdeps.conf<br>/dev/sda1 /dev/sda<br>/dev/sda2 /dev/sda<br>/dev/sda3 /dev/sda<br>/dev/sda4 /dev/sda<br>/dev/sda5 /dev/sda<br>/dev/sda6 /dev/sda<br>/dev/sda7 /dev/sda<br>/dev/LLVTSSAPPVG pv:/dev/sdc<br>pv:/dev/sdc /dev/sdc<br>/dev/vg9 pv:/dev/sdb<br>pv:/dev/sdb /dev/sdb<br>/dev/vg0 pv:/dev/sda7<br>pv:/dev/sda7 /dev/sda7<br>/dev/mapper/LLVTSSAPPVG-APP /dev/LLVTSSAPPVG<br>/dev/mapper/LLVTSSAPPVG-LIB /dev/LLVTSSAPPVG<br>/dev/mapper/LLVTSSAPPVG-LOG /dev/LLVTSSAPPVG<br>/dev/mapper/LLVTSSAPPVG-TSS /dev/LLVTSSAPPVG<br>/dev/mapper/vg9-DUMP /dev/vg9<br>/dev/mapper/vg9-CRASH /dev/vg9<br>/dev/mapper/vg0-sysadmin /dev/vg0<br>fs:/APP /dev/mapper/LLVTSSAPPVG-APP<br>fs:/APP fs:/<br>fs:/LIB /dev/mapper/LLVTSSAPPVG-LIB<br>fs:/LIB fs:/<br>fs:/LOG /dev/mapper/LLVTSSAPPVG-LOG<br>fs:/LOG fs:/<br>fs:/TSS /dev/mapper/LLVTSSAPPVG-TSS<br>fs:/TSS fs:/<br>fs:/sysadmin /dev/mapper/vg0-sysadmin<br>fs:/sysadmin fs:/<br>fs:/CRASH /dev/mapper/vg9-CRASH<br>fs:/CRASH fs:/<br>fs:/boot /dev/sda1<br>fs:/boot fs:/<br>fs:/ /dev/sda2<br>fs:/var /dev/sda3<br>fs:/var fs:/<br>fs:/home /dev/sda5<br>fs:/home fs:/<br>swap:/dev/sda6 /dev/sda6<br><br>감사합니다.<br><br><publishedDate>2018-08-23T07:19:22Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LeY73IAF"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-21T08:44:32Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-21T08:44:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>Q1) EXCLUDE를 구분하여 하는 이유<br>A1) 두 옵션의 적용 부분이 다르기 때문입니다.<br>- BACKUP_PROG_EXCLUDE : backup.tar.gz 파일에서 제외시킬 부분을 지정합니다.<br>- COPY_AS_IS_EXCLUDE : rear-hostname.iso 파일에서 제외시킬 부분을 지정합니다.<br><br>Q2) EXCLUDE_RECREATE 것은 혹시 어떤 의미인지도 문의드립니다.<br>A2) rear 로 시스템을 복구하는 과정중에 disk layout 을 생성하는 과정이 있습니다.<br>EXCLUDE_RECREATE 옵션은 disk layout 을 생성하는 과정에서 임의로 제외하고자 하는 부분을 지정하는 옵션입니다.<br>좀 더 자세한 정보는 아래 URL 을 참조 부탁드립니다.<br><br>&quot;Layout configuration&quot;<br>https://github.com/rear/rear/blob/master/doc/user-guide/06-layout-configuration.adoc<br><br>감사합니다.<br><br><publishedDate>2018-08-21T08:44:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LeVT5IAN"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-08-21T04:25:02Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-08-21T04:25:02Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>답변 감사드립니다.<br><br>제가 두번째 문의드렸던 부분이<br>COPY_AS_IS_EXCLUDE <br>BACKUP_PROG_EXCLUDE <br>두개의 부분인데요.<br><br>알려주셨듯이 COPY_AS_IS_EXCLUDE 은 삼성생명 백업 설정에서 <br>ISO 파일에서 제외하는 부분이고 BACKUP_PROG_EXCLUDE같은 경우는 BACKUP에서 제외하는 파일들인것 같은데<br>EXCLUDE를 구분하여 하는 이유에 대해서 문의드리려고 합니다. <br><br>추가로  EXCLUDE_RECREATE 것은 혹시 어떤 의미인지도 문의드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-21T04:25:02Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LeUQGIA3"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-21T02:02:40Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-21T02:02:40Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>문의하신 두 가지에 대한 답변드립니다.<br><br>Q1) 현재 설정파일을 변경한다고 하면 아래와 같이 적용하면 될 지 문의드립니다.<br>A1) /usr/share/rear/conf/default.conf 파일에 보시면 oracle asm 관련하여 아래와 같은 설정을 제공하고 있습니다. <br><br>598 COPY_AS_IS_EXCLUDE=( dev/shm dev/shm/\* dev/oracleasm dev/.udev $VAR_DIR/output/\* )<br><br>위의 내용은 /dev/shm 을 비롯한 백업이 필요없는 동적으로 생성되는 파일과 dev/oracleasm 을 제외합니다.<br>따라서 위의 설정으로 변경하셔서 테스트를 해보시기 바랍니다.<br><br>Q2) 추가로 알려주신 내역으로 보면 COPY_AS_IS_EXCLUDE 부분은 ISO 생성시 제외를 시키는 부분인데요. BACKUP_PROG_EXCLUDE 실제 backup 파일에서는 제외가 필요하지 않은 부분인지도 문의드리려고 합니다.<br>A2) 말씀하신 질문이 제가 이해하기로는 oracleasm 관련항목을 BACKUP_PROG_EXCLUDE 옵션에서는 제거할 필요가 없는지 문의하신 것으로 이해하였습니다.<br>oracleasm 관련된 이슈는 github 의 721 issue 에 정리되어있으며, 이에 대한 조치방법은 앞서 안내해드린 COPY_AS_IS_EXCLUDE 옵션을 설정하는 것입니다.<br>BACKUP_PROG_EXCLUDE 옵션에 추가로 할당해야하는 부분은 확인되지 않기 때문에 BACKUP_PROG_EXCLUDE 옵션에 oracleasm 항목을 추가로 설정하실 필요는 없을 것으로 예상됩니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-21T02:02:40Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LeDJYIA3"><br>======================<br><b>생성계정 : KIM, JIMIN</b><br><b>생성날짜 : 2018-08-20T02:34:46Z</b><br><b>마지막 답변자 : KIM, JIMIN</b><br><b>마지막 수정 일자 : 2018-08-20T02:34:46Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>아래는 삼성생명에서 실제로 oracleasm 으로 운영하는 DB 서버이고<br>ReaR를 통해서 OS backup을 구성하였습니다.<br><br>oracleasm device 영역 관련 link를 참조해보면<br>oracleasm device 영역을 제외처리하기 위해서 아래와 같이 제외를 하였는데요.<br>COPY_AS_IS_EXCLUDE=( dev/shm dev/shm/* dev/.udev $VAR_DIR/output/* dev/oracleasm/iid/* )<br><br>현재 설정파일을 변경한다고 하면 아래와 같이 적용하면 될 지 문의드립니다.<br><br>추가로 알려주신 내역으로 보면 COPY_AS_IS_EXCLUDE 부분은 ISO 생성시 제외를 시키는 부분인데요.<br>BACKUP_PROG_EXCLUDE 실제 backup 파일에서는 제외가 필요하지 않은 부분인지도 문의드리려고 합니다.<br><br><br> - local.conf 수정<br>local.conf<br>OUTPUT=ISO<br>BACKUP=NETFS<br>BACKUP_OPTIONS=&quot;nfsvers=3,nolock&quot;<br>OUTPUT_OPTIONS=&quot;nfsvers=3,nolock&quot;<br>BACKUP_URL=nfs://100.254.69.121/REAR/regular/SLPAFIDL01<br>OUTPUT_URL=nfs://100.254.69.121/REAR/regular/SLPAFIDL01<br>ONLY_INCLUDE_VG=(&quot;vg&quot;)<br>NETFS_KEEP_OLD_BACKUP_COPY=y<br>AUTOEXCLUDE_MULTIPATH=y<br>BACKUP_PROG_EXCLUDE=( &quot;${BACKUP_PROG_EXCLUDE[@]}&quot; '/dev/*' '/run/*' '/sys/fs/cgroup/*' '/CRASH/*' '/sysadmin/*' '/backup/*' '/LOG/*' '/dbadmin/*' '/oracle/*' '/oragrid/*' '/run/user/30485/*' '/run/user/0/*' )<br>EXCLUDE_VG=( 'vg0' 'vg1' 'vg9' )<br>EXCLUDE_RECREATE=( &quot;${EXCLUDE_RECREATE[@]}&quot; 'vg:vg0' 'vg:vg1' 'vg:vg9' 'lv:/dev/vg0/home' 'lv:/dev/vg0/sysadmin' 'lv:/dev/vg1/LOG' 'lv:/dev/vg1/backup' 'lv:/dev/vg1/dbadmin' 'lv:/dev/vg1/oracle' 'lv:/dev/vg1/oragrid' 'lv:/dev/vg9/CRASH' 'lv:/dev/vg9/DUMP' 'disk:sda6' 'pv:/dev/sda6' 'disk:sdb1' 'pv:/dev/sdb1' )<br>COPY_AS_IS_EXCLUDE=(/dev/oracleasm/iid/* ) ◀ 추가<br><br><br> - oracleasm 구성되어 있는 서버<br>root@SLPAFIDL01 /dev/oracleasm # ls -al<br>total 0<br>drwxr-xr-x  4 root    root     0 May  6 11:04 .<br>drwxr-xr-x 24 root    root 15080 Aug 14 13:47 ..<br>-rw-rw----  1 oragrid dba      0 May  6 11:04 .check_iid<br>-rw-rw----  1 oragrid dba      0 May  6 11:04 .get_iid<br>-rw-rw----  1 oragrid dba      0 May  6 11:04 .query_disk<br>-rw-rw----  1 oragrid dba      0 May  6 11:04 .query_version<br>drwxr-xr-x  1 root    root     0 May  6 11:04 disks<br>drwxrwx---  1 oragrid dba      0 May  6 11:04 iid<br><br> - 현재 설정 파일<br>root@SLPAFIDL01 /etc/rear/regular # cat local.conf<br>OUTPUT=ISO<br>BACKUP=NETFS<br>BACKUP_OPTIONS=&quot;nfsvers=3,nolock&quot;<br>OUTPUT_OPTIONS=&quot;nfsvers=3,nolock&quot;<br>BACKUP_URL=nfs://100.254.69.121/REAR/regular/SLPAFIDL01<br>OUTPUT_URL=nfs://100.254.69.121/REAR/regular/SLPAFIDL01<br>ONLY_INCLUDE_VG=(&quot;vg&quot;)<br>NETFS_KEEP_OLD_BACKUP_COPY=y<br>AUTOEXCLUDE_MULTIPATH=y<br>BACKUP_PROG_EXCLUDE=( &quot;${BACKUP_PROG_EXCLUDE[@]}&quot; '/dev/*' '/run/*' '/sys/fs/cgroup/*' '/CRASH/*' '/sysadmin/*' '/backup/*' '/LOG/*' '/dbadmin/*' '/oracle/*' '/oragrid/*' '/run/user/30485/*' '/run/user/0/*' )<br>EXCLUDE_VG=( 'vg0' 'vg1' 'vg9' )<br>EXCLUDE_RECREATE=( &quot;${EXCLUDE_RECREATE[@]}&quot; 'vg:vg0' 'vg:vg1' 'vg:vg9' 'lv:/dev/vg0/home' 'lv:/dev/vg0/sysadmin' 'lv:/dev/vg1/LOG' 'lv:/dev/vg1/backup' 'lv:/dev/vg1/dbadmin' 'lv:/dev/vg1/oracle' 'lv:/dev/vg1/oragrid' 'lv:/dev/vg9/CRASH' 'lv:/dev/vg9/DUMP' 'disk:sda6' 'pv:/dev/sda6' 'disk:sdb1' 'pv:/dev/sdb1' )<br><br>감사합니다.<br><br><publishedDate>2018-08-20T02:34:46Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LeCxwIAF"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-20T01:37:25Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-20T01:37:24Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대한 답변입니다.<br><br>Q1) 경우 ReaR 백업에서 아래 설정을 적용해야하는 것인지 문의드리려고 합니다.<br>A1) issue 의 내용은 oracleasm 장치를 제외하지 않고 backup 을 생성하는 경우 오랜시간동안 백업이 종료되지 않는 버그입니다.<br>이 버그는 백업시에 ASM 의 runtime 정보를 백업하면서 오래 걸리는 것이며, 이 파일들은 ASM 서비스를 재시작하거나 시스템을 재시작하게 되면 지워지는 정보이므로 백업 대상에서 제외하고 백업을 하시기 바랍니다.<br><br>Q2) COPY_AS_IS과 COPY_AS_IS_EXCLUDE 의미<br>A2) 두 옵션은 ISO 이미지를 생성할때 적용되는 옵션입니다.<br> - COPY_AS_IS : ISO 파일 생성시 포함시킬 파일 또는 디렉토리를 지정합니다.<br> - COPY_AS_IS_EXCLUDE : ISO 파일 생성시 제외시킬 파일 또는 디렉토리를 지정합니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-20T01:37:24Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LeCeyIAF"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-08-20T00:48:46Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-08-20T00:48:46Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>Platform Support 를 담당하고 있는 Technical Support Engineer 박현익 입니다.<br>문의하신 내용에 대하여 답변을 정리중입니다. 정리되는대로 업데이트 드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2018-08-20T00:48:46Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br><br>SDS 상암센터 <br>김지민 선임입니다.<br><br>아래와 같이 root@TDKREL01SL /root # view /usr/share/rear/conf/default.conf에 <br>oracleasm 관련 설정과 issue 관련 부분이 보이는데요.<br><br>oracleasm을 사용할 경우 ReaR 백업에서 아래 설정을 적용해야하는 것인지 문의드리려고 합니다.<br><br># files/dirs to copy as-is (with tar)<br>COPY_AS_IS=( $SHARE_DIR $VAR_DIR )<br># things to exclude from the copy<br># /dev/oracleasm contains internal files generated by Oracle ASM upon boot.<br># See https://github.com/rear/rear/issues/721 for more details<br>COPY_AS_IS_EXCLUDE=( dev/shm dev/shm/\* dev/oracleasm dev/.udev $VAR_DIR/output/\* )<br><br>추가로 COPY_AS_IS과 COPY_AS_IS_EXCLUDE 의미를 문의드리려고 합니다.<br><br>감사합니다.</issue><cep>false</cep></case>