======================<br><b>생성계정 : OSC SamsungFire</b><br><b>생성날짜 : 2015-08-04T11:19:03Z</b><br><b>마지막 답변자 : JINKOO HAN</b><br><b>마지막 수정 일자 : 2015-09-08T04:56:48Z</b><br><b>id : 500A000000RxVf3IAF</b><br>======================<br><br><b><font size=15>
제목  : &quot;getty@getty.service holdoff time over&quot; 출력 후 시스템 hang up
</font></b><br><br>======================<br><b>사전문의<br></b><br>* 고객 담당자 정보 (필수)<br><br>- 성함(직급)<br>김성훈 사원<br><br>- 회사명(부서명)<br>삼성SDS(삼성화재 금융인프라)<br><br>- 전화번호<br>010-6234-0649<br><br>- 메일주소<br>sh1221.kim@samsung.com<br>======================<br>*  문제 설명 (Description)<br><br>- 증상<br><br>시스템 hang up 걸려 cold reboot 후 분석 결과 /var/log/messages에서 아래와 같은 로그를 확인하였습니다.<br><br> <br>Jul 24 18:02:09 sfdmdgal01 systemd: getty@getty.service holdoff time over, scheduling restart.<br>Jul 24 18:02:09 sfdmdgal01 systemd: Stopping Getty on getty...<br>Jul 24 18:02:09 sfdmdgal01 systemd: Starting Getty on getty...<br>Jul 24 18:02:09 sfdmdgal01 systemd: Started Getty on getty.<br>======================<br><br><br><br>- 발생 시점<br>7월 24일 18:00경<br><br><br>- 발생 빈도<br>이번이 처음<br><br>- 문의 내용(기대 답변)<br><br>(제품의 동작 방법에 대한 문의의 경우 이슈와 직접적으로 어떻게 연관되어 있는지를 함께 설명)<br><br>위 로그 발생 및 hang up의 원인에 대해 분석 요청 드립니다.<br><br>※ 기술문의01486962 건(고객: 삼성SDS 이정훈 사원)과 유사한 케이스로 보입니다.<br>======================<br><br>======================<br><br>* 재현 방법<br>======================<br><br><br>## sosreport 를 첨부 할 수 없는 경우 아래 내용도 함께 작성 ##<br>======================<br>* sosreport 첨부 불가 사유<br><br>  예) 보안 이슈로 시간 소요, 시스템이 불안하여 sosreport 실행 보류 중.<br>======================<br><br><br>* 제품 정보 (고객 서버 정보입니다)<br><br>- 관련 패키지의 버전 정보<br><br>  예) 커널 관련 증상일 경우 &quot;uname -a&quot; 정보<br><br>[root@localhost sosreport-sfdpmsal01-20150728174632]# cat uname<br>Linux sfdpmsal01 3.10.0-229.1.2.el7.x86_64 #1 SMP Fri Mar 27 03:04:26 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux<br>[root@localhost sosreport-sfdpmsal01-20150728174632]#<br><br><br>- 제품의 아키텍처 (예, x86_64, x86)<br>x86_64<br>======================<br><br><br>* 하드웨어 정보 (고객 서버 정보입니다)             <br><br>- Model: VMWare<br><br>- CPU: 17core<br>processor       : 0<br>vendor_id       : GenuineIntel<br>cpu family      : 6<br>model           : 63<br>model name      : Intel(R) Xeon(R) CPU E5-2690 v3 @ 2.60GHz<br>stepping        : 2<br>microcode       : 0x2d<br>cpu MHz         : 2599.997<br>cache size      : 30720 KB<br>physical id     : 0<br>siblings        : 17<br>core id         : 16<br>cpu cores       : 17<br>apicid          : 16<br>initial apicid  : 16<br>fpu             : yes<br>fpu_exception   : yes<br>cpuid level     : 15<br>wp              : yes<br>flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts <br><br>nopl xtopology tsc_reliable nonstop_tsc aperfmperf eagerfpu pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor <br><br>lahf_lm abm ida arat epb xsaveopt pln pts dtherm tpr_shadow vnmi ept vpid fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid<br>bogomips        : 5199.99<br>clflush size    : 64<br>cache_alignment : 64<br>address sizes   : 42 bits physical, 48 bits virtual<br>power management:<br><br><br>- Memory:<br>[root@localhost sosreport-sfdpmsal01-20150728174632]# cat proc/meminfo<br>MemTotal:       280479700 kB<br>MemFree:        277102196 kB<br>MemAvailable:   277684384 kB<br>Buffers:           18504 kB<br>Cached:           687084 kB<br>SwapCached:            0 kB<br>Active:           437768 kB<br>Inactive:         490572 kB<br>Active(anon):     223704 kB<br>Inactive(anon):    16936 kB<br>Active(file):     214064 kB<br>Inactive(file):   473636 kB<br>Unevictable:           0 kB<br>Mlocked:               0 kB<br>SwapTotal:      285208572 kB<br>SwapFree:       285208572 kB<br>Dirty:             11860 kB<br>Writeback:             0 kB<br>AnonPages:        221952 kB<br>Mapped:           132100 kB<br>Shmem:             17364 kB<br>Slab:             223272 kB<br>SReclaimable:     126848 kB<br>SUnreclaim:        96424 kB<br>KernelStack:       14112 kB<br>PageTables:         7068 kB<br>NFS_Unstable:          0 kB<br>Bounce:                0 kB<br>WritebackTmp:          0 kB<br>CommitLimit:    425448420 kB<br>Committed_AS:     825296 kB<br>VmallocTotal:   34359738367 kB<br>VmallocUsed:     1052156 kB<br>VmallocChunk:   34358654976 kB<br>HardwareCorrupted:     0 kB<br>AnonHugePages:     63488 kB<br>HugePages_Total:       0<br>HugePages_Free:        0<br>HugePages_Rsvd:        0<br>HugePages_Surp:        0<br>Hugepagesize:       2048 kB<br>DirectMap4k:      202560 kB<br>DirectMap2M:     3991552 kB<br>DirectMap1G:    283115520 kB<br>[root@localhost sosreport-sfdpmsal01-20150728174632]#<br>======================<br><br><br>- 기타 관련 설정 정보:<br>VM on VMWare vSphere 6<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.0</b><br><b>타입  : Account / Customer Service Request</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000EbQ6iIAF"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2015-09-08T04:56:47Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2015-09-08T04:56:47Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br>본 케이스와 관련되어 지난 4주간 아무런 업데이트가 없으셔서 본 케이스는 Close하도록 하겠습니다.<br><br>본 케이스에 대한 추가 문의사항이 있으시면 해당 케이스를 Re-open하셔도 되며, 추가 문의사항에 대해서 새로운 케이스를 오픈하시면 해당 케이스를 통해 지원하도록 하겠습니다.<br>======================<br>감사합니다.<br><br><publishedDate>2015-09-08T04:56:46Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000EOFG1IAP"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2015-08-05T09:59:08Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2015-08-05T09:59:08Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br>보내주신 sosreport를 확인한 결과를 아래 공유 드립니다.<br><br>* 시스템 환경<br>- VMware<br>- Red Hat Enterprise Linux 7.0 (3.10.0-229.1.2.el7.x86_64)<br><br><br>* hang으로 의심되는 시간대에 마지막으로 출력한 로그정보<br><br>Jul 23 17:14:25 sfdpmsal01 kernel: sd 0:0:0:0: [sda] SCSI device reset on scsi0:0  &lt;&lt;--- 문제가 발생되었을 것이라고 추전되는 시간<br>Jul 23 17:14:37 sfdpmsal01 kernel: INFO: task vnetd:5916 blocked for more than 120 seconds.<br>Jul 23 17:14:37 sfdpmsal01 kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>...<br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda] SCSI device reset on scsi0:0<br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda]<br>Jul 23 17:27:29 sfdpmsal01 kernel: Result: hostbyte=DID_TIME_OUT driverbyte=DRIVER_OK<br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda] CDB:<br>Jul 23 17:27:29 sfdpmsal01 kernel: Read(10): 28 00 00 08 44 d0 00 00 08 00<br>Jul 23 17:27:29 sfdpmsal01 kernel: end_request: I/O error, dev sda, sector 541904<br>[...]<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): metadata I/O error: block 0x265930 (&quot;xfs_trans_read_buf_map&quot;) error 5 numblks 16<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): xfs_do_force_shutdown(0x1) called from line 383 of file fs/xfs/xfs_trans_buf.c.  Return address = 0xffffffffa021f9c1<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): I/O Error Detected. Shutting down filesystem<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): Please umount the filesystem and rectify the problem(s)<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): xfs_imap_to_bp: xfs_trans_read_buf() returned error 5.<br>Jul 23 17:30:34 sfdpmsal01 vmsvc[3687]: [ warning] [guestinfo] Failed to get disk info.<br>Jul 24 08:43:13 sfdpmsal01 rsyslogd: [origin software=&quot;rsyslogd&quot; swVersion=&quot;7.4.7&quot; x-pid=&quot;3505&quot; x-info=&quot;http://www.rsyslog.com&quot;] start   &lt;&lt;-- 시스템 재시작 시간 <br>Jul 24 08:43:06 sfdpmsal01 journal: Runtime journal is using 8.0M (max 4.0G, leaving 4.0G of free 133.7G, current limit 4.0G).<br>Jul 24 08:43:06 sfdpmsal01 kernel: Initializing cgroup subsys cpuset<br>Jul 24 08:43:06 sfdpmsal01 kernel: Initializing cgroup subsys cpu<br>Jul 24 08:43:06 sfdpmsal01 kernel: Initializing cgroup subsys cpuacct<br>Jul 24 08:43:06 sfdpmsal01 kernel: Linux version 3.10.0-229.1.2.el7.x86_64 (builder@kbuilder.dev.centos.org) (gcc version 4.8.2 20140120 (Red Hat 4.8.2-16) (GCC) ) #1 SMP Fri Mar 27 03:04:26 UTC 2015<br>Jul 24 08:43:06 sfdpmsal01 kernel: Command line: BOOT_IMAGE=/vmlinuz-3.10.0-229.1.2.el7.x86_64 root=/dev/mapper/rhel-root ro rd.lvm.lv=rhel/root vconsole.keymap=us vconsole.font=latarcyrheb-sun16 crashkernel=auto net.ifnames=0 LANG=en_US.UTF-8<br><br>[... Rebooting Process ...]<br><br>Jul 24 08:43:14 sfdpmsal01 kernel: intel_rapl: no valid rapl domains found in package 0<br>Jul 24 17:43:10 sfdpmsal01 systemd: Time has been changed<br>======================<br><br>* 분석내용<br><br>1. 시스템이 Rebooting된 시점은 7월 24일 18시 경으로 추정됩니다.<br><br>Jul 24 08:43:14 sfdpmsal01 kernel: intel_rapl: no valid rapl domains found in package 0<br>Jul 24 17:43:10 sfdpmsal01 systemd: Time has been changed<br><br><br>2. 시스템이 Hang이 발생한 시점은 로그상으로 본다면, 7월 23일 17시 10분경부터 문제가 발생했을 것으로 추정됩니다.<br><br>Jul 23 17:14:25 sfdpmsal01 kernel: sd 0:0:0:0: [sda] SCSI device reset on scsi0:0  &lt;&lt;--- 문제가 발생되었을 것이라고 추전되는 시간<br>Jul 23 17:14:37 sfdpmsal01 kernel: INFO: task vnetd:5916 blocked for more than 120 seconds.<br><br><br>3. 해당 hang issue의 원인으로는 scsi layer의 문제가 있었던 것이 아닌가 추정됩니다.<br><br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda] SCSI device reset on scsi0:0<br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda]<br>Jul 23 17:27:29 sfdpmsal01 kernel: Result: hostbyte=DID_TIME_OUT driverbyte=DRIVER_OK<br>Jul 23 17:27:29 sfdpmsal01 kernel: sd 0:0:0:0: [sda] CDB:<br>Jul 23 17:27:29 sfdpmsal01 kernel: Read(10): 28 00 00 08 44 d0 00 00 08 00<br>Jul 23 17:27:29 sfdpmsal01 kernel: end_request: I/O error, dev sda, sector 541904<br>[...]<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): metadata I/O error: block 0x265930 (&quot;xfs_trans_read_buf_map&quot;) error 5 numblks 16<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): xfs_do_force_shutdown(0x1) called from line 383 of file fs/xfs/xfs_trans_buf.c.  Return address = 0xffffffffa021f9c1<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): I/O Error Detected. Shutting down filesystem<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): Please umount the filesystem and rectify the problem(s)<br>Jul 23 17:30:30 sfdpmsal01 kernel: XFS (dm-0): xfs_imap_to_bp: xfs_trans_read_buf() returned error 5.<br>Jul 23 17:30:34 sfdpmsal01 vmsvc[3687]: [ warning] [guestinfo] Failed to get disk info.<br>======================<br>* 결론적으로,<br><br>1. hang상태를 유지한 시간이 real 사간과 동일하지 않을 수 있습니다.<br>- 위 로그상으로는 Hang Issue는 7월 23일 오후 17시 10분 경에서 부터 시작이 된 것으로 추정되나, 7월 24일 오후 18시경에 시스템을 리부팅을 한 것으로 추정됩니다.<br><br>2. hang issue는 sosreport의 로그만으로는 분석의 한계가 있습니다. hang issue 발생시에 문제 분석을 위해서는 kernel을 sysrq를 이용하여 crash 시켜서 vmcore를 생성하시는 것이 가장 중요합니다.<br>관련 문서를 첨부드립니다. (https://access.redhat.com/articles/231663)<br><br><br>3. 현재의 로그 정보만 가지고 해당 이슈를 추정해볼때, Storage와 VMware Layer에서 어떠한 작업이 있었거나, 장애가 있었을 것으로 추정됩니다.<br>해당 이슈 처리를 위해서 당시 Vmware에서 Storage와의 상태에 대해서 VMware의 점검이 필요하며, 당시 Storage의 어떤 작업이 있었거나?, VMware에서의 어떤 이슈가 있었는지 해당 Vendor로 기술지원 요청이 필요합니다.<br>======================<br><br>감사합니다.<br><br><publishedDate>2015-08-05T09:59:07Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000EOBa5IAH"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2015-08-05T01:37:26Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2015-08-05T03:47:35Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br><br>문의주신 내용에 대해서 몇가지 문의드립니다.<br><br>1. Cold reboot을 한 시점이 7/24일 18:00 경인가요?<br>2. Hang up과 같은 경우에는 Cold reboot보단 vmcore를 발생하여야 분석에 용이합니다. 혹시 vmcore 생성을 하셨는지요?<br>3. 현재 의심하고 있는 로그가 왜 이번 hang up에 원인이라고 생각하시는 이유가 있으신지요? <br> <br>Jul 24 18:02:09 sfdmdgal01 systemd: getty@getty.service holdoff time over, scheduling restart.<br>Jul 24 18:02:09 sfdmdgal01 systemd: Stopping Getty on getty...<br>Jul 24 18:02:09 sfdmdgal01 systemd: Starting Getty on getty...<br>Jul 24 18:02:09 sfdmdgal01 systemd: Started Getty on getty.<br>======================<br>확인 바랍니다.<br><br><br>감사합니다.<br><br><publishedDate>2015-08-05T01:37:26Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000EOBSoIAP"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2015-08-05T01:15:49Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2015-08-05T01:15:49Z</b><br><br>안녕하세요,<br>Red Hat Technical Account Manager 한진구 입니다.<br><br><br>보내주신 자료를 확인 후, 답변 드리도록 하겠습니다.<br>======================<br><br>감사합니다.<br><br><publishedDate>2015-08-05T01:15:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>