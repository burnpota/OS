======================<br><b>생성계정 : 주호 이</b><br><b>생성날짜 : 2017-06-20T09:29:54Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-07-14T10:03:34Z</b><br><b>id : 500A000000XORppIAH</b><br>======================<br><br><b><font size=15>
제목  : .
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>1. power save 모드 적용 여부<br>2. sap 용 패키지 설정인지 또는 RHEL7.2 기본 설정이 power save 모드 인지<br>3. 영구<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>현재 power save 모드로 확인 되는데 확인이 필요합니다.<br><br>언제 문제가 발생했습니까? 이러한 문제가 자주 발생합니까? 반복적으로 발생합니까? 특정 시간에 발생합니까?<br><br>.<br><br>해결 기간이나 업무에 미치는 영향에 대한 정보를 제공해 주시겠습니까?<br><br>.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 4 (Low)</b><br><hostname>pmsalp05</hostname><br><br><folderNumber>74173</folderNumber><br><comment id="a0aA000000JnRPBIA3"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-28T05:04:33Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-28T05:04:33Z</b><br><br>안녕하세요? Red Hat 송 창 안 입니다.<br>두번째 문의 사항에 대해서 답변 하도록 하겠습니다.<br><br>테스트를 하실 경우에, 아래의 내용을 참조 하시면, 설정 전 과 설정 후에 설정이 내려간 내용에 대해서 확인 이 가능 할 것으로 판단 됩니다.<br>cpupower 명령은 제가 바로 바로 바뀌는 부분을 보이기 위해서 사용 한 예제 입니다.<br><br>//powersave 설정 후 cpu hz 변화, watch 로 2초 마다 한번씩 찍히게 되어 값은 조금씩 다를 수 있습니다.<br># cpupower frequency-set -g powersave<br>&lt;&lt; 설정 전 &gt;&gt;<br># watch grep \&quot;cpu MHz\&quot; /proc/cpuinfo<br>Every 2.0s: grep &quot;cpu MHz&quot; /proc/cpuinfo                Wed Jun 28 13:58:10 2017<br><br>cpu MHz         : 799.963<br>cpu MHz         : 799.963<br>cpu MHz         : 799.963<br>cpu MHz         : 799.963<br><br>//performance 설정 후 cpu hz 변화<br>#  cpupower frequency-set -g performance<br>&lt;&lt; 설정 후 &gt;&gt;<br>Every 2.0s: grep &quot;cpu MHz&quot; /proc/cpuinfo                Wed Jun 28 13:59:30 2017<br><br>cpu MHz         : 2744.250<br>cpu MHz         : 2820.898<br>cpu MHz         : 2791.857<br>cpu MHz         : 2749.804<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-06-28T05:04:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JnCMaIAN"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-27T09:07:56Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-28T01:58:02Z</b><br><br>안녕하세요? Red Hat 송 창 안 입니다.<br><br>문의 주신 내용에 대해서 일부 부분에 대해서 답변 하도록 하겠습니다.<br>제가 영구 적용 테스트를 하기 위해서 테스트 서버에 동일한 구성으로 테스트 하였습니다.<br><br># cat /etc/sysconfig/cpupower<br># See 'cpupower help' and cpupower(1) for more info<br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance&quot;<br>CPUPOWER_STOP_OPTS=&quot;frequency-set -g ondemand&quot;<br><br># cpupower frequency-set --governor performance<br>...<br><br>//0번 CPU를 일단 샘플로 확인 합니다.<br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor<br>performance &lt;-----<br><br># systemctl status tuned<br>● tuned.service - Dynamic System Tuning Daemon<br>   Loaded: loaded (/usr/lib/systemd/system/tuned.service; disabled; vendor preset: enabled)<br>   Active: inactive (dead)<br><br># systemctl enable cpupower<br># systemctl start cpupower<br><br># systemctl status cpupower<br>● cpupower.service - Configure CPU power related settings<br>   Loaded: loaded (/usr/lib/systemd/system/cpupower.service; enabled; vendor preset: disabled)<br>   Active: active (exited) since Tue 2017-06-27 08:45:57 IST; 4min 1s ago<br>  Process: 864 ExecStart=/usr/bin/cpupower $CPUPOWER_START_OPTS (code=exited, status=0/SUCCESS)<br> Main PID: 864 (code=exited, status=0/SUCCESS)<br>   CGroup: /system.slice/cpupower.service<br><br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 7<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 8<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 9<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 10<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 11<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 12<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 13<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 14<br>Jun 27 08:45:57 localhost.localdomain cpupower[864]: Setting cpu: 15<br>Jun 27 08:45:57 localhost.localdomain systemd[1]: Started Configure CPU power related settings.<br><br># reboot<br><br>&lt;&lt; reboot &gt;&gt;<br><br>//0번 CPU를 일단 샘플로 확인 합니다.<br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor<br>performance &lt;-----<br><br><br>그리고, 설정 후 확인 부분에 관해서는 추가적으로 저희 전문 엔지니어와 상의 하여 확인이 필요 한 내용이 있어서<br>확인 후 추가로 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br><br>송 창 안 드림.<br><br><publishedDate>2017-06-27T09:07:56Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JnB0qIAF"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2017-06-27T07:49:37Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2017-06-27T07:49:37Z</b><br><br>답변 감사합니다.<br>정리하면 저희가 현재 sap 설정에 의해 tuned 서비스를 꺼 놓은 상태입니다.<br>현재 P-state 관련하여 영구적으로  perfermance 상태로 두게 할려면<br><br>/etc/sysconfig/cpupower 파일을 아래와 같이 두고<br><br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance&quot;<br>CPUPOWER_STOP_OPTS=&quot;frequency-set -g ondemand&quot;<br><br>systemctl enable cpupower.service<br>systemctl start cpupower.service <br><br>하게 되면 영구적으로 performance 모드로 동작하게 되는게 맞는지요?<br><br>이 설정 방법이 맞다면 확인 방법은 <br> lscpu  명령으로  <br>Model Name 에 나오는 GHZ 값과 CPU MHz 값을 비교하면 되는건가요?<br><br><publishedDate>2017-06-27T07:49:37Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JmdrnIAB"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-23T09:01:15Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-23T09:01:15Z</b><br><br>안녕하세요? Red Hat 송 창 안 입니다.<br><br>문의 주신 내용에 cpu frequency 에 관련된 내용에 대해 RHEL7에서 설정 할때 governors 사용 하시는 경우에는 다른 추가적인 설정은 없습니다.<br><br>3.2. CPUfreq<br>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Power_Management_Guide/cpufreq_governors.html<br>적용 하시게 되면, 현재까지 저의 판단은 높은 전압이 CPU에 인가되기 떄문에 전력 소모량에 대해서 기존 대비 두배 이상이 될것으로 판단 되며, CPU 수명에도 연관이 있을 수 있습니다.<br><br>만약 전체 시스템의 성능에 관련된 내용에 대해서는 여러가지 요소에 대해서는 아래의 저희 문서를 참고 하시는게 도움이 되실 것으로 판단이 됩니다.<br><br>Red Hat Enterprise Linux 7 Performance Tuning Guide<br>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/pdf/Performance_Tuning_Guide/Red_Hat_Enterprise_Linux-7-Performance_Tuning_Guide-en-US.pdf<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-06-23T09:01:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JmaVwIAJ"><br>======================<br><b>생성계정 : 이, 주호</b><br><b>생성날짜 : 2017-06-23T02:09:10Z</b><br><b>마지막 답변자 : 이, 주호</b><br><b>마지막 수정 일자 : 2017-06-23T02:09:10Z</b><br><br>추가 문의드립니다.<br>항상 성능의 최적을 위해 해당 설정을 performance 위주로 적용을 해야될 것 같은데, 적용 할때 같이 바꿔줘야 되는 값이 있나요 ?<br>추가로 관련해서 적용 시 side effect 가 존재하는지도 문의드립니다.<br><br><publishedDate>2017-06-23T02:09:10Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JmL5PIAV"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-22T05:54:51Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-22T05:54:51Z</b><br><br>안녕하세요? Red Hat 송 창 안 입니다.<br><br>문의 주신 내용에 대해서 답변 하도록 하겠습니다.<br>Q1) 부하가 급격하게 많을 시 (CPU 100% 사용 등) 해당 설정에 따른 성능 저하율. Performance 위주 세팅 대비<br><br>pstate에 cpu frequency 관련된 설정에 대한 성능 저하율에 대해서는 따로 측정된 자료에 대해서는 없습니다.<br>pstate에서는 실제 state 단계는 CPU 및 제조사마다 다르지만 P0은 가장 많은 전원을 인가받아 가장 빠른 Frequency로 동작하며, <br>P1, P2... Pn으로 가면서 좀 더 적은 전원과 낮은 Frequency로 동작하게 됩니다. <br><br>따라서, 테스트 할 수 있는 방법은 stress 와 같은 cpu 벤치마크 도구를 이용하여 , cpupower monitor를 통해서,<br>측정이 가능 할 수 있을 것으로 판단 됩니다.<br><br>아래는 cpu frequency 관련 문서를 첨부 합니다. <br>Understanding CPU freq Power governors<br>https://www.redhat.com/f/pdf/RHEL_Governers_WP.pdf<br><br>Q2) RHEL7, RHEL6 에서의 해당 값의 default<br><br>@RHEL7<br>tuned가 구성되어 있는 경우에, scaling_governor은 performace 입니다.<br><br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor <br>performance<br>[root@dell-430-41 ~]# systemctl status tuned<br>● tuned.service - Dynamic System Tuning Daemon<br>   Loaded: loaded (/usr/lib/systemd/system/tuned.service; enabled; vendor preset: enabled)<br>   Active: active (running) since Thu 2017-06-22 05:06:06 IST; 28min ago<br> Main PID: 1187 (tuned)<br>   CGroup: /system.slice/tuned.service<br>           └─1187 /usr/bin/python -Es /usr/sbin/tuned -l -P<br><br>Jun 22 05:06:05 dell-430-41.gsslab.pnq2.redhat.com systemd[1]: Starting Dynamic System Tuning Daemon...<br>Jun 22 05:06:06 dell-430-41.gsslab.pnq2.redhat.com systemd[1]: Started Dynamic System Tuning Daemon.<br><br><br>@RHEL6<br>해당 기능에 대해서는 커널 모듈을 구동을 시켜야 활성화가 가능합니다. 따라서 해당 값의 default는 구성 하면서 달라질것으로 판단 됩니다.<br><br># modprobe cpufreq_ondemand<br>WARNING: All config files need .conf: /etc/modprobe.d/sunrpc, it will be ignored in a future release.<br># lsmod | grep cpufreq*<br>cpufreq_ondemand       10544  0 <br>freq_table              4881  1 cpufreq_ondemand<br><br>RHEL6의 해당 기능에 대해서는 다음 링크를 참조 하시면 도움이 될것으로 판단이 됩니다.<br><br>3.2.2. CPUfreq Setup<br>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Power_Management_Guide/cpufreq_setup.html#enabling_a_cpufreq_governor<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-06-22T05:54:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Jm2trIAB"><br>======================<br><b>생성계정 : 이, 주호</b><br><b>생성날짜 : 2017-06-21T04:59:57Z</b><br><b>마지막 답변자 : 이, 주호</b><br><b>마지막 수정 일자 : 2017-06-21T04:59:57Z</b><br><br>추가 문의드립니다.<br>ERP 전체장비에 대해서 사전에 OS 전반에 대한 진단을 수행하였는데 해당 부분에 대한 언급은 없었습니다.<br>관련하여 2가지 문의를 추가로 드립니다.<br>1) 부하가 급격하게 많을 시 (CPU 100% 사용 등) 해당 설정에 따른 성능 저하율. Performance 위주 세팅 대비<br>2) RHEL7, RHEL6 에서의 해당 값의 default<br><br><publishedDate>2017-06-21T04:59:57Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Jm24YIAR"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-21T02:39:16Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-21T04:39:53Z</b><br><br>Red Hat 송 창 안 입니다.<br><br>문의 주신 내용에 대해서 답변 하겠습니다.<br><br>프로젝트에 참여 했던 엔지니어 분들과 담당 TAM 분에게 상황 및 sosreport 내용을 확인 내용을 근거로 설명을 하게 되었습니다.<br>어제 설명 드린 tuned에 대해서는 현재의 시스템은 tuned 서비스를 통한 자동으로 적용 된 내용이 아닌 수동 설정하여 시스템이 적용이 된것으로 파악이 됩니다.<br><br>또한, CPU Frequency 관련 부분은 성능 관련 이슈에 대한 내용이며, 장애 와 관련되는 파라메터는 아닌 것으로 판단이 됩니다. <br>그리하여, 향후 사용하고 계신 시스템에 대해 workload에 측정 하면서 차후 적용이 될 요소로 판단 된것으로 확인됩니다.<br><br>P-State 의 내용은 아래와 같습니다.<br>- P-State의 경우 CPU 부하게 따라 자동으로 Frequency를 조정하여 전력을 절약하는 방법입니다.<br>- Frequency 조정관 관련하여 다음과 같은 Governor를 지원하고 있습니다.<br> • cpufreq_performance  : 가장 높은 Frequency에서 동작하도록 설정<br> • cpufreq_powersave    : 가장 낮은 Frequency에서 동작하도록 설정<br> • cpufreq_ondemand     : 시스템 부하에 따라 동적으로 Frequency를 변경<br> • cpufreq_userspace    : Userspace 프로그램이 Frequency를 설정하도록 허용 (보통 cpuspeed와 함께 사용)<br> • cpufreq_conservative : ondemand와 유사하나 Frequency 변경을 보다 단계적으로 올리거나 내림<br><br>참고적으로 cpu frequency를 적용 하시기전에 먼저 테스트 장비에서 아래 내용에 대해서 테스트 후 적용을 권고 드립니다.<br><br>3.2.3 절의 내용을 참조 하시면<br>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Power_Management_Guide/cpufreq_governors.html#cpufreq_setup<br><br>모든 코어에 대해서 performance 파라메터를 적용 합니다.<br># cpupower frequency-set --governor performance<br>Setting cpu: 0<br>Setting cpu: 1<br>Setting cpu: 2<br>Setting cpu: 3<br><br>특정 코어에 대해서 아래와 같이 설정도 가능 합니다.<br># cpupower -c 1-3,5 frequency-set --governor performance<br><br>이전에 RHEL6에서는 cpuspeed 라는 패키지에서 설정이 가능 했으나, 지금은 <br>https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Migration_Planning_Guide/sect-Red_Hat_Enterprise_Linux-Migration_Planning_Guide-Package_Replacements.html<br><br>영구 적용 방법은 cpupower.service 를 통해서 가능 한 것으로 판단 됩니다.<br># systemctl enable cpupower<br># systemctl start cpupower<br><br>이 서비스는 아래의 파라메터 값을 토대로 적용이 되며 start 될 당시 때에 설정은 performance 입니다. <br>아래의 파라메터를 수정하여 원하는 프로파일 값으로 포함 시키면 될것으로 판단 됩니다.<br>@ /etc/sysconfig/cpupower<br># See 'cpupower help' and cpupower(1) for more info<br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance&quot;<br>CPUPOWER_STOP_OPTS=&quot;frequency-set -g ondemand&quot;<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-06-21T02:39:16Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Jm1J1IAJ"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-21T00:28:52Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-21T00:28:52Z</b><br><br>안녕하세요? Red Hat 송창안 입니다.<br><br>현재 심각도는 2로 설정을 하셨습니다.<br>Red Hat 기술문의 심각도 정의에 의하면 보내 주신 문의 사항은 심각도 4에 해당 합니다.<br>Red Hat 기술 문의 심각도 정의와 관련하여 하기의 URL를 참고 하시기 바랍니다.<br>- https://access.redhat.com/support/policy/severity/<br><br>따라서 본 케이스의 심각도를 4으로 조절 하도록 하겠습니다.<br><br>송 창 안 드림.<br><br><publishedDate>2017-06-21T00:28:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Jm1IXIAZ"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-06-21T00:27:28Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-06-21T00:27:28Z</b><br><br>안녕하세요? Red Hat Technical Account Manager 송 창 안 입니다.<br><br>문의 주신 내용에 대해서 확인 후 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-06-21T00:27:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JlpcCIAR"><br>======================<br><b>생성계정 : Kirby, Taylor</b><br><b>생성날짜 : 2017-06-20T12:29:40Z</b><br><b>마지막 답변자 : Kirby, Taylor</b><br><b>마지막 수정 일자 : 2017-06-20T12:29:39Z</b><br><br>안녕하세요,<br><br> <br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br> <br><br>고객님께서는 프리미엄 서브스크립션을 보유하고 계시며, 현재 한국 업무 시간이 종료되어 기술 지원은 영어로만 진행이 됨을 안내해드립니다.<br><br>한국어 지원은 돌아오는 한국 업무 시간에 진행됩니다.<br><br> <br><br>한국 업무 시간 : 월 - 금, 오전 9시 - 오후 5시<br><br> <br><br>감사합니다.<br><br> <br><br>Dear Customer,<br><br>My name is Taylor Kirby and I am working on this case. <br><br>I see that you have Premium subscriptions and have submitted a Severity-2 case.  It's outside of your local business hours at this moment, so your case will be supported in English.<br><br>If you would  like to continue the support, can you please let us know the following details in English:<br>a) Problem description.<br>b) Business impact of the issue.<br>c) Contact point for this particular case whom we can reach 24x7, if needed.<br><br>I would also encourage you to call us on below phone numbers for Severity-2 which has very high impact on your business and needs to be worked through 24x7 ;<br>https://access.redhat.com/ko/support/contact/technicalSupport<br><br> <br>Please let us know if you are able to continue this case in English or if you prefer to wait for your local support during your next business day.<br><br> <br><br>Kind Regards,<br>Taylor Kirby<br>Red Hat Global Support Delivery<br><br><publishedDate>2017-06-20T12:29:39Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>2. sap 용 패키지 설정인지 또는 RHEL7.2 기본 설정이 power save 모드 인지<br>3. 영구</issue><environment>현재 power save 모드로 확인 되는데 확인이 필요합니다.</environment><periodicityOfIssue>.</periodicityOfIssue><timeFramesAndUrgency>.</timeFramesAndUrgency><cep>false</cep><folderName>ERP-ALL</folderName></case>