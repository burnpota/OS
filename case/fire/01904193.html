======================<br><b>생성계정 : support os</b><br><b>생성날짜 : 2017-08-03T13:54:55Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2017-08-07T06:38:16Z</b><br><b>id : 500A000000Y5DViIAN</b><br>======================<br><br><b><font size=15>
제목  : rhel7 kernel.numa_balancing= default 값이 1 (enable) 로 알고 있습니다. 만약 하드웨어에서 numa balancing 을 off 하게 되면 자동으로 os 에서 kernel.numa_balancing=0  이 되는지요?
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>저희가 명시적으로 kernel.numa_balancing=0 으로 적용 시키기 전에 시스템 값을 확인해 보니 하드웨어에서 numa_balacing 을  off 하니 자동으로 시스템에서는 kernel.numa_balancing=0 으로 되어 있습니다.<br>정상적인 동작인지요?<br><br><br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>   - 성함(직급) :이주호 책임<br>   - 회사명(부서명) :금융시스템그룹(금융/서비스)/삼성SDS<br>   - 전화번호 :+82-70-7111-2079  <br>   - 메일주소 :juho88.lee@samsung.com<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>   - 성함(직급) :이승훈 수석<br>   - 회사명(부서명) :타임게이트<br>   - 전화번호 :010-5493-0769<br>   - 메일주소 :sh.lee@time-gate.com<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><hostname>[삼성화재ERP][가동] kernel.numa_balancing= default 값 문의</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000K80BkIAJ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-08-07T06:38:15Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-08-07T06:38:15Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>먼저, 본 기술 문의가 해결되어 다행입니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 재개하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-08-07T06:38:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000K7zzyIAB"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2017-08-07T06:14:03Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2017-08-07T06:14:03Z</b><br><br>빠른답변 감사합니다.<br>close 하도록 하겠습니다.<br><br><publishedDate>2017-08-07T06:14:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000K7ylbIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-08-07T02:00:15Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-08-07T02:00:15Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-08-07T02:00:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000K7gmgIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-08-04T04:49:57Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-08-04T04:49:57Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>BIOS 에서 NUMA 기능을 활성화/비활성화하게되면, OS 에서 자동으로 기능을 활성화/비활성화하는 것으로 확인됩니다.<br>따라서, 본 기능은 정상적인 현상인 것으로 보이며, BIOS 에서 활성화하였다고 하여도, <br>grub 설정에서 혹은 sysctl 에서 numa_balancing=0 으로 설정하게되면<br>해당 기능은 비활성화됩니다.<br><br>include/trace/events/sched.h&quot;<br><br>    465 /*<br>    466  * Tracks migration of tasks from one runqueue to another. Can be used to<br>    467  * detect if automatic NUMA balancing is bouncing between nodes<br>    468  */<br>    469 DEFINE_EVENT(sched_move_task_template, sched_move_numa,<br>    470         TP_PROTO(struct task_struct *tsk, int src_cpu, int dst_cpu),<br>    471 <br>    472         TP_ARGS(tsk, src_cpu, dst_cpu)<br>    473 );<br><br>arch/x86/mm/numa.c<br><br>    357 static int __init numa_alloc_distance(void)<br>    358 {<br>    359         nodemask_t nodes_parsed;<br>    360         size_t size;<br>    361         int i, j, cnt = 0;<br>    362         u64 phys;<br>    363 <br>    364         /* size the new table and allocate it */<br>    365         nodes_parsed = numa_nodes_parsed;<br>    366         numa_nodemask_from_meminfo(&amp;nodes_parsed, &amp;numa_meminfo);<br>    367 <br>    368         for_each_node_mask(i, nodes_parsed)<br>    369                 cnt = i;<br>    370         cnt++;<br>    371         size = cnt * cnt * sizeof(numa_distance[0]);<br>    372 <br>    373         phys = memblock_find_in_range(0, PFN_PHYS(max_pfn_mapped),<br>    374                                       size, PAGE_SIZE);<br>    375         if (!phys) {<br>    376                 pr_warning(&quot;NUMA: Warning: can't allocate distance table!\n&quot;);<br>    377                 /* don't retry until explicitly reset */<br>    378                 numa_distance = (void *)1LU;<br>    379                 return -ENOMEM;<br>    380         }<br>    381         memblock_reserve(phys, size);<br>    382 <br>    383         numa_distance = __va(phys);<br>    384         numa_distance_cnt = cnt;<br>    385 <br>    386         /* fill with the default distances */<br>    387         for (i = 0; i &lt; cnt; i++)<br>    388                 for (j = 0; j &lt; cnt; j++)<br>    389                         numa_distance[i * cnt + j] = i == j ?<br>    390                                 LOCAL_DISTANCE : REMOTE_DISTANCE;<br>    391         printk(KERN_DEBUG &quot;NUMA: Initialized distance table, cnt=%d\n&quot;, cnt);<br>    392 <br>    393         return 0;<br>    394 }<br><br><br>mm/mempolicy.c<br><br>   2527 #ifdef CONFIG_NUMA_BALANCING<br>   2528 static int __initdata numabalancing_override;<br>   2529 <br>   2530 static void __init check_numabalancing_enable(void)<br>   2531 {<br>   2532         bool numabalancing_default = false;<br>   2533 <br>   2534         if (IS_ENABLED(CONFIG_NUMA_BALANCING_DEFAULT_ENABLED))<br>   2535                 numabalancing_default = true;<br>   2536 <br>   2537         /* Parsed by setup_numabalancing. override == 1 enables, -1 disables */<br>   2538         if (numabalancing_override)<br>   2539                 set_numabalancing_state(numabalancing_override == 1);<br>   2540 <br>   2541         if (nr_node_ids &gt; 1 &amp;&amp; !numabalancing_override) {<br>   2542                 printk(KERN_INFO &quot;%s automatic NUMA balancing. &quot;<br>   2543                         &quot;Configure with numa_balancing= or the &quot;<br>   2544                         &quot;kernel.numa_balancing sysctl&quot;,<br>   2545                         numabalancing_default ? &quot;Enabling&quot; : &quot;Disabling&quot;);<br>   2546                 set_numabalancing_state(numabalancing_default);<br>   2547         }<br>   2548 }<br><br>dmesg<br>[    0.000000] NUMA: Initialized distance table, cnt=2<br>...<br>[    0.000000] Enabling automatic NUMA balancing. Configure with numa_balancing= or the kernel.numa_balancing sysctl<br><br>What is NUMA and how does it work on Linux ? <br>https://access.redhat.com/solutions/700683<br><br>How do I create my own tuned profile on RHEL7 ? <br>https://access.redhat.com/solutions/731473<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-08-04T04:49:57Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>정상적인 동작인지요?<br><br><br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>   - 성함(직급) :이주호 책임<br>   - 회사명(부서명) :금융시스템그룹(금융/서비스)/삼성SDS<br>   - 전화번호 :+82-70-7111-2079  <br>   - 메일주소 :juho88.lee@samsung.com<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>   - 성함(직급) :이승훈 수석<br>   - 회사명(부서명) :타임게이트<br>   - 전화번호 :010-5493-0769<br>   - 메일주소 :sh.lee@time-gate.com</issue><cep>false</cep></case>