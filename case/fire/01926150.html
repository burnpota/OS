======================<br><b>생성계정 : support os</b><br><b>생성날짜 : 2017-09-06T15:55:34Z</b><br><b>마지막 답변자 : HyunYick Park</b><br><b>마지막 수정 일자 : 2017-09-27T10:06:08Z</b><br><b>id : 500A000000XznqmIAB</b><br>======================<br><br><b><font size=15>
제목  : 네트워크의 일시적인 순단 후 pcs status 에서 아래와 같은 메세지가 나옵니다.
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>Full list of resources:<br><br> Clone Set: rsc_ping-clone [rsc_ping]<br>     Started: [ quoclp01-HB quoclp02-HB ]<br> Resource Group: grp1<br>     rsc_vip1<br>(ocf::heartbeat:IPaddr2):<br>Started quoclp01-HB<br>     rsc_ascs1<br>(ocf::sfmi:MySAP):<br>Started quoclp01-HB<br> kdump_stonith<br>(stonith:fence_kdump):<br>Started quoclp01-HB<br> ipmilan_stonith1<br>(stonith:fence_ipmilan):<br>Stopped<br> ipmilan_stonith2<br>(stonith:fence_ipmilan):<br>Started quoclp01-HB<br><br>Failed Actions:<br>* ipmilan_stonith1_start_0 on quoclp02-HB 'unknown error' (1): call=33, status=Timed Out, exitreason='none',<br>    last-rc-change='Wed Jul 26 14:35:40 2017', queued=0ms, exec=20003ms<br><br><br>PCSD Status:<br>======================<br>이후 messages 에서도 아래와 같은 메세지가 주기적으로 발생합니다.<br><br>engine[81891]: warning: Processing failed op start for ipmilan_stonith1 on quoclp02-HB: unknown error (1)<br> quoclp01 pengine[81891]: warning: Forcing ipmilan_stonith1 away from quoclp02-HB after 1000000 failures (max=3)<br>Sep  1 03:51:17 quoclp01 pengine[81891]:  notice: Calculated Transition 4531: /var/lib/pacemaker/pengine/pe-input-272.bz2<br>quoclp01 crmd[81892]:  notice: Transition 4531 (Complete=0, Pending=0, Fired=0, Skipped=0, Incomplete=0, Source=/var/lib/pacemaker/pengine/pe-input-272.bz2):<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>이러한 메세지가 발생하더라도  펜싱을 해야 할 상황이 되었을때 ipmi 통신이 정상적으로 된다면 제대로 펜싱 되는것으로 알고있는데 맞는지요?<br>이러한 메세지를 없애는 방법은  pcs  stonith  cleanup 으로 알고 있는데 이 명령을 실행하게 되면<br>운영환경에서  리소스들에 영향이 있는지요?<br><br>확인 부탁드립니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><hostname>[삼성화재][ERP][ quoclp01]  stonith  stopped 확인</hostname><br><br><br><comment id="a0aA000000KVjruIAD"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2017-09-11T04:14:32Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2017-09-11T04:14:32Z</b><br><br>안녕하세요,<br> <br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br> <br>문의주신 내용에 대한 답변입니다.<br> <br>1. 현재 stonith stopped된 상태에서 실제 fencing 상황이 발생하면 정상적으로 fencing이 발생하는지요?<br>   =&gt; 네 정상적으로 fencing이 작동될 것입니다. stonith stopped 메시지는 stonith device 모니터링이 실패했을 때 발생하는 메시지 입니다.<br>일시적인 통신 장애 이후 복원되었다면 stonith stopped가 나타나있는 상황이라도 fencing request를 수신할 수 있기때문에 fencing이 작동될 것입니다.<br><br>2. 이전에 아래 케이스에서 이에 대한 답변을 받았는데 저희쪽 상황과 맞는지 확인 부탁 드립니다.<br>   =&gt; 말씀하신 예전 케이스의 내용은 stonith device와 통신이 불가한 경우에도 모니터링 결과에 정상으로 출력되는 버그에 관련된 질문을 하신것으로 확인됩니다.<br>어떤 부분의 상황을 말씀하신것인지 정확한 내용을 적어주시면 확인해보겠습니다.<br> <br>감사합니다.<br><br><publishedDate>2017-09-11T04:14:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KVQRSIA5"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2017-09-08T07:23:28Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2017-09-08T07:23:28Z</b><br><br>답변 감사합니다.<br>추가적인 질문 드립니다.<br>현재 상태에서  ipmi_lan 명령어로 확인하면  정상적으로 접속(idrac 접속) 이 가능한것인 확인 됩니다.<br>현재 stonith stopped 된 상태에서 실제 fening 상황이 발생하면 정상적으로 fencing 이 발생하는지요? <br><br>이전에 아래 케이스에서 이에 대한 답변을 받았는데 저희쪽 상황과 맞는지 확인 부탁 드립니다.<br>https://access.redhat.com/support/cases/#/case/01774911<br><br><publishedDate>2017-09-08T07:23:28Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KVPN9IAP"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2017-09-08T05:24:51Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2017-09-08T07:15:36Z</b><br><br>안녕하세요,<br> <br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br> <br>문의하신 내용에 대한 답변입니다.<br> <br>1. pcs stonith cleanup을 하였을 경우 다른 리소스에 영향이 있습니까?<br>- 네 영향이 있습니다. pcs stonith cleanup 명령어는 stonith resource를 초기화 하는 probing 과정을 거치게 됩니다.<br>stonith probing은 모든 resource의 재시작을 발생시킵니다. 결과적으로 stonith resource만 cleanup 할 수는 없습니다.<br>대신 stontih resource를 제외하고 일반적인 resource는 개별로 cleanup이 가능합니다.<br> <br>2. 에러 메시지를 제거 및 상태 복구 방법은 무엇입니까?<br>(A -&gt; B -&gt; C 절차로 진행하시면 됩니다.)<br> <br>A. 하기 명령어로 stonith의 fail-count 속성을 임시적으로 변경합니다. (1m은 1분을 의미합니다.)<br># pcs stonith update &lt;stonith resource&gt; meta failure-timeout=1m<br> <br>B. pcs status로 에러 메시지가 제거되었는지 확인합니다. <br>- A. 명령어로 fail-count 속성이 초기화 될 수 있는 시간이 1분이며, 이 시간이 지나면 초기화 될 조건이 갖추어 지게 되지만,<br>resource의 메타 속성이 변경됨을 인지하는 기본간격이 15분이므로 에러 메시지가 제거 되는데 시간이 좀 더 소요될 수 있습니다.<br> <br>C. 임시로 설정한 stonith fail-count 속성을 원복합니다. <br># pcs stonith update &lt;stonith resource&gt; meta failure-timeout= <br><br><br>참조하시면 도움이 되실만한 KCS를 첨부합니다.<br><br>&quot;All resources restart after executing 'pcs resource cleanup' in a cluster with a stonith device that provides unfencing in a RHEL 6 or 7 High Availability cluster with pacemaker&quot;<br>https://access.redhat.com/solutions/2949821<br><br><br>감사합니다.<br><br><publishedDate>2017-09-08T05:24:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KIZ9jIAH"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2017-09-07T06:46:36Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2017-09-07T06:46:36Z</b><br><br>안녕하세요,<br> <br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>해당 케이스에 대하여 확인중에 있습니다.<br><br>확인 후 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-07T06:46:36Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KIPXhIAP"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2017-09-06T15:57:35Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2017-09-06T15:57:35Z</b><br><br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>    - 성함(직급) :이주호 책임<br>    - 회사명(부서명) :금융시스템그룹(금융/서비스)/삼성SDS<br>    - 전화번호 :+82-70-7111-2079  <br>    - 메일주소 :juho88.lee@samsung.com<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>    - 성함(직급) :이승훈 수석<br>    - 회사명(부서명) :타임게이트<br>    - 전화번호 :010-5493-0769<br>    - 메일주소 :sh.lee@time-gate.com<br><br><publishedDate>2017-09-06T15:57:35Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br> Clone Set: rsc_ping-clone [rsc_ping]<br>     Started: [ quoclp01-HB quoclp02-HB ]<br> Resource Group: grp1<br>     rsc_vip1<br>(ocf::heartbeat:IPaddr2):<br>Started quoclp01-HB<br>     rsc_ascs1<br>(ocf::sfmi:MySAP):<br>Started quoclp01-HB<br> kdump_stonith<br>(stonith:fence_kdump):<br>Started quoclp01-HB<br> ipmilan_stonith1<br>(stonith:fence_ipmilan):<br>Stopped<br> ipmilan_stonith2<br>(stonith:fence_ipmilan):<br>Started quoclp01-HB<br><br>Failed Actions:<br>* ipmilan_stonith1_start_0 on quoclp02-HB 'unknown error' (1): call=33, status=Timed Out, exitreason='none',<br>    last-rc-change='Wed Jul 26 14:35:40 2017', queued=0ms, exec=20003ms<br><br><br>PCSD Status:<br>======================<br>이후 messages 에서도 아래와 같은 메세지가 주기적으로 발생합니다.<br><br>engine[81891]: warning: Processing failed op start for ipmilan_stonith1 on quoclp02-HB: unknown error (1)<br> quoclp01 pengine[81891]: warning: Forcing ipmilan_stonith1 away from quoclp02-HB after 1000000 failures (max=3)<br>Sep  1 03:51:17 quoclp01 pengine[81891]:  notice: Calculated Transition 4531: /var/lib/pacemaker/pengine/pe-input-272.bz2<br>quoclp01 crmd[81892]:  notice: Transition 4531 (Complete=0, Pending=0, Fired=0, Skipped=0, Incomplete=0, Source=/var/lib/pacemaker/pengine/pe-input-272.bz2):</issue><environment>이러한 메세지가 발생하더라도  펜싱을 해야 할 상황이 되었을때 ipmi 통신이 정상적으로 된다면 제대로 펜싱 되는것으로 알고있는데 맞는지요?<br>이러한 메세지를 없애는 방법은  pcs  stonith  cleanup 으로 알고 있는데 이 명령을 실행하게 되면<br>운영환경에서  리소스들에 영향이 있는지요?<br><br>확인 부탁드립니다.</environment><cep>false</cep></case>