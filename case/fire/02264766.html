======================<br><b>생성계정 : support os</b><br><b>생성날짜 : 2018-11-30T07:16:07Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-12-22T11:01:32Z</b><br><b>id : 5002K00000curFbQAI</b><br>======================<br><br><b><font size=15>
제목  : SFTP 에서 chroot 환경 구성방법 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>리눅스 서버들에 대해서 보안상 권고로 ftp 에서 sftp 접속 방식으로 접근제어 시스템이 전환되었습니다.<br>기존에 문의드려서 설정하였던 ftp 환경에서의 chroot 설정을 sftp 환경에서 적용될 수 있도록 구성이 필요합니다.<br><br>기존에 진행문의 했던 케이스 <br>https://access.redhat.com/support/cases/#/case/02091320<br><br><br>현재 참고하고 있는 레드햇 솔루션<br>https://access.redhat.com/solutions/2399571<br>https://access.redhat.com/solutions/20764<br><br>=====================================================================<br><br>1. 기존 ftp 방식과 다르게 sftp 방식에서의 계정별로 chroot 설정 방법<br><br>chroot 구성시 사용자 shell이     /bin/false 설정하는것이 꼭  필요한가요? <br>필요하다면 사용자는 sftp 전용계정과 ssh 계정을 분리해서 사용해야 하는지요?<br><br><br>2. 계정별 업로드 또는 다운로드 만 가능하게 설정하는 방법<br>sftp 전용만 사용할 경우 ftp incoming 처럼 쓰기만 가능하고 삭제는 안되는 설정이 가능한지요?<br> <br><br>3. sftp 에 대해 사용자 계정을 chroot 설정 후 같은포트로 서비스되는 ssh 접속시 영향도는 없는지?<br><br><br>===================================================================<br>담당자 정보<br>===================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>    - 성함(직급) :이주호 책임<br>    - 회사명(부서명) :금융시스템그룹(금융/서비스)/삼성SDS<br>    - 전화번호 :+82-70-7111-2079  <br>    - 메일주소 :juho88.lee@samsung.com<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>    - 성함(직급) :이승훈 수석<br>    - 회사명(부서명) :타임게이트<br>    - 전화번호 :010-5493-0769<br>    - 메일주소 :sh.lee@time-gate.com<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><hostname>[삼성화재][ERP][레거시]</hostname><br><br><br><comment id="a0a2K00000OQYV9QAP"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-12-07T08:11:03Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-12-07T08:11:03Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>&gt; sftp  chroot 구성시 사용자  shell 이 /bin/bash 일경우 <br>&gt; sftp 에서는 chroot 디렉토리 안에서만 이동이 가능하고 ssh 상에서는 모든 디렉토리가 이동 가능하는데 맞는지요?<br><br>네, 맞습니다.<br><br>해당 이슈에 대하여 추가적인 이슈가 있으시면 다시 연락 주시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2018-12-07T08:11:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000OQXyAQAX"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2018-12-07T07:20:14Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2018-12-07T07:20:14Z</b><br><br>sftp  chroot 구성시 사용자  shell 이 /bin/bash 일경우 <br>sftp 에서는 chroot 디렉토리 안에서만 이동이 가능하고 ssh 상에서는 모든 디렉토리가 이동 가능하는데 맞는지요?<br><br><publishedDate>2018-12-07T07:20:14Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0a2K00000OPLQKQA5"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2018-12-03T02:20:52Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2018-12-03T02:20:51Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>저는 Platform Support 를 담당하고 있는 Senior Technical Support Engineer 황 영 입니다.<br><br>문의하신 질문에 대한 답변은 아래와 같이 안내해 드립니다.<br><br>1. 기존 ftp 방식과 다르게 sftp 방식에서의 계정별로 chroot 설정 방법<br><br>chroot 구성시 사용자 shell이     /bin/false 설정하는것이 꼭  필요한가요? <br>필요하다면 사용자는 sftp 전용계정과 ssh 계정을 분리해서 사용해야 하는지요?<br><br>==&gt; /bin/false는 로그인 shell이 필요하지 않는 계정에 추가하는 것이며 꼭 필요한 설정은 아닙니다.<br><br><br>2. 계정별 업로드 또는 다운로드 만 가능하게 설정하는 방법<br>sftp 전용만 사용할 경우 ftp incoming 처럼 쓰기만 가능하고 삭제는 안되는 설정이 가능한지요?<br> <br>==&gt; 앞서 안내해 드린바와 같이 파일 삭제 작업을 하는 유저가 해당 파일이 있는 디렉토리에 대하여 쓰기 권한이 있다면<br>삭제 작업이 가능하게 됩니다. <br><br>참고문서:<br>How to set permissions on directories shared via SFTP in RHEL6?<br>https://access.redhat.com/solutions/539133<br><br>3. sftp 에 대해 사용자 계정을 chroot 설정 후 같은포트로 서비스되는 ssh 접속시 영향도는 없는지?<br><br>==&gt; sftp 유저의 shell을 수정하지 않았다면 해당 유제에 대한ssh는 정상적으로 사용 가능합니다.<br><br>4. sftp 에 대한 로그를 별도로 남기는 방법이 있는지요?<br>기존에는 xferlog 나 vsftp 로그에 로그가 남는데 sftp 일 경우 로그가 어디에 남는지요?<br><br>==&gt; sshd_config 설정 파일에 아래와 같이 설정시 sftp 로그를 /var/log/secure 파일에 기록하게 됩니다.<br>Subsystem sftp internal-sftp -f AUTHPRIV -l VERBOSE<br>                             ^^^^^^^^^^^^^^^^^^^^^^^ 추가부분<br>설정후 서비스 재기동<br># systemctl restart sshd<br><br>감사합니다.<br><br><publishedDate>2018-12-03T02:20:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0a2K00000OP2UzQAL"><br>======================<br><b>생성계정 : os, support</b><br><b>생성날짜 : 2018-11-30T07:40:07Z</b><br><b>마지막 답변자 : os, support</b><br><b>마지막 수정 일자 : 2018-11-30T07:40:07Z</b><br><br>추가 문의 드립니다.<br>sftp 에 대한 로그를 별도로 남기는 방법이 있는지요?<br>기존에는 xferlog 나 vsftp 로그에 로그가 남는데 sftp 일 경우 로그가 어디에 남는지요?<br><br><publishedDate>2018-11-30T07:40:07Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>기존에 문의드려서 설정하였던 ftp 환경에서의 chroot 설정을 sftp 환경에서 적용될 수 있도록 구성이 필요합니다.<br><br>기존에 진행문의 했던 케이스 <br>https://access.redhat.com/support/cases/#/case/02091320<br><br><br>현재 참고하고 있는 레드햇 솔루션<br>https://access.redhat.com/solutions/2399571<br>https://access.redhat.com/solutions/20764<br><br>=====================================================================<br><br>1. 기존 ftp 방식과 다르게 sftp 방식에서의 계정별로 chroot 설정 방법<br><br>chroot 구성시 사용자 shell이     /bin/false 설정하는것이 꼭  필요한가요? <br>필요하다면 사용자는 sftp 전용계정과 ssh 계정을 분리해서 사용해야 하는지요?<br><br><br>2. 계정별 업로드 또는 다운로드 만 가능하게 설정하는 방법<br>sftp 전용만 사용할 경우 ftp incoming 처럼 쓰기만 가능하고 삭제는 안되는 설정이 가능한지요?<br> <br><br>3. sftp 에 대해 사용자 계정을 chroot 설정 후 같은포트로 서비스되는 ssh 접속시 영향도는 없는지?<br><br><br>===================================================================<br>담당자 정보<br>===================================================================<br>* 고객 정보 (필수) - 실제 레드햇 서브스크립션을 소유하고 시스템에 사용 중인 엔드 유저<br>    - 성함(직급) :이주호 책임<br>    - 회사명(부서명) :금융시스템그룹(금융/서비스)/삼성SDS<br>    - 전화번호 :+82-70-7111-2079  <br>    - 메일주소 :juho88.lee@samsung.com<br><br>* 파트너 정보 (옵션) - 실제 고객의 시스템을 유지보수하는 업체<br>    - 성함(직급) :이승훈 수석<br>    - 회사명(부서명) :타임게이트<br>    - 전화번호 :010-5493-0769<br>    - 메일주소 :sh.lee@time-gate.com</issue><cep>false</cep></case>