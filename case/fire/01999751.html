======================<br><b>생성계정 : 주호 이</b><br><b>생성날짜 : 2017-12-26T01:40:52Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-01-22T11:11:46Z</b><br><b>id : 500A000000ZOJtlIAH</b><br>======================<br><br><b><font size=15>
제목  : quota 설정 방법 문ㅇ
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>xfs 파일시스템의 사이즈를 줄이고자 하는데 방법이 없어서 quota 로 제한하려고 합니다.<br>관련하여 전체 계정, group 상관없이 적용이 가능한 방법을 문의드리며,  불가 시 root 외 전 계정 및 group 에 대해서 적용할수 있는 방법을 문의드립니다.<br>(파일시스템 offline 없이 진행가능한 방법 문의)<br><br>I'm asking for how to set quota limit for a XFS filesystem without distingush account and group.<br>(I need how to set quota in online filesystem)<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.1</b><br><b>타입  : Other</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 4 (Low)</b><br><br><br><folderNumber>74173</folderNumber><br><comment id="a0aA000000LF6udIAD"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-12-27T05:42:20Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-12-27T05:43:16Z</b><br><br>안녕하세요? Red Hat 송 창 안 입니다.<br><br>현재까지 제가 테스트한 결과 project quota룰 사용하는 경우에 원하시는 결과를 확인 할 수 있을 것으로 판단하고 있으며,<br>테스트 된 내용에 대해서 현재의 케이스에서 공유 하도록 하겠습니다.<br><br>1. 먼저 제가 테스트를 진행한 디스크 정보에 해당이 됩니다.<br>[root@localhost ~]# fdisk /dev/vdb<br>Welcome to fdisk (util-linux 2.23.2).<br><br>Changes will remain in memory only, until you decide to write them.<br>Be careful before using the write command.<br><br>Command (m for help): p<br><br>2. 실제로 2GB 이상의 디스크를 정보를 확인 할 수 있습니다.<br>Disk /dev/vdb: 2147 MB, 2147483648 bytes, 4194304 sectors<br>Units = sectors of 1 * 512 = 512 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk label type: dos<br>Disk identifier: 0x452460ae<br><br>   Device Boot      Start         End      Blocks   Id  System<br>/dev/vdb1            2048     4194303     2096128   83  Linux<br><br>Command (m for help): quit<br><br>3. project quota로 사용하기 위해서 마운트를 합니다.<br>[root@localhost ~]# mount -o prjquota /dev/vdb1 /test<br><br>아래의 projects/projid는 uid/guid 개념이 아닌 label 개념이라고 판단 하시면 됩니다.<br>[root@localhost ~]# echo 42:/test &gt;&gt; /etc/projects<br>[root@localhost ~]# echo logfiles:42 &gt;&gt; /etc/projid<br><br>마운트 포인트에 대해서 디렉토리 파일에 project quota를 사용하기 위한 초기화 과정을 진행 합니다.<br>[root@localhost ~]# xfs_quota -x -c 'project -s logfiles' /test<br><br>bhard 파라메터를 통해 100M만 사용이 가능하도록 설정 하였습니다.<br>[root@localhost ~]# xfs_quota -x -c 'limit -p bhard=100m logfiles' /test<br><br><br>4.시스템에서 실제 디스크의 사용량은 100M 로 확인을 할수 있습니다.<br>[root@localhost ~]# df -h<br>Filesystem             Size  Used Avail Use% Mounted on<br>/dev/mapper/rhel-root   18G  2.2G   16G  13% /<br>devtmpfs               910M     0  910M   0% /dev<br>tmpfs                  920M     0  920M   0% /dev/shm<br>tmpfs                  920M  8.5M  912M   1% /run<br>tmpfs                  920M     0  920M   0% /sys/fs/cgroup<br>/dev/vdb1              100M     0  100M   0% /test             &lt;--------------------<br>/dev/vda1              497M  125M  373M  26% /boot<br>tmpfs                  184M     0  184M   0% /run/user/0<br><br>5.root 또한 1기가 파일에 대해서 파일을 생성 할 수 없다고 에러 메세지를 확인 할 수 있습니다.<br>[root@localhost ~]# cd /test<br>[root@localhost test]# ls<br>[root@localhost test]# dd if=/dev/zero of=1gig bs=32k count=32000  <br>dd: error writing ‘1gig’: No space left on device<br>3201+0 records in<br>3200+0 records out<br>104857600 bytes (105 MB) copied, 1.04407 s, 100 MB/s<br><br>아래의 내용은 bhard 값을 100M 씩 늘려면서 테스트 한 결과 입니다.<br>[root@localhost ~]# df -h<br>Filesystem             Size  Used Avail Use% Mounted on<br>/dev/mapper/rhel-root   18G  2.2G   16G  13% /<br>devtmpfs               910M     0  910M   0% /dev<br>tmpfs                  920M     0  920M   0% /dev/shm<br>tmpfs                  920M  8.4M  912M   1% /run<br>tmpfs                  920M     0  920M   0% /sys/fs/cgroup<br>/dev/vda1              497M  125M  373M  26% /boot<br>tmpfs                  184M     0  184M   0% /run/user/0<br>/dev/vdb1              100M  100M     0 100% /test<br><br>[root@localhost ~]# xfs_quota -x -c 'limit -p bhard=200m logfiles' /test<br>[root@localhost ~]# df -h<br>Filesystem             Size  Used Avail Use% Mounted on<br>/dev/mapper/rhel-root   18G  2.2G   16G  13% /<br>devtmpfs               910M     0  910M   0% /dev<br>tmpfs                  920M     0  920M   0% /dev/shm<br>tmpfs                  920M  8.4M  912M   1% /run<br>tmpfs                  920M     0  920M   0% /sys/fs/cgroup<br>/dev/vda1              497M  125M  373M  26% /boot<br>tmpfs                  184M     0  184M   0% /run/user/0<br>/dev/vdb1              200M  100M  100M  50% /test<br>[root@localhost ~]# cd /test<br><br>[root@localhost test]# dd if=/dev/zero of=1gig bs=32k count=32000 <br>dd: error writing ‘1gig’: No space left on device<br>6401+0 records in<br>6400+0 records out<br>209715200 bytes (210 MB) copied, 2.42193 s, 86.6 MB/s<br>[root@localhost test]# df -h<br>Filesystem             Size  Used Avail Use% Mounted on<br>/dev/mapper/rhel-root   18G  2.2G   16G  13% /<br>devtmpfs               910M     0  910M   0% /dev<br>tmpfs                  920M     0  920M   0% /dev/shm<br>tmpfs                  920M  8.4M  912M   1% /run<br>tmpfs                  920M     0  920M   0% /sys/fs/cgroup<br>/dev/vda1              497M  125M  373M  26% /boot<br>tmpfs                  184M     0  184M   0% /run/user/0<br>/dev/vdb1              200M  200M     0 100% /test<br><br>[root@localhost test]# xfs_quota -x -c 'limit -p bhard=400m logfiles' /test<br>[root@localhost test]# dd if=/dev/zero of=1gig bs=32k count=32000 <br>dd: error writing ‘1gig’: No space left on device<br>12801+0 records in<br>12800+0 records out<br>419430400 bytes (419 MB) copied, 4.22175 s, 99.3 MB/s<br>[root@localhost test]# df -h<br>Filesystem             Size  Used Avail Use% Mounted on<br>/dev/mapper/rhel-root   18G  2.2G   16G  13% /<br>devtmpfs               910M     0  910M   0% /dev<br>tmpfs                  920M     0  920M   0% /dev/shm<br>tmpfs                  920M  8.4M  912M   1% /run<br>tmpfs                  920M     0  920M   0% /sys/fs/cgroup<br>/dev/vda1              497M  125M  373M  26% /boot<br>tmpfs                  184M     0  184M   0% /run/user/0<br>/dev/vdb1              400M  400M     0 100% /test<br><br>xfs quota 관련 자세한 내용은 아래 링크를 참고하시면, 도움이 되실 것으로 판단 됩니다.<br><br>3.3. XFS Quota Management<br>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/xfsquota<br><br>또한 제가 확인 한 예제는 아래 명령어를 시스템에서 입력 하시면 많은 정보를 확인 하실 수 있습니다. <br># man xfs_quota<br># man 5 projid<br># man 5 projects<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-12-27T05:42:20Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LEyVCIA1"><br>======================<br><b>생성계정 : Song, Chang-An</b><br><b>생성날짜 : 2017-12-26T04:01:17Z</b><br><b>마지막 답변자 : Song, Chang-An</b><br><b>마지막 수정 일자 : 2017-12-26T04:01:16Z</b><br><br>안녕하세요? Red Hat Technical Account Manager 송 창 안 입니다.<br><br>문의 주신 내용에 대해서 확인 후 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br>송 창 안 드림.<br><br><publishedDate>2017-12-26T04:01:16Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>