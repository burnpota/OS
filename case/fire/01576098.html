======================<br><b>생성계정 : Seung-Pil Kim</b><br><b>생성날짜 : 2016-02-01T11:42:43Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2016-04-17T10:01:22Z</b><br><b>id : 500A000000TSSREIA5</b><br>======================<br><br><b><font size=15>
제목  : [삼성화재][보험ERP][가동계] xfs volume unexpectly unmount
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>##################################################<br># Failed Info AND Messages<br>##################################################<br>요약 :<br>1) 하기의 로그가 시스템 메세지( /var/log/messages )에 기록되고, xfs 파일시스템 영역이 Unmounted 됨<br>2) xfs 파일시스템 영역이 종종 Unmounted 되는 것이 정상적인 것인지 확인이 필요 합니다.<br>3) xfs 파일시스템 영역에 문제가 있을 경우에도 Unmounted 되지 않고, I/O error 메세지 등을 발생하는 등<br>    Unmounted 되는 현상을 방지할 수 있는 방법이 있는지 확인이 필요 합니다.<br><br><br>Jan 29 15:36:00 quoalp01 systemd: Unmounted /usr/sap.<br>Jan 29 15:36:00 quoalp01 systemd: Unit usr-sap.mount entered failed state.<br>Jan 29 15:36:40 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 29 15:36:40 quoalp01 systemd-fsck: /sbin/fsck.xfs: XFS file system.<br>Jan 29 15:36:40 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 29 15:36:40 quoalp01 systemd: usr-sap.mount: Directory /usr/sap to mount over is not empty, mounting anyway.<br>Jan 29 15:36:40 quoalp01 systemd: Mounting /usr/sap...<br>Jan 29 15:36:40 quoalp01 kernel: XFS (dm-15): Mounting V4 Filesystem<br>Jan 29 15:36:40 quoalp01 kernel: XFS (dm-15): Ending clean mount<br>Jan 29 15:36:40 quoalp01 systemd: Mounted /usr/sap.<br>Jan 29 15:37:15 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sapQFP_lv...<br>Jan 29 15:37:15 quoalp01 systemd-fsck: /sbin/fsck.xfs: XFS file system.<br>Jan 29 15:37:15 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sapQFP_lv.<br>Jan 29 15:37:15 quoalp01 systemd: Mounting /usr/sap/QFP...<br>Jan 29 15:37:15 quoalp01 kernel: XFS (dm-16): Mounting V4 Filesystem<br>Jan 29 15:37:15 quoalp01 kernel: XFS (dm-16): metadata I/O error: block 0xc800020 (&quot;xlog_bread_noalign&quot;) error 19 numblks <br><br>Jan  7 10:59:13 eccalp01 kernel: XFS (sdb1): Unmounting Filesystem<br><br><br>4) 관련된 시스템 sosreport는 하기의 케이스에 첨부된 sosreport 파일이니 참조하여 주시기 바랍니다.<br>https://access.redhat.com/support/cases/#/case/01576080<br>https://access.redhat.com/support/cases/#/case/01576068<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><br><br><folderNumber>74166</folderNumber><br><comment id="a0aA000000GmmnfIAB"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-04-01T01:38:42Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-04-01T01:38:42Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>금일 해당 버그 픽스 버전이 릴리즈 되었습니다.<br>픽스 버전은 systemd-219-19.el7_2.7 이며 <br>해당 버그의 영향을 받지 않기 위하여 업데이트 하시기 바랍니다.<br><br>https://rhn.redhat.com/errata/RHBA-2016-0181.html<br><br><br>감사합니다.<br><br><publishedDate>2016-04-01T01:38:42Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GjFRsIAN"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-03-15T06:00:17Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-03-15T06:00:17Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>문의하신 질문에 대한 답변 아래와 같이 안내해 드립니다.<br><br>1)<br>권고하셨던 xfs파일시스템 관련 /etc/fstab 설정 &quot;0 0&quot;부분은 문제 분석을해주신 내용으로 판단해보면, Workaround를 적용과 상관없이 기존 설정인  &quot;0 2&quot;로 원복하여도 상관없으리라 판단됩니다.<br>이에대한 검토가 필요합니다.<br><br>앞서 안내해드린바와 같이 xfs는 부팅시 fstab 파일 설정에 의한 dump와 fsck를 지원하기 않습니다.<br>따라서 fstab에서 해당 두 값을 &quot;0 2&quot;으로 변경하셔도 아무런 작용을 하지 않을뿐 문제는 없을 것입니다.<br><br>2) # sed -i '/DM_UDEV_DISABLE_OTHER_RULES_FLAG/s|.*|SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ACTION==&quot;add&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;|' /usr/lib/udev/rules.d/99-systemd.rules<br><br>앞서 안내하여주신 WorkAround를 적용할 시,<br>문제가 없음을 판단할 수 있는 테스트 방법이나 기준이 있는지 확인이 필요합니다.<br><br>해당 설정는 현 케이스에서 리포팅된 버그의 패치 내용이며 udev 잘못된 룰을 변경하여 DM multipath 디바이스 리로딩에 의한 <br>CHANGE 이벤트가 해당 DM 디바이스위의 파일시스템을 자동으로 unmount 작업을 진행하지 않게 하는 작용을 합니다.<br><br>변경전:<br>SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;<br><br>변경후:<br>SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ACTION==&quot;add&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;<br><br>따라서 해당 작업을 진행하셔도 서버에 문제가 없을것으로 보입니다.<br><br>감사합니다.<br><br><publishedDate>2016-03-15T06:00:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GiYiGIAV"><br>======================<br><b>생성계정 : Kim, Seung-Pil</b><br><b>생성날짜 : 2016-03-11T01:58:19Z</b><br><b>마지막 답변자 : Kim, Seung-Pil</b><br><b>마지막 수정 일자 : 2016-03-11T01:58:19Z</b><br><br>안녕하세요.<br>추가 문의사항이 있습니다.<br><br>1)<br>권고하셨던 xfs파일시스템 관련 /etc/fstab 설정 &quot;0 0&quot;부분은 문제 분석을해주신 내용으로 판단해보면, Workaround를 적용과 상관없이 기존 설정인  &quot;0 2&quot;로 원복하여도 상관없으리라 판단됩니다.<br>이에대한 검토가 필요합니다.<br><br><br>2) # sed -i '/DM_UDEV_DISABLE_OTHER_RULES_FLAG/s|.*|SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ACTION==&quot;add&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;|' /usr/lib/udev/rules.d/99-systemd.rules<br><br>앞서 안내하여주신 WorkAround를 적용할 시,<br>문제가 없음을 판단할 수 있는 테스트 방법이나 기준이 있는지 확인이 필요합니다.<br><br>지원에 감사 드립니다.<br>고맙습니다.<br><br>(Hwang, Yeong에 회신)<br>&gt; 안녕하세요,<br>&gt; <br>&gt; Red Hat Global Support Services 입니다.<br>&gt; <br>&gt; 해당 이슈는 버그로 판정되었으며 패치가 개발되어 확인중에 있으며 아직 테스트 단계에 진입하지 <br>&gt; 않은것으로 확인됩니다.<br>&gt; <br>&gt; 현재 해당 이슈에 대하여 아래와 같은 workaround가 제공되고 있으며<br>&gt; 만일 이 workaround를 사용시 충분한 테스트를 진행후 적용하시는것을 권고 드립니다.<br>&gt; <br>&gt; # sed -i '/DM_UDEV_DISABLE_OTHER_RULES_FLAG/s|.*|SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ACTION==&quot;add&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;|' /usr/lib/udev/rules.d/99-systemd.rules<br>&gt; <br>&gt; And reloading the rules:<br>&gt; <br>&gt; # udevadm control --reload<br>&gt; <br>&gt; 감사합니다.<br><br><publishedDate>2016-03-11T01:58:19Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GcXAmIAN"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-03-04T02:19:34Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-03-04T02:19:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>해당 이슈는 버그로 판정되었으며 패치가 개발되어 확인중에 있으며 아직 테스트 단계에 진입하지 <br>않은것으로 확인됩니다.<br><br>현재 해당 이슈에 대하여 아래와 같은 workaround가 제공되고 있으며<br>만일 이 workaround를 사용시 충분한 테스트를 진행후 적용하시는것을 권고 드립니다.<br><br># sed -i '/DM_UDEV_DISABLE_OTHER_RULES_FLAG/s|.*|SUBSYSTEM==&quot;block&quot;, KERNEL!=&quot;ram*&quot;, ACTION==&quot;add&quot;, ENV{DM_UDEV_DISABLE_OTHER_RULES_FLAG}==&quot;1&quot;, ENV{SYSTEMD_READY}=&quot;0&quot;|' /usr/lib/udev/rules.d/99-systemd.rules<br><br>And reloading the rules:<br><br># udevadm control --reload<br><br>감사합니다.<br><br><publishedDate>2016-03-04T02:19:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GZVdSIAX"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-22T06:34:53Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-22T06:34:53Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>해당 이슈의 현 상황은 서비스 개발엔지니어분들과 스토리지 개발엔지니어분들께서<br>함께 확인중에 있습니다.<br>정확한 분석 결과가 있을 경우 바로 업데이트 해드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-22T06:34:53Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GZCTbIAP"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-19T07:26:52Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-19T07:26:52Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>현재 해당 이슈는 앞서 안내해드린바와 같이 systemd의 feature로 <br>밝혀지고 있습니다. 다만 이와 같이 작업이 RHEL6와 일치하지 않기<br>때문에 이와 같은 현상이 정상적인지에 대하여 추가적인 확인이<br>필요한 상황입니다. 해당 이슈에 대하여 백업 엔지니어 분들과 함께 <br>분석중이기 때문에 다소 시간이 걸릴것으로 보입니다. 이점 양해<br>부탁드립니다.<br><br>정확한 분석 결과가 있을 경우 바로 업데이트 해드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-19T07:26:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GYlfNIAT"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-18T07:52:47Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-18T07:52:46Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>현재 저희 환경에서 테스트 해본 결과 파일시스템 아래의 디바이스가 disconnected로<br>될 경우 (멀티패스일 경우 모든 패스가 다운됨) 파일시스템이 unmount 가 되는것이 발견 되었습니다.<br>RHEL7에서 systemd로 파일시스템을 관리하게 되며 이와 같은 현상은 XFS 파일시스템에서만 발생되는 이슈가 아니라 <br>모든 파일시스템을 사용시 발생되는 것으로 확인됩니다.<br><br>Feb 18 14:33:30 localhost systemd: Unmounting /xfs_mount...<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): Unmounting Filesystem<br>Feb 18 14:33:30 localhost kernel: blk_update_request: I/O error, dev dm-2, sector 1048610<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): metadata I/O error: block 0x100022 (&quot;xlog_iodone&quot;) error 5 numblks 64<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): xfs_do_force_shutdown(0x2) called from line 1180 of file fs/xfs/xfs_log.c.  Return address = 0xffffffffa0248b1e<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): Log I/O Error Detected.  Shutting down filesystem<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): Please umount the filesystem and rectify the problem(s)<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): Unable to update superblock counters. Freespace may not be correct on next mount.<br>Feb 18 14:33:30 localhost kernel: XFS (dm-2): xfs_log_force: error -5 returned.<br>Feb 18 14:33:30 localhost kernel: blk_update_request: I/O error, dev dm-2, sector 0<br>Feb 18 14:33:30 localhost systemd: Unmounted /xfs_mount.<br><br>현재 해당 현상이 systemd의 정상적인 행동인지와 맞다면 이와 같은 기능을 비활성화할수 있는지에<br>대하여 확인해 보도록 하겠습니다. 새로운 발견이 있을 경우 다시 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-18T07:52:46Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GYTRoIAP"><br>======================<br><b>생성계정 : Kim, Seung-Pil</b><br><b>생성날짜 : 2016-02-17T18:01:21Z</b><br><b>마지막 답변자 : Kim, Seung-Pil</b><br><b>마지막 수정 일자 : 2016-02-17T18:01:21Z</b><br><br>안녕하세요.<br><br>/etc/fstab의 파일시스템 점검 설정은 시스템 booting시에 적용되는 것 이외에,<br>운영중인 상태에서도 fsck를 수행하도록 하는 등 영향을 줄 수 있는 가능성이 있는지요?<br><br>/etc/fstab에서 xfs 파일시스템의 설정을 &quot;0 0&quot;으로 변경하는 것이<br>운영중인 상태에서 fsck이 자주 발생되고 unmount 되는 현상과 어떤 연관관계가 있을지 추가 문의 드립니다.<br><br>우선, 조언하여주신  /etc/fstab에 xfs 파일시스템의 점검 설정은 0으로 변경해 두었습니다.<br><br>참고로 /etc/fstab에서 xfs 파일시스템의 설정을 &quot;0 0&quot;으로 변경하지 않은 상태에서,<br>최근 2주일 동안에는  파일시스템이 unmount되는 현상이 없었습니다.<br><br>고맙습니다.<br><br>(Hwang, Yeong에 회신)<br>&gt; 안녕하세요,<br>&gt; <br>&gt; Red Hat Global Support Services 입니다.<br>&gt; <br>&gt; xfs는 부팅시 fstab 파일 설정에 의한 dump와 fsck를 지원하기 않습니다.<br>&gt; 따라서 fstab에서 해당 두 값을 &quot;0 0&quot;으로 변경하셔도 문제가 없을 것입니다.<br>&gt; <br>&gt; 감사합니다.<br><br><publishedDate>2016-02-17T18:01:21Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GYJMDIA5"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-17T03:17:18Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-17T03:17:18Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>xfs는 부팅시 fstab 파일 설정에 의한 dump와 fsck를 지원하기 않습니다.<br>따라서 fstab에서 해당 두 값을 &quot;0 0&quot;으로 변경하셔도 문제가 없을 것입니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-17T03:17:18Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GYIJVIA5"><br>======================<br><b>생성계정 : Kim, Seung-Pil</b><br><b>생성날짜 : 2016-02-17T00:15:04Z</b><br><b>마지막 답변자 : Kim, Seung-Pil</b><br><b>마지막 수정 일자 : 2016-02-17T00:15:03Z</b><br><br>문의에 오해가 있을 듯하여,<br>추가 설명 드립니다.<br><br>RHEL영역의 xfs 파일시스템의 경우, /etc/fstab에 파일시스템 점검 설정이 0으로 설정되는 것은 알고 있습니다.<br>현재 문제가 발생하던 파일시스템 영역의 설정 &quot;1  1&quot;을,<br>권고해주신 값 &quot;0  0&quot;으로 변경하면 파일시스템 점검을 수행하지 않을 것이라 예상합니다.<br>이와같이 파일시스템 점검을 하지않더라도 문제 없을지 확인 부탁 드립니다.<br><br><br>(Kim, Seung-Pil에 회신)<br>&gt; 안녕하세요.<br>&gt; <br>&gt; 답변 감사 드립니다.<br>&gt; <br>&gt; RHEL영역의 xfs 파일시스템의 경우, <br>&gt; /etc/fstab에 파일시스템 점검 설정이 0으로 설정되는 데, 해당설정으로 변경하여 파일시스템 점검을 수행하지<br>&gt;  않더라도 문제 없을지 확인 부탁 드립니다.<br>&gt; <br>&gt; 고맙습니다.<br>&gt; <br>&gt; (Hwang, Yeong에 회신)<br>&gt; &gt; 안녕하세요,<br>&gt; &gt; <br>&gt; &gt; Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br>&gt; &gt; <br>&gt; &gt; 앞서 저희 Masahiro Matsuya 엔지니어분께서 업데이트 해드린바와 같이 unmount되는 파일시스템에<br>&gt; &gt; 대한 fsck이 자주 발생된것으로 확인됩니다.<br>&gt; &gt; <br>&gt; &gt; 아래와 같이 fsck를 비활성화 하시고 리부팅 하신후 이와 같이 이슈가 발생되는지를 확인 부탁드립니다.<br>&gt; &gt; # cat /etc/fstab<br>&gt; &gt; ...<br>&gt; &gt;  /dev/DATAVG001/sap_lv<br>/usr/sap/<br>xfs<br>defaults<br>0 0<br>&gt; &gt;  /dev/DATAVG001/sapQFP_lv<br>/usr/sap/QFP<br>xfs<br>defaults<br>0 0<br>&gt; &gt;  /dev/DATAVG001/APP_lv<br>/APP<br>xfs<br>defaults<br>0 0<br>&gt; &gt; <br>&gt; &gt; 감사합니다.<br><br><publishedDate>2016-02-17T00:15:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GYIHPIA5"><br>======================<br><b>생성계정 : Kim, Seung-Pil</b><br><b>생성날짜 : 2016-02-17T00:07:29Z</b><br><b>마지막 답변자 : Kim, Seung-Pil</b><br><b>마지막 수정 일자 : 2016-02-17T00:07:28Z</b><br><br>안녕하세요.<br><br>답변 감사 드립니다.<br><br>RHEL영역의 xfs 파일시스템의 경우, <br>/etc/fstab에 파일시스템 점검 설정이 0으로 설정되는 데, 해당설정으로 변경하여 파일시스템 점검을 수행하지<br> 않더라도 문제 없을지 확인 부탁 드립니다.<br><br>고맙습니다.<br><br>(Hwang, Yeong에 회신)<br>&gt; 안녕하세요,<br>&gt; <br>&gt; Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br>&gt; <br>&gt; 앞서 저희 Masahiro Matsuya 엔지니어분께서 업데이트 해드린바와 같이 unmount되는 파일시스템에<br>&gt; 대한 fsck이 자주 발생된것으로 확인됩니다.<br>&gt; <br>&gt; 아래와 같이 fsck를 비활성화 하시고 리부팅 하신후 이와 같이 이슈가 발생되는지를 확인 부탁드립니다.<br>&gt; # cat /etc/fstab<br>&gt; ...<br>&gt;  /dev/DATAVG001/sap_lv<br>/usr/sap/<br>xfs<br>defaults<br>0 0<br>&gt;  /dev/DATAVG001/sapQFP_lv<br>/usr/sap/QFP<br>xfs<br>defaults<br>0 0<br>&gt;  /dev/DATAVG001/APP_lv<br>/APP<br>xfs<br>defaults<br>0 0<br>&gt; <br>&gt; 감사합니다.<br><br><publishedDate>2016-02-17T00:07:28Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000GACWfIAP"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-04T08:56:23Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-04T08:56:23Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>앞서 저희 Masahiro Matsuya 엔지니어분께서 업데이트 해드린바와 같이 unmount되는 파일시스템에<br>대한 fsck이 자주 발생된것으로 확인됩니다.<br><br>아래와 같이 fsck를 비활성화 하시고 리부팅 하신후 이와 같이 이슈가 발생되는지를 확인 부탁드립니다.<br># cat /etc/fstab<br>...<br> /dev/DATAVG001/sap_lv<br>/usr/sap/<br>xfs<br>defaults<br>0 0<br> /dev/DATAVG001/sapQFP_lv<br>/usr/sap/QFP<br>xfs<br>defaults<br>0 0<br> /dev/DATAVG001/APP_lv<br>/APP<br>xfs<br>defaults<br>0 0<br><br>감사합니다.<br><br><publishedDate>2016-02-04T08:56:23Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GABlPIAX"><br>======================<br><b>생성계정 : Matsuya, Masahiro</b><br><b>생성날짜 : 2016-02-04T07:34:19Z</b><br><b>마지막 답변자 : Matsuya, Masahiro</b><br><b>마지막 수정 일자 : 2016-02-04T07:34:19Z</b><br><br>Greetings,<br><br>My name is Masahiro Matsuya. I'm a Software Engineer at Red Hat who will be helping Yeong with this case.<br><br>Thanks for your providing the sosreport and the logs in /var/log.<br>I found that fsck was executed a little often.<br><br>$ grep &quot;File System Check on /dev/DATAVG001/sap_lv&quot; messages<br>Jan 14 18:01:41 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 14 18:01:41 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 14 18:01:41 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/sap_lv.<br>Jan 14 18:01:41 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/sap_lv...<br>Jan 14 18:01:41 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 14 18:01:41 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 25 17:48:48 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/sap_lv.<br>Jan 25 17:48:48 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/sap_lv...<br>Jan 25 18:58:15 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 25 18:58:15 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 26 14:37:21 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 26 14:37:21 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 26 17:04:04 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 26 17:04:04 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 29 15:32:05 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/sap_lv.<br>Jan 29 15:32:05 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/sap_lv...<br>Jan 29 15:36:40 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 29 15:36:40 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br>Jan 29 17:59:48 quoalp01 systemd: Starting File System Check on /dev/DATAVG001/sap_lv...<br>Jan 29 17:59:48 quoalp01 systemd: Started File System Check on /dev/DATAVG001/sap_lv.<br><br>It's possible that it caused umount, because fsck needs the umounted file system for checking.<br><br>I checked your /etc/fstab.<br>------------------------------------------<br>/dev/mapper/vg00-root_lv /                       xfs     defaults        0 0<br>UUID=cab2a32a-0f78-401a-b705-247e54b0af58 /boot                   xfs     defaults        0 0<br>/dev/mapper/vg00-home_lv /home                   xfs     defaults        0 0<br>/dev/mapper/vg00-var_lv /var                    xfs     defaults        0 0<br>/dev/mapper/vg00-swap_lv swap                    swap    defaults        0 0<br>/dev/mapper/vg01-crash_lv /CRASH<br><br>xfs<br>defaults<br>0 0<br>/dev/DATAVG001/sap_lv<br>/usr/sap/<br>xfs<br>defaults<br>1 1<br>/dev/DATAVG001/sapQFP_lv<br>/usr/sap/QFP<br>xfs<br>defaults<br>1 1<br>/dev/DATAVG001/APP_lv<br>/APP<br>xfs<br>defaults<br>1 1<br><br># 2016.01.25 - NAS<br>nasalp02:/quo_sap_trans<br>/usr/sap/trans<br>nfs<br>vers=3,proto=tcp,hard,intr,timeo=600,retrans=2,wsize=65536,rsize=65536,_netdev<br>0 0<br>nasalp02:/quo_QFP<br>/sapmnt/QFP<br>nfs<br>vers=3,proto=tcp,hard,intr,timeo=600,retrans=2,wsize=65536,rsize=65536,_netdev<br>0 0<br>nasalp02:/quo_FSQUO<br>/FSQUO<br>nfs<br>vers=3,proto=tcp,hard,intr,timeo=600,retrans=2,wsize=65536,rsize=65536,_netdev<br>0 0<br>nasalp02:/quo_MIG<br>/MIG<br>nfs<br>vers=3,proto=tcp,hard,intr,timeo=600,retrans=2,wsize=65536,rsize=65536,_netdev<br>0 0<br>------------------------------------------<br><br>And, fsck is disabled for any other file systems except for /dev/DATAVG001/*. So, can you disable it for /dev/DATAVG001/* as well?<br>In that case, try the following like other file system.<br><br> /dev/DATAVG001/sap_lv<br>/usr/sap/<br>xfs<br>defaults<br>0 0<br> /dev/DATAVG001/sapQFP_lv<br>/usr/sap/QFP<br>xfs<br>defaults<br>0 0<br> /dev/DATAVG001/APP_lv<br>/APP<br>xfs<br>defaults<br>0 0<br><br>Then, reboot the system. Check if the system status about mounting the file systems is correct, and check if the problem still happens.<br><br>Best Regards,<br><br>Masahiro Matsuya<br>Senior Software Maintenance Engineer<br>Red Hat<br><br><publishedDate>2016-02-04T07:34:19Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000G9wIjIAJ"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-03T04:30:03Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-03T04:30:03Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>지금까지 분석한 상황에 대하여 공유해 드리도록 하겠습니다.<br><br>unmount 이슈가 발생되는 xfs 파일시스템을 확인한바에 의하면 전부 멀티패스 디바이스위에 있는것으로 확인되며<br>로컬 디바이스위에 있는 xfs 파일시스템에는 이와 같은 이슈가 발생되지 않는 것으로 확인됩니다.<br><br>또한 매번 unmount 작업이 발생되기전 아래와 같이 multipathd reassign table 메시지거나 기타<br>multipathd 관련 정보가 기록되는것으로 확인됩니다.<br><br>Jan 25 17:48:48 quoalp01 multipathd: sdag: reassign table DATAVG001-sap_lv old 66:0 new 253:6<br>Jan 25 17:48:48 quoalp01 multipathd: sdag: reassign table DATAVG001-sapQFP_lv old 66:0 new 253:6<br>Jan 25 17:48:48 quoalp01 multipathd: sdag: reassign table DATAVG001-APP_lv old 66:0 new 253:6<br>...<br>Jan 25 17:48:48 quoalp01 systemd: Reloaded Device-Mapper Multipath Device Controller.<br>Jan 25 17:48:48 quoalp01 multipathd: ok<br>Jan 25 17:48:48 quoalp01 systemd-logind: Removed session 17628.<br>Jan 25 17:48:48 quoalp01 systemd: Unmounting /usr/sap/QFP...    &lt;======<br>Jan 25 17:48:48 quoalp01 systemd: Stopped target Remote File Systems.<br>Jan 25 17:48:48 quoalp01 systemd: Stopping Remote File Systems.<br>Jan 25 17:48:48 quoalp01 systemd: Unmounting /usr/sap/trans...<br>Jan 25 17:48:48 quoalp01 kernel: XFS (dm-16): Unmounting Filesystem<br>Jan 25 17:48:48 quoalp01 systemd: Unmounted /usr/sap/QFP.<br>Jan 25 17:48:48 quoalp01 systemd: Unmounting /APP...<br>Jan 25 17:48:48 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/sapQFP_lv.<br>Jan 25 17:48:48 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/sapQFP_lv...<br>Jan 25 17:48:48 quoalp01 kernel: XFS (dm-18): Unmounting Filesystem<br>Jan 25 17:48:48 quoalp01 systemd: Unmounted /APP.<br>Jan 25 17:48:48 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/APP_lv.<br>Jan 25 17:48:48 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/APP_lv...<br>Jan 25 17:48:48 quoalp01 systemd: Unmounted /usr/sap/trans.<br>Jan 25 17:48:48 quoalp01 systemd: Unmounting /usr/sap...<br>Jan 25 17:48:48 quoalp01 kernel: XFS (dm-15): Unmounting Filesystem<br>Jan 25 17:48:48 quoalp01 systemd: Unmounted /usr/sap.<br>Jan 25 17:48:48 quoalp01 systemd: Stopped File System Check on /dev/DATAVG001/sap_lv.<br>Jan 25 17:48:48 quoalp01 systemd: Stopping File System Check on /dev/DATAVG001/sap_lv...<br><br>Jan 29 15:32:04 quoalp01 systemd: Started Device-Mapper Multipath Device Controller.<br>Jan 29 15:32:04 quoalp01 systemd: Stopped target Remote File Systems.<br>Jan 29 15:32:04 quoalp01 systemd: Stopping Remote File Systems.<br><br>Jan 29 18:30:00 quoalp01 multipathd: sdp: reassign table DATAVG001-sapQFP_lv old 8:240 new 253:5<br>Jan 29 18:30:01 quoalp01 systemd: Unmounting /usr/sap/QFP...  &lt;===== <br><br>아직 정확한 원인이 확인되지 않으나 상기 현상에 의하면 이는 멀티패스와 연관이 있는것으로 추측됩니다.<br>해당 이슈에 대하여 콜라보레이션을 진행하여 더 심도깊은 분석을 하도록 하겠습니다.<br>추가적인 진행상황이 있을 경우 다시 업데이트 하도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-03T04:30:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000G9i1lIAB"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-02-02T03:51:31Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-02-02T03:51:31Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>해당 이슈에 대하여 확인 중에 있으면 관련 정보가 확인이 되는대로 다시 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-02-02T03:51:31Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000G9WrJIAV"><br>======================<br><b>생성계정 : Kim, Seung-Pil</b><br><b>생성날짜 : 2016-02-01T14:10:41Z</b><br><b>마지막 답변자 : Kim, Seung-Pil</b><br><b>마지막 수정 일자 : 2016-02-01T14:10:41Z</b><br><br># 참고 - Available TEST - Time Table<br>1) System CPU/Memory stress test<br>Jan 26 18:40 경 부터 Jan 27 06:40 경 까지 , CPU / MEMORY에대한 stress 테스트를 수행 하였음.( stress 명령어를 이용 )<br><br>2) NAS Storage test<br>Jan 27 11:00 경 부터 Jan 27 15:30 경 까지 , NAS Storage에서 가용성 테스트를 수행 하였음.( 각 시스템에게 할당된 NAS 볼륨 중 1개에 DD를 이용한 I/O 쓰기 작업 확인 )<br><br>3) SAN Storage test<br>Jan 29 12:00 경 부터 Jan 29 20:00 경 까지 , SAN Storage에서 가용성 테스트를 수행 하였음.( eccalp01 / eccalp02 호스트에서, SAN 영역에 DD를 이용한 부하 생성 )<br><br>4) Multipath fail-over test<br>Jan 29 13:00 경 부터 Jan 29 20:00 경 까지 , Multipath 테스트를 수행하였음.( 시스템에서 HBA 포트 1개를 절체하여, path Fail-Over 되는지와 I/O가 유지되는지 확인 )<br><br><publishedDate>2016-02-01T14:10:41Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>