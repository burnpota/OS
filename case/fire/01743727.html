======================<br><b>생성계정 : hyangjun son</b><br><b>생성날짜 : 2016-11-21T04:55:09Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2016-11-28T01:11:41Z</b><br><b>id : 500A000000VnC8AIAV</b><br>======================<br><br><b><font size=15>
제목  : [삼성화재][개발][sfqquoal01] 파티션 write error
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>[증상] <br><br>증상.1.DATAVG002-mig_lv 볼륨으로 마운트 된 /MIG 디렉토리에서 파일 쓰기가 안되는 현상 <br><br>시스템에서 hung_task 에러가 발생하여 sosreport 수집하던중 를 <br><br>(9/103)block 부분에서 더 이상 진행이 되지 않음 <br><br>다시 sosreport -vvvv 으로 실행한 결과 parted -s /dev/dm-4 (/MIG ) 에서 멈춰있음 <br><br>/MIG 디렉토리에서 사용자 및 root 가 파일 쓰기가 되지 않는 현상이 발생함 <br><br>강제로 umount 한 상태에서 xfs_repair /dev/mapper/datavg002-MIG_lv 상태에서 멈춰있음 <br><br>강제로 crash dump 를 일으킨 후 재부팅후 정상으로 동작함 <br><br>증상.2 .시스템 메모리 사용량이 top 에서 100% 사용되는 현상 <br><br>위의 1.과 같은 상황이 발생시 시스템 메모리가 100% 사용되는 상태가 표시되는데 실제 top에서는 <br> 전체 100G 메모리중 2G 이상을 사용하고 있는 프로세스가 없음 <br><br>리부팅 후 정상적으로 됨 <br><br>[요청사항]<br><br>1.증상1 와 같은 상황에 발생하는 원인에 대해서 확인 부탁 드립니다.<br>2.증상1 와 같은 상황 발생시 messages 에서 별다른 메세지가 발생하지 않늗데 차후 발생시 추적해 볼수 있는 방법과 조치 방법을 알려주시길 바랍니다.<br>3.메모리 사용량이 제대로 표시되지 않는 이유는 증상1이 원인이 되는 지 확인 바랍니다.<br>4.메모리 사용량이 제대로 확인이 되지 않을 경우 조치 방법을 확인 바랍니다.<br><br>[업로드 파일] <br><br>1.sosreport -vvvv 했을 때 화면을 보내드립니다.<br>2.문제가 발생하던 시점은 sosreport 파일(2016년11월18일자) 을 올려드립니다.<br>3.리부팅후 sosreport파일 (2016년 11월 20일자)을 올려드립니다.<br>4.해당 시점시 dump 파일(vmcore) 파일은 고객사 케이스 오픈후  올려드리도록 하겠습니다.<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>해당 장비는 vmware 가상화 환경입니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 1596892</b><br><b>심각도  : 3 (Normal)</b><br><br><br><folderNumber>74173</folderNumber><br><comment id="a0aA000000IJ6SSIA1"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-11-28T01:11:38Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-11-28T01:11:38Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2016-11-28T01:11:38Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IIifZIAT"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-11-24T00:05:13Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-11-24T00:05:13Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin<br>Technical Support Engineer<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2016-11-24T00:05:13Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000II4CHIA1"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2016-11-21T06:43:02Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2016-11-21T06:43:02Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>18일에 아래 로그에서 보는 것 처럼 행이 발생하였습니다.<br>원인은 CenterCutTask-8 프로세스에 의하여 발생하였으며, seos 모듈이 관련되어 있는 것으로 확인됩니다.<br><br>Nov 18 11:43:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34063 blocked for more than 120 seconds.<br>Nov 18 11:43:17 sfqquoal01 kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>Nov 18 11:43:17 sfqquoal01 kernel: CenterCutTask-8 D ffff8800367c1b08     0 34063  57879 0x00000000<br>Nov 18 11:43:17 sfqquoal01 kernel: ffff880029b4fc10 0000000000000086 ffff88176952f300 ffff880029b4ffd8<br>Nov 18 11:43:17 sfqquoal01 kernel: ffff880029b4ffd8 ffff880029b4ffd8 ffff88176952f300 ffff8800367c1800<br>Nov 18 11:43:17 sfqquoal01 kernel: 0000000000000001 0000000000000001 0000000000000000 ffff8800367c1b08<br>Nov 18 11:43:17 sfqquoal01 kernel: Call Trace:<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff8163a909&gt;] schedule+0x29/0x70<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811e108e&gt;] __sb_start_write+0xde/0x110<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff810a6ae0&gt;] ? wake_up_atomic_t+0x30/0x30<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811febf4&gt;] mnt_want_write+0x24/0x50<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811ec33f&gt;] do_last+0xc1f/0x1270<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffffa05b8c0f&gt;] ? eAC_cfree+0x5f/0xf0 [seos]<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811ee672&gt;] path_openat+0xc2/0x490<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffffa05b8c00&gt;] ? eAC_cfree+0x50/0xf0 [seos]<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811efe3b&gt;] do_filp_open+0x4b/0xb0<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811fc9c7&gt;] ? __alloc_fd+0xa7/0x130<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811dd7e3&gt;] do_sys_open+0xf3/0x1f0<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffffa059fc22&gt;] ? SEOS_scs_stat_entry+0x42/0x80 [seos]<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff811dd8fe&gt;] SyS_open+0x1e/0x20<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffffa059c0aa&gt;] my_open+0x9a/0x1a0 [seos]<br>Nov 18 11:43:17 sfqquoal01 kernel: [&lt;ffffffff81645909&gt;] system_call_fastpath+0x16/0x1b<br><br>10 개의 로그가 출력되고 아래 파라메터값이 0으로 변경됨<br>- 기본 값이 10으로 설정되어있으며, 행 발생시 로그 출력후 1씩 감소하여 0까지 감소하게됨.<br>- 0이 되면 더 이상 행 메세지를 콘솔에 출력하지 않으며, 로그에 저장하지 않음.<br><br>sosreport-sfqquoal01-20161118171313/proc/sys/kernel/hung_task_warnings <br>0<br><br>$ grep blocked var/log/messages*<br>var/log/messages:Nov 18 11:43:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34063 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:43:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34230 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:43:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34320 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:45:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34063 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:45:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34230 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:45:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34320 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:47:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34063 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:47:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34230 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:47:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34320 blocked for more than 120 seconds.<br>var/log/messages:Nov 18 11:49:17 sfqquoal01 kernel: INFO: task CenterCutTask-8:34063 blocked for more than 120 seconds.<br><br>Nov 21 11:06:22 sfqquoal01 rsyslogd: [origin software=&quot;rsyslogd&quot; swVersion=&quot;7.4.7&quot; x-pid=&quot;1613&quot; x-info=&quot;http://www.rsyslog.com&quot;] start<br>--- RESTART ---<br>Nov 21 11:06:13 sfqquoal01 journal: Runtime journal is using 8.0M (max allowed 4.0G, trying to leave 4.0G free of 47.1G available → current limit 4.0G).<br>Nov 21 11:06:13 sfqquoal01 kernel: Initializing cgroup subsys cpuset<br>Nov 21 11:06:13 sfqquoal01 kernel: Initializing cgroup subsys cpu<br>Nov 21 11:06:13 sfqquoal01 kernel: Initializing cgroup subsys cpuacct<br>Nov 21 11:06:13 sfqquoal01 kernel: Linux version 3.10.0-327.el7.x86_64 (mockbuild@x86-034.build.eng.bos.redhat.com) (gcc version 4.8.3 20140911 (Red Hat 4.8.3-9) (GCC) ) #1 SMP Thu Oct 29 17:29:29 EDT 2015<br>Nov 21 11:06:13 sfqquoal01 kernel: Command line: BOOT_IMAGE=/vmlinuz-3.10.0-327.el7.x86_64 root=/dev/mapper/rhel-root ro rd.lvm.lv=rhel/root rdblacklist=vmw_vsock_vmci_transport,vsock,vmw_vmci vconsole.keymap=us vconsole.font=latarcyrheb-sun16 crashkernel=auto net.ifnames=0 LANG=en_US.UTF-8 nmi_watchdog=0 transparent_hugepage=never elevator=noop<br><br><br>[요청사항]<br><br>1.증상1 와 같은 상황에 발생하는 원인에 대해서 확인 부탁 드립니다.<br>  - seos 모듈에 의한 것으로 추정하고 있습니다. seos 사에 추가적인 분석을 해 볼 수 있습니다.<br><br>2.증상1 와 같은 상황 발생시 messages 에서 별다른 메세지가 발생하지 않늗데 차후 발생시 추적해 볼수 있는 방법과 조치 방법을 알려주시길 바랍니다.<br>  - /proc/sys/kernel/hung_task_warnings 값을 증가시키면 해당 값 만큼 행 발생시에 로그와 콘솔에 행 메시지를 출력합니다.<br><br>3.메모리 사용량이 제대로 표시되지 않는 이유는 증상1이 원인이 되는 지 확인 바랍니다.<br>  - ps 사용량에 따른 메모리 사용량<br>    50061.4 MB<br>$ cat free<br>              total        used        free      shared  buff/cache   available<br>Mem:       98823448    90977248     5208576     1455916     2637624     6106088<br>Swap:     100659196    64130344    36528852<br><br>  - vmware 시스템으로 확인되며, vmware 에서 제공하는 메모리 발루닝 기능에 의해서 해당 메모리가 다른 가상 머신에 사용될 가능성이 있습니다.<br>    해당 부분은 vmware 측에 확인이 필요합니다.<br><br>4.메모리 사용량이 제대로 확인이 되지 않을 경우 조치 방법을 확인 바랍니다.<br>  - 만일 메모리 발루닝 기능을 사용하지 않으려면, 호스트에 별도의 설정이 필요한 것으로 알고 있습니다. 이 부분 역시, vmware 측에 확인이 필요합니다.<br><br>vmcore 를 올려주시면 추가적으로 분석할 내용이 있는지 확인해보도록 하겠습니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2016-11-21T06:43:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000II3hnIAD"><br>======================<br><b>생성계정 : son, hyangjun</b><br><b>생성날짜 : 2016-11-21T05:26:24Z</b><br><b>마지막 답변자 : son, hyangjun</b><br><b>마지막 수정 일자 : 2016-11-21T05:26:24Z</b><br><br>sosreport -vvvv 실행시 hang 화면<br>======================<br>[root@sfqquoal01:/var/tmp]#cat sosreport_error.txt<br><br>[plugin:block] collected output of 'parted' in 0.0122480392456<br><br>[plugin:block] unpacked command tuple: ('fdisk -l /dev/dm-1', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'fdisk -l /dev/dm-1'<br><br>[plugin:block] collected output of 'fdisk' in 0.00476884841919<br><br>[plugin:block] unpacked command tuple: ('udevadm info -ap /sys/block/dm-2', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'udevadm info -ap /sys/block/dm-2'<br><br>[plugin:block] collected output of 'udevadm' in 0.00531005859375<br><br>[plugin:block] unpacked command tuple: ('parted -s /dev/dm-2 unit s print', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'parted -s /dev/dm-2 unit s print'<br><br>[plugin:block] collected output of 'parted' in 0.0075249671936<br><br>[plugin:block] unpacked command tuple: ('fdisk -l /dev/dm-2', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'fdisk -l /dev/dm-2'<br><br>[plugin:block] collected output of 'fdisk' in 0.00415802001953<br><br>[plugin:block] unpacked command tuple: ('udevadm info -ap /sys/block/dm-3', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'udevadm info -ap /sys/block/dm-3'<br><br>[plugin:block] collected output of 'udevadm' in 0.00518989562988<br><br>[plugin:block] unpacked command tuple: ('parted -s /dev/dm-3 unit s print', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'parted -s /dev/dm-3 unit s print'<br><br>[plugin:block] collected output of 'parted' in 0.00799584388733<br><br>[plugin:block] unpacked command tuple: ('fdisk -l /dev/dm-3', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'fdisk -l /dev/dm-3'<br><br>[plugin:block] collected output of 'fdisk' in 0.0041069984436<br><br>[plugin:block] unpacked command tuple: ('udevadm info -ap /sys/block/dm-4', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'udevadm info -ap /sys/block/dm-4'<br><br>[plugin:block] collected output of 'udevadm' in 0.0049741268158<br><br>[plugin:block] unpacked command tuple: ('parted -s /dev/dm-4 unit s print', 'None', 'None', 300, 'True', 'True', 'None')<br><br>[plugin:block] collecting output of 'parted -s /dev/dm-4 unit s print'<br><br><publishedDate>2016-11-21T05:26:24Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br>증상.1.DATAVG002-mig_lv 볼륨으로 마운트 된 /MIG 디렉토리에서 파일 쓰기가 안되는 현상 <br><br>시스템에서 hung_task 에러가 발생하여 sosreport 수집하던중 를 <br><br>(9/103)block 부분에서 더 이상 진행이 되지 않음 <br><br>다시 sosreport -vvvv 으로 실행한 결과 parted -s /dev/dm-4 (/MIG ) 에서 멈춰있음 <br><br>/MIG 디렉토리에서 사용자 및 root 가 파일 쓰기가 되지 않는 현상이 발생함 <br><br>강제로 umount 한 상태에서 xfs_repair /dev/mapper/datavg002-MIG_lv 상태에서 멈춰있음 <br><br>강제로 crash dump 를 일으킨 후 재부팅후 정상으로 동작함 <br><br>증상.2 .시스템 메모리 사용량이 top 에서 100% 사용되는 현상 <br><br>위의 1.과 같은 상황이 발생시 시스템 메모리가 100% 사용되는 상태가 표시되는데 실제 top에서는 <br> 전체 100G 메모리중 2G 이상을 사용하고 있는 프로세스가 없음 <br><br>리부팅 후 정상적으로 됨 <br><br>[요청사항]<br><br>1.증상1 와 같은 상황에 발생하는 원인에 대해서 확인 부탁 드립니다.<br>2.증상1 와 같은 상황 발생시 messages 에서 별다른 메세지가 발생하지 않늗데 차후 발생시 추적해 볼수 있는 방법과 조치 방법을 알려주시길 바랍니다.<br>3.메모리 사용량이 제대로 표시되지 않는 이유는 증상1이 원인이 되는 지 확인 바랍니다.<br>4.메모리 사용량이 제대로 확인이 되지 않을 경우 조치 방법을 확인 바랍니다.<br><br>[업로드 파일] <br><br>1.sosreport -vvvv 했을 때 화면을 보내드립니다.<br>2.문제가 발생하던 시점은 sosreport 파일(2016년11월18일자) 을 올려드립니다.<br>3.리부팅후 sosreport파일 (2016년 11월 20일자)을 올려드립니다.<br>4.해당 시점시 dump 파일(vmcore) 파일은 고객사 케이스 오픈후  올려드리도록 하겠습니다.</issue><environment>해당 장비는 vmware 가상화 환경입니다.</environment><cep>false</cep><folderName>ERP-ALL</folderName></case>