======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2017-09-14T08:06:49Z</b><br><b>마지막 답변자 : Jake Jaewook Shin</b><br><b>마지막 수정 일자 : 2017-10-11T05:45:59Z</b><br><b>id : 500A000000YPtHyIAL</b><br>======================<br><br><b><font size=15>
제목  : application 업무 계정에 대해서 limit 값 확인 내역 중 maxsignal 부분에 대해서 확인 요청을 드리려고 합니다.
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>아래는 pepadm이라는 업무 계정의 limit 값을 확인한 내역입니다.<br>항목 중에서  maxsignal    771663 값에 대한 문의를 드리려고 합니다.<br><br>제가 /etc/security/limits.conf 와 /etc/security/limits.d/하위 파일들에 대한 정보를 보내드렸습니다.<br><br>문의드리려고 하는 maxsignal 값은 sigpending - max number of pending signals 정보 같은데요.<br>해당 값이 따로 설정되어있지 않는데 771663 값이 나오는 이유에 대해서 문의드리려고 합니다.<br><br>추가로 해당 sigpending 값이 어떤 값을 의미하는지도 문의드리려고 합니다.<br><br>root@PEPSAL01SL /root # su - pepadm<br>Last login: Thu Sep 14 16:36:02 KST 2017<br>PEPSAL01SL:pepadm 51&gt; limit<br>cputime      unlimited<br>filesize     unlimited<br>datasize     unlimited<br>stacksize    8192 kbytes<br>coredumpsize unlimited<br>memoryuse    unlimited<br>vmemoryuse   unlimited<br>descriptors  32800<br>memorylocked 64 kbytes<br>maxproc      unlimited<br>maxlocks     unlimited<br>maxsignal    771663<br>maxmessage   819200<br>maxnice      0<br>maxrtprio    0<br>maxrttime    unlimited<br>PEPSAL01SL:pepadm 52&gt; bash<br>[pepadm@PEPSAL01SL ~]$ ulimit -a<br>core file size          (blocks, -c) unlimited<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 771663<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 32800<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 8192<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) unlimited<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br><br>root@PEPSAL02SL /etc/security/limits.d # ls<br>20-nproc.conf  99-sap-limits.conf  core.conf<br>root@PEPSAL02SL /etc/security/limits.d # cat 20-nproc.conf<br># Default limit for number of user's processes to prevent<br># accidental fork bombs.<br># See rhbz #432903 for reasoning.<br><br>#*          soft    nproc     4096<br>*          soft    nproc     10240<br>*          hard    nproc     10240<br>root       soft    nproc     unlimited<br>root@PEPSAL02SL /etc/security/limits.d # cat 99-sap-limits.conf<br># Added by sapconf on 2016-04-07 08:08:27 UTC<br>@sdba hard nofile 32800<br># Added by sapconf on 2016-04-07 08:08:27 UTC<br>@sdba soft nofile 32800<br><br>root@PEPSAL02SL /etc/security # cat limits.conf<br># /etc/security/limits.conf<br>#<br>#This file sets the resource limits for the users logged in via PAM.<br>#It does not affect resource limits of the system services.<br>#<br>#Also note that configuration files in /etc/security/limits.d directory,<br>#which are read in alphabetical order, override the settings in this<br>#file in case the domain is the same or more specific.<br>#That means for example that setting a limit for wildcard domain here<br>#can be overriden with a wildcard setting in a config file in the<br>#subdirectory, but a user specific setting here can be overriden only<br>#with a user specific setting in the subdirectory.<br>#<br>#Each line describes a limit for a user in the form:<br>#<br>#&lt;domain&gt;        &lt;type&gt;  &lt;item&gt;  &lt;value&gt;<br>#<br>#Where:<br>#&lt;domain&gt; can be:<br>#        - a user name<br>#        - a group name, with @group syntax<br>#        - the wildcard *, for default entry<br>#        - the wildcard %, can be also used with %group syntax,<br>#                 for maxlogin limit<br>#<br>#&lt;type&gt; can have the two values:<br>#        - &quot;soft&quot; for enforcing the soft limits<br>#        - &quot;hard&quot; for enforcing hard limits<br>#<br>#&lt;item&gt; can be one of the following:<br>#        - core - limits the core file size (KB)<br>#        - data - max data size (KB)<br>#        - fsize - maximum filesize (KB)<br>#        - memlock - max locked-in-memory address space (KB)<br>#        - nofile - max number of open file descriptors<br>#        - rss - max resident set size (KB)<br>#        - stack - max stack size (KB)<br>#        - cpu - max CPU time (MIN)<br>#        - nproc - max number of processes<br>#        - as - address space limit (KB)<br>#        - maxlogins - max number of logins for this user<br>#        - maxsyslogins - max number of logins on the system<br>#        - priority - the priority to run user process with<br>#        - locks - max number of file locks the user can hold<br>#        - sigpending - max number of pending signals<br>#        - msgqueue - max memory used by POSIX message queues (bytes)<br>#        - nice - max nice priority allowed to raise to values: [-20, 19]<br>#        - rtprio - max realtime priority<br>#<br>#&lt;domain&gt;      &lt;type&gt;  &lt;item&gt;         &lt;value&gt;<br>#<br><br>#*               soft    core            0<br>#*               hard    rss             10000<br>#@student        hard    nproc           20<br>#@faculty        soft    nproc           20<br>#@faculty        hard    nproc           50<br>#ftp             hard    nproc           0<br>#@student        -       maxlogins       4<br><br>### SAP ###<br>@sapsys                 hard    nofile    32800<br>@sapsys                 soft    nofile    32800<br>@dba                    hard    nofile    32800<br>@dba                    soft    nofile    32800<br>@sapsys                 soft    nproc     unlimited<br>@sapsys                 hard    nproc     unlimited<br><br>*               soft    nofile           10240<br>*               hard    nofile           10240<br><br># End of file<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>PEPSAL01SL</hostname><br><br><br><comment id="a0aA000000KYbF5IAL"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-25T04:56:33Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-25T04:56:32Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>현재 해당 케이스의 상황이 어떠신지 확인 부탁드립니다.<br>일정시간 업데이트가 없으실 경우, 해당 케이스는 close 처리 될 것입니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-25T04:56:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWuWHIA1"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-15T09:14:36Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-15T09:14:36Z</b><br><br>안녕하세요. 김지민 선임님<br><br>Red Hat Global Support Service를 이용해 주셔서 감사합니다.<br><br>&gt;/proc/sys/kernel/threads-max 값의 default는 서버의 memory에 따라서 그럼 OS 내부적으로 계산이 되어지는 값인가요?<br>&gt;(혹시 memory에 따라 계산되어지는 방식 같은 것이 있는지 문의드리려고 합니다.)<br><br>예, 커널내부에서 계산되어지는 값입니다.<br>max_threads 과 관련해서 다음 한글 메뉴얼을 참고하시면 도움이 되실 것 같습니다.<br><br>https://access.redhat.com/documentation/ko-KR/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/s-memory-captun.html<br><br>또는 커널 소스를 보셔도 다음과 같이 나와 있습니다.<br><br>Kernel Source: kernel/fork.c<br>....<br>         max_threads = mempages / (8 * THREAD_SIZE / PAGE_SIZE);<br><br>업무에 도움이 되시기 바랍니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-15T09:14:36Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWu0wIAD"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-09-15T08:33:40Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-09-15T08:33:40Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>추가적으로 문의드릴점은 <br><br>/proc/sys/kernel/threads-max 값의 default는 서버의 memory에 따라서 그럼 OS 내부적으로 계산이 되어지는 값인가요?<br>(혹시 memory에 따라 계산되어지는 방식 같은 것이 있는지 문의드리려고 합니다.)<br><br>감사합니다.<br><br><publishedDate>2017-09-15T08:33:40Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KWtdxIAD"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-15T07:58:16Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-15T07:58:16Z</b><br><br>안녕하세요.<br><br>Red Hat Global Support Service를 이용해 주셔서 감사합니다.<br><br>피드백 주셔서 정말 감사드립니다.<br>이상으로 본 케이스는 close 처리하도록 하겠습니다.<br><br>케이스가 처리 완료되면 고객 설문조사 메일이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-15T07:58:16Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWtRyIAL"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-09-15T07:40:10Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-09-15T07:40:10Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>답변 감사드립니다.<br><br><publishedDate>2017-09-15T07:40:10Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KWqSTIA1"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-15T02:09:28Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-15T02:09:27Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>추가로 sigpending 에 대해서 man 페이지가 존재합니다.<br># man sigpending<br><br>즉, 시그널 핸들러가 큐잉(펜딩,대기,etc) 가능한 시그널 수입니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-15T02:09:27Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWqNdIAL"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-15T01:57:03Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-15T01:57:03Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>디폴트로는 nproc 과 sigpending 이 동일한 값을 가질 텐데요,<br>max user process 관련해서 다음과 같이 커스터마이징하신 값들이 프로세스에 반영된 것으로 보입니다.<br><br>예)<br>~~~<br>@sapsys                 soft    nproc     unlimited<br>@sapsys                 hard    nproc     unlimited<br><br>*          soft    nproc     10240<br>*          hard    nproc     10240<br>root       soft    nproc     unlimited<br>~~~<br><br>특별히 조정하지 않는다면 sigpending 의 디폴트 값은 /proc/sys/kernel/threads-max 값의 절반으로 보시면 될 것 같습니다.<br><br>예)<br>~~~<br>[root@localhost ~]# cat /etc/redhat-release <br>Red Hat Enterprise Linux Server release 7.2 (Maipo)<br>[root@localhost ~]# <br>[root@localhost ~]# cat /proc/sys/kernel/threads-max<br>14476<br>[root@localhost ~]# <br>[root@localhost ~]# ulimit -a<br>core file size          (blocks, -c) 0<br>data seg size           (kbytes, -d) unlimited<br>scheduling priority             (-e) 0<br>file size               (blocks, -f) unlimited<br>pending signals                 (-i) 7238<br>max locked memory       (kbytes, -l) 64<br>max memory size         (kbytes, -m) unlimited<br>open files                      (-n) 1024<br>pipe size            (512 bytes, -p) 8<br>POSIX message queues     (bytes, -q) 819200<br>real-time priority              (-r) 0<br>stack size              (kbytes, -s) 8192<br>cpu time               (seconds, -t) unlimited<br>max user processes              (-u) 7238<br>virtual memory          (kbytes, -v) unlimited<br>file locks                      (-x) unlimited<br>~~~<br><br>감사합니다.<br><br><publishedDate>2017-09-15T01:57:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWgg0IAD"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-09-14T13:17:54Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-09-14T13:17:54Z</b><br><br>안녕하세요<br><br>dropbox.redhat.com 의 incoming 경로에 sosreport 정보를 업로드하였습니다.<br><br>sosreport-PEPSAL01SL-20170914211255.tar.xz_170914<br><br>해당 서버의 /proc/sys/kernel/threads-max 값도 첨부합니다.<br><br>root@PEPSAL01SL /root # cat /proc/sys/kernel/threads-max<br>1543326<br><br>반으로 계산하면 문의드렸던 ulimit 결과에서 pending signals(max signal) 값과 동일하게 계산되는 것 같습니다.<br><br>max user processes와 pending signals 값간의 관계를 확인하기위해서 <br><br>How can I find out the ulimit values for a running process? <br>- https://access.redhat.com/solutions/37453<br>에서 확인한 후 application 프로세스 1개를 확인한 내역은 아래와 같습니다.<br><br>max user processes 와 pending signals 의 hard limit 값이 동일하지는 않은 것 처럼보입니다.<br><br>root@PEPSAL01SL /proc/305 # cat limits<br>Limit                     Soft Limit           Hard Limit           Units<br>Max cpu time              unlimited            unlimited            seconds<br>Max file size             unlimited            unlimited            bytes<br>Max data size             unlimited            unlimited            bytes<br>Max stack size            8388608              unlimited            bytes<br>Max core file size        unlimited            unlimited            bytes<br>Max resident set          unlimited            unlimited            bytes<br>Max processes             unlimited            unlimited            processes<br>Max open files            32800                32800                files<br>Max locked memory         65536                65536                bytes<br>Max address space         unlimited            unlimited            bytes<br>Max file locks            unlimited            unlimited            locks<br>Max pending signals       771663               771663               signals<br>Max msgqueue size         819200               819200               bytes<br>Max nice priority         0                    0<br>Max realtime priority     0                    0<br>Max realtime timeout      unlimited            unlimited            us<br><br><publishedDate>2017-09-14T13:17:54Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KWdNbIAL"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-14T09:12:34Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-14T09:12:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>pending signals 의 경우 max user processes 의 값에 의존하는 것으로 보고되어 있으며<br>max user processes 값은 기본적으로 /proc/sys/kernel/threads-max 의 반으로 계산 되는 것으로 보고되어 있습니다.<br><br>구체적인 확인을 위해 sosreport 수집 후 업데이트 가능할지요?<br><br>다음은 참조를 위한 KCS 입니다만,<br>max user processes 와 pending signals 의 hard limit 값이 동일한 것이 확인 가능하실 것입니다.<br><br>How can I find out the ulimit values for a running process? <br>- https://access.redhat.com/solutions/37453<br><br>감사합니다.<br><br><publishedDate>2017-09-14T09:12:34Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KWcjuIAD"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2017-09-14T08:29:44Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2017-09-14T08:29:44Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>저는 신재욱 차장이라고 하며 앞으로 해당 케이스를 담당하게 되었습니다.<br><br>현재 케이스 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-09-14T08:29:44Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>