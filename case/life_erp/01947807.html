======================<br><b>생성계정 : 우택 심</b><br><b>생성날짜 : 2017-10-08T01:14:24Z</b><br><b>마지막 답변자 : 우택 심</b><br><b>마지막 수정 일자 : 2017-10-09T06:06:54Z</b><br><b>id : 500A000000YSWl1IAH</b><br>======================<br><br><b><font size=15>
제목  : rear backup 시 VX 볼륨 (Veritas Filesystem) 지원 여부 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요. 현재 프로젝트 운영 시스템 중 VX Filesystem (Veritas Cluster File system) 을 사용하는 노드가 있습니다.<br><br>다른  xfs, ext4 등의 파일 시스템 운영 노드는 모두 rear backup 이 정상적으로 진행되었으나,<br><br>유독 VX 파일 시스템을 포함한 2개의 노드에 대해서는 아래와 같이 rear backup 실패가 되었습니다.<br><br>정확한 원인과 구성방법을 문의 드립니다.<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>먼저, 백업을 수행한 시간대 에러로그는 아래와 같습니다.<br><br>[PNLSDL01SL]<br>tar: dev/dmpconfig: Cannot mknod: Invalid argument<br>tar: dev/vx/dmpconfig: Cannot mknod: Invalid argument<br>tar: Removing leading `/' from hard link targets<br>tar: Exiting with failure status due to previous errors<br>2017-10-07 19:51:11.573211102 ERROR: Could not copy files and directories<br><br>[PNLSDL02SL]<br>tar: dev/dmpconfig: Cannot mknod: Invalid argument<br>tar: dev/vx/dmpconfig: Cannot mknod: Invalid argument<br>tar: Removing leading `/' from hard link targets<br>tar: Exiting with failure status due to previous errors<br>2017-10-07 19:51:26.720444325 ERROR: Could not copy files and directories<br><br>/var/log/messages<br>Oct 07 19:51:11 PNLSDL01SL root[61563]: ReaR regular OS backup failed.(143) [SCSI]<br>Oct 07 19:51:26 PNLSDL02SL root[49586]: ReaR regular OS backup failed.(143) [SCSI]<br><br>시스템의 파일시스템은 아래와 같습니다.<br><br>root@PNLSDL01SL /root # df -Ph<br>Filesystem                     Size  Used Avail Use% Mounted on<br>/dev/sda2                       30G   11G   20G  37% /<br>devtmpfs                       252G     0  252G   0% /dev<br>tmpfs                          252G     0  252G   0% /dev/shm<br>tmpfs                          252G  1.2G  251G   1% /run<br>tmpfs                          252G     0  252G   0% /sys/fs/cgroup<br>/dev/sda1                     1014M  324M  691M  32% /boot<br>/dev/sda3                       20G  7.3G   13G  37% /var<br>/dev/mapper/vg0-sysadmin        20G   12G  8.2G  60% /sysadmin<br>/dev/mapper/vg0-home            10G   99M  9.9G   1% /home<br>/dev/mapper/vg9-CRASH          427G   33M  427G   1% /CRASH<br>tmpfs                          4.0K     0  4.0K   0% /dev/vx<br>/dev/vx/dsk/FSDG/usr_sap_PNLS   50G  3.8G   44G   8% /usr/sap/PNLS<br>/dev/vx/dsk/FSDG/DATA          150G   12G  130G   9% /DATA<br>tmpfs                           51G     0   51G   0% /run/user/30052<br>tmpfs                           51G     0   51G   0% /run/user/30274<br><br>언제 문제가 발생했습니까? 이러한 문제가 자주 발생합니까? 반복적으로 발생합니까? 특정 시간에 발생합니까?<br><br>ReaR Backup 의 local.conf 는 아래와 같이 설정 하였습니다.<br><br>root@PNLSDL01SL /root # cat /etc/rear/regular/local.conf<br># Default is to create Relax-and-Recover rescue media as ISO image<br># set OUTPUT to change that<br># set BACKUP to activate an automated (backup and) restore of your data<br># Possible configuration values can be found in /usr/share/rear/conf/default.conf<br>#<br># This file (local.conf) is intended for manual configuration. For configuration<br># through packages and other automated means we recommend creating a new<br># file named site.conf next to this file and to leave the local.conf as it is.<br># Our packages will never ship with a site.conf.<br>OUTPUT=ISO<br>OUTPUT_URL=nfs://172.18.12.195/os_backup/rear/regular/<br>BACKUP=NETFS<br>NETFS_KEEP_OLD_BACKUP_COPY=y<br>BACKUP_PROG_ARCHIVE=&quot;$(hostname)&quot;<br>BACKUP_URL=nfs://172.18.12.195/os_backup/rear/regular/<br>EXCLUDE_RECREATE=(&quot;${EXCLUDE_RECREATE[@]}&quot; &quot;fs:/CRASH&quot; &quot;fs:/usr/sap/PNLS&quot; &quot;fs:/DATA&quot;)<br>EXCLUDE_MOUNTPOINTS=('/CRASH' '/usr/sap/PNLS' '/DATA')<br>KERNEL_CMDLINE=&quot;biosdevname=1&quot;<br>BACKUP_PROG_EXCLUDE=(&quot;${BACKUP_PROG_EXCLUDE[@]}&quot; '/dev' '/run' '/sys/fs/cgroup' '/sysadmin' '/CRASH' '/dev/vx' '/usr/sap/PNLS' '/DATA' '/run/user/30052' '/run/user/0')<br><br>여기서 VX 관련된 파일시스템 볼륨은 모두 exclude 를 했는데도 불구하고,<br><br>백업 수행 시 dmpconfig 등을 인식하여 실패가 된 것으로 추정하고 있습니다.<br><br>해결 기간이나 업무에 미치는 영향에 대한 정보를 제공해 주시겠습니까?<br><br>추가로 분석에 필요한 데이터가 있으면 답글 부탁드립니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Defect / Bug</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 4 (Low)</b><br><hostname>PNLSDL01SL, PNLSDL02SL</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000KfWe3IAF"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2017-10-08T12:14:07Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2017-10-08T12:14:07Z</b><br><br>안녕하세요?<br><br>Senior Technical Account Manager 허경입니다.<br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>rear의 기본설정은 아래 파일을 기본으로 동작합니다.<br>/usr/share/rear/conf/default.conf<br>local.conf에 설정을 조정할 경우 이 기본 설정 파일을 참고하시면 도움이 됩니다.<br>이 기본 설정 파일에는 약간의 설명이 주석으로 들어 있습니다. <br>전반적으로 내용을 확인하셔서 현재 운영하는 환경과 관련된 사항이 있는 경우 적절한 테스트를 거쳐서 보완하시면 좋습니다.<br><br>또한, 예제로 제공하는 설정 파일들도 참고하시기 바랍니다.<br>/usr/share/rear/conf/examples 디렉토리에 몇가지 예제 설정을 제공하고 있습니다.<br><br>참고로, incremental, differential 백업시 백업 데이터를 삭제하는 설정이 별도로 없습니다. <br>백업 공간이 충분한지 확인하시고 부족해지는 경우 오래된 백업을 수동으로 삭제해야 합니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2017-10-08T12:14:07Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KfVzaIAF"><br>======================<br><b>생성계정 : 심, 우택</b><br><b>생성날짜 : 2017-10-08T04:55:01Z</b><br><b>마지막 답변자 : 심, 우택</b><br><b>마지막 수정 일자 : 2017-10-08T04:55:01Z</b><br><br>안녕하세요.<br><br>해당 문제에 대해 아래와 같이 local.conf 에 수정을 하여 dmpconfig 가 exclude 되어 정상적으로 백업이 되는 것을 확인 했는데요,<br><br>BACKUP_PROG_EXCLUDE=(&quot;${BACKUP_PROG_EXCLUDE[@]}&quot; '/dev' '/run' '/sys/fs/cgroup' '/sysadmin' '/CRASH' '/usr/sap/PNLS' '/DATA' '/run/user/30052' '/run/user/0')<br><br>COPY_AS_IS_EXCLUDE=(&quot;${COPY_AS_IS_EXCLUDE[@]}&quot; '/dev/dmpconfig' '/dev/vx/dmpconfig') &lt;-- 추가된 항목<br><br>위와 같은 옵션 외에 추가적으로 고려해야 할 사항이 있는지 확인 부탁 드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-10-08T04:55:01Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br>다른  xfs, ext4 등의 파일 시스템 운영 노드는 모두 rear backup 이 정상적으로 진행되었으나,<br><br>유독 VX 파일 시스템을 포함한 2개의 노드에 대해서는 아래와 같이 rear backup 실패가 되었습니다.<br><br>정확한 원인과 구성방법을 문의 드립니다.</issue><environment>먼저, 백업을 수행한 시간대 에러로그는 아래와 같습니다.<br><br>[PNLSDL01SL]<br>tar: dev/dmpconfig: Cannot mknod: Invalid argument<br>tar: dev/vx/dmpconfig: Cannot mknod: Invalid argument<br>tar: Removing leading `/' from hard link targets<br>tar: Exiting with failure status due to previous errors<br>2017-10-07 19:51:11.573211102 ERROR: Could not copy files and directories<br><br>[PNLSDL02SL]<br>tar: dev/dmpconfig: Cannot mknod: Invalid argument<br>tar: dev/vx/dmpconfig: Cannot mknod: Invalid argument<br>tar: Removing leading `/' from hard link targets<br>tar: Exiting with failure status due to previous errors<br>2017-10-07 19:51:26.720444325 ERROR: Could not copy files and directories<br><br>/var/log/messages<br>Oct 07 19:51:11 PNLSDL01SL root[61563]: ReaR regular OS backup failed.(143) [SCSI]<br>Oct 07 19:51:26 PNLSDL02SL root[49586]: ReaR regular OS backup failed.(143) [SCSI]<br><br>시스템의 파일시스템은 아래와 같습니다.<br><br>root@PNLSDL01SL /root # df -Ph<br>Filesystem                     Size  Used Avail Use% Mounted on<br>/dev/sda2                       30G   11G   20G  37% /<br>devtmpfs                       252G     0  252G   0% /dev<br>tmpfs                          252G     0  252G   0% /dev/shm<br>tmpfs                          252G  1.2G  251G   1% /run<br>tmpfs                          252G     0  252G   0% /sys/fs/cgroup<br>/dev/sda1                     1014M  324M  691M  32% /boot<br>/dev/sda3                       20G  7.3G   13G  37% /var<br>/dev/mapper/vg0-sysadmin        20G   12G  8.2G  60% /sysadmin<br>/dev/mapper/vg0-home            10G   99M  9.9G   1% /home<br>/dev/mapper/vg9-CRASH          427G   33M  427G   1% /CRASH<br>tmpfs                          4.0K     0  4.0K   0% /dev/vx<br>/dev/vx/dsk/FSDG/usr_sap_PNLS   50G  3.8G   44G   8% /usr/sap/PNLS<br>/dev/vx/dsk/FSDG/DATA          150G   12G  130G   9% /DATA<br>tmpfs                           51G     0   51G   0% /run/user/30052<br>tmpfs                           51G     0   51G   0% /run/user/30274</environment><periodicityOfIssue>ReaR Backup 의 local.conf 는 아래와 같이 설정 하였습니다.<br><br>root@PNLSDL01SL /root # cat /etc/rear/regular/local.conf<br># Default is to create Relax-and-Recover rescue media as ISO image<br># set OUTPUT to change that<br># set BACKUP to activate an automated (backup and) restore of your data<br># Possible configuration values can be found in /usr/share/rear/conf/default.conf<br>#<br># This file (local.conf) is intended for manual configuration. For configuration<br># through packages and other automated means we recommend creating a new<br># file named site.conf next to this file and to leave the local.conf as it is.<br># Our packages will never ship with a site.conf.<br>OUTPUT=ISO<br>OUTPUT_URL=nfs://172.18.12.195/os_backup/rear/regular/<br>BACKUP=NETFS<br>NETFS_KEEP_OLD_BACKUP_COPY=y<br>BACKUP_PROG_ARCHIVE=&quot;$(hostname)&quot;<br>BACKUP_URL=nfs://172.18.12.195/os_backup/rear/regular/<br>EXCLUDE_RECREATE=(&quot;${EXCLUDE_RECREATE[@]}&quot; &quot;fs:/CRASH&quot; &quot;fs:/usr/sap/PNLS&quot; &quot;fs:/DATA&quot;)<br>EXCLUDE_MOUNTPOINTS=('/CRASH' '/usr/sap/PNLS' '/DATA')<br>KERNEL_CMDLINE=&quot;biosdevname=1&quot;<br>BACKUP_PROG_EXCLUDE=(&quot;${BACKUP_PROG_EXCLUDE[@]}&quot; '/dev' '/run' '/sys/fs/cgroup' '/sysadmin' '/CRASH' '/dev/vx' '/usr/sap/PNLS' '/DATA' '/run/user/30052' '/run/user/0')<br><br>여기서 VX 관련된 파일시스템 볼륨은 모두 exclude 를 했는데도 불구하고,<br><br>백업 수행 시 dmpconfig 등을 인식하여 실패가 된 것으로 추정하고 있습니다.</periodicityOfIssue><timeFramesAndUrgency>추가로 분석에 필요한 데이터가 있으면 답글 부탁드립니다.<br><br>감사합니다.</timeFramesAndUrgency><cep>false</cep></case>