======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2017-11-06T11:58:15Z</b><br><b>마지막 답변자 : Xingbin Li</b><br><b>마지막 수정 일자 : 2017-11-24T02:12:54Z</b><br><b>id : 500A000000Z1nZEIAZ</b><br>======================<br><br><b><font size=15>
제목  : application core dump 설정과 kernel parameter 반영 관련 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>삼성생명 보험 ERP SAP EP 서버들에 대해서 application core dump 설정을 하려고 합니다.<br><br>현재 설정은 application core 설정에 대해서 아래와 같이 되어있는 상태입니다.<br><br>root@PEPSAL01SL /root # cat /etc/sysctl.conf | grep -i core<br>net.core.somaxconn = 8192<br>kernel.core_pattern = /var/crash/core_%e_%p_%h_%u_%t<br>net.core.netdev_max_backlog = 8192<br>root@PEPSAL01SL /root # cat /proc/sys/kernel/core_pattern<br>/var/crash/core_%e_%p_%h_%u_%t<br><br>변경하려고 하는 설정은 아래의 절차와 같습니다.<br>여기서 문의드릴 점은 1/2/3/4의 설정 후 os의 reboot이 필요한지 문의드리려고 합니다.<br><br>sysctl.conf의 kernel.core_pattern 부분에 변화가 일어나면 sysctl -p 가 아닌 reboot이 필요한지 문의드리려고 합니다.<br>아니면 나머지 2/3/4의 설정 중에서 reboot이 필요한 절차가 있는지 문의드리려고 합니다.<br><br>1) /etc/sysctl.conf ← application core 위치를 var를 사용하지 않기 위해서 주석 처리<br>#kernel.core_pattern = /var/crash/core_%e_%p_%h_%u_%t<br><br>2) /etc/systemd/system.conf<br>DefaultLimitCORE=infinity<br><br>3) /usr/lib/systemd/system/httpd.service<br>[Service]<br>LimitCORE = infinity<br><br>4) /APP/ep/apache/conf/httpd.conf<br>CoreDumpDirectory /LOG/ep/apache<br><br>5) 위 설정 후 reboot<br><br>root@TEPSAL01SL /APP/ep/apache/conf # grep Core ./httpd.conf<br>CoreDumpDirectory /LOG/ep/apache<br><br>6) core_pattern 확인<br>$ cat /proc/sys/kernel/core_pattern<br>core<br><br>7) core_pattern 변경<br>$ echo &quot;core._%e_%p_%h_%u_%t&quot; &gt; /proc/sys/kernel/core_pattern<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>PEPSAL01SL</hostname><br><br><br><comment id="a0aA000000L4VblIAF"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-24T02:12:51Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-24T02:12:51Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service입니다.<br><br>마지막 안내후 일정기간동안 답변이 없으셔서 본 케이스를 close 처리 하려고 합니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.  <br>  <br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발생됩니다. <br>고객님께서 남기 신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다. <br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.  <br>  <br>감사합니다.<br><br><publishedDate>2017-11-24T02:12:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000L3C2oIAF"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-17T06:35:54Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-17T06:35:53Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 추가적으로 문의하실 사항이 있으신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-17T06:35:53Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Kxn2kIAB"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-13T02:09:49Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-13T02:09:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의주신 내용에 아래와 같이 답변드리겠습니다.<br><br>Q1. soft limit은 0이지만 hard limit이 unlimited일 경우 unlimited/unlimited와 차이점이 무엇인지 문의드리려고 합니다.<br>A1. Max core file size 의 soft limit 값이 0이면 해당 프로세스는 코어파일을 생성하지 않음을 의미하고 unlimited 는 코어파일이<br>    생성가능함을 의미합니다. soft limit은 hard limit을 기준으로 변경이 가능하고 하드리미트값을 초과못합니다. 따라서 프로세스의 <br>    실제 limit 값은 soft limit 값을 기준으로 하며 hard limit는 soft limit의 한계라고 보실수 있습니다.<br><br>Q2. 서버가 reboot이 되면 설정이 없어지는 건지 해서 문의드립니다.<br>A2. 네 재부팅 하면 해당 설정이 없어지게 됩니다. <br>    재부팅후에도 해당 값으로 적용되게 하시려면 /etc/sysctl.conf 파일에 <br>    해당 파라메터와 그 값을 기입하시고 &quot;sysctl -p&quot; 명령어로 적용하셔야 합니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-13T02:09:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxkJyIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-12T01:50:31Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-12T01:50:30Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다. <br><br>추가로 혹시  /etc/sysctl.conf 부분에 아래와 같이 kernel.core_pattern을 주석처리하고 <br>#kernel.core_pattern = /CRASH/core_%e_%p_%h_%u_%t<br>다시 반영을 하였는데요.<br>echo &quot;core._%e_%p_%h_%u_%t&quot; &gt; /proc/sys/kernel/core_pattern<br><br>서버가 reboot이 되면 설정이 없어지는 건지 해서 문의드립니다.<br><br><publishedDate>2017-11-12T01:50:30Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KxiSwIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-11T08:51:24Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-11T08:51:24Z</b><br><br>안녕하세요 <br><br>죄송합니다. 이 건 관련해서 한가지 더 문의드리면<br><br>아래와 같이 해당 설정 값을 확인해보면 Max core file size부분이 soft limit은 0이지만 hard limit이 unlimited일 경우 unlimited/unlimited와 차이점이 무엇인지 문의드리려고 합니다.<br><br>root@PIWBWL01SL /proc/10154 # cat limits<br>Limit                     Soft Limit           Hard Limit           Units<br>Max cpu time              unlimited            unlimited            seconds<br>Max file size             unlimited            unlimited            bytes<br>Max data size             unlimited            unlimited            bytes<br>Max stack size            8388608              unlimited            bytes<br>Max core file size        0                    unlimited            bytes<br>Max resident set          unlimited            unlimited            bytes<br>Max processes             255569               255569               processes<br>Max open files            4096                 4096                 files<br>Max locked memory         65536                65536                bytes<br>Max address space         unlimited            unlimited            bytes<br>Max file locks            unlimited            unlimited            locks<br>Max pending signals       255569               255569               signals<br>Max msgqueue size         819200               819200               bytes<br>Max nice priority         0                    0<br>Max realtime priority     0                    0<br>Max realtime timeout      unlimited            unlimited            us<br><br><publishedDate>2017-11-11T08:51:24Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KxiP4IAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-11T08:27:04Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-11T08:27:03Z</b><br><br>안녕하세요<br><br>답변 감사드립니다.<br><br>추가로 문의할 내역은 없습니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-11T08:27:03Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Kwvx8IAB"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-08T08:31:28Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-08T08:31:28Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>본 케이스에 관련하여 추가로 문의하실 사항이 있으신지요?<br><br>감사합니다.<br><br><publishedDate>2017-11-08T08:31:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KwvTBIAZ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-08T07:45:31Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-08T07:45:31Z</b><br><br>네 답변 감사합니다.<br><br><publishedDate>2017-11-08T07:45:31Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KwuV6IAJ"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-08T06:06:11Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-08T06:06:11Z</b><br><br>안녕하세요, 김지민 선임님<br><br>Red Hat Global Suppot Services를 이용해주셔서 감사합니다.<br><br>문의주신 내용에 아래와 같이 답변드리겠습니다.<br><br>Q1.만약에 OS에서 DefaultLimitCORE=infinity 설정이 되어있다면 어떤 식으로 확인이 가능한지 문의드리려고 합니다.<br><br>A1.재부팅후 애플리케이션 프로세스의 pid를 확인후 <br>   /proc/&lt;pid&gt;/limits 에서 &quot;Max core file size&quot; 가 unlimited unlimited 로 확인이 된다면 <br>   설정이 적용된 것으로 볼수 있으십니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-08T06:06:11Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KwuROIAZ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-08T05:58:21Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-08T05:58:21Z</b><br><br>안녕하세요<br><br>김지민 선임입니다.<br><br>추가로 한가지 문의드릴 점은 <br>만약에 OS에서 DefaultLimitCORE=infinity 설정이 되어있다면 어떤 식으로 확인이 가능한지 문의드리려고 합니다.<br><br>sysctl -a의 결과에서는 안나오는 것 처럼 보여서 혹시 설정이 되어있는 부분을 확인할 수 있는 방법을 문의드리려고 합니다.<br><br><publishedDate>2017-11-08T05:58:21Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KwuHdIAJ"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-08T05:37:16Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-08T05:37:15Z</b><br><br>안녕하세요, 김지민 선임님<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>혹시 추가 문의 사항이 있으신지요?<br>추가 사항이 없으시다면 본 케이스는 close 처리 해드려도 되겠는지요?<br><br>감사합니다.<br><br><publishedDate>2017-11-08T05:37:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KwuG1IAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-08T05:33:54Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-08T05:33:54Z</b><br><br>안녕하세요<br><br>김지민 선임입니다. <br><br>상세한 답변 감사드립니다.<br><br>답변 감사드립니다.<br><br><publishedDate>2017-11-08T05:33:54Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KwsoIIAR"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-08T02:03:30Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-08T02:03:29Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의 주신내요에 아래와 같이 답변드리겠습니다.<br><br>Q1.DefaultLimitCORE=infinity 설정이면 CORE 생성에 있어서 제한없이 없어지는 것 같은데 혹시 용량인지 개수인지 문의드리려고 합니다<br>A1.용량에 제한이 없어지는 것을 가리킵니다.<br><br>Q2.아래처럼 기본 설정은 # 처리가 되어있는 것 처럼보여서 혹시 그럼 default는 어떤 설정을 가지게 되는지도 문의드립니다.<br>A2.Default는 0 으로 프로세스의 core dump가 생성되지 않습니다.<br><br>Q3.1) 설정 부분과 2) 설정 부분이 비슷해보이는데 차이점이 있는지도 문의드립니다.<br>A3.<br>~~~~~~~~<br>/etc/systemd/system.conf<br>DefaultLimitCORE=infinity<br><br>system.conf 파일에 위와 같이 설정하고 재부팅하면 모든 프로세스가 core dump 파일을 생성할수 있고 덤프 파일의 용량에 제한이 없게 됩니다.<br><br>/usr/lib/systemd/system/httpd.service<br>[Service]<br>LimitCORE = infinity<br><br>httpd.service 파일에 위와 같이 설정하시면 httpd 서비스가 coredump 파일을 생성할수 있게 됩니다.<br>만약 system.conf에 infinity를 이미 설정하셨다면 httpd.service 에 추가로 설정하실 필요가 없습니다.<br>만약 httpd 서비스만 coredump를 생성하게 하시려면 system.conf의 부분을 주석처리하시고 httpd.service파일에만 <br>설정하실 필요가 있습니다.<br>~~~~~~~<br><br>감사합니다.<br><br><publishedDate>2017-11-08T02:03:29Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KwfYuIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-07T11:56:52Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-07T11:56:52Z</b><br><br>안녕하세요 <br><br>추가로 문의드릴 점은<br>1) 설정 부분과 2) 설정 부분이 비슷해보이는데 차이점이 있는지도 문의드립니다.<br><br>1)<br>/etc/systemd/system.conf<br>DefaultLimitCORE=infinity<br>2)<br>/usr/lib/systemd/system/httpd.service<br>[Service]<br>LimitCORE = infinity<br><br><publishedDate>2017-11-07T11:56:52Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KweFsIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-11-07T10:08:52Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-11-07T10:08:52Z</b><br><br>안녕하세요.<br><br>답변 감사드립니다.<br><br>재부팅이 필요한 DefaultLimitCORE 값은 혹시 어떤 의미를 가지는지 문의드리려고 합니다.<br>DefaultLimitCORE=infinity 설정이면 CORE 생성에 있어서 제한없이 없어지는 것 같은데 혹시 용량인지 개수인지 문의드리려고 합니다.<br><br>아래처럼 기본 설정은 # 처리가 되어있는 것 처럼보여서 혹시 그럼 default는 어떤 설정을 가지게 되는지도 문의드립니다.<br><br>root@PIWBWL01SL /root # cat /etc/systemd/system.conf | grep DefaultLimitCORE<br>#DefaultLimitCORE=<br><br><publishedDate>2017-11-07T10:08:52Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KwZiLIAV"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-07T02:20:51Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-07T02:20:51Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>가이드 문서를 참조해보면 아래의 절차후 시스템 재부팅이 필요하다고 나와있습니다.<br><br>2) /etc/systemd/system.conf<br>DefaultLimitCORE=infinity<br><br>하지만 5) 번에서 재부팅하시기 때문에 앞의 1/2/3/4 에서 재부팅할 필요는 없습니다.<br><br>[참고문서]<br>    How to enable core file dumps when an application crashes or segmentation faults<br>    -https://access.redhat.com/solutions/4896<br><br><br>감사합니다.<br><br><publishedDate>2017-11-07T02:20:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KwZH5IAN"><br>======================<br><b>생성계정 : Li, Xingbin</b><br><b>생성날짜 : 2017-11-07T01:33:48Z</b><br><b>마지막 답변자 : Li, Xingbin</b><br><b>마지막 수정 일자 : 2017-11-07T01:33:48Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>현재 관련내용을 살펴보고 있는 중이며 답변이 정리하는 대로<br>코멘트 남겨드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-07T01:33:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>