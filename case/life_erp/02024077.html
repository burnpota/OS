======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2018-01-31T02:41:54Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-03-30T10:01:26Z</b><br><b>id : 500A000000ZfhUCIAZ</b><br>======================<br><br><b><font size=15>
제목  : qla2xxx queue_depth 확인
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 상암센터 김지민 선임입니다.<br><br>Redhat 6.4 서버에서 HBA port의 queue depth 설정 확인 관련해서 문의드리려고 합니다.<br><br>아래 링크를 참고하여서 확인하였는데<br><br>https://access.redhat.com/solutions/23366<br><br>아래와 같이 설정이 되어있으면 queue depth가 32로 확인하면 되는 것인지 문의드립니다.<br>root@FLPTRSD02 /root # modinfo qla2xxx | grep ql2xmaxqdepth<br>parm:           ql2xmaxqdepth:Maximum queue depth to set for each LUN. Default is 32. (int)<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>FLPTRSD02</hostname><br><br><br><comment id="a0aA000000Kt5laIAB"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-03-14T01:11:51Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-03-14T01:11:51Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>진행하시고 결과 알려주시면 고맙겠습니다.<br><br>허 경 드림.<br><br>(In reply to kim, jimin)<br>&gt; 안녕하세요<br>&gt; <br>&gt; 추가로 확인해 주신 내역 반영해서 아래와 같이 진행을 하겠습니다.<br>&gt; <br>&gt; 감사합니다.<br>&gt; <br>&gt; 0 . 작업 전 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인 및 작업 전 외장 파일시스템 umount<br>&gt; <br>&gt;  1. scsi_hostadapter.conf 파일 생성 (ql2xmaxqdepth 8로 변경하는 경우)<br>&gt; root@FLPTRSD02' /etc/modprobe.d # vi ./scsi_hostadapter.conf 파일을 생성<br>&gt; alias scsi_hostadapter1 qla2xxx<br>&gt; options qla2xxx ql2xmaxqdepth=8<br>&gt; <br>&gt;  2. modeprobe 통한 모듈 재가동<br>&gt; root@FLPTRSD02' /etc/modprobe.d # modprobe -r qla2xxx 모듈 내림<br>&gt; root@FLPTRSD02' /etc/modprobe.d # modprobe qla2xxx 모듈 올림<br>&gt; <br>&gt;  3. 작업 후 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br><br><publishedDate>2018-03-14T01:11:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LubWgIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-03-13T07:03:18Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-03-13T07:03:18Z</b><br><br>안녕하세요<br><br>추가로 확인해 주신 내역 반영해서 아래와 같이 진행을 하겠습니다.<br><br>감사합니다.<br><br>0 . 작업 전 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인 및 작업 전 외장 파일시스템 umount<br><br> 1. scsi_hostadapter.conf 파일 생성 (ql2xmaxqdepth 8로 변경하는 경우)<br>root@FLPTRSD02' /etc/modprobe.d # vi ./scsi_hostadapter.conf 파일을 생성<br>alias scsi_hostadapter1 qla2xxx<br>options qla2xxx ql2xmaxqdepth=8<br><br> 2. modeprobe 통한 모듈 재가동<br>root@FLPTRSD02' /etc/modprobe.d # modprobe -r qla2xxx 모듈 내림<br>root@FLPTRSD02' /etc/modprobe.d # modprobe qla2xxx 모듈 올림<br><br> 3. 작업 후 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br><br><publishedDate>2018-03-13T07:03:18Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LubP6IAJ"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-03-13T06:52:02Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-03-13T06:52:01Z</b><br><br>외장 스토리지 볼륨을 사용하고 있다면 umount등으로 일단 사용하지 않는 상태로 변경하신 후에 작업을 하셔야 합니다.<br><br>2번 단계만 조금 보완하시면 될 것으로 보입니다.<br><br>설정 파일 변경 전에 해당 모듈을 내립니다.<br>modprobe -r qla2xxx<br><br>설정 파일 변경 후 해당 모듈을 다시 올립니다.<br>modprobe qla2xxx<br><br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><br>(In reply to kim, jimin)<br>&gt; 안녕하세요 <br>&gt; <br>&gt; 답변 감사드립니다.<br>&gt; <br>&gt; dracut을 통해서 ramdisk 이미지를 만드는 과정은  OS 영역이 외장 스토리지의 디스크에 있을 경우 필요한 부분이네요.<br>&gt; <br>&gt; 그럼 OS 영역이 물리 서버의 internal에 있는 경우dracut 부분은 필요 없이<br>&gt; <br>&gt; 온라인 중 아래와 같은 절차로 진행을 하면 되는지 문의드립니다.<br>&gt; <br>&gt;  0 . 작업 전 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br>&gt; <br>&gt;  1. scsi_hostadapter.conf 파일 생성 (ql2xmaxqdepth 8로 변경하는 경우)<br>&gt; root@FLPTRSD02' /etc/modprobe.d # vi ./scsi_hostadapter.conf 파일을 생성<br>&gt; alias scsi_hostadapter1 qla2xxx<br>&gt; options qla2xxx ql2xmaxqdepth=8<br>&gt; <br>&gt;  2. modeprobe 통한 모듈 반영<br>&gt; root@FLPTRSD02' /etc/modprobe.d # modprobe<br>&gt; <br>&gt;  3. 작업 후 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br><br><publishedDate>2018-03-13T06:52:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LuapmIAB"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-03-13T05:59:25Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-03-13T05:59:25Z</b><br><br>안녕하세요 <br><br>답변 감사드립니다.<br><br>dracut을 통해서 ramdisk 이미지를 만드는 과정은  OS 영역이 외장 스토리지의 디스크에 있을 경우 필요한 부분이네요.<br><br>그럼 OS 영역이 물리 서버의 internal에 있는 경우dracut 부분은 필요 없이<br><br>온라인 중 아래와 같은 절차로 진행을 하면 되는지 문의드립니다.<br><br> 0 . 작업 전 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br><br> 1. scsi_hostadapter.conf 파일 생성 (ql2xmaxqdepth 8로 변경하는 경우)<br>root@FLPTRSD02' /etc/modprobe.d # vi ./scsi_hostadapter.conf 파일을 생성<br>alias scsi_hostadapter1 qla2xxx<br>options qla2xxx ql2xmaxqdepth=8<br><br> 2. modeprobe 통한 모듈 반영<br>root@FLPTRSD02' /etc/modprobe.d # modprobe<br><br> 3. 작업 후 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값 확인<br><br><publishedDate>2018-03-13T05:59:25Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LuZFTIA3"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-03-13T02:38:51Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-03-13T02:38:51Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>qla2xxx 모듈을 사용하는 HBA Card가 시스템에 장착되어 있으면 부팅시에 해당 드라이버인 qla2xxx 모듈이 자동으로 로드됩니다.<br><br>dracut으로 ramdisk 이미지를 만드는 것은 만약 스토리지의 디스크로 부팅이 필요한 경우 qla2xxx 드라이버가 부팅 초기에 로드되도록 하기 위해서 알려드린 사항입니다. ramdisk 이미지 생성은 추가 옵션으로 생각하실 수 있습니다.<br><br>qla2xxx 모듈을 사용하는 장치가 존재하지 않아도 modprob.d 디렉터리에 적절한 설정 파일을 만들어서 modprobe 명령으로 모듈을 다시 올리기만 해도 적용됩니다. 적용 여부 확인은 /sys/module/qla2xxx/parameters/ql2xmaxqdepth 값을 확인해보시면 됩니다. 따라서, 장치가 없는 테스트 시스템에서도 설정 파일 적용 여부를 간단히 확인하실 수 있습니다.<br><br>재부팅이 필요한 이유는 HBA Card를 통해서 스토리지의 볼륨을 사용하고 있는 경우에 스토리지 연결을 끊고 다시 연결하면서 새로운 설정이 적용되도록 하기 위한 것입니다.<br><br>고맙습니다.<br><br><publishedDate>2018-03-13T02:38:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LuIhgIAF"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-03-12T08:21:47Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-03-12T08:21:47Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>아래 문의에 대해서 추가 문의를 드리려고 합니다.<br><br>========== 기술 문의 02024077 내용 ========== <br><br>qla2xxx queue_depth 확인<br><br>안녕하세요<br><br>SDS 상암센터 김지민 선임입니다.<br><br>Redhat 6.4 서버에서 HBA port의 queue depth 설정 확인 관련해서 문의드리려고 합니다.<br><br>아래 링크를 참고하여서 확인하였는데<br><br>https://access.redhat.com/solutions/23366'<br><br>아래와 같이 설정이 되어있으면 queue depth가 32로 확인하면 되는 것인지 문의드립니다.<br>root@FLPTRSD02' /root # modinfo qla2xxx | grep ql2xmaxqdepth<br>parm:           ql2xmaxqdepth:Maximum queue depth to set for each LUN. Default is 32. (int)<br><br>감사합니다.<br><br>=============================================<br><br>만약 FLPTRSD02 서버에서 ql2xmaxqdepth 값을 변경한다면 보내주신 KBase 문서를 참고해서<br><br>root@FLPTRSD02 /etc/modprobe.d # vi ./scsi_hostadapter.conf 파일을 생성하고<br><br>해당 파일에 아래 내용을 입력 후 initram disk 재생성 dracut -f -v 수행 후 rebooting을 하면 되는지 문의드리려고 합니다.<br><br>alias scsi_hostadapter1 qla2xxx<br>options qla2xxx ql2xmaxqdepth=(변경하려는 값)<br><br>추가로 문의드릴 점은 위의 값을 반영 후 rebooting만하면 효과는 없는 것인가요?<br><br>한가지는 이 모듈은 booting 시에만 load가 되도록 되어있는 건지 문의드리려고 합니다.<br><br><publishedDate>2018-03-12T08:21:47Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LoBdPIAV"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-02-13T01:16:15Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-02-13T01:16:15Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-02-13T01:16:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000La1nXIAR"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-02-06T00:29:16Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-02-06T00:29:15Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-02-06T00:29:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LYywvIAD"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-02-01T01:02:45Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-02-01T01:02:44Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>ql2xmasqdepth 모듈 파라미터를 수동으로 변경하여 값이 변경되어도 실질적인 효과는 없습니다.<br>이 파라미터 값은 해당 모듈이 다시 로드될 때 적용됩니다. <br><br>아래 KBase 문서를 참고하셔서 적용하시길 바랍니다.<br>https://access.redhat.com/solutions/23366<br><br>간략히, 주요 내용을 설명드리면,<br><br>/etc/modprobe.d 디렉토리에 아래의 내용으로 파일을 생성합니다.<br><br>~~~<br>alias scsi_hostadapter1 qla2xxx  <br>options qla2xxx ql2xmaxqdepth=16<br>~~~<br><br>부팅시 바로 적용이 되도록 initrd/initramfs 이미지를 다시 생성하여 다음 부팅시 적용되도록 하실 것을 권장합니다.<br>https://access.redhat.com/knowledge/solutions/1958<br><br>시스템 재부팅 후 변경설정한 파라미터가 적용되었는지 확인하시기 바랍니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2018-02-01T01:02:44Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LYc4iIAD"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-01-31T05:42:02Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-01-31T05:42:02Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>혹시 queue_depth값을 8로 변경을 해야하면 어떻게 해야하는지 문의드리려고 합니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-31T05:42:02Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LYbpJIAT"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-01-31T05:13:47Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-01-31T05:13:47Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>확인해주신 방법으로 확인해보니<br><br>root@FLPTRSD02 /sys/block/sdr/device # cat queue_depth<br>32<br><br>결과가 위와 같이 32로 설정되어있는 것 같습니다.<br><br>감사합니다.<br><br><publishedDate>2018-01-31T05:13:47Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LYbhUIAT"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-01-31T04:52:27Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-01-31T04:52:27Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>답변이 제공된 것을 모르고 코멘트를 남겼습니다.<br>앞서 안내해드린 방법으로 파라미터 적용 값을 확인하시면 됩니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2018-01-31T04:52:27Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LYb6pIAD"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-01-31T03:30:41Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-01-31T03:30:36Z</b><br><br>안녕하세요?<br><br>Senior Technical Account Manager 허경입니다.<br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>문의하신 내용에 대해서 확인한 후 업데이트 드리겠습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2018-01-31T03:30:36Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LYb6kIAD"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-01-31T03:30:33Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-01-31T03:30:33Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>기본값이 32 입니다.<br>해당 값의 확인은 아래 명령어로 확인할 수 있습니다.<br><br>$ cat /sys/block/sd&lt;N&gt;/device/queue_depth<br>32<br><br> How to find and change fnic queue depth ? <br>https://access.redhat.com/solutions/73403<br>======================<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-01-31T03:30:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>