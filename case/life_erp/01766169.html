======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2017-01-03T06:31:07Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-01-22T11:13:13Z</b><br><b>id : 500A000000W81PnIAJ</b><br>======================<br><br><b><font size=15>
제목  : /etc/logrotate.conf 설정 관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요<br><br>김지민 선임입니다.<br><br>아래와 같이 /etc/logrotate.conf에 wtmp log 설정이 되어있는 상태입니다.<br><br>rotate 조건이 monthly와 1M 2개의 조건이 있는데 monthly만 사용을 해도 괜찮은지 문의드리려고 합니다.<br>default 1M인것을 보면 1M 이상 설정 시 문제가 되는 부분도 있는 것 같아서 문의드립니다.<br><br>root@PECCAL01SL /root # cat /etc/logrotate.conf<br># see &quot;man logrotate&quot; for details<br># rotate log files weekly<br>monthly<br><br># keep 4 weeks worth of backlogs<br>rotate 12<br><br># create new (empty) log files after rotating old ones<br>create 0600 root root<br><br># use date as a suffix of the rotated file<br>dateext<br><br># uncomment this if you want your log files compressed<br>#compress<br><br># RPM packages drop log rotation information into this directory<br>include /etc/logrotate.d<br><br># no packages own wtmp and btmp -- we'll rotate them here<br>/var/log/wtmp {<br>    monthly<br>    create 0600 root utmp<br>        minsize 1M<br>    rotate 12<br>}<br><br>/var/log/btmp {<br>    missingok<br>    monthly<br>    create 0600 root utmp<br>    rotate 12<br>}<br><br># system-specific logs may be also be configured here.<br>root@PECCAL01SL /root # cd /var/log<br>root@PECCAL01SL /var/log # ls -al | grep wtmp<br>-rw-------   1 root         utmp      983424 Jan  3 15:02 wtmp<br>-rw-------.  1 root         utmp     1060608 Feb 26  2016 wtmp-20160227<br>-rw-------   1 root         utmp     1051776 Apr  6  2016 wtmp-20160407<br>-rw-------   1 root         utmp     1060992 May 17  2016 wtmp-20160518<br>-rw-------   1 root         utmp     1067904 Jun 26  2016 wtmp-20160626<br>-rw-------   1 root         utmp     1049856 Aug  5 21:07 wtmp-20160806<br>-rw-------   1 root         utmp     1053696 Sep 17 21:56 wtmp-20160918<br>-rw-------   1 root         utmp     1074432 Oct 27 23:18 wtmp-20161028<br>-rw-------   1 root         utmp     1065600 Nov 21 16:23 wtmp-20161122<br>root@PECCAL01SL /var/log # ls -al | grep btmp<br>-rw-------   1 root         utmp           0 Jan  1 03:19 btmp<br>-rw-------   1 root         utmp       21120 Jan 31  2016 btmp-20160201<br>-rw-------   1 root         utmp       12288 Feb 29  2016 btmp-20160301<br>-rw-------   1 root         utmp        1152 Mar 25  2016 btmp-20160401<br>-rw-------   1 root         utmp      657408 Apr 29  2016 btmp-20160501<br>-rw-------   1 root         utmp        2304 May 27  2016 btmp-20160601<br>-rw-------   1 root         utmp   260883456 Jul  1  2016 btmp-20160701<br>-rw-------   1 root         utmp   321967872 Aug  1 03:39 btmp-20160801<br>-rw-------   1 root         utmp    75229056 Aug 30 20:04 btmp-20160901<br>-rw-------   1 root         utmp         768 Sep 12 17:14 btmp-20161001<br>-rw-------   1 root         utmp        5760 Oct 25 10:03 btmp-20161101<br>-rw-------   1 root         utmp       17280 Nov 15 10:31 btmp-20161201<br>-rw-------   1 root         utmp         384 Dec 19 15:44 btmp-20170101<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Configuration issue</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 4 (Low)</b><br><br><br>======================<br><b>생성계정 : Zheng, Meiyan</b><br><b>생성날짜 : 2017-01-04T03:35:17Z</b><br><b>마지막 답변자 : Zheng, Meiyan</b><br><b>마지막 수정 일자 : 2017-01-04T03:35:17Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용 해 주셔서 감사합니다.<br><br>minsize 와 monthly(혹은 daily,weekly) 옵션이 같이 사용될 때 로그는 이 <br>두가지 조건이 동시에 만족되어야만 로테이트를 진행하게 됩니다. 예를 들면 monthly 와<br>minsize 1M 이 사용되었을 때 아래와 같은 상황이라면 로테이트를 진행하지 못 합니다.<br><br>1) 한달이 지났지만 로그파일의 크기가 1M에 도달하지 못하였을때.<br>2) 로그파일의 크기가 1M을 초과하였으나 한달이 지나지 않았을때.<br><br>[참고자료]<br>Is there the effect when set size and time interval options by setting of logrotate together?<br>-https://access.redhat.com/solutions/35086<br><br><br>문의 주신 내용에 대해 아래와 같이 답변 드립니다. <br><br>1. wtmp log 에 관하여 rotate 설정 중 아래와 같이 minsize 1M 옵션을 사용하지<br>   않으셔도 문제가 없습니다. 이렇게 설정하시면 wtmp 로그는 로그파일의 크기가 1M이 <br>   되어야 로테이트 하던 것이 btmp 로그처럼 매달 한번 로테이트가 진행됩니다.<br><br>/var/log/wtmp {<br>    monthly<br>    create 0600 root utmp<br>#       minsize 1M<br>    rotate 12<br>}<br><br>2. minsize 을 default 1M 보다 크게 설정하셔도 문제가 없습니다.예를 들어 2M으로<br>   설정하시면 wtmp 로그는 그 크기가 2M이 되었을 때 로테이트가 한번 진행됩니다.<br><br><br>감사합니다.<br><br><publishedDate>2017-01-04T03:35:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br><br>김지민 선임입니다.<br><br>아래와 같이 /etc/logrotate.conf에 wtmp log 설정이 되어있는 상태입니다.<br><br>rotate 조건이 monthly와 1M 2개의 조건이 있는데 monthly만 사용을 해도 괜찮은지 문의드리려고 합니다.<br>default 1M인것을 보면 1M 이상 설정 시 문제가 되는 부분도 있는 것 같아서 문의드립니다.<br><br>root@PECCAL01SL /root # cat /etc/logrotate.conf<br># see &quot;man logrotate&quot; for details<br># rotate log files weekly<br>monthly<br><br># keep 4 weeks worth of backlogs<br>rotate 12<br><br># create new (empty) log files after rotating old ones<br>create 0600 root root<br><br># use date as a suffix of the rotated file<br>dateext<br><br># uncomment this if you want your log files compressed<br>#compress<br><br># RPM packages drop log rotation information into this directory<br>include /etc/logrotate.d<br><br># no packages own wtmp and btmp -- we'll rotate them here<br>/var/log/wtmp {<br>    monthly<br>    create 0600 root utmp<br>        minsize 1M<br>    rotate 12<br>}<br><br>/var/log/btmp {<br>    missingok<br>    monthly<br>    create 0600 root utmp<br>    rotate 12<br>}<br><br># system-specific logs may be also be configured here.<br>root@PECCAL01SL /root # cd /var/log<br>root@PECCAL01SL /var/log # ls -al | grep wtmp<br>-rw-------   1 root         utmp      983424 Jan  3 15:02 wtmp<br>-rw-------.  1 root         utmp     1060608 Feb 26  2016 wtmp-20160227<br>-rw-------   1 root         utmp     1051776 Apr  6  2016 wtmp-20160407<br>-rw-------   1 root         utmp     1060992 May 17  2016 wtmp-20160518<br>-rw-------   1 root         utmp     1067904 Jun 26  2016 wtmp-20160626<br>-rw-------   1 root         utmp     1049856 Aug  5 21:07 wtmp-20160806<br>-rw-------   1 root         utmp     1053696 Sep 17 21:56 wtmp-20160918<br>-rw-------   1 root         utmp     1074432 Oct 27 23:18 wtmp-20161028<br>-rw-------   1 root         utmp     1065600 Nov 21 16:23 wtmp-20161122<br>root@PECCAL01SL /var/log # ls -al | grep btmp<br>-rw-------   1 root         utmp           0 Jan  1 03:19 btmp<br>-rw-------   1 root         utmp       21120 Jan 31  2016 btmp-20160201<br>-rw-------   1 root         utmp       12288 Feb 29  2016 btmp-20160301<br>-rw-------   1 root         utmp        1152 Mar 25  2016 btmp-20160401<br>-rw-------   1 root         utmp      657408 Apr 29  2016 btmp-20160501<br>-rw-------   1 root         utmp        2304 May 27  2016 btmp-20160601<br>-rw-------   1 root         utmp   260883456 Jul  1  2016 btmp-20160701<br>-rw-------   1 root         utmp   321967872 Aug  1 03:39 btmp-20160801<br>-rw-------   1 root         utmp    75229056 Aug 30 20:04 btmp-20160901<br>-rw-------   1 root         utmp         768 Sep 12 17:14 btmp-20161001<br>-rw-------   1 root         utmp        5760 Oct 25 10:03 btmp-20161101<br>-rw-------   1 root         utmp       17280 Nov 15 10:31 btmp-20161201<br>-rw-------   1 root         utmp         384 Dec 19 15:44 btmp-20170101</issue><cep>false</cep></case>