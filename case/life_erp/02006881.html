======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2018-01-09T00:15:16Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-01-25T11:06:00Z</b><br><b>id : 500A000000ZQ26JIAT</b><br>======================<br><br><b><font size=15>
제목  : Mware guest redhat 서버(RHEL)에서 파일시스템 확장 관련 문의 (ext4/xfs)
</font></b><br><br>======================<br><b>사전문의<br></b><br>xfs<br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>VMware guest redhat 서버(RHEL)에서 파일시스템 확장 관련 문의를 드리려고 합니다.<br><br>아래는 제가 테스트 해본 예시인데 혹시 절차상 문제가 있는 부분이 있으면 확인 부탁드리려고 합니다.<br><br>ext4와 xfs 파일시스템 두 종류로 수행하였습니다.<br><br> - ext4 type으로 구성된 파일시스템 증설 테스트 (/LOG1 20G → 30G)<br><br><br>1. 현재 파일시스템 확인<br>root@NONSAP / # df -Ph<br>Filesystem                Size  Used Avail Use% Mounted on<br>/dev/sda2                  30G  5.7G   23G  21% /<br>tmpfs                     1.7G     0  1.7G   0% /dev/shm<br>/dev/sda1                 976M   62M  863M   7% /boot<br>/dev/sda3                  20G  416M   19G   3% /var<br>/dev/mapper/vg0-home      9.8G   23M  9.2G   1% /home<br>/dev/mapper/vg0-sysadmin  9.8G  8.1G  1.2G  88% /sysadmin<br>/dev/mapper/testvg-APP     30G   44M   28G   1% /APP<br>/dev/mapper/testvg-DATA    50G   52M   47G   1% /DATA<br>/dev/mapper/testvg-LOG     30G   44M   28G   1% /LOG<br>/dev/mapper/testvg-TEST    40G   48M   38G   1% /TEST<br>/dev/mapper/testvg1-APP1   30G   44M   28G   1% /APP1<br>/dev/mapper/testvg1-LOG1   20G   44M   19G   1% /LOG1<br><br>2. PV 확인<br>root@NONSAP / # pvs<br>  PV         VG      Fmt  Attr PSize   PFree<br>  /dev/sda6  vg0     lvm2 a--   33.00g 13.00g<br>  /dev/sdb1  testvg  lvm2 a--  150.00g     0<br>  /dev/sdc   testvg1 lvm2 a--   50.00g     0<br><br>3. Vsphere 통해서 /dev/sdc 부분 100G로 증설<br><br><br>4. disk scan 후 증설 확인 (/dev/sdc 53.7G → 107.4GB)<br><br>root@NONSAP / # fdisk -l<br>=== 생략 ===<br>Disk /dev/sdc: 53.7 GB, 53687091200 bytes<br>64 heads, 32 sectors/track, 51200 cylinders<br>Units = cylinders of 2048 * 512 = 1048576 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk identifier: 0x00000000<br>=== 생략 ===<br><br>root@NONSAP / # echo 1 &gt; /sys/block/sdc/device/rescan<br><br>root@NONSAP / # fdisk -l<br>=== 생략 ===<br>Disk /dev/sdc: 107.4 GB, 107374182400 bytes<br>255 heads, 63 sectors/track, 13054 cylinders<br>Units = cylinders of 16065 * 512 = 8225280 bytes<br>Sector size (logical/physical): 512 bytes / 512 bytes<br>I/O size (minimum/optimal): 512 bytes / 512 bytes<br>Disk identifier: 0x00000000<br>=== 생략 ===<br><br>5. pvresize 및 확인<br>root@NONSAP / # pvresize /dev/sdc<br>  Physical volume &quot;/dev/sdc&quot; changed<br>  1 physical volume(s) resized / 0 physical volume(s) not resized<br><br>root@NONSAP / # pvs<br>  PV         VG      Fmt  Attr PSize   PFree<br>  /dev/sda6  vg0     lvm2 a--   33.00g 13.00g<br>  /dev/sdb1  testvg  lvm2 a--  150.00g     0<br>  /dev/sdc   testvg1 lvm2 a--  100.00g 50.00g<br><br>root@NONSAP / # vgs<br>  VG      #PV #LV #SN Attr   VSize   VFree<br>  testvg    1   4   0 wz--n- 150.00g     0<br>  testvg1   1   2   0 wz--n- 100.00g 50.00g<br>  vg0       1   2   0 wz--n-  33.00g 13.00g<br><br>root@NONSAP / # lvs<br>  LV       VG      Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert<br>  APP      testvg  -wi-ao---- 30.00g<br>  DATA     testvg  -wi-ao---- 50.00g<br>  LOG      testvg  -wi-ao---- 30.00g<br>  TEST     testvg  -wi-ao---- 40.00g<br>  APP1     testvg1 -wi-ao---- 30.00g<br>  LOG1     testvg1 -wi-ao---- 20.00g<br>  home     vg0     -wi-ao---- 10.00g<br>  sysadmin vg0     -wi-ao---- 10.00g<br><br>6. /LOG volume extend<br>root@NONSAP / # lvextend -L +10G /dev/testvg1/LOG1<br>  Size of logical volume testvg1/LOG1 changed from 20.00 GiB (5119 extents) to 30.00 GiB (7679 extents).<br>  Logical volume LOG1 successfully resized<br>root@NONSAP / # df -Ph<br>=== 생략 ===<br>/dev/mapper/testvg1-APP1   30G   44M   28G   1% /APP1<br>/dev/mapper/testvg1-LOG1   20G   44M   19G   1% /LOG1<br><br>7. resize2fs 통해서 파일시스템 반영<br>root@NONSAP / # resize2fs /dev/testvg1/LOG1<br>resize2fs 1.41.12 (17-May-2010)<br>Filesystem at /dev/testvg1/LOG1 is mounted on /LOG1; on-line resizing required<br>old desc_blocks = 2, new_desc_blocks = 2<br>Performing an on-line resize of /dev/testvg1/LOG1 to 7863296 (4k) blocks.<br>The filesystem on /dev/testvg1/LOG1 is now 7863296 blocks long.<br><br>8. 확인<br>root@NONSAP / # df -Ph<br>=== 생략 ===<br>/dev/mapper/testvg1-APP1   30G   44M   28G   1% /APP1<br>/dev/mapper/testvg1-LOG1   30G   44M   28G   1% /LOG1<br><br> - xfs<br><br>1 ~ 6번까지의 절차는 ext4와 동일하게 하였습니다.<br><br>7. xfs_growfs<br>root@NONSAP / # xfs_growfs /dev/testvg1/LOG1<br>meta-data=/dev/mapper/testvg1-LOG1 isize=256    agcount=4, agsize=1310464 blks<br>         =                       sectsz=512   attr=2, projid32bit=1<br>         =                       crc=0        finobt=0<br>data     =                       bsize=4096   blocks=5241856, imaxpct=25<br>         =                       sunit=0      swidth=0 blks<br>naming   =version 2              bsize=4096   ascii-ci=0 ftype=0<br>log      =internal               bsize=4096   blocks=2560, version=2<br>         =                       sectsz=512   sunit=0 blks, lazy-count=1<br>realtime =none                   extsz=4096   blocks=0, rtextents=0<br>data blocks changed from 5241856 to 7863296<br><br>8. 확인<br>root@NONSAP / # df -Ph<br>=== 생략 ===<br>/dev/mapper/testvg1-APP1   30G   33M   30G   1% /APP1<br>/dev/mapper/testvg1-LOG1   30G   33M   30G   1% /LOG1<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>NONSAP</hostname><br><br><br><comment id="a0aA000000LLFAVIA5"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-01-09T03:46:47Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-01-09T03:46:47Z</b><br><br>안녕하세요?<br><br>Senior Technical Account Manager 허경입니다.<br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>문의하신 내용에 문제는 없어보입니다. 그대로 진행하시면 될 것 같습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2018-01-09T03:46:47Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>