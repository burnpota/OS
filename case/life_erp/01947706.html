======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2017-10-07T06:39:21Z</b><br><b>마지막 답변자 : 우택 심</b><br><b>마지막 수정 일자 : 2017-10-13T00:33:42Z</b><br><b>id : 500A000000YSTpnIAH</b><br>======================<br><br><b><font size=15>
제목  : rear backup 사용 시 매일 1:30 cron 수행되는 작업에 대한
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>삼성생명 ERP 서버들에 대해서 OS 백업은 현재 rear를 구성해서 사용 중 입니다.<br>(추후 전체 redhat 서버들에 대해서 가능하면 rear 백업을 적용하려고 합니다.)<br><br>rear에 대해서 문의드리는 것이 맞는지 잘모르겠는데, <br>처음 사용해보는 tool이어서 동작 관련해서 문의를 드리려고 합니다.<br><br>rear를 구성하고 확인해보니 아래와 같이 rear 기능 중에서 cron을 통해 매일 01:30 checklayout과 mkrescue 수행 부분이 등록되어있는 상태입니다.<br><br>master 서버에서도 백업 수행 시 해당 mkrescue 시 생성되는 iso 이미지는 백업이 받히는 상태입니다.<br><br> - cron 설정 내역<br>root@DECCAL01SL / # cat /etc/cron.d/rear<br>30 1 * * * root /usr/sbin/rear checklayout || /usr/sbin/rear mkrescue<br><br> - 생성 내역<br>root@DECCAL01SL /var/lib/rear/output # ls -al<br>total 127500<br>drwxr-xr-x 2 root root        32 Jun 13 01:30 .<br>drwxr-xr-x 6 root root        61 Jun 13 01:30 ..<br>-rw------- 1 root root 130560000 Sep 28 01:30 rear-DECCAL01SL.iso<br><br> - rear master server<br>root@DBKSML02SL /os_backup/rear/regular/DECCAL01SL # ls -al<br>total 4004260<br>drwxr-x---   2 root root       4096 Sep  4 01:30 .<br>drwxr-x--- 208 root root       8192 Sep 13 16:30 ..<br>-rw-------   1 root root          0 Sep 28 01:30 .lockfile<br>-rw-------   1 root root   16966254 Sep  2 21:07 DECCAL01SL.log<br>-rw-------   1 root root 3952748014 Sep  2 21:07 DECCAL01SL.tar.gz<br>-rw-------   1 root root        202 Sep 28 01:30 README<br>-rw-------   1 root root        268 Sep 28 01:30 VERSION<br>-rw-------   1 root root  130560000 Sep 28 01:30 rear-DECCAL01SL.iso<br>-rw-------   1 root root      53685 Sep 28 01:30 rear-DECCAL01SL.log<br>root@DBKSML02SL /os_backup/rear/regular/DECCAL01SL # du -sh ./*<br>17M     ./DECCAL01SL.log<br>3.7G    ./DECCAL01SL.tar.gz<br>4.0K    ./README<br>4.0K    ./VERSION<br>125M    ./rear-DECCAL01SL.iso<br>56K     ./rear-DECCAL01SL.log<br><br>checklayout과 mkrescue 부분은 man page를 통해서 간단히 확인을 하긴 하였는데<br>간단히 보면 os disklayout을 확인해서 mkrescue를 통해서 iso 이미지를 생성하는 것 처럼 보이는데요.<br><br>checklayout : check if the disk layout has changed since the last run of mkbackup/mkrescue<br>mkrescue : create rescue media only<br><br>아래 내용이 자동으로 cron에 등록되어서 매일 수행이 되어야 하는 이유가 있는지 문의드리려고 합니다.<br>30 1 * * * root /usr/sbin/rear checklayout || /usr/sbin/rear mkrescue<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 4 (Low)</b><br><hostname>DECCAL01SL</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000KfobpIAB"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2017-10-10T05:45:48Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2017-10-10T05:45:48Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>충분한 답변이 되었다면 케이스를 종료처리하겠습니다.<br>고맙습니다.<br><br>(In reply to kim, jimin)<br>&gt; 안녕하세요 <br>&gt; <br>&gt; SDS 김지민 선임입니다.<br>&gt; <br>&gt; 상세한 답변 감사드립니다.<br><br><publishedDate>2017-10-10T05:45:48Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Kfo8hIAB"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-10-10T05:02:00Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-10-10T05:02:00Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>상세한 답변 감사드립니다.<br><br><publishedDate>2017-10-10T05:02:00Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KfWchIAF"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2017-10-08T12:03:22Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2017-10-08T12:03:22Z</b><br><br>안녕하세요?<br><br>Senior Technical Account Manager 허경입니다.<br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>이미 확인하신데로 cron job으로 등록된 내용은 os의 disklayout의 변화를 확인하여 변화가 있는 경우에 mkrescue 명령을 수행하도록 되어 있습니다.<br>이 작업이 매일 실행되는 이유는 os의 disklayout의 변화가 자동으로 복구 ISO 이미지에 반영되어야 하기 때문입니다.<br><br>os disklayout이 변경된 상황에서 복구 ISO 이미지를 변경하지 않은 상태로 두게 되면 복구를 시도하는 과정에서 복구가 실패할 수도 있기 때문입니다.<br>ISO 이미지로 복구를 진행할 때 첫번째 단계로 디스크 레이아웃을 새로 생성하도록 되어 있습니다. 디스크 레이아웃이 변경되었는데 ISO 이미지를 업데이트 하지 않으면<br>복구시 정확하게 디스크 레이아웃을 반영할 수 없게 됩니다. 따라서 변경이 발생하면 그 변경 사항은 반드시 복구 ISO에 반영되어야 합니다. <br><br>예를 들어 시스템 운영을 하던 중 파일시스템 사용량이 늘어나서 파일시스템을 확장하여 기존 파일시스템보다 파일시스템의 크기가 증가했다고 가정을 해보겠습니다.<br>ISO 이미지가 업데이트되지 않은 상태라면 복구 과정에서 파일 시스템 확장전의 크기로 파일시스템이 생성되고 백업되어 있던 데이터를 이용하여 복원하게 됩니다.<br>이 때 백업되어 있던 데이터의 크기가 복구과정에서 새롭게 생성된 파일 시스템 보다 큰 경우에는 복구를 실패할 가능성이 있습니다.<br>이 같은 상황을 예방하기 위해서 디스크 레이아웃의 변경이 생기면 복구 ISO 이미지를 새롭게 만들도록 구성되어 있는 것입니다. <br><br>그렇기 때문에 rear의 기본 설정으로 cron job이 생성되어 포함되는 있는 것입니다.<br><br>이 작업은 os disklayout의 변화여부를 매일 점검하고, 혹시라도 누락될 수 있는 복구 ISO 이미지 자동 재생성 작업을 확실하게 하도록 설정되는 것으로 생각하시면 좋을 것 같습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br><publishedDate>2017-10-08T12:03:22Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br><br>SDS 김지민 선임입니다.<br><br>삼성생명 ERP 서버들에 대해서 OS 백업은 현재 rear를 구성해서 사용 중 입니다.<br>(추후 전체 redhat 서버들에 대해서 가능하면 rear 백업을 적용하려고 합니다.)<br><br>rear에 대해서 문의드리는 것이 맞는지 잘모르겠는데, <br>처음 사용해보는 tool이어서 동작 관련해서 문의를 드리려고 합니다.<br><br>rear를 구성하고 확인해보니 아래와 같이 rear 기능 중에서 cron을 통해 매일 01:30 checklayout과 mkrescue 수행 부분이 등록되어있는 상태입니다.<br><br>master 서버에서도 백업 수행 시 해당 mkrescue 시 생성되는 iso 이미지는 백업이 받히는 상태입니다.<br><br> - cron 설정 내역<br>root@DECCAL01SL / # cat /etc/cron.d/rear<br>30 1 * * * root /usr/sbin/rear checklayout || /usr/sbin/rear mkrescue<br><br> - 생성 내역<br>root@DECCAL01SL /var/lib/rear/output # ls -al<br>total 127500<br>drwxr-xr-x 2 root root        32 Jun 13 01:30 .<br>drwxr-xr-x 6 root root        61 Jun 13 01:30 ..<br>-rw------- 1 root root 130560000 Sep 28 01:30 rear-DECCAL01SL.iso<br><br> - rear master server<br>root@DBKSML02SL /os_backup/rear/regular/DECCAL01SL # ls -al<br>total 4004260<br>drwxr-x---   2 root root       4096 Sep  4 01:30 .<br>drwxr-x--- 208 root root       8192 Sep 13 16:30 ..<br>-rw-------   1 root root          0 Sep 28 01:30 .lockfile<br>-rw-------   1 root root   16966254 Sep  2 21:07 DECCAL01SL.log<br>-rw-------   1 root root 3952748014 Sep  2 21:07 DECCAL01SL.tar.gz<br>-rw-------   1 root root        202 Sep 28 01:30 README<br>-rw-------   1 root root        268 Sep 28 01:30 VERSION<br>-rw-------   1 root root  130560000 Sep 28 01:30 rear-DECCAL01SL.iso<br>-rw-------   1 root root      53685 Sep 28 01:30 rear-DECCAL01SL.log<br>root@DBKSML02SL /os_backup/rear/regular/DECCAL01SL # du -sh ./*<br>17M     ./DECCAL01SL.log<br>3.7G    ./DECCAL01SL.tar.gz<br>4.0K    ./README<br>4.0K    ./VERSION<br>125M    ./rear-DECCAL01SL.iso<br>56K     ./rear-DECCAL01SL.log<br><br>checklayout과 mkrescue 부분은 man page를 통해서 간단히 확인을 하긴 하였는데<br>간단히 보면 os disklayout을 확인해서 mkrescue를 통해서 iso 이미지를 생성하는 것 처럼 보이는데요.<br><br>checklayout : check if the disk layout has changed since the last run of mkbackup/mkrescue<br>mkrescue : create rescue media only<br><br>아래 내용이 자동으로 cron에 등록되어서 매일 수행이 되어야 하는 이유가 있는지 문의드리려고 합니다.<br>30 1 * * * root /usr/sbin/rear checklayout || /usr/sbin/rear mkrescue</issue><cep>false</cep></case>