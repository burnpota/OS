======================<br><b>생성계정 : 삼성생명 타임게이트</b><br><b>생성날짜 : 2017-07-13T17:20:50Z</b><br><b>마지막 답변자 : Workflow Integration</b><br><b>마지막 수정 일자 : 2017-07-20T01:52:33Z</b><br><b>id : 500A000000XVIVxIAP</b><br>======================<br><br><b><font size=15>
제목  : 거버너 퍼포먼스모드  최대 cpu클럭 설정 건
</font></b><br><br>======================<br><b>사전문의<br></b><br>sosreport 첨부하였습니다.<br>DNLSDL01SL_170713.tar.gz<br>이 장비는 dell장비입니다.<br><br>안녕하세요?<br>BIOS 에서 PSTATE 설정을 키고 최대퍼포먼스를 사용하기 위한 작업 중<br>의문점이 있어 문의드립니다.<br><br>/etc/sysconfig/cpupower에서 CPU 클럭 범위를 최대로 지정하고자 <br>/sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq의 값을 /etc/sysconfig/cpupower의 min max 값에 적용하려 했으나 이 값은 물리 CPU 클럭 2.60GHz 보다 큰 3.50GHz (3500000)입니다.<br>CPUPOWER_START_OPTS 값에서 min max값을 3500000 주어야 할지 2600000으로 주어야 할지 난감합니다.<br><br>그리고 이 사항 이전에 왜 3500000이 스케일링된 맥스값인지 궁금합니다.<br><br>아울러 아래와 같이 min max 설정을 2.60ghz이라 한다 하면 ghz단위가 아닌  khz단위로 2600000 을 사용하는것이 맞는지 확인 부탁드립니다.<br><br>&lt;/etc/sysconfig/cpupower 내용&gt;<br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance --min 2600000 --max 2600000&quot;<br><br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # ls -al<br>total 0<br>drwxr-xr-x 2 root root    0 May 11 09:40 .<br>drwxr-xr-x 9 root root    0 May 11 09:40 ..<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 affected_cpus<br>-r-------- 1 root root 4096 Jul  5 10:54 cpuinfo_cur_freq<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 cpuinfo_max_freq<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 cpuinfo_min_freq<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 cpuinfo_transition_latency<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 related_cpus<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 scaling_available_governors<br>-r--r--r-- 1 root root 4096 Jul  5 10:54 scaling_driver<br>-rw-r--r-- 1 root root 4096 Jul  5 10:54 scaling_governor<br>-rw-r--r-- 1 root root 4096 Jul  5 10:54 scaling_max_freq<br>-rw-r--r-- 1 root root 4096 Jul  5 10:54 scaling_min_freq<br>-rw-r--r-- 1 root root 4096 Jul  5 10:54 scaling_setspeed<br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # cat scaling_max_freq<br>3500000<br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # cat scaling_min_freq<br>1200000<br>root@DNLSDL01SL /root # lscpu<br>Architecture:          x86_64<br>CPU op-mode(s):        32-bit, 64-bit<br>Byte Order:            Little Endian<br>CPU(s):                28<br>On-line CPU(s) list:   0-27<br>Thread(s) per core:    1<br>Core(s) per socket:    14<br>Socket(s):             2<br>NUMA node(s):          2<br>Vendor ID:             GenuineIntel<br>CPU family:            6<br>Model:                 79<br>Model name:            Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.60GHz<br>Stepping:              1<br>CPU MHz:               1200.062<br>BogoMIPS:              5204.44<br>Virtualization:        VT-x<br>L1d cache:             32K<br>L1i cache:             32K<br>L2 cache:              256K<br>L3 cache:              35840K<br>NUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26<br>NUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27<br><br>root@DNLSDL01SL /root # cpupower frequency-info<br>analyzing CPU 0:<br>  driver: intel_pstate<br>  CPUs which run at the same hardware frequency: 0<br>  CPUs which need to have their frequency coordinated by software: 0<br>  maximum transition latency: 0.97 ms.<br>  hardware limits: 1.20 GHz - 3.50 GHz<br>  available cpufreq governors: performance, powersave<br>  current policy: frequency should be within 1.20 GHz and 3.50 GHz.<br>                  The governor &quot;powersave&quot; may decide which speed to use<br>                  within this range.<br>  current CPU frequency is 1.20 GHz (asserted by call to hardware).<br>  boost state support:<br>    Supported: yes<br>    Active: yes<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>DNLSDL01SL</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000Jw6HAIAZ"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-07-20T01:52:33Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-07-20T01:52:32Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>먼저, 본 기술 문의가 해결되어 다행입니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 재개하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>GSS, Asia Pacific, Red Hat Inc<br><br><publishedDate>2017-07-20T01:52:32Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JvxcdIAB"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-19T13:54:18Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-19T13:54:18Z</b><br><br>답변 감사합니다...<br><br><publishedDate>2017-07-19T13:54:18Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JvK2rIAF"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-07-17T00:11:42Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-07-17T00:11:41Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>네 사용하셔도 문제는 없을 것으로 판단됩니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-07-17T00:11:41Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JvK2XIAV"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-17T00:09:27Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-17T00:09:27Z</b><br><br>답변 감사합니다. <br>min max값에 대한 답변 감사합니다.<br>허나 저희쪽 dell장비에서는 물리 2.6ghz cpu를 장착하여 사용하고 있으며<br>터보 부스트 모드로 3.5ghz까지 쓸수 있는것으로 나와 있습니다.<br>이때 터보 부스트 모드가 적용된 스캐일링값을 맥스(3.5Ghz)로 선택하여 <br>사용하여도 문제가 없는지 여쭤보고 싶습니다.<br><br><publishedDate>2017-07-17T00:09:27Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JvJwyIAF"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-07-16T23:13:19Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-07-16T23:13:19Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>min과 max를 동일하게 설정해도 됩니다만, 아래 테스트에서 보시다시피 크게 영향은 없는 것 같습니다.<br><br>** cpupower 서비스를 활성화하면 tuned 설정은 비활성화되며<br>   tuned 설정을 활성화하면 cpupower 서비스는 비활성화됨<br><br>1. cpupower performance governor 설정<br><br># grep START /etc/sysconfig/cpupower <br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance --min 3700000 --max 3700000&quot;<br><br># systemctl status cpupower|grep Active<br>   Active: active (exited) since 금 2017-07-14 23:29:37 AEST; 9min ago<br><br># systemctl status tuned|grep Active<br>   Active: inactive (dead) since 금 2017-07-14 23:29:38 AEST; 10min ago<br><br><br>Every 2.0s: grep MHz /proc/cpuinfo                      Fri Jul 14 23:42:01 2017<br><br>cpu MHz         : 1200.128<br>cpu MHz         : 3662.296<br>cpu MHz         : 3503.882<br>cpu MHz         : 3233.671<br>cpu MHz         : 1200.023<br>cpu MHz         : 3542.800<br>cpu MHz         : 3528.246<br>cpu MHz         : 3652.066<br><br># cpupower frequency-info<br>analyzing CPU 0:<br>  driver: intel_pstate<br>  CPUs which run at the same hardware frequency: 0<br>  CPUs which need to have their frequency coordinated by software: 0<br>  maximum transition latency:  Cannot determine or is not supported.<br>  hardware limits: 1.20 GHz - 3.70 GHz<br>  available cpufreq governors: performance powersave<br>  current policy: frequency should be within 3.70 GHz and 3.70 GHz. &lt;&lt;-- min/max 동일<br>                  The governor &quot;powersave&quot; may decide which speed to use<br>                  within this range.<br>  current CPU frequency: 2.95 GHz (asserted by call to hardware)<br>  boost state support:<br>    Supported: yes<br>    Active: yes<br>    3500 MHz max turbo 4 active cores<br>    3500 MHz max turbo 3 active cores<br>    3600 MHz max turbo 2 active cores<br>    3700 MHz max turbo 1 active cores<br><br><br>2. tuned 활성화<br><br># systemctl status cpupower|grep Active<br>   Active: failed (Result: exit-code) since 금 2017-07-14 23:40:29 AEST; 2s ago<br><br># systemctl status tuned|grep Active<br>   Active: active (running) since 금 2017-07-14 23:40:29 AEST; 6s ago<br><br>Every 2.0s: grep MHz /proc/cpuinfo                      Fri Jul 14 23:45:55 2017<br><br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.875<br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.980<br>cpu MHz         : 3499.980<br><br><br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_m*<br>3700000<br>3700000<br><br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver <br>intel_pstate<br><br>3. pstate 비활성화-<br>   cpupower 서비스가 비활성화되면 tuned 가 활성화됨.<br><br>Every 2.0s: grep MHz /proc/cpuinfo                      Fri Jul 14 23:45:50 2017<br><br>cpu MHz         : 2701.875<br>cpu MHz         : 2701.769<br>cpu MHz         : 2701.558<br>cpu MHz         : 2701.980<br>cpu MHz         : 2701.980<br>cpu MHz         : 2701.191<br>cpu MHz         : 2701.875<br>cpu MHz         : 2701.980<br><br># cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_driver <br>acpi_cpufreq<br><br># cpupower frequency-info<br>analyzing CPU 0:<br>  driver: acpi-cpufreq<br>  CPUs which run at the same hardware frequency: 0<br>  CPUs which need to have their frequency coordinated by software: 0<br>  maximum transition latency: 10.0 us<br>  hardware limits: 1.20 GHz - 2.70 GHz<br>  available frequency steps:  2.70 GHz, 2.70 GHz, 2.60 GHz, 2.50 GHz, 2.40 GHz, 2.30 GHz, 2.20 GHz, 2.10 GHz, 1.90 GHz, 1.80 GHz, 1.70 GHz, 1.60 GHz, 1.50 GHz, 1.40 GHz, 1.30 GHz, 1.20 GHz<br>  available cpufreq governors: conservative userspace powersave ondemand performance<br>  current policy: frequency should be within 1.20 GHz and 2.70 GHz.<br>                  The governor &quot;performance&quot; may decide which speed to use<br>                  within this range.<br>  current CPU frequency: 2.70 GHz (asserted by call to hardware)<br>  boost state support:<br>    Supported: yes<br>    Active: yes<br>    3500 MHz max turbo 4 active cores<br>    3500 MHz max turbo 3 active cores<br>    3600 MHz max turbo 2 active cores<br>    3700 MHz max turbo 1 active cores<br><br>4. pstate 비활성화 + tuned 비활성화<br><br>Every 2.0s: grep MHz /proc/cpuinfo                      Fri Jul 14 23:51:40 2017<br><br>cpu MHz         : 1300.000<br>cpu MHz         : 1300.000<br>cpu MHz         : 1200.000<br>cpu MHz         : 1200.000<br>cpu MHz         : 1200.000<br>cpu MHz         : 1200.000<br>cpu MHz         : 1200.000<br>cpu MHz         : 1200.000<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-07-16T23:13:19Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Jv3OgIAJ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2017-07-14T07:43:59Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2017-07-14T07:43:59Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>cpupower 설정 적용 관련 문의 사항이 있어서 첨부로 문의를 드립니다.<br><br>아래와 같이 scaling_max_freq와 scaling_min_freq 부분이 있는데요.<br>scaling_max_freq 부분이 3500000으로 현재 CPU 물리적 spec보다 model name      : Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.60GHz<br>더 높은 상태까지 max값이 가능한 상태로 보입니다. (HW에서 turbo boost 기능 적용)<br><br>cpupower설정을 할 때 <br>/etc/sysconfig/cpupower 부분에 --min과 --max 값을 설정하려고 하는데요.<br>항상 최대 성능 사용을 위해서 --min과 --max 부분에 max 기준 값을 적용하려고 하는데요.<br><br>아래와 같은 장비의 경우에 3500000로 적용을 해도 될지 문의드립니다.<br><br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # cat scaling_max_freq<br>3500000<br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # cat scaling_min_freq<br>1200000<br><br>root@DNLSDL01SL /sys/devices/system/cpu/cpu0/cpufreq # cat /proc/cpuinfo | grep -i ghz | more<br>model name      : Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.60GHz<br><br><publishedDate>2017-07-14T07:43:59Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Jv25LIAR"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-07-14T05:27:19Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-07-14T05:27:19Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>맞습니다. 이미 알고계신것 처럼, 온라인 설정 수동 설정은 1번과 같이 설정 하시면되고, 리부팅 이후 혹은 cpupower 서비스 재기동시에는 2번과 같이 설정하시면 됩니다.<br><br>아래 서비스 실제 서비스 파일에 /etc/sysconfig/cpupower 에서 설정된 값이 매치되게 됩니다.<br><br>$ cat /usr/lib/systemd/system/cpupower.service<br>----------------------------------------------<br>[Unit]<br>Description=Configure CPU power related settings<br>After=syslog.target<br><br>[Service]<br>Type=oneshot<br>RemainAfterExit=yes<br>EnvironmentFile=/etc/sysconfig/cpupower<br>ExecStart=/usr/bin/cpupower $CPUPOWER_START_OPTS<br>ExecStop=/usr/bin/cpupower $CPUPOWER_STOP_OPTS<br>----------------------------------------------<br><br>$ cat /etc/sysconfig/cpupower <br>----------------------------------------------<br># See 'cpupower help' and cpupower(1) for more info<br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance&quot;<br>CPUPOWER_STOP_OPTS=&quot;frequency-set -g ondemand&quot;<br>----------------------------------------------<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-07-14T05:27:19Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Jv1tvIAB"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-14T05:05:14Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-14T05:05:13Z</b><br><br>답변감사합니다.<br><br>확인차 다시 여쭤봅니다.<br>cpupower 거버너를 퍼포먼스로 사용할시 <br>min max값을 설정하는것은 <br><br>echo 260000 &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq <br>echo 260000 &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_max_freq<br><br>위와 같은 방법과<br><br>/etc/sysconfig/cpupower 에 아래와 같이 설정하는 법 <br>CPUPOWER_START_OPTS=&quot;frequency-set -g performance --min 2600000 --max 2600000&quot;<br> <br>2가지 다 가능한것이고 영구 적용으로는 2번째 방법이 맞는것이지요?<br><br><publishedDate>2017-07-14T05:05:13Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Jv15VIAR"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2017-07-14T02:40:33Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2017-07-14T02:40:33Z</b><br><br>안녕하세요<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>/usr/share/doc/kernel-doc-3.10.0/Documentation/cpu-freq/governors.txt<br>/usr/share/doc/kernel-doc-3.10.0/Documentation/cpu-freq/pcc-cpufreq.txt<br><br>2.3 cpuinfo_cur_freq:<br>---------------------<br>A) Often cpuinfo_cur_freq will show a value different than what is declared<br>in the scaling_available_frequencies or scaling_cur_freq, or scaling_max_freq.<br>This is due to &quot;turbo boost&quot; available on recent Intel processors. If certain<br>conditions are met the BIOS can achieve a slightly higher speed than requested<br>by OSPM. An example:<br><br>문의하신 내용에 답변드리자면,<br>&gt; 그리고 이 사항 이전에 왜 3500000이 스케일링된 맥스값인지 궁금합니다.<br><br>https://access.redhat.com/documentation/ko-KR/Red_Hat_Enterprise_Linux/6/html/Power_Management_Guide/tuning_cpufreq_policy_and_speed.html<br> 각각의 튜닝 가능한 항목의 값을 변경하려면, echo [value] &gt; /sys/devices/system/cpu/[cpu ID]/cpufreq/[tunable]를 사용합니다. 예를 들어, cpu0의 최저 클럭 속도를 360 Khz로 설정하려면 다음과 같이 합니다:<br>echo 360000 &gt; /sys/devices/system/cpu/cpu0/cpufreq/scaling_min_freq <br><br>350 khz = 350000<br>3500 khz = 3500000<br><br>https://ark.intel.com/ko/products/91770/Intel-Xeon-Processor-E5-2690-v4-35M-Cache-2_60-GHz<br><br>인텔 터보 부스크 기능에 의해 최대 값이 설정됩니다.<br><br>hardware limits: 1.20 GHz - 3.50 GHz<br><br>프로세서 기본 주파수 2.60 GHz<br>최대 터보 주파수 3.50 GHz <br><br><br>&gt; 아울러 아래와 같이 min max 설정을 2.60ghz이라 한다 하면 ghz단위가 아닌  khz단위로 2600000 을 사용하는것이 맞는지 확인 부탁드립니다.<br>khz 단위로 사용하는 것이 맞습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br><br>Jay Shin, Technical Support Engineer<br><br>Office: +82 2 3490 5200 - ext 3 (기술문의)<br>Email: jaeshin@redhat.com <br><br>Red Hat, Asia-Pacific Pty Ltd <br>Website: www.redhat.com<br><br><publishedDate>2017-07-14T02:40:33Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>