======================<br><b>생성계정 : 삼성생명 타임게이트</b><br><b>생성날짜 : 2017-07-06T02:23:01Z</b><br><b>마지막 답변자 : Ying Huang</b><br><b>마지막 수정 일자 : 2017-08-25T03:23:58Z</b><br><b>id : 500A000000XUO0tIAH</b><br>======================<br><br><b><font size=15>
제목  : cstate 파라메터 관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까?<br>송석중 수석보입니다.<br>c-state 설정시 grub에 추가하는 <br>intel_idle.max_cstate와<br>processor.max_cstate의 파라메터 값의 종류(0,1 외)와 의미하는 바를 말씀 부탁드립니다.<br><br>현재 저희가 설정하고자하는 파라메터값은 <br>intel_idle.max_cstate=0<br>processor.max_cstate=1 로 설정 예정입니다.<br><br>답변 부탁드립니다. 감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Usage / Documentation Help</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>all</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000Jtw0DIAR"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-09T13:38:10Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-09T13:38:10Z</b><br><br>답변 감사합니다.<br><br><publishedDate>2017-07-09T13:38:10Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Jth1XIAR"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-07-07T06:49:22Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-07-07T06:49:22Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>&gt; intel_idle.max_cstate=0 processor.max_cstate=1 여기서 값(0,1)의 의미가 무엇<br><br>상기 설정은 intel_idle 드라이버를 비활성화하여 acpi_idle를 사용하며 C1를 사용함을 알립니다. <br>앞서 안내해드린 문서를 보시다시피 C1은 &quot;CPU fully turned on&quot; 상태를 의미합니다.<br><br>저희 kernel-doc 확인시 말씀하신 두 파라미터 설정 범위는 아래와 같습니다.<br>        intel_idle.max_cstate=  [KNL,HW,ACPI,X86]<br>                        0       disables intel_idle and fall back on acpi_idle.<br>                        1 to 6  specify maximum depth of C-state.<br><br>        processor.max_cstate=   [HW,ACPI]<br>                        Limit processor to maximum C-state<br>                        max_cstate=9 overrides any DMI blacklist limit.<br><br>다만 이는 하드웨어와 밀접한 관계가 있어 Intel 문서 확인 결과 아래와 같습니다. 참고하시기 바랍니다.<br><br>A1) intel_idle.max_cstate<br><br>- intel_idle.mac_cstate 파라미터는 커널 intel_idle 모듈에서 사용되는 파라미터입니다. <br>- intel_idle 모듈의 역할은 다음과 같이 특정 Intel CPU에서 기존의 ACPI idle 모듈을 대체하여 CPU가 idle 상태일 때 전원 관리 기술중 하나인 C-State를 통제하게 됩니다. 이에 대한 설명은 다음의 intel_idle.c 커널 모듈에서도 확인하실 수 있습니다.<br><br>/*<br> * intel_idle is a cpuidle driver that loads on specific Intel processors<br> * in lieu of the legacy ACPI processor_idle driver.  The intent is to<br> * make Linux more efficient on these processors, as intel_idle knows<br> * more than ACPI, as well as make Linux more immune to ACPI BIOS bugs.<br> */<br><br>해당 파라미터 설정값에는 0, 1, 2, 3이 있는데 관련 값이 0 - 비활성화, 1 - 최대로 C1 진입, 2 - 최대로 C3 진입, 3 - 최대로 C6 진입 와 같은 작용을 합니다.<br><br>If looking to control which C-states are entered instead of the BIOS setting you can use the kernel parameter intel_idle.max_cstate. Note that the C-States are defined to the ACPI standard so with the example processor setting the parameter intel_idle.max_cstate=2 will ensure that the processor goes no deeper than C-State 3, %c3 when viewed in turbostat and similarly intel_idle.max_cstate=3 ensures no deeper than C-State 6, %c6.  You can observe the difference in latencies measured in microseconds in /sys/devices/system/cpu/cpu0/cpuidle for a particular C-State.<br><br>- 그러나 intel_idle의 C-state는 1) 전원 절약 기능이 매우 적극적이로 이루어져서 빠른 응답속도가 요구되는 환경에서는 적합하지 않고, 2) 일부 Nehalem, Westmere CPU의 버그로 인하여 intel_idle의 C3/C6 단계에서 시스템이 행에 빠지는 문제가 있어, 이 경우 intel_idle.max_cstate=0으로 해당 모듈의 기능을 비활성화 하도록 권고해드리고 있습니다.<br><br>A2) processor.max_cstate=1 파라미터의 용도 및 적용 값 확인<br><br>- processor.max_cstate 파라미터는 기본 ACPI Idle C-State 모듈로서 intel_idle 모듈이 지원하지 않는 CPU이거나 intel_idle.max_cstate=0으로 비활성화될 경우 사용되는 기본 모듈입니다.<br>- 기능은 intel_idle 모듈과 동일하게 CPU가 Idle 상태에서 단계별로 Sleep(C-State)되어 전원을 절약할 수 있도록 하는 기능을 제공합니다.<br>- 코드상 해당 모듈에 현재 사용할 수 있는 값은 0-7, 9 으로 확인되며 실제 적용 범위는 하드웨어에 관련되는것으로 확인됩니다.<br>즉 상기 Intel_idle 사용 가능한 모델일 경우 0-3으로 설정 가능하십니다.<br><br>- 또한 해당 모듈은 다음과 같이 processor.max_cstate=0으로 지정하더라도 max_cstate=1로 자동 설정되게 됩니다.<br><br>        if (max_cstate == 0)<br>                max_cstate = 1;<br><br>따라서 빠른 응답속도가 필요한 환경에서는 시스템이 Sleep 모드로 진입하지 못하도록 processor.max_cstate=1로 설정하는 것을 권고하고 있습니다.<br><br>감사합니다.<br><br><publishedDate>2017-07-07T06:49:22Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JpN3nIAF"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-06T16:21:57Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-06T16:21:57Z</b><br><br>intel_idle.max_cstate=0 processor.max_cstate=1 여기서 값(0,1)의 의미가 무엇이며 해당 파라메터의 값은 어떤 종류가 있는지요?<br>그리고 그 파라메터 값들이 의미하는 바는 무엇인지요?<br><br>intel_idle.max_cstate는 cpu의 전력 상태를 유휴상태로 사용한다는 이야기이고 파라메터 값은 0(enable),1(disable)  둘중에 하나 사용하여야 하고<br>processor.max_cstate는 cpu의 전력상태를 c0~c6 상태로 사용하겠다는 이야기고 파라메터값은 0~6까지 주면 되는건가요?<br><br>구체적인 답변 부탁드립니다.<br><br><publishedDate>2017-07-06T16:21:57Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000JpA16IAF"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2017-07-06T06:19:03Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2017-07-06T06:19:03Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의하신 질문에 대한 답변은 아래의 문서를 참고하시면 될것으로 보입니다.<br><br>What are CPU &quot;C-states&quot; and how to disable them if needed?<br>https://access.redhat.com/solutions/202743<br><br>만일 강제로 cpu 최대 frequency를 사용하게 하시려면 <br>설정 방법에는 아래의 문서를 참고하실수 있으십니다.<br><br>How to force cpuspeed to run cpu at max frequency.<br>https://access.redhat.com/solutions/55876<br><br>감사합니다.<br><br><publishedDate>2017-07-06T06:19:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>