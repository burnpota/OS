======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2018-04-30T01:40:53Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2018-05-15T10:03:47Z</b><br><b>id : 500A000000aQSqEIAW</b><br>======================<br><br><b><font size=15>
제목  : systemd 서비스 체크 관련 문ㅇ
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>Redhat 7버전 이후의 OS에 대해서<br>systemctl을 통해서 가동된 서비스들의 전체적인 상태를 보는 방법에 대해서 문의드리려고 합니다.<br><br>아래와 같이 서버는 다르지만 몇몇 서비스들에 대해서는 비정상 적인 부분들이 있는 상황인데요.<br><br>혹시 서비스들에 대해서 정상인지 정상이 아닌지 여부를 전체적으로 체크할 수 있는 방법이 있는지 문의드리려고 합니다.<br><br>root@SLPAFIDL01 /sysadmin/work/180430 # systemctl status sshd.service<br>* sshd.service - OpenSSH server daemon<br>   Loaded: loaded (/usr/lib/systemd/system/sshd.service; enabled; vendor preset: enabled)<br>   Active: active (running) since Sun 2017-05-14 16:04:14 KST; 11 months 15 days ago<br>     Docs: man:sshd(8)<br>           man:sshd_config(5)<br> Main PID: 5543 (sshd)<br>   CGroup: /system.slice/sshd.service<br>           `-5543 /usr/sbin/sshd -D<br><br>Apr 30 08:37:47 SLPAFIDL01 sshd[19264]: pam_tally2(sshd:setcred): unknown option: reset<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24564]: Accepted publickey for oragrid from 100.254.54.211 port 21523 ssh2: RSA e...:61:4c<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24564]: pam_tally2(sshd:setcred): unknown option: no_magic_root<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24564]: pam_tally2(sshd:setcred): unknown option: reset<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24593]: Accepted publickey for oragrid from 100.254.54.211 port 21525 ssh2: RSA e...:61:4c<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24593]: pam_tally2(sshd:setcred): unknown option: no_magic_root<br>Apr 30 08:44:24 SLPAFIDL01 sshd[24593]: pam_tally2(sshd:setcred): unknown option: reset<br>Apr 30 09:00:29 SLPAFIDL01 sshd[41341]: Accepted publickey for oragrid from 100.254.54.211 port 22939 ssh2: RSA e...:61:4c<br>Apr 30 09:00:29 SLPAFIDL01 sshd[41341]: pam_tally2(sshd:setcred): unknown option: no_magic_root<br>Apr 30 09:00:29 SLPAFIDL01 sshd[41341]: pam_tally2(sshd:setcred): unknown option: reset<br>Hint: Some lines were ellipsized, use -l to show in full.<br><br>root@SLPAMLDL01 /root # systemctl status cpupower.service<br>* cpupower.service - Configure CPU power related settings<br>   Loaded: loaded (/usr/lib/systemd/system/cpupower.service; enabled; vendor preset: disabled)<br>   Active: failed (Result: exit-code) since Mon 2018-04-23 13:28:00 KST; 6 days ago<br>  Process: 3507 ExecStart=/usr/bin/cpupower $CPUPOWER_START_OPTS (code=exited, status=237)<br> Main PID: 3507 (code=exited, status=237)<br><br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: - Do you have proper administration rights? (super-user?)<br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: - Is the governor you requested available and modprobed?<br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: - Trying to set an invalid policy?<br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: - Trying to set a specific frequency, but userspace...le,<br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: for example because of hardware which cannot be set...ncy<br>Apr 23 13:28:00 SLPAMLDL01 cpupower[3507]: or because the userspace governor isn't loaded?<br>Apr 23 13:28:00 SLPAMLDL01 systemd[1]: cpupower.service: main process exited, code=exited, st.../n/a<br>Apr 23 13:28:00 SLPAMLDL01 systemd[1]: Failed to start Configure CPU power related settings.<br>Apr 23 13:28:00 SLPAMLDL01 systemd[1]: Unit cpupower.service entered failed state.<br>Apr 23 13:28:00 SLPAMLDL01 systemd[1]: cpupower.service failed.<br>Hint: Some lines were ellipsized, use -l to show in full.<br><br>root@SLPAMLDL01 /root # systemctl status kdump.service<br>* kdump.service - Crash recovery kernel arming<br>   Loaded: loaded (/usr/lib/systemd/system/kdump.service; enabled; vendor preset: enabled)<br>   Active: failed (Result: exit-code) since Mon 2018-04-23 13:28:09 KST; 6 days ago<br>  Process: 3896 ExecStart=/usr/bin/kdumpctl start (code=exited, status=1/FAILURE)<br> Main PID: 3896 (code=exited, status=1/FAILURE)<br><br>Apr 23 13:28:08 SLPAMLDL01 kdumpctl[3896]: /etc/kdump.conf<br>Apr 23 13:28:08 SLPAMLDL01 kdumpctl[3896]: /etc/fstab<br>Apr 23 13:28:08 SLPAMLDL01 kdumpctl[3896]: Rebuilding /boot/initramfs-3.10.0-693.el7.x86_64kdump.img<br>Apr 23 13:28:09 SLPAMLDL01 kdumpctl[3896]: Bad raw disk /dev/vg9/DUMP<br>Apr 23 13:28:09 SLPAMLDL01 kdumpctl[3896]: mkdumprd: failed to make kdump initrd<br>Apr 23 13:28:09 SLPAMLDL01 kdumpctl[3896]: Starting kdump: [FAILED]<br>Apr 23 13:28:09 SLPAMLDL01 systemd[1]: kdump.service: main process exited, code=exited, statu...LURE<br>Apr 23 13:28:09 SLPAMLDL01 systemd[1]: Failed to start Crash recovery kernel arming.<br>Apr 23 13:28:09 SLPAMLDL01 systemd[1]: Unit kdump.service entered failed state.<br>Apr 23 13:28:09 SLPAMLDL01 systemd[1]: kdump.service failed.<br>Hint: Some lines were ellipsized, use -l to show in full.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLPAFIDL01/SLPAMLDL01</hostname><br><br><br><comment id="a0aA000000MRA2dIAH"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-04-30T05:47:29Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-04-30T05:47:29Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>전체적인 상태를 확인하시려면 systemctl status 명령으로 확인하실 수 있으며, 실패한 서비스만 확인하시려면 systemctl --failed 명령을 이용하시면 됩니다.<br><br>아래 예제를 참고하시기 바랍니다.<br><br>systemctl status 명령을 수행했을 때 State: degraded 로 표시되면1개 이상의 unit이 실패한 것으로 볼 수 있습니다.<br><br>[root@khuh ~]# systemctl status<br>● khuh<br>    State: degraded<br>     Jobs: 0 queued<br>   Failed: 1 units<br>    Since: 수 2018-03-14 18:03:53 KST; 1 months 16 days ago<br>   CGroup: /<br>           ├─1 /usr/lib/systemd/systemd --switched-root --system --deserialize 2<br>           ├─user.slice<br>           │ ├─user-986.slice<br>           │ │ └─session-9192.scope<br>           │ │   └─3508 pmlogger -r -T 24h10m -m pmlogger_daily -P -l pmlogger.l<br>           │ └─user-1000.slice<br>           │   ├─session-9339.scope<br>           │   │ ├─3886 sshd: khuh [priv]<br>           │   │ ├─3890 sshd: khuh@pts/8<br>           │   │ ├─3891 -bash<br>           │   │ ├─4162 sudo -i<br>           │   │ ├─4171 -bash<br>           │   │ ├─4736 systemctl status<br>           │   │ └─4737 less<br>           │   ├─session-9313.scope<br>           │   │ ├─29728 sshd: khuh [priv]<br>           │   │ ├─29737 sshd: khuh@pts/4<br>           │   │ ├─29739 -bash<br><br>실패한 unit을 확인하려면 systemctl --failed 명령으로 확인이 가능합니다.<br>이후 각각의 unit에 대해서 systemctl status &lt;unit-name&gt; 으로 상세 내용을 확인할 수 있습니다.<br><br>[root@khuh ~]# systemctl --failed<br>  UNIT        LOAD   ACTIVE SUB    DESCRIPTION<br>● znc.service loaded failed failed ZNC, an advanced IRC bouncer<br><br>LOAD   = Reflects whether the unit definition was properly loaded.<br>ACTIVE = The high-level unit activation state, i.e. generalization of SUB.<br>SUB    = The low-level unit activation state, values depend on unit type.<br><br>1 loaded units listed. Pass --all to see loaded but inactive units, too.<br>To show all installed unit files use 'systemctl list-unit-files'.<br><br>모든 서비스가 정상적인 경우 systemctl status 명령 수행시 아래와 같이 나타납니다.<br><br>● khuh<br>    State: running<br>     Jobs: 0 queued<br>   Failed: 0 units<br>    Since: 월 2018-04-30 13:45:29 KST; 2min 38s ago<br>   CGroup: /<br>           ├─1 /usr/lib/systemd/systemd --switched-root --system --deserialize 2<br>           ├─user.slice<br>           │ ├─user-42.slice<br>           │ │ └─session-c2.scope<br>           │ │   ├─2173 gdm-session-worker [pam/gdm-launch-environment]<br>           │ │   ├─2179 /usr/libexec/gnome-session-binary --autostart /usr/share<br>           │ │   ├─2204 dbus-launch --exit-with-session /usr/libexec/gnome-sessi<br>           │ │   ├─2213 /bin/dbus-daemon --fork --print-pid 4 --print-address 6<br>           │ │   ├─2221 /usr/libexec/at-spi-bus-launcher<br>           │ │   ├─2276 /bin/dbus-daemon --config-file=/usr/share/defaults/at-sp<br>           │ │   ├─2422 /usr/libexec/at-spi2-registryd --use-gnome-session<br>           │ │   ├─3051 /usr/bin/gnome-shell<br>           │ │   ├─3069 syndaemon -i 1.0 -t -K -R<br>           │ │   ├─3073 /usr/bin/pulseaudio --start --log-target=syslog<br>           │ │   ├─3173 ibus-daemon --xim --panel disable<br>           │ │   ├─3180 /usr/libexec/xdg-permission-store<br>           │ │   ├─3188 /usr/libexec/ibus-dconf<br>           │ │   ├─3191 /usr/libexec/ibus-x11 --kill-daemon<br>           <br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-04-30T05:47:29Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MR9XUIA1"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-04-30T04:29:51Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-04-30T04:29:51Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br>Red Hat 기술지원 서비스를 이용해 주셔서 감사합니다.<br><br>문의하신 내용에 대해서 확인한 후 업데이트 드리겠습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-04-30T04:29:51Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>