======================<br><b>생성계정 : 우택 심</b><br><b>생성날짜 : 2016-04-07T02:18:45Z</b><br><b>마지막 답변자 : Jake Jaewook Shin</b><br><b>마지막 수정 일자 : 2016-04-15T07:50:34Z</b><br><b>id : 500A000000U7SY9IAN</b><br>======================<br><br><b><font size=15>
제목  : SAP Migration 성능 Network Packet Drop 의 건
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요.<br><br>최근에 진행되었던 SAP Migration 성능 테스트에서 아래와 같이 Network Packet Drop 이 발견 되었습니다.<br><br>bond0: flags=5187&lt;UP,BROADCAST,RUNNING,MASTER,MULTICAST&gt;  mtu 1500<br>        inet 100.254.142.31  netmask 255.255.255.0  broadcast 100.254.142.255<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 0  (Ethernet)<br>        RX packets 5221904823  bytes 3317663809254 (3.0 TiB)<br>        RX errors 0  dropped 2368292  overruns 0  frame 0<br>        TX packets 5859857038  bytes 3036170323988 (2.7 TiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>bond1: flags=5187&lt;UP,BROADCAST,RUNNING,MASTER,MULTICAST&gt;  mtu 1500<br>        inet 172.18.12.31  netmask 255.255.255.0  broadcast 172.18.12.255<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 0  (Ethernet)<br>        RX packets 3217449  bytes 357011305 (340.4 MiB)<br>        RX errors 0  dropped 215400  overruns 0  frame 0<br>        TX packets 48815820  bytes 68421505668 (63.7 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>eno49: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.10.17  netmask 255.255.255.0  broadcast 10.10.10.255<br>        ether 28:80:23:9e:f1:a8  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>eno50: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.20.100  netmask 255.255.255.0  broadcast 10.10.20.255<br>        ether 28:80:23:9e:f1:a9  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>eno51: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.30.100  netmask 255.255.255.0  broadcast 10.10.30.255<br>        ether 28:80:23:9e:f1:aa  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>eno52: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.40.100  netmask 255.255.255.0  broadcast 10.10.40.255<br>        ether 28:80:23:9e:f1:ab  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens1f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:28  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens1f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:29  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens1f2: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:2a  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens1f3: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:2b  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens2f0: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 1000  (Ethernet)<br>        RX packets 5219391952  bytes 3315971114028 (3.0 TiB)<br>        RX errors 0  dropped 1123  overruns 0  frame 0<br>        TX packets 5859594690  bytes 3035791306196 (2.7 TiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens2f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4d  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens3f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:08  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens3f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:09  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens3f2: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:0a  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens3f3: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:0b  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens5f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:44  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens5f1: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 1000  (Ethernet)<br>        RX packets 2512872  bytes 1692695375 (1.5 GiB)<br>        RX errors 0  dropped 2367169  overruns 0  frame 0<br>        TX packets 262348  bytes 379017792 (361.4 MiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens6f0: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 1000  (Ethernet)<br>        RX packets 3002064  bytes 343691736 (327.7 MiB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 48815850  bytes 68421508968 (63.7 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens6f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7d  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens8f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:49:6c  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens8f1: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 1000  (Ethernet)<br>        RX packets 215400  bytes 13321639 (12.7 MiB)<br>        RX errors 0  dropped 215400  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>        inet 127.0.0.1  netmask 255.0.0.0<br>        loop  txqueuelen 0  (Local Loopback)<br>        RX packets 528687378  bytes 15406544539 (14.3 GiB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 528687378  bytes 15406544539 (14.3 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>======================<br>[root@wshim-redhat packet_drop]# cat netstat-i.txt <br>Kernel Interface table<br>Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg<br>bond0     1500 5221905464      0 2368292 0      5859857939      0      0      0 BMmRU<br>bond1     1500  3217457      0 215400 0      48815827      0      0      0 BMmRU<br>eno49     1500        0      0      0 0             0      0      0      0 BMU<br>eno50     1500        0      0      0 0             0      0      0      0 BMU<br>eno51     1500        0      0      0 0             0      0      0      0 BMU<br>eno52     1500        0      0      0 0             0      0      0      0 BMU<br>ens2f0    1500 5219392593      0   1123 0      5859595591      0      0      0 BMsRU<br>ens5f1    1500  2512872      0 2367169 0        262348      0      0      0 BMsRU<br>ens6f0    1500  3002072      0      0 0      48815857      0      0      0 BMsRU<br>ens8f1    1500   215400      0 215400 0             0      0      0      0 BMsRU<br>lo       65536 528687426      0      0 0      528687426      0      0      0 LRU<br>======================<br>[root@wshim-redhat packet_drop]# cat ethtool-g.txt <br>Ring parameters for ens2f0:<br>Pre-set maximums:<br>RX:<br><br>4096<br>RX Mini:<br>0<br>RX Jumbo:<br>0<br>TX:<br><br>4096<br>Current hardware settings:<br>RX:<br><br>512<br>RX Mini:<br>0<br>RX Jumbo:<br>0<br>TX:<br><br>512<br>======================<br>[root@wshim-redhat packet_drop]# cat bond0.txt <br>Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)<br><br>Bonding Mode: fault-tolerance (active-backup)<br>Primary Slave: None<br>Currently Active Slave: ens2f0<br>MII Status: up<br>MII Polling Interval (ms): 100<br>Up Delay (ms): 0<br>Down Delay (ms): 0<br><br>Slave Interface: ens2f0<br>MII Status: up<br>Speed: 10000 Mbps<br>Duplex: full<br>Link Failure Count: 1<br>Permanent HW addr: 00:11:0a:6b:4f:4c<br>Slave queue ID: 0<br><br>Slave Interface: ens5f1<br>MII Status: up<br>Speed: 10000 Mbps<br>Duplex: full<br>Link Failure Count: 1<br>Permanent HW addr: 00:11:0a:6b:4f:45<br>Slave queue ID: 0<br><br>어디서 문제가 발생했습니까? 어떤 환경에서 발생했습니까?<br><br>테스트 기간 동안 이와 관련하여 장애가 발견되지는 않았으나, <br><br>Drop 이 발생되는 원인과 조치 방안을 마련하려 합니다.<br><br>sosreport 를 dropbox.redhat.com 에 파일이름 sosreport-PPMSAL01SL-20160407095254.tar.xz 으로 업로드 하도록 하겠습니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000DjYf8IAF"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-04-12T05:22:17Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-04-12T05:22:17Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해주셔서 감사합니다.<br><br>해당 케이스를 직접 close 처리해주셔서 정말 감사합니다!<br><br>케이스가 처리 완료되면 *고객 설문조사 메일* 이 발송됩니다.<br>고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-12T05:22:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000DjYd2IAF"><br>======================<br><b>생성계정 : 심, 우택</b><br><b>생성날짜 : 2016-04-12T05:18:23Z</b><br><b>마지막 답변자 : 심, 우택</b><br><b>마지막 수정 일자 : 2016-04-12T05:18:23Z</b><br><br>감사합니다.<br><br>해당 케이스는 Closed 하도록 하겠습니다.<br><br><publishedDate>2016-04-12T05:18:23Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000DjYcOIAV"><br>======================<br><b>생성계정 : 심, 우택</b><br><b>생성날짜 : 2016-04-12T05:17:32Z</b><br><b>마지막 답변자 : 심, 우택</b><br><b>마지막 수정 일자 : 2016-04-12T05:17:32Z</b><br><br>감사합니다.<br><br>해당 케이스는 Closed 하도록 하겠습니다.<br><br><publishedDate>2016-04-12T05:17:32Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Gp9ePIAR"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-04-07T08:04:17Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-04-08T01:58:23Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대하여 안내를 드리면 다음과 같습니다.<br><br>일단 패킷 드랍 상황을 보면 다음과 같습니다.<br>~~~<br>OS<br>  Hostname: PPMSAL01SL<br>  Distro:   [redhat-release] Red Hat Enterprise Linux Server release 7.2 (Maipo)<br><br>NETDEV<br>  Interface  RxMiBytes  RxPackets  RxErrs  RxDrop         RxFifo  RxComp  RxFrame  RxMultCast<br>  =========  =========  =========  ======  ======         ======  ======  =======  ==========<br>  bond0      3163972    5221910 k  0       2368294 (0%)   0       0       0        68 (0%)<br>  bond1      340        3218 k     0       215400 (6%)    0       0       0        56 (0%)<br><br>  ens2f0     3162357    5219398 k  0       1123 (0%)      0       0       0        34 (0%)<br>  ens5f1     1614       2513 k     0       2367171 (49%)  0       0       0        34 (0%)<br><br>  ens6f0     328        3002 k     0       0              0       0       0        28 (0%)<br>  ens8f1     13         215 k      0       215400 (50%)   0       0       0        28 (0%)<br><br>BONDING<br>  Device    Mode               ifcfg-File BONDING_OPTS   Partner MAC Addr    Slaves (*=active; [n]=AggID)<br>  ========  =================  ========================  ==================  ===============================<br>  bond0     1 (active-backup)  mode=1 miimon=100         -                   * ens2f0 (00:11:0a:6b:4f:4c)<br>                                                                               ens5f1 (00:11:0a:6b:4f:45)<br>                                                                             - - - - - - - - - - - - - - - -<br>  bond1     1 (active-backup)  mode=1 miimon=100         -                   * ens6f0 (00:11:0a:6b:4b:7c)<br>                                                                               ens8f1 (00:11:0a:6b:49:6d)<br>~~~<br><br>상기에서 확인되듯이<br>본딩 디바이스를 구성하고 있는 inactive slave 인 ens5f1 와 ens8f1 에서 패킷 드랍의 대부분이 발생하고 있는 것이 확인됩니다.<br>이와 관련해서 다음 KBase 들을 참조하실 수 있습니다.<br><br>Inactive slave in bond shows dropped packets on MRG-Realtime 2.1+ and RHEL7 <br>- https://access.redhat.com/solutions/295953<br><br>RHEL7.1: rx_dropped errors on inactive bonding slave <br>- https://access.redhat.com/solutions/295953<br><br>즉, bond 의 inactive slave 디바이스에서 패킷 드랍이 발생하는 것은 <br>상위 업스트림에서 rx_dropped counter 관련 설계가 변경된 부분이<br>RHEL7 부터 적용된 결과로 이번 해당 출력값은 무시하셔도 되는 것으로 보고되어 잇습니다.<br><br>active slave 인 ens2f0 에서도 패킷 드랍이 발생하고 있으나, 전체 패킷 전송분 대비 경미한 비율이며<br>일반적으로 재전송에 의해 복구되며 TCP 의 특성상 정상적이고 예상된 동작으로 보고되어 있습니다.<br><br>이와 관련해서는 다음 KBase 를 참조하시기 바랍니다.  <br><br>Should I be concerned about a 0.05% packet drop rate? <br>- https://access.redhat.com/solutions/742043<br><br>추가로 문의하신 rx/tx 의 링 버퍼 튜닝에 관해서는 다음 문서가 참고되실 것으로 보입니다.<br><br>What are the recommendations for 10 Gigabit network adapter tuning parameters? <br>- https://access.redhat.com/solutions/127143<br><br>Ring Buffer<br>It is recommended to make the NIC receive and transmit ring buffers as large as possible to prevent packet drops.<br><br>10 기가 비트 관련 문서이지만 기가 비트도 동일하게 보시면 될 것 같습니다.<br>즉, 패킷 드랍을 막기 위해서는 가능한한 크게 링버퍼의 송수신 사이즈를 하시는 것이 권장되고 잇습니다.<br><br>결론적으로 현재 올려주신 sosreport 를 확인 결과,<br>현재 상황이 특별히 문제가 될 것으로 보이지는 않으며<br>링버퍼 튜닝을 하시면 패킷 드랍에 대한 예방에 다소 도움이 될 것으로 보입니다.<br><br>추가 튜닝 포인트로는 상기문서에도 있지만 net.core.netdev_budget 가 현재 300 인 디폴트 값으로 기가비트 환경에서는<br>다소 작을 수 있으므로 해당 문서를 참조로 튜닝해보시면 도움이 되실 수 있습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-07T08:04:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000GpC6iIAF"><br>======================<br><b>생성계정 : 심, 우택</b><br><b>생성날짜 : 2016-04-07T12:17:14Z</b><br><b>마지막 답변자 : 심, 우택</b><br><b>마지막 수정 일자 : 2016-04-07T12:17:14Z</b><br><br>안녕하세요.<br><br>만약 Packet drop 과 같은 중요한 이슈가 없더라도 rx/tx 의 buffer 의 값을 max 로 설정하는 방안이 권고 튜닝 포인트인지 확인 부탁 드립니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-07T12:17:14Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Gp9N7IAJ"><br>======================<br><b>생성계정 : Shin, Jake Jaewook</b><br><b>생성날짜 : 2016-04-07T07:32:39Z</b><br><b>마지막 답변자 : Shin, Jake Jaewook</b><br><b>마지막 수정 일자 : 2016-04-07T07:32:39Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service를 이용해주셔서 감사합니다.<br><br>저는 신재욱이라고 하며 앞으로 이 케이스를 담당하게 되었습니다.<br><br>현재 이 케이스의 내용을 살펴보는 중이며, 관련하여 업데이트 드리도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-07T07:32:39Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000Gp7PuIAJ"><br>======================<br><b>생성계정 : 심, 우택</b><br><b>생성날짜 : 2016-04-07T02:23:30Z</b><br><b>마지막 답변자 : 심, 우택</b><br><b>마지막 수정 일자 : 2016-04-07T02:23:30Z</b><br><br>sosreport 는 업로드 완료 하였으며,<br><br>별도로 명령어 결과를 수집한 파일도 업로드 하도록 하겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-04-07T02:23:30Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br><br>최근에 진행되었던 SAP Migration 성능 테스트에서 아래와 같이 Network Packet Drop 이 발견 되었습니다.<br><br>bond0: flags=5187&lt;UP,BROADCAST,RUNNING,MASTER,MULTICAST&gt;  mtu 1500<br>        inet 100.254.142.31  netmask 255.255.255.0  broadcast 100.254.142.255<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 0  (Ethernet)<br>        RX packets 5221904823  bytes 3317663809254 (3.0 TiB)<br>        RX errors 0  dropped 2368292  overruns 0  frame 0<br>        TX packets 5859857038  bytes 3036170323988 (2.7 TiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>bond1: flags=5187&lt;UP,BROADCAST,RUNNING,MASTER,MULTICAST&gt;  mtu 1500<br>        inet 172.18.12.31  netmask 255.255.255.0  broadcast 172.18.12.255<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 0  (Ethernet)<br>        RX packets 3217449  bytes 357011305 (340.4 MiB)<br>        RX errors 0  dropped 215400  overruns 0  frame 0<br>        TX packets 48815820  bytes 68421505668 (63.7 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>eno49: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.10.17  netmask 255.255.255.0  broadcast 10.10.10.255<br>        ether 28:80:23:9e:f1:a8  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>eno50: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.20.100  netmask 255.255.255.0  broadcast 10.10.20.255<br>        ether 28:80:23:9e:f1:a9  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>eno51: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.30.100  netmask 255.255.255.0  broadcast 10.10.30.255<br>        ether 28:80:23:9e:f1:aa  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>eno52: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500<br>        inet 10.10.40.100  netmask 255.255.255.0  broadcast 10.10.40.255<br>        ether 28:80:23:9e:f1:ab  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens1f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:28  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens1f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:29  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens1f2: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:2a  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens1f3: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:c5:2b  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens2f0: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 1000  (Ethernet)<br>        RX packets 5219391952  bytes 3315971114028 (3.0 TiB)<br>        RX errors 0  dropped 1123  overruns 0  frame 0<br>        TX packets 5859594690  bytes 3035791306196 (2.7 TiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens2f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4d  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens3f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:08  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens3f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:09  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens3f2: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:0a  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 16  <br><br>ens3f3: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 28:80:23:b2:ae:0b  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>        device interrupt 17  <br><br>ens5f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:44  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens5f1: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4f:4c  txqueuelen 1000  (Ethernet)<br>        RX packets 2512872  bytes 1692695375 (1.5 GiB)<br>        RX errors 0  dropped 2367169  overruns 0  frame 0<br>        TX packets 262348  bytes 379017792 (361.4 MiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens6f0: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 1000  (Ethernet)<br>        RX packets 3002064  bytes 343691736 (327.7 MiB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 48815850  bytes 68421508968 (63.7 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens6f1: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7d  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens8f0: flags=4098&lt;BROADCAST,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:49:6c  txqueuelen 1000  (Ethernet)<br>        RX packets 0  bytes 0 (0.0 B)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>ens8f1: flags=6211&lt;UP,BROADCAST,RUNNING,SLAVE,MULTICAST&gt;  mtu 1500<br>        ether 00:11:0a:6b:4b:7c  txqueuelen 1000  (Ethernet)<br>        RX packets 215400  bytes 13321639 (12.7 MiB)<br>        RX errors 0  dropped 215400  overruns 0  frame 0<br>        TX packets 0  bytes 0 (0.0 B)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>        inet 127.0.0.1  netmask 255.0.0.0<br>        loop  txqueuelen 0  (Local Loopback)<br>        RX packets 528687378  bytes 15406544539 (14.3 GiB)<br>        RX errors 0  dropped 0  overruns 0  frame 0<br>        TX packets 528687378  bytes 15406544539 (14.3 GiB)<br>        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br>======================<br>[root@wshim-redhat packet_drop]# cat netstat-i.txt <br>Kernel Interface table<br>Iface      MTU    RX-OK RX-ERR RX-DRP RX-OVR    TX-OK TX-ERR TX-DRP TX-OVR Flg<br>bond0     1500 5221905464      0 2368292 0      5859857939      0      0      0 BMmRU<br>bond1     1500  3217457      0 215400 0      48815827      0      0      0 BMmRU<br>eno49     1500        0      0      0 0             0      0      0      0 BMU<br>eno50     1500        0      0      0 0             0      0      0      0 BMU<br>eno51     1500        0      0      0 0             0      0      0      0 BMU<br>eno52     1500        0      0      0 0             0      0      0      0 BMU<br>ens2f0    1500 5219392593      0   1123 0      5859595591      0      0      0 BMsRU<br>ens5f1    1500  2512872      0 2367169 0        262348      0      0      0 BMsRU<br>ens6f0    1500  3002072      0      0 0      48815857      0      0      0 BMsRU<br>ens8f1    1500   215400      0 215400 0             0      0      0      0 BMsRU<br>lo       65536 528687426      0      0 0      528687426      0      0      0 LRU<br>======================<br>[root@wshim-redhat packet_drop]# cat ethtool-g.txt <br>Ring parameters for ens2f0:<br>Pre-set maximums:<br>RX:<br><br>4096<br>RX Mini:<br>0<br>RX Jumbo:<br>0<br>TX:<br><br>4096<br>Current hardware settings:<br>RX:<br><br>512<br>RX Mini:<br>0<br>RX Jumbo:<br>0<br>TX:<br><br>512<br>======================<br>[root@wshim-redhat packet_drop]# cat bond0.txt <br>Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)<br><br>Bonding Mode: fault-tolerance (active-backup)<br>Primary Slave: None<br>Currently Active Slave: ens2f0<br>MII Status: up<br>MII Polling Interval (ms): 100<br>Up Delay (ms): 0<br>Down Delay (ms): 0<br><br>Slave Interface: ens2f0<br>MII Status: up<br>Speed: 10000 Mbps<br>Duplex: full<br>Link Failure Count: 1<br>Permanent HW addr: 00:11:0a:6b:4f:4c<br>Slave queue ID: 0<br><br>Slave Interface: ens5f1<br>MII Status: up<br>Speed: 10000 Mbps<br>Duplex: full<br>Link Failure Count: 1<br>Permanent HW addr: 00:11:0a:6b:4f:45<br>Slave queue ID: 0</issue><environment>테스트 기간 동안 이와 관련하여 장애가 발견되지는 않았으나, <br><br>Drop 이 발생되는 원인과 조치 방안을 마련하려 합니다.<br><br>sosreport 를 dropbox.redhat.com 에 파일이름 sosreport-PPMSAL01SL-20160407095254.tar.xz 으로 업로드 하도록 하겠습니다.<br><br>감사합니다.</environment><cep>false</cep></case>