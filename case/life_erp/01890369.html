======================<br><b>생성계정 : 삼성생명 타임게이트</b><br><b>생성날짜 : 2017-07-14T07:38:15Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-08-02T10:05:12Z</b><br><b>id : 500A000000XVN4XIAX</b><br>======================<br><br><b><font size=15>
제목  : 메모리 점유가 점점 증가하는 증상관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하십니까<br>시스템 운영중 메모리 사용량이 크게 증가하였고 어플리케이션 사용이 확인되지만<br>해당 시점에 메모리 점유가 되는 증상이 있는지 OS단에 vmcore 분석 및 sosreport를 통해 자세한 분석 부탁드립니다<br>파일은 모두 dropbox에 업로드하였으며 mc5sum값 보내드립니다<br>vmcore용량이 워낙 커서 (약200G) 잘라서 업로드하였습니다<br><br>파일 확인해보시고 파일 업로드가 안된 파일이나 잘못된 파일 있으시면 알려주시면 추가로 업로드하도록 하겠습니다<br>추가로 sosreport도 올렸습니다 함께 확인 부탁드립니다<br>감사합니다 <br><br>9af9fd05ad58e0408a312f3475abf3be  vmcore170713_aa<br>547f949458e5596ce4ed0ee830d8fd0a  vmcore170713_ab<br>e8cbe10421b102c308f661c165c7c4cb  vmcore170713_ac<br>18222b95c9550aad1d3e68ba85434e55  vmcore170713_ad<br>20b4fe6adf563f71384454d3a7d6882f  vmcore170713_ae<br>1dbd1528db1bf630ca618371f68d666b  vmcore170713_af<br>00c9f6eed49954e8fc67f7b3f263a7b8  vmcore170713_ag<br>a188e90014eaf848a8a17189d543192f  vmcore170713_ah<br>73a51e551b41f8c730a794609a9dfcbd  vmcore170713_ai<br>237df928472cbc00d26405df871d26f6  vmcore170713_aj<br>680d15858b30248943d1fcf277172baa  vmcore170713_ak<br>0759765a993bdd10619f83c4091b4285  vmcore170713_al<br>eb1af3af04bc9dbf790e883ef9470be6  vmcore170713_am<br>414f8ef689f047ed7acd0c193e2ee158  vmcore170713_an<br>6e3a204b02ee3cc4d35f4146a0e28640  vmcore170713_ao<br>a634bcf3472fd2911166213014c1aa6c  vmcore170713_ap<br>e84d0c359e52ebbd141d83b40e1424af  vmcore170713_aq<br>78683d98181edc0b8eface855ed1dc8c  vmcore170713_ar<br>d9ff132f008b3a391e5536e502da48f6  vmcore170713_as<br>7305ee0a427eb433ecdf713da99acdb5  vmcore170713_at<br>e790bee57ac89122cc5dd359c2a4e5d6  vmcore170713_au<br>7373a278179dff1ffd55e3f32fc7e9d2  vmcore170713_av<br>de6b70ebb9d7bca5b832f344e8e00190  vmcore170713_aw<br>2726fb387367a6e79b90c6a185503d97  vmcore170713_ax<br>f88a497126cbb7f5679c8178a8e8a0a9  vmcore170713_ay<br>dc33a32b9441bb9c81ec70b1da0998b3  vmcore170713_az<br>18c6170d68650348d977f44b5ba32b96  vmcore170713_ba<br>79c5e1aa4325dac47e3538e45c66aa63  vmcore170713_bb<br>d060b8148cabd63ed3c1dba4476d68d8  vmcore170713_bc<br>c44a881bf14994e7420a4fa826194761  vmcore170713_bd<br>b542182873a56081a2d0691fe8f4224b  vmcore170713_be<br>5418036fc4183af8e6d6c63ac917fe70  vmcore170713_bf<br>7d41474c20d6ce9caa3651824a9aa21a  vmcore170713_bg<br>7366afdad6bfd51837018a3f49d566aa  vmcore170713_bh<br>4c2bdc4ba01c7c0823d151064e18da33  vmcore170713_bi<br>582752b51edcf85f9c685b605d8cdebb  vmcore170713_bj<br>9bc01b11b57f93659fce9af48aecf833  vmcore170713_bk<br>ce47b5ecfee927a26364d9b44b9c91ae  vmcore170713<br> <br>sosreport 파일정보<br> sosreport-PMPRAL03SL-20170713122609.tar.xz<br> sosreport-PMPRAL03SL-20170714091639.tar.xz<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>PMPRAL03SL</hostname><br><br><br><comment id="a0aA000000JvKL5IAN"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2017-07-17T01:29:04Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2017-07-17T01:57:29Z</b><br><br>안녕하세요<br>Red Hat 한진구 입니다.<br><br>우선 보내주신 vmcore를 분석한 결과를 안내드립니다.<br><br>* system 정보<br><br>      KERNEL: /cores/retrace/repos/kernel/x86_64/usr/lib/debug/lib/modules/3.10.0-327.44.2.el7.x86_64/vmlinux<br>    DUMPFILE: /cores/retrace/tasks/181013968/crash/vmcore  [PARTIAL DUMP]<br>        CPUS: 56<br>        DATE: Wed Jul 12 23:35:51 2017<br>      UPTIME: 59 days, 21:58:35<br>LOAD AVERAGE: 59.23, 57.05, 56.92<br>       TASKS: 1356<br>    NODENAME: PMPRAL03SL<br>     RELEASE: 3.10.0-327.44.2.el7.x86_64<br>     VERSION: #1 SMP Thu Nov 24 05:49:35 EST 2016<br>     MACHINE: x86_64  (2597 Mhz)<br>      MEMORY: 767.9 GB<br>       PANIC: &quot;SysRq : Trigger a crash&quot;<br>         PID: 117277<br>     COMMAND: &quot;bash&quot;<br>        TASK: ffff88bc51ccc500  [THREAD_INFO: ffff882a95244000]<br>         CPU: 16<br>       STATE: TASK_RUNNING (SYSRQ)<br><br><br>해당 vmcore는 고객사에서 말씀주신 것 처럼 sysrq로 강제로 crash 한것으로 보입니다.<br>======================<br>* 당시 시스템 Status<br> <br>당시 시스템에 대한 상태를 확인 한 결과,<br><br>해당 시스템은 총 756GB의 물리적 메모리를 가지고 있는 것을 확인 할 수 있었고, 또 현재 해당 물리적 메모리의 99%인 751GB가 모두 사용중인 상태임을 확인 할 수 있었습니다.<br><br>                 PAGES        TOTAL      PERCENTAGE<br>    TOTAL MEM  197995539     755.3 GB         ----<br>         FREE  1126488       4.3 GB    0% of TOTAL MEM<br>         USED  196869051       751 GB   99% of TOTAL MEM<br>       SHARED  1431355       5.5 GB    0% of TOTAL MEM<br>      BUFFERS    14322      55.9 MB    0% of TOTAL MEM<br>       CACHED  21629386      82.5 GB   10% of TOTAL MEM<br>         SLAB   729253       2.8 GB    0% of TOTAL MEM<br>======================<br>그렇다면 어떤 부분에서 메모리를 많이 소모하고 있는가를 확인해 본 결과,  'pmtomatosx_u64_' 라는 프로세스에서 총 653GB의 메모리를 모두 사용중인 것으로 확인됩니다.<br><br>&lt; Top 10 메모리 사용 프로세스 &gt; <br><br>     pmtomatosx_u64_  685217196 KiB<br>                java    2492676 KiB<br>              python      63540 KiB<br>     systemd-journal      45368 KiB<br>                sshd      40472 KiB<br>              hpsmhd      33564 KiB<br>               httpd      30016 KiB<br>                bash      27040 KiB<br>            rsyslogd      26768 KiB<br>             nbdisco      22552 KiB<br><br><br>  PID    PPID  CPU       TASK        ST  %MEM     VSZ    RSS  COMM<br><br>  43243      1  29  ffff88adbd1a6780  IN  20.5 173144844 165498492  pmtomatosx_u64_<br>  43300      1  34  ffff88adbd1a4500  IN  23.0 193548688 185617128  pmtomatosx_u64_<br>  43374      1  38  ffff88bc4b242280  IN  20.6 173334468 166201224  pmtomatosx_u64_<br>  43411      1  26  ffff88bc4b242e00  IN  20.8 175478840 167900352  pmtomatosx_u64_<br>             <br><br><br>결론적으로,<br><br>고객이 수동으로 crash시킨 커널의 vmcore에서 확인한 결과로는, 'pmtomatosx_u64_' 라는 프로세스가 653GB를 포함하여 총 물리적 메로리 755GB 중 751GB(99%)를 모두 소모하고 있는 던 상태인 것으로 확인됩니다.<br><br><br>해당 프로세스의 메모리 점유상태가 정상적인지에 대해서 해당 application 제조사와 확인이 필요하며, 만약 해당 프로세스가 정상적이고 많은 메모리를 소모하는 프로세스라고 한다면 해당 Application의 가이드를 받아서 물리적 메모리 확장을 고려가 필요할 수 있습니다.<br>======================<br><br>감사합니다.<br><br><publishedDate>2017-07-17T01:29:03Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JvK6eIAF"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2017-07-17T00:34:21Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2017-07-17T00:34:21Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br>올려주신 vmcore를 현재 분석중에 있으며, 분석이 완료되며 바로 안내드리도록 하겠습니다.<br><br>참고로, vmcore분석은 business hour 기준으로 2-3일 정도 소요될 수 있습니다. 이점 업무에 참고하여 주시기 바랍니다.<br>======================<br>감사합니다.<br><br><publishedDate>2017-07-17T00:34:21Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000JvErpIAF"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-07-15T00:51:55Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-07-15T00:51:55Z</b><br><br>해당 모든 화일을 업로드 완료하였습니다.<br>전체적으로 해당 파일들이 ftp에 업로드 되었는지<br>확인 부탁드리고 누락된 파일은 어떤것이 있는지 확인 부탁드립니다.<br><br>ce47b5ecfee927a26364d9b44b9c91ae  vmcore170713<br>위 파일은 스플릿 이전의 전체 화일이므로 ftp에는 없는 화일입니다.<br><br><publishedDate>2017-07-15T00:51:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br></comments><br>