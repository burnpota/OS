======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2016-12-28T03:01:00Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-01-22T11:11:37Z</b><br><b>id : 500A000000W7bAeIAJ</b><br>======================<br><br><b><font size=15>
제목  : 파일시스템 df 결과 관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>안녕하세요<br><br>삼성생명 ERP 인프라 구축 지원하고 있는 SDS 김지민 선임입니다.<br><br>아래 FS-PQM AP 서버에서 df 결과로 파일시스템을 조회하였을 때 <br>/LOG 파일시스템은 사용률이 83%로 나오는데요.<br><br>실제 들어가서 보면 12G 정도 용량을 사용하고 있어서<br>차이가 나는 부분에 대해서 문의드리려고 합니다.<br><br>lvol의 metadata와 reserved block 등을 제외하고서도 차이가 조금 나는 것 같아서 문의드립니다.<br><br>root@PQUOAL02SL /LOG # df -Ph<br>Filesystem                               Size  Used Avail Use% Mounted on<br>/dev/sda2                                 30G   13G   18G  43% /<br>devtmpfs                                 378G     0  378G   0% /dev<br>tmpfs                                    711G     0  711G   0% /dev/shm<br>tmpfs                                    378G  307M  378G   1% /run<br>tmpfs                                    378G     0  378G   0% /sys/fs/cgroup<br>/dev/sda1                               1016M  370M  646M  37% /boot<br>/dev/sda3                                 20G  3.2G   17G  16% /var<br>/dev/mapper/LRPQUOSAPVG-usr_sap           10G  2.2G  7.9G  22% /usr/sap<br>/dev/mapper/vg0-home                      10G   71M   10G   1% /home<br>/dev/mapper/vg0-sysadmin                  20G  4.9G   16G  25% /sysadmin<br>/dev/mapper/vg9-CRASH                    311G   39G  273G  13% /CRASH<br>/dev/mapper/LRPQUOSAPVG-oracle           2.0G  215M  1.8G  11% /oracle<br>/dev/mapper/LRPQUOSAPVG-LOG              200G  166G   35G  83% /LOG<br>/dev/mapper/LRPQUOSAPVG-usr_sap_NQU      100G   18G   83G  18% /usr/sap/NQU<br>/dev/mapper/LRPQUOSAPVG-APP               80G   17G   64G  22% /APP<br>/dev/mapper/LRPQUOSAPVG-usr_sap_PQU      200G   22G  179G  11% /usr/sap/PQU<br>100.254.144.209:/QUO_usr_sap_trans        50G   34G   17G  67% /usr/sap/trans<br>100.254.144.209:/QUO_FSQUO               200G   18G  183G   9% /FSQUO<br>100.254.144.209:/QUO_sapmnt_NQU           50G  3.3G   47G   7% /sapmnt/NQU<br>100.254.144.202:/BATCH_bat_sam_SAM_bak   5.0T  119G  4.9T   3% /batch_sam/SAM/backup<br>100.254.144.209:/QUO_FSQUO2              200G   19G  182G  10% /FSQUO2<br>100.254.144.202:/BATCH_bat_sam_SAM_work  5.0T  763G  4.3T  15% /batch_sam/SAM/work<br>100.254.144.209:/QUO_MIG                 980G     0  980G   0% /MIG<br>100.254.144.209:/QUO_sapmnt_PQU           50G  3.8G   47G   8% /sapmnt/PQU<br>100.254.144.209:/QUO_SAPP                 30G   80M   30G   1% /SAPP<br>tmpfs                                     76G     0   76G   0% /run/user/1231<br>tmpfs                                     76G     0   76G   0% /run/user/30307<br>tmpfs                                     76G     0   76G   0% /run/user/31531<br>tmpfs                                     76G     0   76G   0% /run/user/1021<br>tmpfs                                     76G     0   76G   0% /run/user/31883<br>root@PQUOAL02SL /LOG # ls -al<br>total 4<br>drwxr-x---   5 pquadm   sapsys     49 Dec 22 08:21 .<br>dr-xr-xr-x. 31 root     root     4096 Nov 13 16:04 ..<br>drwxr-x---   2 pquadm   sapsys      6 Dec 16 10:53 fsquo<br>drwxr-x---   4 pquadm   sapsys     38 Sep 26 21:14 netweaver<br>drwxr-x---   3 weblogic weblogic   18 May 26  2016 weblogic<br>root@PQUOAL02SL /LOG # du -sh ./*<br>0       ./fsquo<br>836K    ./netweaver<br>12G     ./weblogic<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 4 (Low)</b><br>======================<br><comment id="a0aA000000IXYA7IAP"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2017-01-02T04:20:17Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2017-01-02T04:20:17Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br>방금 유선으로 설명드린 부분을 정리하여 드립니다.<br><br>우선 'df' 명령은 기본적으로  primary superblock의 정보를 읽어오나, 실제 시스템을 운영하면서 파일을 열거나 생성할 경우에 이러한 부분이 반영이 되어 출력이 됩니다.<br>또한 실제 파일시스템에서 삭제가 이뤄졌다고 하더라도 프로세스에서는 이러한 부분의 데이터를 아직 잡고있을 수 있는 등 다양한 상황에 놓일 수 있습니다.<br><br>그래서 'df'의 결과는 실제의 값과는 많은 차이를 가지고 있을 수 밖에 없으며, 그 상황을 정확하게 계산하고 확인하는 방법은 없는 것으로 확인됩니다.<br><br><br>다만, 'lsof'를 통해서 혹시라고 현재 열려있는 파일들을 확인해봄으로써 그 Gap의 부분을 확인하는데는 조금 도움이 될 것으로 보입니다.<br>======================<br><br>감사합니다.<br><br><publishedDate>2017-01-02T04:20:17Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IXHEzIAP"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2016-12-29T05:35:35Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2016-12-29T05:35:35Z</b><br><br>안녕하세요,<br>Red Hat 한진구 입니다.<br><br>문의주신 내용의 부분에 대해서 확인이 가능한지? 어떻게 확인할 수 있느지 확인해보고 업데이트 드리겠습니다.<br>======================<br>감사합니다.<br><br><publishedDate>2016-12-29T05:35:35Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IXGWBIA5"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2016-12-29T02:04:09Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2016-12-29T02:04:09Z</b><br><br>네 답변 감사드립니다.<br><br>혹시 그럼 <br><br>실제 LRPQUOSAPVG_LOG라는 volume은 200G이고 du의 결과에서는 12G를 사용하는 것처럼은 보이는데요.<br>그럼 혹시 나머지 144G는 어떻게 사용되는지 확인하는 방법에 대해서 문의드리려고 합니다.<br><br>/LOG 파일시스템의 용도는 weblogic의 log를 저장하는 용도로 확인을 하였습니다.<br>추가로 확인하는데 필요하신 내역이 있으면 요청 부탁드립니다.<br><br>/dev/mapper/LRPQUOSAPVG-LOG              200G  166G   35G  83% /LOG<br><br>root@PQUOAL02SL' /LOG # du -sh ./*<br>0       ./fsquo<br>836K    ./netweaver<br>12G     ./weblogic<br><br><publishedDate>2016-12-29T02:04:09Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IXGDiIAP"><br>======================<br><b>생성계정 : HAN, JINKOO</b><br><b>생성날짜 : 2016-12-29T01:12:52Z</b><br><b>마지막 답변자 : HAN, JINKOO</b><br><b>마지막 수정 일자 : 2016-12-29T01:12:52Z</b><br><br>안녕하세요,<br>Red Hat Technical Account Manager 한진구 입니다.<br><br>우선 일반적으로 'df'명령어는 파일시스템의 primary superblock으로 부터 정보를 가지고 와서 빠르게 결과를 보여주기 위한 툴로써 사용됩니다.<br><br>'df'의 경우 실제 object의 사이즈를 확인하는 것이 아니다보니, 실제 파일의 사이즈와는 차이를 많이 갖기도 합니다.<br>또한 'df'는 open files(실제 디스크가 아니지만 메모리상), data/index 파일들과 unnamed files의 정보를 포함해서 자주 'df'는 실제 디스크 사용량보다도 많이 사용되는 것으로 report를 하고 있습니다.<br><br><br>'df' 툴은 일반적으로 빠르게 확인만을 하기 위해서 사용하는 것으로 참고하시고 사용하는 것으로써 실제 디스크의 사이즈가 얼마나 사용되고 여유공간이 있는데를 검사할때에 사용하기에는 조금 어려움이 있을 것으로 보입니다.<br><br><br>감사합니다.<br><br><publishedDate>2016-12-29T01:12:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br><br>삼성생명 ERP 인프라 구축 지원하고 있는 SDS 김지민 선임입니다.<br><br>아래 FS-PQM AP 서버에서 df 결과로 파일시스템을 조회하였을 때 <br>/LOG 파일시스템은 사용률이 83%로 나오는데요.<br><br>실제 들어가서 보면 12G 정도 용량을 사용하고 있어서<br>차이가 나는 부분에 대해서 문의드리려고 합니다.<br><br>lvol의 metadata와 reserved block 등을 제외하고서도 차이가 조금 나는 것 같아서 문의드립니다.<br><br>root@PQUOAL02SL /LOG # df -Ph<br>Filesystem                               Size  Used Avail Use% Mounted on<br>/dev/sda2                                 30G   13G   18G  43% /<br>devtmpfs                                 378G     0  378G   0% /dev<br>tmpfs                                    711G     0  711G   0% /dev/shm<br>tmpfs                                    378G  307M  378G   1% /run<br>tmpfs                                    378G     0  378G   0% /sys/fs/cgroup<br>/dev/sda1                               1016M  370M  646M  37% /boot<br>/dev/sda3                                 20G  3.2G   17G  16% /var<br>/dev/mapper/LRPQUOSAPVG-usr_sap           10G  2.2G  7.9G  22% /usr/sap<br>/dev/mapper/vg0-home                      10G   71M   10G   1% /home<br>/dev/mapper/vg0-sysadmin                  20G  4.9G   16G  25% /sysadmin<br>/dev/mapper/vg9-CRASH                    311G   39G  273G  13% /CRASH<br>/dev/mapper/LRPQUOSAPVG-oracle           2.0G  215M  1.8G  11% /oracle<br>/dev/mapper/LRPQUOSAPVG-LOG              200G  166G   35G  83% /LOG<br>/dev/mapper/LRPQUOSAPVG-usr_sap_NQU      100G   18G   83G  18% /usr/sap/NQU<br>/dev/mapper/LRPQUOSAPVG-APP               80G   17G   64G  22% /APP<br>/dev/mapper/LRPQUOSAPVG-usr_sap_PQU      200G   22G  179G  11% /usr/sap/PQU<br>100.254.144.209:/QUO_usr_sap_trans        50G   34G   17G  67% /usr/sap/trans<br>100.254.144.209:/QUO_FSQUO               200G   18G  183G   9% /FSQUO<br>100.254.144.209:/QUO_sapmnt_NQU           50G  3.3G   47G   7% /sapmnt/NQU<br>100.254.144.202:/BATCH_bat_sam_SAM_bak   5.0T  119G  4.9T   3% /batch_sam/SAM/backup<br>100.254.144.209:/QUO_FSQUO2              200G   19G  182G  10% /FSQUO2<br>100.254.144.202:/BATCH_bat_sam_SAM_work  5.0T  763G  4.3T  15% /batch_sam/SAM/work<br>100.254.144.209:/QUO_MIG                 980G     0  980G   0% /MIG<br>100.254.144.209:/QUO_sapmnt_PQU           50G  3.8G   47G   8% /sapmnt/PQU<br>100.254.144.209:/QUO_SAPP                 30G   80M   30G   1% /SAPP<br>tmpfs                                     76G     0   76G   0% /run/user/1231<br>tmpfs                                     76G     0   76G   0% /run/user/30307<br>tmpfs                                     76G     0   76G   0% /run/user/31531<br>tmpfs                                     76G     0   76G   0% /run/user/1021<br>tmpfs                                     76G     0   76G   0% /run/user/31883<br>root@PQUOAL02SL /LOG # ls -al<br>total 4<br>drwxr-x---   5 pquadm   sapsys     49 Dec 22 08:21 .<br>dr-xr-xr-x. 31 root     root     4096 Nov 13 16:04 ..<br>drwxr-x---   2 pquadm   sapsys      6 Dec 16 10:53 fsquo<br>drwxr-x---   4 pquadm   sapsys     38 Sep 26 21:14 netweaver<br>drwxr-x---   3 weblogic weblogic   18 May 26  2016 weblogic<br>root@PQUOAL02SL /LOG # du -sh ./*<br>0       ./fsquo<br>836K    ./netweaver<br>12G     ./weblogic</issue><cep>false</cep></case>