======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2018-02-26T02:52:25Z</b><br><b>마지막 답변자 : Jay Shin</b><br><b>마지막 수정 일자 : 2018-11-05T03:52:09Z</b><br><b>id : 500A000000ZrFcAIAV</b><br>======================<br><br><b><font size=15>
제목  : SWAP 사용률 관련 /proc/sys/vm/swappiness 조정 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>SWAP 사용률 관련 /proc/sys/vm/swappiness 값 조정 문의를 드리려고 합니다.<br><br>아래와 같이 swap 사용률이 조금 높은 서버가 있습니다.<br><br>실제 memory 사용률은 낮은 편이어서<br><br>혹시 /proc/sys/vm/swappiness 값의 조정을 통해서 실제 memory 사용률을 낮추는 것을 적용해보려고 하는데요.<br><br>echo를 통해서 적용하면 온라인 중으로 적용이되어서 동작하게 되는지 문의드리려고 합니다.<br><br>해당 서버는 물리장비이고 8GB*8EA memory가 장착되어있습니다.<br><br>감사합니다.<br><br>root@FLPIDMM01 /root # cat /etc/redhat-release<br>Red Hat Enterprise Linux Server release 6.4 (Santiago)<br><br>root@FLPIDMM01 /root # free -g<br>             total       used       free     shared    buffers     cached<br>Mem:            62         62          0          0          0         46<br>-/+ buffers/cache:         15         47<br>Swap:           63         41         22<br><br>root@FLPIDMM01 /root # cat /proc/sys/vm/swappiness<br>60<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 6.4</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>FLPIDMM01</hostname><br><br><br><comment id="a0aA000000O6l4oIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-11-05T03:52:06Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-11-05T03:52:06Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>본 기술 문의의 상태를 처리완료 상태로 변경하고자 합니다.<br><br>만약 본 기술 문의와 관련하여 추가 질문이 있으시다면 언제든지 본 기술 문의를 *재개*하실 수 있습니다.<br><br>기술 문의가 처리 완료되면 *고객 설문조사* 메일이 발송됩니다. 고객님께서 남기신 의견은 보다 나은 서비스를 위해 지속적으로 반영될 것입니다.<br>향후 기술 지원 서비스의 품질 향상을 위해, 소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>만약 본 이슈와 관련하여 추가적인 문의 사항이 있으실 경우 연락 주시기 바랍니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-11-05T03:52:06Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000O66ncIAB"><br>======================<br><b>생성계정 : Shin, Jay</b><br><b>생성날짜 : 2018-11-01T00:37:15Z</b><br><b>마지막 답변자 : Shin, Jay</b><br><b>마지막 수정 일자 : 2018-11-01T00:37:14Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 입니다.<br><br>본 케이스와 연관되어 더 궁금한 사항이 있거나 추가적인 지원이 필요하신가요?<br><br>본 안내 후 일주일 이내에 별다른 답변이 없다면 자동으로 종료 상태가 된다는 것을 알려 드립니다.<br><br>만약 추가적인 지원이 필요하다면, 연락 부탁드립니다.<br><br>감사합니다.<br><br>Jay Shin,<br>Senior TSE, Brisbane, APAC<br>Red Hat Customer Experience and Engagement<br><br><publishedDate>2018-11-01T00:37:14Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000O2dMeIAJ"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-10-17T01:00:52Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-10-17T01:00:52Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>먼저 마지막 문의주신 내용에 대한 업데이트를 제가 못드린것 같습니다.<br>죄송합니다. 이전 문의 내용에 대한 답변을 드립니다.<br><br>Q1) swap 사용률이 높으면 결국 memory를 사용해야할 프로세스들이 disk를 사용하는 상황이 되는 것인데 문제가 되지 않는 것인가요?<br><br>A1) 해당 케이스를 최초 오픈 이후 swappiness 값을 줄였음에도 swap 사용율의 변화가 없다는 적용결과를 기반으로 보면, 한동안 swap을 사용하는 프로세스가 없다는 것으로 판단되었습니다.<br>따라서 어플리케이션 수준의 성능 문제가 아닌, 리눅스에서 문제가 되지 않는다는 내용을 업데이트 드린 것입니다.<br><br><br>Q2) 2.6.32-504 커널 이하의 버전이면 swap 관련해서 사용이 증가되는 bug가 있는 것인지 문의드리려고 합니다.<br><br>A2) 네 이전에 안내해드린 KCS에서 보신게 맞습니다. 해당 버그질라의 내용을 확인해본 결과 모든 시스템에 해당하는 것은 아닌것으로 확인되며, 주로 I/O가 많은 시스템에서 발생한 것으로 확인됩니다.<br>필요하신 경우 테스트를 거치신 후 적용하는 것도 좋은 방법이 될 수 있을 것입니다. 이 밖에 해당 버그 관련하여 추가적인 안내가 어려운 부분 양해 부탁드립니다.<br><br>마지막으로 진행되는 상황에 대해서 항상 결과 공유 감사드립니다.<br><br><publishedDate>2018-10-17T01:00:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000O2cmvIAB"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-10-16T23:52:09Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-10-16T23:52:09Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>이전에 문의드렸던 swap 사용량이 높았던 서버는<br><br>root@FLPIDMM01 /root # free -g<br>             total       used       free     shared    buffers     cached<br>Mem:            62         61          1          0          1         18<br>-/+ buffers/cache:         41         20<br>Swap:           63          0         63<br><br>root@FLPIDMM01 /root # cat /proc/sys/vm/swappiness<br>10<br><br>/proc/sys/vm/swappiness 값 조정 후 프로세스를 재가동하니 swap 사용량이 줄어들었습니다.<br>위에 결과를 첨부하였습니다.<br><br>감사합니다.<br><br><publishedDate>2018-10-16T23:52:09Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000M6ROOIA3"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-04-02T08:34:27Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-04-02T08:34:26Z</b><br><br>안녕하세요<br><br>추가로 문의드릴 점은 <br><br>보내주신 link에 있는 Swap usage 관련 정보를 확인 중<br><br>아래와 같은 내용이 있었는데 혹시 2.6.32-504 커널 이하의 버전이면 swap 관련해서 사용이 증가되는 bug가 있는 것인지 문의드리려고 합니다.<br><br>Regarding full swap, multiple points should be taken into consideration:<br> 0. On RHEL6, a bug which did lead to increased swap usage is resolved in kernel-2.6.32-504.el6 (RHSA-2014-1392) and later. Private RHBZ #949166 has details.<br><br><publishedDate>2018-04-02T08:34:26Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000M6QVTIA3"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-04-02T06:50:56Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-04-02T06:50:55Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다. <br><br>한가지 문의드릴 점은 swap 사용률이 높으면 결국 memory를 사용해야할 프로세스들이 <br><br>disk를 사용하는 상황이 되는 것인데 문제가 되지 않는 것인가요?<br><br>아래 서버와 같은 경우는 63 중에서 39를 사용하고 있는 것으로 나와서 다량 사용하고 있는 것 같아서 문의드립니다.<br><br>root@FLPIDMM01 /root # free -g<br>             total       used       free     shared    buffers     cached<br>Mem:            62         61          1          0          0         39<br>-/+ buffers/cache:         21         41<br>Swap:           63         39         24<br><br>감사합니다.<br><br><publishedDate>2018-04-02T06:50:55Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000M6OZrIAN"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-04-02T01:14:01Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-04-02T01:16:36Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>swappiness 값을 적용하였으나 swap 사용률에 변화가 없다면, 현재는 swap을 사용하는 프로세스가 없기 때문일 것입니다.<br><br>swap을 줄이는 방법에는 swap을 flush 하거나 해당 프로세스를 죽이는 방법이 있습니다.<br>현재 시점에서 swap flush를 할 경우 out of memory 상태가 발생할 수 있으므로, swap 사용영역을 낮추고 싶으시다면<br>아래 KCS의 &quot;Resolution 2: Find process's memory regions that are using the most swap&quot; 부분을 참조하셔서<br>swap을 사용하는 프로세스를 찾아서 kill 하거나 재시작하는 것이 방법이 될 수 있습니다.<br><br>&quot;Swap usage is at 100% and need to find out what processes are using swap and reduce swap usage&quot;<br>https://access.redhat.com/solutions/33375<br><br>하지만 기본적으로 리눅스에서는 swap 사용률이 높다고 해서 문제되지 않기 때문에 가급적이면, 유지보수 일정을 잡고 swap을 flush하시거나 시스템 또는 프로그램 재시작을 하시는 것이 좋을것 같습니다.<br><br>감사합니다.<br><br><publishedDate>2018-04-02T01:14:01Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000M69UJIAZ"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-03-30T02:48:05Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-03-30T02:48:05Z</b><br><br>안녕하세요 <br><br>SDS 김지민 선임입니다.<br><br>/proc/sys/vm/swappiness 값에 대해서 문의 후 <br>swap 사용률이 높은 FLPIDMM01 서버에 대해서 /proc/sys/vm/swappiness 값을 적용(60 → 10)하였는데요.<br><br>3일 정도 지났는데 swap 사용량은 그대로여서 혹시 swap 사용량을 줄이기 위해서 추가로 확인할만한 부분이 있는지 문의드리려고 합니다.<br><br>root@FLPIDMM01 /root # cat /proc/sys/vm/swappiness<br>10<br><br>root@FLPIDMM01 /root # free -g<br>             total       used       free     shared    buffers     cached<br>Mem:            62         61          1          0          1         37<br>-/+ buffers/cache:         23         39<br>Swap:           63         39         24<br><br><publishedDate>2018-03-30T02:48:05Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000LrZDBIA3"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-02-28T04:30:30Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-02-28T04:31:25Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대한 답변드립니다.<br><br>Q) 해당 프로세스가 /proc/sys/vm/swappiness 값을 낮춘 후 부터는 swap 사용 빈도가 줄어드는지 문의드리려고 합니다.<br><br>A) swappiness 값을 낮추고 난 이후 swap을 사용하는 프로세스가 있다면 해당 프로세스에 의해서 사용되는 swap의 빈도는 줄어들게 됩니다.<br>반대로 swap을 사용하는 프로세스가 존재하지 않는다면 swap 사용량에 특별한 변화점을 찾으실 수 없을 것입니다.<br><br>감사합니다.<br><br><publishedDate>2018-02-28T04:30:28Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000LrWNIIA3"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-02-27T23:08:51Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-02-27T23:08:51Z</b><br><br>안녕하세요<br><br>답변 감사드립니다.<br><br>그럼 실제 swap을 사용하고 있는 프로세스가 동작하는 상황에서 적용했을 <br>해당 프로세스가 /proc/sys/vm/swappiness 값을 낮춘 후 부터는 <br>swap 사용 빈도가 줄어드는지 문의드리려고 합니다.<br><br><publishedDate>2018-02-27T23:08:51Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000Lqzi4IAB"><br>======================<br><b>생성계정 : Park, HyunYick</b><br><b>생성날짜 : 2018-02-26T09:10:30Z</b><br><b>마지막 답변자 : Park, HyunYick</b><br><b>마지막 수정 일자 : 2018-02-26T09:14:34Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>문의하신 내용에 대한 답변 드립니다.<br><br>Q1) echo를 통해서 적용하면 온라인 중으로 적용이되어서 동작하게 되는지 문의드리려고 합니다.<br><br>A1) 네 적용이 됩니다. 아래의 두 가지 방법중 하나로 설정하실 수 있습니다.<br><br>먼저 /etc/sysctl.conf 파일을 수정하여 적용하는 방법입니다.<br><br> 1. 아래의 kernel parameter를 /etc/sysctl.conf 파일에 붙여넣고 저장합니다.<br>  # vi /etc/sysctl.conf<br><br>   vm.swappiness = 40<br><br> 2. /etc/sysctl.conf 에 저장한 parameter 값을 아래 명령어로 바로 적용합니다.<br>  # sysctl -p<br><br><br>다음은 echo를 이용하여 직접 값을 입력하는 방법입니다.<br><br>  # echo '40' &gt; /proc/sys/vm/swappiness<br>  # sysctl  -a | grep swappiness<br>추가적으로 vm.swappiness 값을 0으로 설정하는 것을 권장하지 않고 있습니다. 자세한 내용은 아래 KCS에서 확인 부탁드립니다.<br><br>&quot;Why does my system utilize swap space instead of freeing up cache and buffer memory?&quot;<br>https://access.redhat.com/solutions/3367<br><br>감사합니다.<br><br><publishedDate>2018-02-26T09:10:29Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>