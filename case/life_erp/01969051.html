======================<br><b>생성계정 : 삼성생명 타임게이트</b><br><b>생성날짜 : 2017-11-08T07:04:52Z</b><br><b>마지막 답변자 : GSS Tools</b><br><b>마지막 수정 일자 : 2017-11-26T11:04:05Z</b><br><b>id : 500A000000Z27JQIAZ</b><br>======================<br><br><b><font size=15>
제목  : nfs filesystem inode 사용률 증가 관련
</font></b><br><br>======================<br><b>사전문의<br></b><br>nfs를 사용하는 파일시스템 3개가 있습니다.<br>이 3개의 파일 시스템이 아이노드 사용률이 모두 같고 지속적으로 증가하고 있습니다.<br>그러나 df -h로 봤을때는 파일이 없습니다.<br>그리고 해당 파일시스템 /msg/out/ 하부에는 지속적으로 파일을 쓰고 지우는 작업이 진행되고 있습니다.<br>이에 df -i로 봤을때 아이노드 사용률이 맞는지 궁금합니다. <br>아니라면 정확한 아이노드 사용률이 무엇인지 확인하는 방법을 알려주십시요.<br>sosreport는 DMPRAL06SL_sosreport.tar.gz으로 드롭박스에 업로드 하였습니다.<br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>DMPRAL06SL</hostname><br><br><br><comment id="a0aA000000KxTxgIAF"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2017-11-10T05:21:39Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2017-11-10T05:21:39Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>리눅스 커널에서 파일을 핸들링할시에 ( 읽고,생성,삭제 등 ) 성능,재사용, 캐쉬의 목적으로 각 파일에 대한 정보인 dentry 와 inode 정보를 커널이 사용하는 메모리내에 일정시간 유지하게 됩니다.<br>지금 보고 계신것도 마찬가지로 커널이 NFS 마운트로 파일을 핸들링할때 마다 개벌 파일들의 정보를 커널메모리에 저장이 되어있는것을 df -i 가 보여주고 있는것으로 이해하실수 있을것입니다.<br><br>아래의 두 명령중에 하나를 실행하셔서 원하시는 출력이 나오는지 확인해보시고, 추가문의가 있으시다면 다시 코멘트 남겨주십시오.<br><br>* Free pagecache, dentries and inodes<br>$ echo 3 &gt;/proc/sys/vm/drop_caches<br><br>* Free dentries and inodes only<br>$ echo 2 &gt;/proc/sys/vm/drop_caches<br><br>감사합니다.<br><br><publishedDate>2017-11-10T05:21:39Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxTbuIAF"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-11-10T04:19:00Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-11-10T04:19:00Z</b><br><br>안녕하세요<br><br>타임게이트 허 민 입니다.<br><br>보내주신 답변 내용을 보면 df -i로 보여지는 inode 값은 해당 NAS의 정보를 가져와서 보여주기만 하는 것 이라는 말씀이신지요?<br>따라서 해당 NAS에서 가지고 있는 cache 된 데이터 들의 정보이기 때문에 해당 디렉토리에서 파일을 쓰거나 삭제 하여도 NAS에서 <br>정보를 가져와서 보여주기 떄문에 문제 될 것이 없다는 말씀이신지요?<br><br><publishedDate>2017-11-10T04:19:00Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KxSaXIAV"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2017-11-10T01:47:12Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2017-11-10T01:48:57Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>추가로 안내드리자면 파일이 하나도 없는 상태인데도 불구하고 IUsed 의 수가 보여진다면, 이는 파일시스템 캐쉬에서 가져온 값일것이니,<br>아래의 명령어로 drop cache 하여 정상적으로 보여지는지 확인해보시길 바랍니다. - 참고문서[1]<br><br>Commands<br><br>Optional: start with the sync command to have the kernel write as many dirty cache pages to disk as it can (to maximize the number of data cache pages that can be dropped)<br><br>Trigger cache-dropping by using sysctl -w vm.drop_caches=&lt;number&gt; or by writing directly to /proc/sys/vm/drop_caches as follows:<br><br>* Free pagecache, dentries and inodes<br>$ echo 3 &gt;/proc/sys/vm/drop_caches<br><br>* Free dentries and inodes only<br>$ echo 2 &gt;/proc/sys/vm/drop_caches<br><br>* Free the pagecache only<br>$ echo 1 &gt;/proc/sys/vm/drop_caches<br><br><br>[ 참고문서 ]<br><br>[1] What is the purpose of /proc/sys/vm/drop_caches in Red Hat Enterprise Linux?<br>- https://access.redhat.com/solutions/5409<br><br>감사합니다.<br><br><publishedDate>2017-11-10T01:47:11Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxSXiIAN"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2017-11-10T01:41:52Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2017-11-10T01:41:52Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합ㄴ디ㅏ.<br><br>말씀하신 df -i 의 출력물에서 Inodes/IUsed/IFree 의 값은 옵션없이 실행한 df 의 출력에서 나타나는 block 을 대신한것으로 보여주는것입니다.<br><br>좀 더 다르게 설명을 드리자면 현재 해당 디렉토리에 파일을 쓰거나 삭제하지 않더라도 NFS Share 에 이미 쓰여져 있는 파일시스템 정보들을 기<br>반으로 출력이 되는 전체 Inode 수, 사용중인 inode 수, 사용이 가능한 inode 수로 표현이 되는것이기 때문에 문제가 될만한것이 없는것으로 보<br>셔도 될것 같습니다.<br><br><br>[ 참고문서 ]<br><br>[1] Command &quot;df -Phi&quot; print the inode number like '117K'<br>- https://access.redhat.com/solutions/1461783<br><br>감사합니다.<br><br><publishedDate>2017-11-10T01:41:52Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxSMVIA3"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-11-10T01:22:14Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-11-10T01:22:13Z</b><br><br>재 확인후 답변 부탁드립니다. 감사합니다.<br><br><publishedDate>2017-11-10T01:22:13Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KxSAUIA3"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2017-11-10T00:55:15Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2017-11-10T00:55:15Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>추가로 문의하신 내용이 어떤 의도인지 잘 이해가 되지 않습니다. 제가 이해할 수 있도록 좀 더 구체적인 질문을 해주시길 부탁드립니다.<br><br>감사합니다.<br><br><publishedDate>2017-11-10T00:55:15Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000KxCvWIAV"><br>======================<br><b>생성계정 : 타임게이트, 삼성생명</b><br><b>생성날짜 : 2017-11-09T06:30:33Z</b><br><b>마지막 답변자 : 타임게이트, 삼성생명</b><br><b>마지막 수정 일자 : 2017-11-09T06:30:33Z</b><br><br>안녕하세요<br><br>타임게이트 허 민 입니다.<br>보내주신 내용대로 하여 확인 해 본결과 파일이 동일 하게 보였으며 inode값 또한 clear되지 않고 동일하게 보여졌습니다.(inode값이 clear 되지 않음)<br><br>root@DMPRAL01SL /root # ls /msg/out/<br>1000026880_10000000593414503_0911230110RS.txt   1000026880_10000000593414509_0911230487RS1.xml  1000026880_10000000593414509_0911230551TC1.xml<br>1000026880_10000000593414503_0911230110RS1.xml  1000026880_10000000593414509_0911230487TC1.xml  1000026880_10000000593414509_0911230850RQ.txt<br>1000026880_10000000593414503_0911230110TC1.xml  1000026880_10000000593414509_0911230551RQ.txt   1000026880_10000000593414509_0911230850RQ1.xml<br>1000026880_10000000593414509_0911230487RQ.txt   1000026880_10000000593414509_0911230551RQ1.xml  1000026880_10000000593414509_0911230850RS.txt<br>1000026880_10000000593414509_0911230487RQ1.xml  1000026880_10000000593414509_0911230551RS.txt   1000026880_10000000593414509_0911230850RS1.xml<br>1000026880_10000000593414509_0911230487RS.txt   1000026880_10000000593414509_0911230551RS1.xml  1000026880_10000000593414509_0911230850TC1.xml<br>root@DMPRAL01SL /root # touch /msg/out<br>root@DMPRAL01SL /root # ls /msg/out/<br>1000026880_10000000593414503_0911230110RS.txt   1000026880_10000000593414509_0911230487RS1.xml  1000026880_10000000593414509_0911230551TC1.xml<br>1000026880_10000000593414503_0911230110RS1.xml  1000026880_10000000593414509_0911230487TC1.xml  1000026880_10000000593414509_0911230850RQ.txt<br>1000026880_10000000593414503_0911230110TC1.xml  1000026880_10000000593414509_0911230551RQ.txt   1000026880_10000000593414509_0911230850RQ1.xml<br>1000026880_10000000593414509_0911230487RQ.txt   1000026880_10000000593414509_0911230551RQ1.xml  1000026880_10000000593414509_0911230850RS.txt<br>1000026880_10000000593414509_0911230487RQ1.xml  1000026880_10000000593414509_0911230551RS.txt   1000026880_10000000593414509_0911230850RS1.xml<br>1000026880_10000000593414509_0911230487RS.txt   1000026880_10000000593414509_0911230551RS1.xml  1000026880_10000000593414509_0911230850TC1.xml<br>root@DMPRAL01SL /root #<br><br>df -i 로 확인한 결과 inode 값 사용율은 50%대를 유지하였으며 파일이 하나도 없었을 경우에도 50%였습니다.<br>nas는 HNAS 장비로 HITACHI 제품입니다.<br>추가로 더 확인 해야 할 사항 있으시면 답변 부탁드립니다.<br><br><publishedDate>2017-11-09T06:30:33Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000KwvoVIAR"><br>======================<br><b>생성계정 : Moon, Jack, Jong Young</b><br><b>생성날짜 : 2017-11-08T08:18:50Z</b><br><b>마지막 답변자 : Moon, Jack, Jong Young</b><br><b>마지막 수정 일자 : 2017-11-08T08:18:50Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Service 를 이용해주셔서 감사합니다.<br><br>현재 직면하신 이슈는 아래의 참고문서[1]에서 보고된것과 일치하는것으로 보입니다. 아래의 명령으로 파일들이 갱신이 되는지 확인부탁드립니다.<br><br>$ touch /msg/out/<br><br>좀 더 자세한 내용과 근본원인은 참고문서[1]의 Root Cause 를 살펴보시고, 다른 문의사항이 있으시면 피드백 주십시오.<br><br><br>[ 참고문서 ]<br><br>[1]  NFS client does not show all the files available on the NFS server <br>- https://access.redhat.com/solutions/21719<br><br>감사합니다.<br><br><publishedDate>2017-11-08T08:18:50Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>