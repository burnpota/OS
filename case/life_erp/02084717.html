======================<br><b>생성계정 : jimin kim</b><br><b>생성날짜 : 2018-04-24T01:21:14Z</b><br><b>마지막 답변자 : Kyung Huh</b><br><b>마지막 수정 일자 : 2018-04-25T00:21:08Z</b><br><b>id : 500A000000aPmKeIAK</b><br>======================<br><br><b><font size=15>
제목  : rpcbind.socket과 rpcbind.service 관계 문의
</font></b><br><br>======================<br><b>사전문의<br></b><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br><br>7.X redhat 서버에서 rpcbind.socket과 rpcbind.service의 관계에 대해서<br>문의를 드리려고 합니다.<br><br>몇몇 서버들에서 설정이 rpcbind.service는 start되어있고 rpcbind.socket이 stop 되어있는 서버가 있고<br>두가지 서비스 모두 start 되어있는 서버들이 있어서 관계에 대해서 문의드리려고 합니다.<br><br>감사합니다.<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>타입  : Other</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><hostname>SLTLFDSEL01</hostname><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000MQAHVIA5"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-04-25T00:21:05Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-04-25T00:21:05Z</b><br><br>충분한 답변이 되셨다면 케이스를 종료하겠습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-04-25T00:21:05Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MPtL3IAL"><br>======================<br><b>생성계정 : kim, jimin</b><br><b>생성날짜 : 2018-04-24T06:32:28Z</b><br><b>마지막 답변자 : kim, jimin</b><br><b>마지막 수정 일자 : 2018-04-24T06:32:27Z</b><br><br>안녕하세요<br><br>SDS 김지민 선임입니다.<br><br>상세한 답변 감사드립니다.<br><br>감사합니다.<br><br><publishedDate>2018-04-24T06:32:27Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000MPsyhIAD"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-04-24T06:03:02Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-04-24T06:03:02Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br><br>기본적으로 rpcbind.service는 rpcbind.socket을 의존하여 작동합니다. <br>간단히 말씀드리면 rpcbind.socket은 111번 포트를 열어주는 역할을 하고 rpcbind.service는 /sbin/rpcbind 프로세스를 실행하는 역할을 합니다. <br>그렇기 때문에 rpcbind.service가 제대로 작동하기 위해서는 rpcbind.socket이 작동하고 있어야 합니다.<br><br>systemd unit 또는 target에 대한 의존관계는 아래와 같이 확인하실 수 있습니다.<br><br># systemctl list-dependencies rpcbind.service<br>rpcbind.service<br>● ├─rpcbind.socket<br>● ├─system.slice<br>● └─basic.target<br><br>이 두가지 systemd unit에 대한 상세설정은 /usr/lib/systemd/system 디렉터리에 있는 rpcbind.socket rpcbind.service 파일에서 확인하실 수 있습니다. 이 파일들은 systemd를 통해 제공하는 rpcbind 관련 systemd unit에 대한 기본 설정 파일입니다.<br><br>rpcbind.service<br>~~~~~~~~~~~~~~~<br>[Unit]<br>Description=RPC bind service<br>Requires=rpcbind.socket<br>After=systemd-tmpfiles-setup.service<br><br>[Service]<br>Type=forking<br>EnvironmentFile=/etc/sysconfig/rpcbind<br>ExecStart=/sbin/rpcbind -w $RPCBIND_ARGS<br><br>[Install]<br>Also=rpcbind.socket<br><br>rpcbind.socket<br>~~~~~~~~~~~~~~<br>[Unit]<br>Description=RPCbind Server Activation Socket<br><br>[Socket]<br>ListenStream=/var/run/rpcbind.sock<br>ListenStream=[::]:111<br>ListenStream=0.0.0.0:111<br>BindIPv6Only=ipv6-only<br><br>[Install]<br>WantedBy=sockets.target<br><br>몇 가지 예를 들어서 rpcbind.service와 rpcbind.socket이 동작하는 방식을 설명드리겠습니다.<br>1. 두 가지 모두 비활성화되어 있을 때<br>이 경우에는 rpc를 필요로 하는 서비스가 동작하지 않습니다. 아래와 같이 rpcinfo 명령을 해보면 작동하지 않는 것을 알 수 있습니다.<br><br># rpcinfo -p<br>rpcinfo: can't contact portmapper: RPC: Remote system error - Connection refused<br><br>2. rpcbind.socket은 활성화되어 있고 rpcbind.service는 비활성화 되어 있는 경우<br><br>netstat 명령으로 111번 포트가 리스닝하고 있는 것을 확인하실 수 있습니다.<br><br># netstat -ntuple | grep 111<br>tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      0          7984534    1/systemd<br>tcp6       0      0 :::111                  :::*                    LISTEN      0          7984533    1/systemd<br><br>이 때 만약 1번 예와 같이 rpcinfo -p 명령을 수행하면 rpcbind.service 가 자동으로 시작합니다.<br># rpcinfo -p<br>   program vers proto   port  service<br>    100000    4   tcp    111  portmapper<br>    100000    3   tcp    111  portmapper<br>    100000    2   tcp    111  portmapper<br>    100000    4   udp    111  portmapper<br>    100000    3   udp    111  portmapper<br>    100000    2   udp    111  portmapper<br><br>netstat 명령을 다시 실행할 경우 결과가 약간 달라집니다. <br># netstat -ntuple | grep 111<br>tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      0          7984534    1/systemd<br>tcp6       0      0 :::111                  :::*                    LISTEN      0          7984533    1/systemd<br>udp        0      0 0.0.0.0:111             0.0.0.0:*                           0          7984683    13688/rpcbind<br>udp6       0      0 :::111                  :::*                                0          7984685    13688/rpcbind<br><br>멈춰있던 rpcbind.service가 active(running) 상태로 변경됩니다.<br><br># systemctl status rpcbind.service<br>● rpcbind.service - RPC bind service<br>   Loaded: loaded (/usr/lib/systemd/system/rpcbind.service; indirect; vendor preset: enabled)<br>   Active: active (running) since Tue 2018-04-24 14:54:51 KST; 48s ago<br>  Process: 13687 ExecStart=/sbin/rpcbind -w $RPCBIND_ARGS (code=exited, status=0/SUCCESS)<br> Main PID: 13688 (rpcbind)<br>   CGroup: /system.slice/rpcbind.service<br>           └─13688 /sbin/rpcbind -w<br><br>Apr 24 14:54:51 khuh systemd[1]: Starting RPC bind service...<br>Apr 24 14:54:51 khuh systemd[1]: Started RPC bind service.<br><br>rpcbind.socket 을 정지하면 rpcbind 프로세스가 작동할 수 없기 때문에 rpcbind.service도 함께 정지됩니다.<br><br>제 답변이 도움이 되셨으면 좋겠습니다.<br><br>허 경 드림.<br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-04-24T06:03:02Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000MPrpVIAT"><br>======================<br><b>생성계정 : Huh, Kyung</b><br><b>생성날짜 : 2018-04-24T04:05:18Z</b><br><b>마지막 답변자 : Huh, Kyung</b><br><b>마지막 수정 일자 : 2018-04-24T04:05:18Z</b><br><br>안녕하세요? 레드햇 허경입니다.<br>Red Hat 기술지원 서비스를 이용해 주셔서 감사합니다.<br><br>문의하신 내용에 대해서 확인한 후 업데이트 드리겠습니다.<br><br>고맙습니다.<br>허 경 드림.<br><br>Regards,<br>Kyung Huh<br>Sr. Technical Account Manager<br>Customer Experience &amp; Engagement<br><br><publishedDate>2018-04-24T04:05:18Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>