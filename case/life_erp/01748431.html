======================<br><b>생성계정 : 타임 게이트</b><br><b>생성날짜 : 2016-11-29T08:51:05Z</b><br><b>마지막 답변자 : Ying Huang</b><br><b>마지막 수정 일자 : 2016-12-09T02:39:30Z</b><br><b>id : 500A000000VnunHIAR</b><br>======================<br><br><b><font size=15>
제목  : nfs 파일시스템 연결 문제..
</font></b><br><br>======================<br><b>사전문의<br></b><br>어떤 문제/오류/결함이 발생했습니까? 기대하시는 결과는 무엇입니까?<br><br>nfs에 연결되어 있는 파일시스템이 nfs서버측과의 통신이 정상적으로 진행되지 않아 보이며<br>결국엔 hung_task_timeout 120s가 발생하였습니다.<br>이로 인해 수 많은 로그가 생성되면서 <br>Nov 28 20:03:18 DECCAL01SL rsyslogd-2177: imjournal: begin to drop messages due to rate-limiting<br>Nov 28 20:05:02 DECCAL01SL rsyslogd-2177: imjournal: 5631 messages lost due to rate-limiting<br>이와 같은 메시지가 발생하였습니다  <br>약 1분 30초 정도 로그를 쌓지 못하였습니다 <br><br>1, 메시지가 drop되는 설정 어디에 있는지? 또 drop이 어느 시점에 풀리는건지 궁금합니다<br><br>&lt;nfs 파일시스템 연결 장애 일부 메시지&gt;<br>Nov 28 20:00:47 DECCAL01SL kernel: nfs: server &lt;serverip&gt; not responding, still trying<br>&lt;snip&gt;<br>Nov 28 20:00:53 DECCAL01SL kernel: nfs: server &lt;serverip&gt; OK<br>Nov 28 20:07:01 DECCAL01SL kernel: INFO: task kworker/u164:0:87123 blocked for more than 120 seconds.<br>Nov 28 20:07:01 DECCAL01SL kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>Nov 28 20:07:01 DECCAL01SL kernel: Call Trace:<br>Nov 28 20:07:01 DECCAL01SL kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>Nov 28 20:07:01 DECCAL01SL kernel: Call Trace:<br>&lt;snip&gt;<br>Nov 28 20:23:10 DECCAL01SL kernel: nfs: server &lt;serverip&gt; OK<br><br> 위에 보듯이 최초 응답이 없던 시점은 20시 00분 47초 였으며 <br>hungtask timeout이 발생한 시간은 20시 07분 01초 이며 <br>마지막으로 nfs통신 정상화가 된 시간은 20시 23분 10초 였습니다<br><br>2.  그럼 io hang상태는 120초 전인 20시 05분 01초에 발생한것이 맞는지요? <br>또 hung task timeout이 발생하고 얼마정도의 시간이 지난후 io가 정상으로 되었는지요?<br>그 로그는 어떤로그인지 궁금합니다<br><br>2가지 질문에 대해서 답변 부탁드립니다<br>=======================<br><b>상태 : Closed</b><br><b>제품명  : Red Hat Enterprise Linux</b><br><b>버젼  : 7.2</b><br><b>계정 번호  : 5251314</b><br><b>심각도  : 3 (Normal)</b><br><enhancedSLA>false</enhancedSLA><contactIsPartner>false</contactIsPartner><tags/><br><br><comment id="a0aA000000IU3Z2IAL"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-12-09T02:39:30Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-12-09T02:39:30Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services를 이용해주셔서 감사합니다.<br><br>해당 케이스를 자체적으로 클로징해주셔서 대단히 감사드립니다.<br>요청대로 본 케이스를 처리완료하도록 하겠습니다.<br>만약 본 케이스와 관련하여 추가 질문이 있으시다면 언제든지 재오픈하실 수 있습니다.<br><br>케이스가 처리 완료되면 가능하게 고객 설문조사 메일이 발송됩니다. 고객님께서 남기 신 의견은<br>보다 나은 서비스를 위해 지속적으로 반영될 것입니다. 향후 기술 지원 서비스의 품질 향상을 위해,<br>소중한 시간을 내어 주시면 대단히 감사드리겠습니다.<br><br>감사합니다.<br><br><publishedDate>2016-12-09T02:39:30Z</publishedDate><createdByType>Associate</createdByType><br>======================<br><comment id="a0aA000000IJy92IAD"><br>======================<br><b>생성계정 : 게이트, 타임</b><br><b>생성날짜 : 2016-12-01T14:36:50Z</b><br><b>마지막 답변자 : 게이트, 타임</b><br><b>마지막 수정 일자 : 2016-12-01T14:36:50Z</b><br><br>내용이 나와 있군요... 기술 문의 닫도록 하겠씁니다.<br>감사합니다.<br><br><publishedDate>2016-12-01T14:36:50Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IJy8JIAT"><br>======================<br><b>생성계정 : 게이트, 타임</b><br><b>생성날짜 : 2016-12-01T14:35:53Z</b><br><b>마지막 답변자 : 게이트, 타임</b><br><b>마지막 수정 일자 : 2016-12-01T14:35:53Z</b><br><br>답변 감사합니다.<br><br>5초 안에 200개 이상의 로그가 발생할때 찍히는 메시지 설정은 어디에 있는지 마지막으로 여쭤보겠습니다.<br><br><publishedDate>2016-12-01T14:35:53Z</publishedDate><createdByType>Customer</createdByType><br>======================<br><comment id="a0aA000000IJbU7IAL"><br>======================<br><b>생성계정 : Huang, Ying</b><br><b>생성날짜 : 2016-11-30T03:09:36Z</b><br><b>마지막 답변자 : Huang, Ying</b><br><b>마지막 수정 일자 : 2016-11-30T03:09:36Z</b><br><br>안녕하세요,<br><br>Red Hat Global Support Services 를 이용해 주셔서 감사합니다.<br><br>1, 메시지가 drop되는 설정 어디에 있는지? 또 drop이 어느 시점에 풀리는건지 궁금합니다<br><br>이와 같은 메시지는 5초 안에 한개의 프로세스가 200개 이상의 로그가 발생 할때 찍히는 메시지이며<br>이는 /var 파일 시스템의 용량이 빨리 소모 되는 것을 방지 하기 위함입니다. <br><br>이와 같은 메시지를 비활성화 시키는 방법에 대해 아래와 같은 링크에서 확인 가능 하십니다. <br><br>- How to disable rsyslog Rate-Limiting in Red Hat Enterprise Linux 6? <br>https://access.redhat.com/solutions/156863<br><br>다만, 해당 기능을 비활성화 시키시면 /var 파일 시스템이 빨리 소모 될수 있다는 점을 알려 드립니다. <br><br>2.  그럼 io hang상태는 120초 전인 20시 05분 01초에 발생한것이 맞는지요? <br><br>Nov 28 20:07:01 DECCAL01SL kernel: INFO: task kworker/u164:0:87123 blocked for more than 120 seconds.<br><br>상기와 같은 메시지는 리소스를 기다리는 상태에 있을 경우 즉 &quot;D state&quot;에 진입되어 있는 시간이 120초 이상일 경우 <br>찍히게 되며 무조건 IO를 기다린다고 보장하기 어렵습니다.<br>만일 해당 프로세스가 NFS 리소스를 기다리고 있는것이라면 이유 발생 시점이 20시 05분 01초 시점 이전으로 보실수 있습니다.<br><br>&gt; 또 hung task timeout이 발생하고 얼마정도의 시간이 지난후 io가 정상으로 되었는지요?<br>&gt; 그 로그는 어떤로그인지 궁금합니다<br><br>리소스를 정상적으로 가져올 경우에는 관련 메시지가 찍히지 않습니다. 따라서 NFS 서버와 정상적으로<br>연결이 복귀된 시점은 로그메시지로 가늠하기 어렵습니다.<br><br>감사합니다.<br><br><publishedDate>2016-11-30T03:09:36Z</publishedDate><createdByType>Associate</createdByType><br>======================<br></comments><br>결국엔 hung_task_timeout 120s가 발생하였습니다.<br>이로 인해 수 많은 로그가 생성되면서 <br>Nov 28 20:03:18 DECCAL01SL rsyslogd-2177: imjournal: begin to drop messages due to rate-limiting<br>Nov 28 20:05:02 DECCAL01SL rsyslogd-2177: imjournal: 5631 messages lost due to rate-limiting<br>이와 같은 메시지가 발생하였습니다  <br>약 1분 30초 정도 로그를 쌓지 못하였습니다 <br><br>1, 메시지가 drop되는 설정 어디에 있는지? 또 drop이 어느 시점에 풀리는건지 궁금합니다<br><br>&lt;nfs 파일시스템 연결 장애 일부 메시지&gt;<br>Nov 28 20:00:47 DECCAL01SL kernel: nfs: server &lt;serverip&gt; not responding, still trying<br>&lt;snip&gt;<br>Nov 28 20:00:53 DECCAL01SL kernel: nfs: server &lt;serverip&gt; OK<br>Nov 28 20:07:01 DECCAL01SL kernel: INFO: task kworker/u164:0:87123 blocked for more than 120 seconds.<br>Nov 28 20:07:01 DECCAL01SL kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>Nov 28 20:07:01 DECCAL01SL kernel: Call Trace:<br>Nov 28 20:07:01 DECCAL01SL kernel: &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.<br>Nov 28 20:07:01 DECCAL01SL kernel: Call Trace:<br>&lt;snip&gt;<br>Nov 28 20:23:10 DECCAL01SL kernel: nfs: server &lt;serverip&gt; OK<br><br> 위에 보듯이 최초 응답이 없던 시점은 20시 00분 47초 였으며 <br>hungtask timeout이 발생한 시간은 20시 07분 01초 이며 <br>마지막으로 nfs통신 정상화가 된 시간은 20시 23분 10초 였습니다<br><br>2.  그럼 io hang상태는 120초 전인 20시 05분 01초에 발생한것이 맞는지요? <br>또 hung task timeout이 발생하고 얼마정도의 시간이 지난후 io가 정상으로 되었는지요?<br>그 로그는 어떤로그인지 궁금합니다<br><br>2가지 질문에 대해서 답변 부탁드립니다</issue><cep>false</cep></case>